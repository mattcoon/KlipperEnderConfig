===== Config file =====
[virtual_sdcard]
path = ~/printer_data/gcodes
on_error_gcode = CANCEL_PRINT

[pause_resume]
recover_velocity = 25

[display_status]

[respond]
default_prefix = 

[gcode_macro CANCEL_PRINT]
description = Cancel the actual running print
rename_existing = BASE_CANCEL_PRINT
gcode = 
	G91
	G0 Z10 F600
	G90
	TURN_OFF_HEATERS
	G0 X5 Y220
	CLEAR_PAUSE
	
	BASE_CANCEL_PRINT

[gcode_macro PAUSE]
description = Pause the actual running print
rename_existing = PAUSE_BASE
gcode = 
	
	{% set x = params.X|default(5) %}
	{% set y = params.Y|default(225) %}
	{% set z = params.Z|default(10)|float %}
	{% set e = params.E|default(1) %}
	
	{% set max_z = printer.toolhead.axis_maximum.z|float %}
	{% set act_z = printer.toolhead.position.z|float %}
	{% set lift_z = z|abs %}
	{% if act_z < (max_z - lift_z) %}
	{% set z_safe = lift_z %}
	{% else %}
	{% set z_safe = max_z - act_z %}
	{% endif %}
	
	PAUSE_BASE
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E-{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	{% if "xyz" in printer.toolhead.homed_axes %}
	G1 Z{z_safe}
	G90
	G1 X{x} Y{y} F6000
	{% else %}
	{action_respond_info("Printer not homed")}
	{% endif %}

[gcode_macro RESUME]
description = Resume the actual running print
rename_existing = RESUME_BASE
variable_last_extruder_temp = {'restore': False, 'temp': 0}
variable_restore_idle_timeout = 0
variable_idle_state = False
gcode = 
	
	{% set e = params.E|default(1) %}
	
	{% if 'VELOCITY' in params|upper %}
	{% set get_params = ('VELOCITY=' + params.VELOCITY)  %}
	{%else %}
	{% set get_params = "" %}
	{% endif %}
	
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	RESUME_BASE {get_params}

[gcode_macro SET_PAUSE_NEXT_LAYER]
description = Enable a pause if the next layer is reached
gcode = 
	{% set pause_next_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_next_layer %}
	{% set ENABLE = params.ENABLE|default(1)|int != 0 %}
	{% set MACRO = params.MACRO|default(pause_next_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_next_layer VALUE="{{ 'enable': ENABLE, 'call': MACRO }}"

[gcode_macro SET_PAUSE_AT_LAYER]
description = Enable/disable a pause if a given layer number is reached
gcode = 
	{% set pause_at_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_at_layer %}
	{% set ENABLE = params.ENABLE|int != 0 if params.ENABLE is defined
	else params.LAYER is defined %}
	{% set LAYER = params.LAYER|default(pause_at_layer.layer)|int %}
	{% set MACRO = params.MACRO|default(pause_at_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_at_layer VALUE="{{ 'enable': ENABLE, 'layer': LAYER, 'call': MACRO }}"

[gcode_macro SET_PRINT_STATS_INFO]
rename_existing = SET_PRINT_STATS_INFO_BASE
description = Overwrite, to get pause_next_layer and pause_at_layer feature
variable_pause_next_layer = { 'enable': False, 'call': "PAUSE" }
variable_pause_at_layer = { 'enable': False, 'layer': 0, 'call': "PAUSE" }
gcode = 
	{% if pause_next_layer.enable %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_next_layer" % pause_next_layer.call}'
	{pause_next_layer.call}
	SET_PAUSE_NEXT_LAYER ENABLE=0
	{% elif pause_at_layer.enable and params.CURRENT_LAYER is defined and params.CURRENT_LAYER|int == pause_at_layer.layer %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_at_layer [%d]" % (pause_at_layer.call, pause_at_layer.layer)}'
	{pause_at_layer.call}
	SET_PAUSE_AT_LAYER ENABLE=0
	{% endif %}
	SET_PRINT_STATS_INFO_BASE {rawparams}

[gcode_macro _TOOLHEAD_PARK_PAUSE_CANCEL]
description = Helper: park toolhead used in PAUSE and CANCEL_PRINT
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set velocity = printer.configfile.settings.pause_resume.recover_velocity %}
	{% set use_custom     = client.use_custom_pos|default(false)|lower == 'true' %}
	{% set custom_park_x  = client.custom_park_x|default(0.0) %}
	{% set custom_park_y  = client.custom_park_y|default(0.0) %}
	{% set park_dz        = client.custom_park_dz|default(2.0)|abs %}
	{% set sp_hop         = client.speed_hop|default(15) * 60 %}
	{% set sp_move        = client.speed_move|default(velocity) * 60 %}
	
	{% set origin    = printer.gcode_move.homing_origin %}
	{% set act       = printer.gcode_move.gcode_position %}
	{% set max       = printer.toolhead.axis_maximum %}
	{% set cone      = printer.toolhead.cone_start_z|default(max.z) %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	
	{% set z_min = params.Z_MIN|default(0)|float %}
	{% set z_park = [[(act.z + park_dz), z_min]|max, (max.z - origin.z)]|min %}
	{% set x_park = params.X       if params.X is defined
	else custom_park_x  if use_custom
	else 0.0            if round_bed
	else (max.x - 5.0) %}
	{% set y_park = params.Y       if params.Y is defined
	else custom_park_y  if use_custom
	else (max.y - 5.0)  if round_bed and z_park < cone
	else 0.0            if round_bed
	else (max.y - 5.0) %}
	
	_CLIENT_RETRACT
	{% if "xyz" in printer.toolhead.homed_axes %}
	G90
	G1 Z{z_park} F{sp_hop}
	G1 X{x_park} Y{y_park} F{sp_move}
	{% if not printer.gcode_move.absolute_coordinates %} G91 {% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='Printer not homed'
	{% endif %}

[gcode_macro _CLIENT_EXTRUDE]
description = Extrudes, if the extruder is hot enough
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set use_fw_retract = (client.use_fw_retract|default(false)|lower == 'true') and (printer.firmware_retraction is defined) %}
	{% set length = params.LENGTH|default(client.unretract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_unretract)|default(35) %}
	{% set absolute_extrude = printer.gcode_move.absolute_extrude %}
	
	{% if printer.toolhead.extruder != '' %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if use_fw_retract %}
	{% if length < 0 %}
	G10
	{% else %}
	G11
	{% endif %}
	{% else %}
	M83
	G1 E{length} F{(speed|float|abs) * 60}
	{% if absolute_extrude %}
	M82
	{% endif %}
	{% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='{"\"%s\" not hot enough" % printer.toolhead.extruder}'
	{% endif %}
	{% endif %}

[gcode_macro _CLIENT_RETRACT]
description = Retracts, if the extruder is hot enough
gcode = 
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set length = params.LENGTH|default(client.retract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_retract)|default(35) %}
	
	_CLIENT_EXTRUDE LENGTH=-{length|float|abs} SPEED={speed|float|abs}

[gcode_macro _CLIENT_LINEAR_MOVE]
description = Linear move with save and restore of the gcode state
gcode = 
	{% set x_move = "X" ~ params.X if params.X is defined else "" %}
	{% set y_move = "Y" ~ params.Y if params.Y is defined else "" %}
	{% set z_move = "Z" ~ params.Z if params.Z is defined else "" %}
	{% set e_move = "E" ~ params.E if params.E is defined else "" %}
	{% set rate = "F" ~ params.F if params.F is defined else "" %}
	{% set ABSOLUTE = params.ABSOLUTE | default(0) | int != 0 %}
	{% set ABSOLUTE_E = params.ABSOLUTE_E | default(0) | int != 0 %}
	SAVE_GCODE_STATE NAME=_client_movement
	{% if x_move or y_move or z_move %}
	G9{ 0 if ABSOLUTE else 1 }
	{% endif %}
	{% if e_move %}
	M8{ 2 if ABSOLUTE_E else 3 }
	{% endif %}
	G1 { x_move } { y_move } { z_move } { e_move } { rate }
	RESTORE_GCODE_STATE NAME=_client_movement

[gcode_macro play_test]
gcode = 
	RESPOND TYPE=command MSG="action:prompt_begin Question"
	RESPOND TYPE=command MSG="action:prompt_text Do you wont to cancel the print?"
	RESPOND TYPE=command MSG="action:prompt_footer_button continue|RESPOND TYPE=command MSG=action:prompt_end"
	RESPOND TYPE=command MSG="action:prompt_footer_button CANCEL|CANCEL_PRINT|error"
	RESPOND TYPE=command MSG="action:prompt_show"

[gcode_macro PRINT_START]
gcode = 
	START_PRINT {rawparams}

[gcode_macro START_PRINT]
gcode = 
	{% set BED_TEMP = params.BED_TEMP|default(60)|float %}
	{% set EXTRUDER_TEMP = params.EXTRUDER_TEMP|default(190)|float %}
	
	M190 S{BED_TEMP}
	
	G90
	
	G28
	
	RESPOND MSG="Bed Meshing"
	
	
	
	
	
	
	
	
	BED_MESH_CLEAR
	BED_MESH_CALIBRATE ADAPTIVE=1
	
	
	
	
	
	
	
	RESPOND MSG="Heating to print temp"
	M104 S{EXTRUDER_TEMP}
	G0 Z40 F240
	M109 S{EXTRUDER_TEMP}
	RESPOND MSG="Enable Runout Sensor"
	SFS_ENABLE
	RESPOND MSG="Line Purge"
	LINE_PURGE
	RESPOND MSG="Print Started"

[gcode_macro LINE_PURGE]
gcode = 
	G92 E0
	G1 Z2.0 F3000
	G1 X0.1 Y20 Z0.3 F5000.0
	G1 X0.1 Y200.0 Z0.3 F1500.0 E15
	G1 X0.4 Y200.0 Z0.3 F5000.0
	G1 X0.4 Y20 Z0.3 F1500.0 E30
	G92 E0
	G1 Z2.0 F3000
	G1 X5 Y20 Z0.3 F5000.0

[gcode_macro PRINT_END]
gcode = 
	END_PRINT

[gcode_macro END_PRINT]
gcode = 
	
	
	RESPOND MSG="Print Finished"
	G91
	G1 E-.5 Z0.2 F2400
	G1 X5 Y5 F6000
	G1 Z10
	G90
	SFS_DISABLE
	
	G1 X0 Y220 F6000
	M106 S0
	M104 S0
	M140 S0
	
	M84 X Y E

[gcode_macro SET_ACTIVE_SPOOL]
gcode = 
	{% if params.ID %}
	{% set id = params.ID|int %}
	{action_call_remote_method(
	"spoolman_set_active_spool",
	spool_id=id
	)}
	{% else %}
	{action_respond_info("Parameter 'ID' is required")}
	{% endif %}

[gcode_macro CLEAR_ACTIVE_SPOOL]
gcode = 
	{action_call_remote_method(
	"spoolman_set_active_spool",
	spool_id=None
	)}

[gcode_macro G29]
gcode = 
	G28
	BED_MESH_CALIBRATE
	G0 X0 Y0 Z10 F6000
	BED_MESH_PROFILE save=default

[gcode_macro M125]
gcode = 
	SAVE_GCODE_STATE NAME=parking
	M117 Parking toolhead
	G91
	G1 Z10 F600
	G90
	G1 X5 Y225 F4000
	RESTORE_GCODE_STATE NAME=parking

[gcode_macro Load_Filament]
gcode = 
	SAVE_GCODE_STATE NAME=loading_filament
	M117 Loading Filament
	M83
	G92 E0.0
	G91
	G1 E50 F200
	G92 E50
	RESTORE_GCODE_STATE NAME=loading_filament

[gcode_macro Unload_Filament]
gcode = 
	SAVE_GCODE_STATE NAME=unloading_filament
	M117 Unloading Filament
	G91
	G1 E5 F100
	G92 E0.0
	G1 E-50 F5000
	G92 E-50
	RESTORE_GCODE_STATE NAME=unloading_filament

[gcode_macro Filament_Change]
gcode = 
	
	SAVE_GCODE_STATE NAME=filament_change
	
	Unload_Filament
	
	RESPOND TYPE=command MSG="action:prompt_begin Question"
	RESPOND TYPE=command MSG="action:prompt_text Please insert new filament and confirm"
	RESPOND TYPE=command MSG="action:prompt_footer_button CONFIRM|Load_Filament|RESPOND TYPE=command MSG=action:prompt_end"
	RESPOND TYPE=command MSG="action:prompt_footer_button CANCEL|RESPOND TYPE=command MSG=action:prompt_end"
	RESPOND TYPE=command MSG="action:prompt_show"
	
	RESTORE_GCODE_STATE NAME=filament_change

[gcode_macro Calibrate_Hotend_PID]
gcode = 
	PID_CALIBRATE HEATER=extruder TARGET=200

[gcode_macro Calibrate_Bed_PID]
gcode = 
	PID_CALIBRATE HEATER=heater_bed TARGET=60

[gcode_macro Calibrate_Zoffset]
gcode = 
	PROBE_CALIBRATE

[gcode_macro Tram_bed]
gcode = 
	SCREWS_TILT_CALCULATE

[gcode_macro TEST_SPEED]
description = Test for max speed and acceleration parameters for the printer. Procedure: Home -> ReadPositionFromMCU -> MovesToolhead@Vel&Accel -> Home -> ReadPositionfromMCU
gcode = 
	
	{% set speed  = params.SPEED|default(printer.configfile.settings.printer.max_velocity)|int %}
	
	{% set iterations = params.ITERATIONS|default(5)|int %}
	
	{% set accel  = params.ACCEL|default(printer.configfile.settings.printer.max_accel)|int %}
	
	{% set min_cruise_ratio = params.MIN_CRUISE_RATIO|default(0.5)|float %}
	
	{% set bound = params.BOUND|default(20)|int %}
	
	{% set smallpatternsize = SMALLPATTERNSIZE|default(20)|int %}
	
	
	
	{% set x_min = printer.toolhead.axis_minimum.x + bound %}
	{% set x_max = printer.toolhead.axis_maximum.x - bound %}
	{% set y_min = printer.toolhead.axis_minimum.y + bound %}
	{% set y_max = printer.toolhead.axis_maximum.y - bound %}
	
	
	
	{% set x_center = (printer.toolhead.axis_minimum.x|float + printer.toolhead.axis_maximum.x|float ) / 2 %}
	{% set y_center = (printer.toolhead.axis_minimum.y|float + printer.toolhead.axis_maximum.y|float ) / 2 %}
	
	
	{% set x_center_min = x_center - (smallpatternsize/2) %}
	{% set x_center_max = x_center + (smallpatternsize/2) %}
	{% set y_center_min = y_center - (smallpatternsize/2) %}
	{% set y_center_max = y_center + (smallpatternsize/2) %}
	
	
	SAVE_GCODE_STATE NAME=TEST_SPEED
	
	
	{ action_respond_info("TEST_SPEED: starting %d iterations at speed %d, accel %d" % (iterations, speed, accel)) }
	
	
	M400
	G28
	
	{% if printer.configfile.settings.quad_gantry_level %}
	{% if printer.quad_gantry_level.applied == False %}
	QUAD_GANTRY_LEVEL
	G28 Z
	{% endif %}
	{% endif %}
	
	G90
	G1 X{printer.toolhead.axis_maximum.x-50} Y{printer.toolhead.axis_maximum.y-50} F{30*60}
	M400
	G28 X Y
	G0 X{printer.toolhead.axis_maximum.x-1} Y{printer.toolhead.axis_maximum.y-1} F{30*60}
	G4 P1000
	GET_POSITION
	
	
	G0 X{x_min} Y{y_min} Z{bound + 10} F{speed*60}
	
	
	{% if printer.configfile.settings.printer.minimum_cruise_ratio is defined %}
	SET_VELOCITY_LIMIT VELOCITY={speed} ACCEL={accel} MINIMUM_CRUISE_RATIO={min_cruise_ratio}
	{% else %}
	SET_VELOCITY_LIMIT VELOCITY={speed} ACCEL={accel} ACCEL_TO_DECEL={accel / 2}
	{% endif %}
	
	{% for i in range(iterations) %}
	
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_max} Y{y_max} F{speed*60}
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	G0 X{x_min} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	
	
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_min} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	
	
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_max} Y{y_center_max} F{speed*60}
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	G0 X{x_center_min} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	
	
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_min} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	{% endfor %}
	
	
	{% if printer.configfile.settings.printer.minimum_cruise_ratio is defined %}
	SET_VELOCITY_LIMIT VELOCITY={printer.configfile.settings.printer.max_velocity} ACCEL={printer.configfile.settings.printer.max_accel} MINIMUM_CRUISE_RATIO={printer.configfile.settings.printer.minimum_cruise_ratio}
	{% else %}
	SET_VELOCITY_LIMIT VELOCITY={printer.configfile.settings.printer.max_velocity} ACCEL={printer.configfile.settings.printer.max_accel} ACCEL_TO_DECEL={printer.configfile.settings.printer.max_accel_to_decel}
	{% endif %}
	
	
	M400
	G28
	
	G90
	G0 X{printer.toolhead.axis_maximum.x-1} Y{printer.toolhead.axis_maximum.y-1} F{30*60}
	G4 P1000
	GET_POSITION
	
	
	RESTORE_GCODE_STATE NAME=TEST_SPEED

[gcode_macro GET_TIMELAPSE_SETUP]
description = Print the Timelapse setup
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% set output_txt = ["Timelapse Setup:"] %}
	{% set _dummy = output_txt.append("enable: %s" % tl.enable) %}
	{% set _dummy = output_txt.append("park: %s" % tl.park.enable) %}
	{% if tl.park.enable %}
	{% set _dummy = output_txt.append("park position: %s time: %s s" % (tl.park.pos, tl.park.time)) %}
	{% set _dummy = output_txt.append("park cord x:%s y:%s dz:%s" % (tl.park.coord.x, tl.park.coord.y, tl.park.coord.dz)) %}
	{% set _dummy = output_txt.append("travel speed: %s mm/s" % tl.speed.travel) %}
	{% endif %}
	{% set _dummy = output_txt.append("fw_retract: %s" % tl.extruder.fw_retract) %}
	{% if not tl.extruder.fw_retract %}
	{% set _dummy = output_txt.append("retract: %s mm speed: %s mm/s" % (tl.extruder.retract, tl.speed.retract)) %}
	{% set _dummy = output_txt.append("extrude: %s mm speed: %s mm/s" % (tl.extruder.extrude, tl.speed.extrude)) %}
	{% endif %}
	{% set _dummy = output_txt.append("verbose: %s" % tl.verbose) %}
	{action_respond_info(output_txt|join("\n"))}

[gcode_macro _SET_TIMELAPSE_SETUP]
description = Set user parameters for timelapse
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	
	{% set min = printer.toolhead.axis_minimum %}
	{% set max = printer.toolhead.axis_maximum %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	{% set park = {'min'   : {'x': (min.x / 1.42)|round(3) if round_bed else min.x|round(3),
	'y': (min.y / 1.42)|round(3) if round_bed else min.y|round(3)},
	'max'   : {'x': (max.x / 1.42)|round(3) if round_bed else max.x|round(3),
	'y': (max.y / 1.42)|round(3) if round_bed else max.y|round(3)},
	'center': {'x': (max.x-(max.x-min.x)/2)|round(3),
	'y': (max.y-(max.y-min.y)/2)|round(3)}} %}
	
	{% if params.ENABLE %}
	{% if params.ENABLE|lower is in ['true', 'false'] %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=enable VALUE={True if params.ENABLE|lower == 'true' else False}
	{% else %}
	{action_raise_error("ENABLE=%s not supported. Allowed values are [True, False]" % params.ENABLE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.VERBOSE %}
	{% if params.VERBOSE|lower is in ['true', 'false'] %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=verbose VALUE={True if params.VERBOSE|lower == 'true' else False}
	{% else %}
	{action_raise_error("VERBOSE=%s not supported. Allowed values are [True, False]" % params.VERBOSE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_X %}
	{% if params.CUSTOM_POS_X|float >= min.x and params.CUSTOM_POS_X|float <= max.x %}
	{% set _dummy = tl.park.custom.update({'x':params.CUSTOM_POS_X|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_X=%s must be within [%s - %s]" % (params.CUSTOM_POS_X, min.x, max.x))}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_Y %}
	{% if params.CUSTOM_POS_Y|float >= min.y and params.CUSTOM_POS_Y|float <= max.y %}
	{% set _dummy = tl.park.custom.update({'y':params.CUSTOM_POS_Y|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_Y=%s must be within [%s - %s]" % (params.CUSTOM_POS_Y, min.y, max.y))}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_DZ %}
	{% if params.CUSTOM_POS_DZ|float >= min.z and params.CUSTOM_POS_DZ|float <= max.z %}
	{% set _dummy = tl.park.custom.update({'dz':params.CUSTOM_POS_DZ|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_DZ=%s must be within [%s - %s]" % (params.CUSTOM_POS_DZ, min.z, max.z))}
	{% endif %}
	{% endif %}
	{% if params.PARK_ENABLE %}
	{% if params.PARK_ENABLE|lower is in ['true', 'false'] %}
	{% set _dummy = tl.park.update({'enable':True if params.PARK_ENABLE|lower == 'true' else False}) %}
	{% else %}
	{action_raise_error("PARK_ENABLE=%s not supported. Allowed values are [True, False]" % params.PARK_ENABLE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.PARK_POS %}
	{% if params.PARK_POS|lower is in ['center','front_left','front_right','back_left','back_right','custom','x_only','y_only'] %}
	{% set dic = {'center'      : {'x': park.center.x   , 'y': park.center.y   , 'dz': 1                },
	'front_left'  : {'x': park.min.x      , 'y': park.min.y      , 'dz': 0                },
	'front_right' : {'x': park.max.x      , 'y': park.min.y      , 'dz': 0                },
	'back_left'   : {'x': park.min.x      , 'y': park.max.y      , 'dz': 0                },
	'back_right'  : {'x': park.max.x      , 'y': park.max.y      , 'dz': 0                },
	'custom'      : {'x': tl.park.custom.x, 'y': tl.park.custom.y, 'dz': tl.park.custom.dz},
	'x_only'      : {'x': tl.park.custom.x, 'y': 'none'          , 'dz': tl.park.custom.dz},
	'y_only'      : {'x': 'none'          , 'y': tl.park.custom.y, 'dz': tl.park.custom.dz}} %}
	{% set _dummy = tl.park.update({'pos':params.PARK_POS|lower}) %}
	{% set _dummy = tl.park.update({'coord':dic[tl.park.pos]}) %}
	{% else %}
	{action_raise_error("PARK_POS=%s not supported. Allowed values are [CENTER, FRONT_LEFT, FRONT_RIGHT, BACK_LEFT, BACK_RIGHT, CUSTOM, X_ONLY, Y_ONLY]"
	% params.PARK_POS|upper)}
	{% endif %}
	{% endif %}
	{% if params.PARK_TIME %}
	{% if params.PARK_TIME|float >= 0.0 %}
	{% set _dummy = tl.park.update({'time':params.PARK_TIME|float|round(3)}) %}
	{% else %}
	{action_raise_error("PARK_TIME=%s must be a positive number" % params.PARK_TIME)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=park VALUE="{tl.park}"
	{% if params.TRAVEL_SPEED %}
	{% if params.TRAVEL_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'travel':params.TRAVEL_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("TRAVEL_SPEED=%s must be larger than 0" % params.TRAVEL_SPEED)}
	{% endif %}
	{% endif %}
	{% if params.RETRACT_SPEED %}
	{% if params.RETRACT_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'retract':params.RETRACT_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("RETRACT_SPEED=%s must be larger than 0" % params.RETRACT_SPEED)}
	{% endif %}
	{% endif %}
	{% if params.EXTRUDE_SPEED %}
	{% if params.EXTRUDE_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'extrude':params.EXTRUDE_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("EXTRUDE_SPEED=%s must be larger than 0" % params.EXTRUDE_SPEED)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=speed VALUE="{tl.speed}"
	{% if params.EXTRUDE_DISTANCE %}
	{% if params.EXTRUDE_DISTANCE|float >= 0.0 %}
	{% set _dummy = tl.extruder.update({'extrude':params.EXTRUDE_DISTANCE|float|round(3)}) %}
	{% else %}
	{action_raise_error("EXTRUDE_DISTANCE=%s must be specified as positiv number" % params.EXTRUDE_DISTANCE)}
	{% endif %}
	{% endif %}
	{% if params.RETRACT_DISTANCE %}
	{% if params.RETRACT_DISTANCE|float >= 0.0 %}
	{% set _dummy = tl.extruder.update({'retract':params.RETRACT_DISTANCE|float|round(3)}) %}
	{% else %}
	{action_raise_error("RETRACT_DISTANCE=%s must be specified as positiv number" % params.RETRACT_DISTANCE)}
	{% endif %}
	{% endif %}
	{% if params.FW_RETRACT %}
	{% if params.FW_RETRACT|lower is in ['true', 'false'] %}
	{% if 'firmware_retraction' in printer.configfile.settings %}
	{% set _dummy = tl.extruder.update({'fw_retract': True if params.FW_RETRACT|lower == 'true' else False}) %}
	{% else %}
	{% set _dummy = tl.extruder.update({'fw_retract':False}) %}
	{% if params.FW_RETRACT|capitalize == 'True' %}
	{action_raise_error("[firmware_retraction] not defined in printer.cfg. Can not enable fw_retract")}
	{% endif %}
	{% endif %}
	{% else %}
	{action_raise_error("FW_RETRACT=%s not supported. Allowed values are [True, False]" % params.FW_RETRACT|capitalize)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=extruder VALUE="{tl.extruder}"
	{% if printer.configfile.settings['gcode_macro pause'] is defined %}
	{% set _dummy = tl.macro.update({'pause': printer.configfile.settings['gcode_macro pause'].rename_existing}) %}
	{% endif %}
	{% if printer.configfile.settings['gcode_macro resume'] is defined %}
	{% set _dummy = tl.macro.update({'resume': printer.configfile.settings['gcode_macro resume'].rename_existing}) %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=macro VALUE="{tl.macro}"

[gcode_macro TIMELAPSE_TAKE_FRAME]
description = Take Timelapse shoot
variable_enable = False
variable_takingframe = False
variable_park = {'enable': False,
	'pos'   : 'center',
	'time'  : 0.1,
	'custom': {'x': 0, 'y': 0, 'dz': 0},
	'coord' : {'x': 0, 'y': 0, 'dz': 0}}
variable_extruder = {'fw_retract': False,
	'retract': 1.0,
	'extrude': 1.0}
variable_speed = {'travel': 100,
	'retract': 15,
	'extrude': 15}
variable_verbose = True
variable_check_time = 0.5
variable_restore = {'absolute': {'coordinates': True, 'extrude': True}, 'speed': 1500, 'e':0, 'factor': {'speed': 1.0, 'extrude': 1.0}}
variable_macro = {'pause': 'PAUSE', 'resume': 'RESUME'}
variable_is_paused = False
gcode = 
	{% set hyperlapse = True if params.HYPERLAPSE and params.HYPERLAPSE|lower =='true' else False %}
	{% if enable %}
	{% if (hyperlapse and printer['gcode_macro HYPERLAPSE'].run) or
	(not hyperlapse and not printer['gcode_macro HYPERLAPSE'].run) %}
	{% if park.enable %}
	{% set pos = {'x': 'X' + park.coord.x|string if park.pos != 'y_only' else '',
	'y': 'Y' + park.coord.y|string if park.pos != 'x_only' else '',
	'z': 'Z'+ [printer.gcode_move.gcode_position.z + park.coord.dz, printer.toolhead.axis_maximum.z]|min|string} %}
	{% set restore = {'absolute': {'coordinates': printer.gcode_move.absolute_coordinates,
	'extrude'    : printer.gcode_move.absolute_extrude},
	'speed'   : printer.gcode_move.speed,
	'e'       : printer.gcode_move.gcode_position.e,
	'factor'  : {'speed'  : printer.gcode_move.speed_factor,
	'extrude': printer.gcode_move.extrude_factor}} %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=restore VALUE="{restore}"
	{% if not printer[printer.toolhead.extruder].can_extrude %}
	{% if verbose %}{action_respond_info("Timelapse: Warning, minimum extruder temperature not reached!")}{% endif %}
	{% else %}
	{% if extruder.fw_retract %}
	G10
	{% else %}
	M83
	G0 E-{extruder.retract} F{speed.retract * 60}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=is_paused VALUE=True
	{macro.pause}
	SET_GCODE_OFFSET X=0 Y=0
	G90
	{% if "xyz" not in printer.toolhead.homed_axes %}
	{% if verbose %}{action_respond_info("Timelapse: Warning, axis not homed yet!")}{% endif %}
	{% else %}
	G0 {pos.x} {pos.y} {pos.z} F{speed.travel * 60}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=takingframe VALUE=True
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_TAKE_FRAME DURATION={check_time}
	M400
	{% endif %}
	_TIMELAPSE_NEW_FRAME HYPERLAPSE={hyperlapse}
	{% endif %}
	{% else %}
	{% if verbose %}{action_respond_info("Timelapse: disabled, take frame ignored")}{% endif %}
	{% endif %}

[gcode_macro _TIMELAPSE_NEW_FRAME]
description = action call for timelapse shoot. must be a seperate macro
gcode = 
	{action_call_remote_method("timelapse_newframe",
	macropark=printer['gcode_macro TIMELAPSE_TAKE_FRAME'].park,
	hyperlapse=params.HYPERLAPSE)}

[delayed_gcode _WAIT_TIMELAPSE_TAKE_FRAME]
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% set factor = {'speed': printer.gcode_move.speed_factor, 'extrude': printer.gcode_move.extrude_factor} %}
	{% if tl.takingframe %}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_TAKE_FRAME DURATION={tl.check_time}
	{% else %}
	{tl.macro.resume} VELOCITY={tl.speed.travel}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=is_paused VALUE=False
	{% if not printer[printer.toolhead.extruder].can_extrude %}
	{action_respond_info("Timelapse: Warning minimum extruder temperature not reached!")}
	{% else %}
	{% if tl.extruder.fw_retract %}
	G11
	{% else %}
	G0 E{tl.extruder.extrude} F{tl.speed.extrude * 60}
	G0 F{tl.restore.speed}
	{% if tl.restore.absolute.extrude %}
	M82
	G92 E{tl.restore.e}
	{% endif %}
	{% endif %}
	{% endif %}
	{% if tl.restore.factor.speed   != factor.speed   %} M220 S{(factor.speed*100)|round(0)}   {% endif %}
	{% if tl.restore.factor.extrude != factor.extrude %} M221 S{(factor.extrude*100)|round(0)} {% endif %}
	{% if not tl.restore.absolute.coordinates %} G91 {% endif %}
	{% endif %}

[gcode_macro HYPERLAPSE]
description = Start/Stop a hyperlapse recording
variable_cycle = 0
variable_run = False
gcode = 
	{% set cycle = params.CYCLE|default(30)|int %}
	{% if params.ACTION and params.ACTION|lower == 'start' %}
	{action_respond_info("Hyperlapse: frames started (Cycle %d sec)" % cycle)}
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=run VALUE=True
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=cycle VALUE={cycle}
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION={cycle}
	TIMELAPSE_TAKE_FRAME HYPERLAPSE=True
	{% elif params.ACTION and params.ACTION|lower == 'stop' %}
	{% if run %}{action_respond_info("Hyperlapse: frames stopped")}{% endif %}
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=run VALUE=False
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION=0
	{% else %}
	{action_raise_error("Hyperlapse: No valid input parameter
	Use:
	- HYPERLAPSE ACTION=START [CYCLE=time]
	- HYPERLAPSE ACTION=STOP")}
	{% endif %}

[delayed_gcode _HYPERLAPSE_LOOP]
gcode = 
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION={printer["gcode_macro HYPERLAPSE"].cycle}
	TIMELAPSE_TAKE_FRAME HYPERLAPSE=True

[gcode_macro TIMELAPSE_RENDER]
description = Render Timelapse video and wait for the result
variable_render = False
variable_run_identifier = 0
gcode = 
	{action_respond_info("Timelapse: Rendering started")}
	{action_call_remote_method("timelapse_render", byrendermacro="True")}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_RENDER VARIABLE=render VALUE=True
	{printer.configfile.settings['gcode_macro pause'].rename_existing}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_RENDER DURATION=0.5

[delayed_gcode _WAIT_TIMELAPSE_RENDER]
gcode = 
	{% set ri = printer['gcode_macro TIMELAPSE_RENDER'].run_identifier % 4 %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_RENDER VARIABLE=run_identifier VALUE={ri + 1}
	{% if printer['gcode_macro TIMELAPSE_RENDER'].render %}
	M117 Rendering {['-','\\','|','/'][ri]}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_RENDER DURATION=0.5
	{% else %}
	{action_respond_info("Timelapse: Rendering finished")}
	M117
	{printer.configfile.settings['gcode_macro resume'].rename_existing}
	{% endif %}

[gcode_macro TEST_STREAM_DELAY]
description = Helper macro to find stream and park delay
gcode = 
	{% set min = printer.toolhead.axis_minimum %}
	{% set max = printer.toolhead.axis_maximum %}
	{% set act = printer.toolhead.position %}
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% if act.z > 5.0 %}
	G0 X{min.x + 5.0} F{tl.speed.travel|int * 60}
	G0 X{(max.x-min.x)/2}
	G4 P{tl.park.time|float * 1000}
	_TIMELAPSE_NEW_FRAME HYPERLAPSE=FALSE
	G0 X{max.x - 5.0}
	{% else %}
	{action_raise_error("Toolhead z %.3f to low. Please place head above z = 5.0" % act.z)}
	{% endif %}

[gcode_macro _OBICO_LAYER_CHANGE]
description = Run a scan across the current print area
variable_first_layer_scan_retract_length = 6
variable_first_layer_scan_retract_speed = 15
variable_first_layer_scan_cooldown_temp = 170
variable_first_layer_scan_resume_speed = 50
variable_first_layer_scan_enabled = True
variable_first_layer_scan_stepover = 10
variable_first_layer_scan_speed = 10
variable_first_layer_scan_zhop = 4
variable_first_layer_scan_zhop_speed = 15
variable_verbose = False
variable_current_layer = -1
variable_first_layer_scanning = False
variable_wait = {'resume': "RESUME", 'absolute_coordinates': True, 'absolute_extrude': True, 'e': 0.0, 'previous_temp': 0}
gcode = 
	
	{% set pause_macro  = "PAUSE"  if printer.configfile.settings['gcode_macro pause']  is not defined
	else printer.configfile.settings['gcode_macro pause'].rename_existing %}
	{% set resume_macro = "RESUME" if printer.configfile.settings['gcode_macro resume'] is not defined
	else printer.configfile.settings['gcode_macro resume'].rename_existing %}
	
	{% set current_layer_default = printer.print_stats.info.current_layer if printer.print_stats.info.current_layer is not none else -1 %}
	{% set current_layer = params.CURRENT_LAYER|default(current_layer_default)|int %}
	
	{% set polygon_points = printer.exclude_object.objects|map(attribute='polygon')|sum(start=[]) if printer.exclude_object is defined else [] %}
	{% set min_x = params.MINX|default(polygon_points|map(attribute=0)|min|default(printer.toolhead.axis_minimum.x))|float %}
	{% set min_y = params.MINY|default(polygon_points|map(attribute=1)|min|default(printer.toolhead.axis_minimum.y))|float %}
	{% set max_x = params.MAXX|default(polygon_points|map(attribute=0)|max|default(printer.toolhead.axis_maximum.x))|float %}
	{% set max_y = params.MAXY|default(polygon_points|map(attribute=1)|max|default(printer.toolhead.axis_maximum.y))|float %}
	
	{% set stepoverCount = ((max_y - min_y) / first_layer_scan_stepover|float)|round(method='ceil')|int %}
	
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Layer %d" % (current_layer)}' {% endif %}
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=current_layer VALUE={current_layer}
	
	{% if first_layer_scan_enabled and current_layer == 2 %}
	
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=first_layer_scanning VALUE=True
	
	
	{% set wait_dic = {'resume'              : resume_macro,
	'absolute_coordinates': printer.gcode_move.absolute_coordinates,
	'absolute_extrude'    : printer.gcode_move.absolute_extrude,
	'e'                   : printer.gcode_move.gcode_position.e,
	'previous_temp'       : printer.extruder.target} %}
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=wait VALUE="{wait_dic}"
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Prepare scanning" {% endif %}
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Scan Coordinates: Min:[%.3f:%.3f] Max:[%.3f:%.3f]" % (min_x,min_y,max_x,max_y)}' {% endif %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Retract %.1fmm filament" % first_layer_scan_retract_length|abs}' {% endif %}
	M83
	G0 E-{first_layer_scan_retract_length|abs} F{first_layer_scan_retract_speed|float * 60}
	{% endif %}
	G91
	G0 Z{first_layer_scan_zhop|abs} F{first_layer_scan_zhop_speed|float * 60}
	
	
	M106 S255
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Fan on and lowering temperature to %.1f" % first_layer_scan_cooldown_temp}' {% endif %}
	M104 S{first_layer_scan_cooldown_temp}
	M109 S{first_layer_scan_cooldown_temp}
	
	{pause_macro}
	
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Start scanning" {% endif %}
	
	UPDATE_DELAYED_GCODE ID=_WAIT_OBICO_LAYER_CHANGE DURATION=1.0
	G90
	G0 X{min_x} Y{min_y} F{first_layer_scan_resume_speed|float * 60}
	{% for ystep in range(stepoverCount) %}
	G0 Y{min_y + first_layer_scan_stepover|float * ystep} F{first_layer_scan_speed|float * 60}
	G0 X{max_x if ystep % 2 == 0 else min_x}              F{first_layer_scan_speed|float * 60}
	{% endfor %}
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Finish scanning" {% endif %}
	
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=first_layer_scanning VALUE=False
	
	{% endif %}

[delayed_gcode _WAIT_OBICO_LAYER_CHANGE]
gcode = 
	{% set lc_macro = printer['gcode_macro _OBICO_LAYER_CHANGE'] %}
	{% if lc_macro.first_layer_scanning %}
	
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Waiting for first layer scan..." {% endif %}
	UPDATE_DELAYED_GCODE ID=_WAIT_OBICO_LAYER_CHANGE DURATION=1.0
	{% else %}
	
	M107
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Fan off and resume print" {% endif %}
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Call %s VELOCITY=%.1f" % (lc_macro.wait.resume, lc_macro.first_layer_scan_resume_speed)}' {% endif %}
	{lc_macro.wait.resume} VELOCITY={lc_macro.first_layer_scan_resume_speed}
	G91
	G0 Z-{lc_macro.first_layer_scan_zhop|abs} F{lc_macro.first_layer_scan_zhop_speed|float * 60}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% set first_layer_scan_unretract_length = lc_macro.first_layer_scan_retract_length + 0.5 %}
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Extrude %.1fmm filament" % first_layer_scan_unretract_length|abs}' {% endif %}
	M83
	G0 E{first_layer_scan_unretract_length|abs} F{lc_macro.first_layer_scan_retract_speed|float * 60}
	{% endif %}
	
	
	M104 S{lc_macro.wait.previous_temp}
	M109 S{lc_macro.wait.previous_temp}
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Heating back up to previous temperature"}' {% endif %}
	
	
	{% if lc_macro.wait.absolute_coordinates %} G90 {% endif %}
	{% if lc_macro.wait.absolute_extrude %}
	M82
	G92 E{lc_macro.wait.e}
	{% endif %}
	{% endif %}

[gcode_macro OBICO_LINK_STATUS]
description = Link to Obico server
variable_one_time_passcode = ''
variable_one_time_passlink = ''
variable_is_linked = False
gcode = 
	{action_respond_info('Obico one_time_passcode: {}'.format(one_time_passcode))}
	{action_respond_info('Obico one_time_passlink: {}'.format(one_time_passlink))}
	{action_respond_info('Obico is_linked: {}'.format(is_linked))}
	{% if not is_linked and one_time_passcode != '' %}
	M117 Code: {one_time_passcode}
	{% else %}
	M117 Obico linked
	{% endif %}

[gcode_macro _OBICO_RELINK]
description = Re-link to Obico server
gcode = 
	{action_respond_info('WARNING: Re-link to Obico server')}
	{action_call_remote_method("obico_remote_event", event_name='relink_obico', message='')}
	{action_respond_info('WARNING: relink_obico requested')}

[exclude_object]

[mcu]
serial = /dev/serial/by-id/usb-1a86_USB_Serial-if00-port0
restart_method = command

[temperature_sensor raspberry_pi]
sensor_type = temperature_host
min_temp = 10
max_temp = 100

[temperature_sensor mcu_temp]
sensor_type = temperature_mcu
min_temp = 0
max_temp = 100

[printer]
kinematics = cartesian
max_velocity = 200
max_accel = 4000
max_z_velocity = 10
max_z_accel = 100
minimum_cruise_ratio = 0.5
square_corner_velocity = 5

[stepper_x]
step_pin = PB9
dir_pin = PC2
enable_pin = !PC3
microsteps = 16
rotation_distance = 40
endstop_pin = ^PA5
position_endstop = 0
position_max = 230
homing_speed = 50

[stepper_y]
step_pin = PB7
dir_pin = PB8
enable_pin = !PC3
microsteps = 16
rotation_distance = 40
endstop_pin = ^PA6
position_endstop = 0
position_max = 231
homing_speed = 50

[stepper_z]
step_pin = PB5
dir_pin = !PB6
enable_pin = !PC3
microsteps = 16
rotation_distance = 8
endstop_pin = probe:z_virtual_endstop
position_max = 250
position_min = -4
homing_speed = 4
second_homing_speed = 1
homing_retract_dist = 2.0

[fan]
pin = PA0

[extruder]
max_extrude_only_distance = 100.0
step_pin = PB3
dir_pin = PB4
enable_pin = !PC3
microsteps = 16
gear_ratio = 42:12
rotation_distance = 26.359
nozzle_diameter = 0.400
filament_diameter = 1.750
heater_pin = PA1
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PC5
min_temp = 0
max_temp = 300
min_extrude_temp = 170
pressure_advance = .0369
pressure_advance_smooth_time = 0.04
control = pid
pid_kp = 19.195
pid_ki = 1.000
pid_kd = 92.135

[firmware_retraction]
retract_length = 0.3
retract_speed = 20

[idle_timeout]
gcode = 
	{% if printer.pause_resume.is_paused %}
	M118 Idle timeout while paused, turning off hotend
	SET_HEATER_TEMPERATURE HEATER=extruder TARGET=0
	{% else %}
	M118 Idle timeout
	TURN_OFF_HEATERS
	M84
	{% endif %}
timeout = 1800

[heater_bed]
heater_pin = PA2
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PC4
min_temp = 0
max_temp = 130
control = pid
pid_kp = 68.601
pid_ki = 1.185
pid_kd = 993.000

[bltouch]
sensor_pin = ^PB1
control_pin = PB0
x_offset = -31.8
y_offset = -40.5
speed = 35
samples = 2
samples_result = median
samples_tolerance = 0.05
samples_tolerance_retries = 2
sample_retract_dist = 5.0
probe_with_touch_mode = true
stow_on_each_sample = false
z_offset = 2.049

[safe_z_home]
home_xy_position = 147, 154
speed = 75
z_hop = 10
z_hop_speed = 5
move_to_previous = false

[bed_screws]
screw1 = 30,51
screw1_name = "FL"
screw2 = 200,51
screw2_name = "FR"
screw3 = 200,195
screw3_name = "RR"
screw4 = 30,195
screw4_name = "RL"

[screws_tilt_adjust]
screw1 = 67, 67
screw1_name = front left screw
screw2 = 230, 67
screw2_name = front right screw
screw3 = 230, 230
screw3_name = rear right screw
screw4 = 67.60, 230
screw4_name = rear left screw
horizontal_move_z = 10
speed = 200
screw_thread = CW-M4

[bed_mesh]
speed = 120
mesh_min = 10,11
mesh_max = 195,182
probe_count = 3,3
algorithm = bicubic
fade_start = 1
fade_end = 10
fade_target = 0

[filament_motion_sensor SFS_T0]
detection_length = 150.00
extruder = extruder
switch_pin = PA4
pause_on_runout = True
event_delay = 3.0
pause_delay = 0.5
runout_gcode = 
	M117 Runout Detected!

[delayed_gcode DISABLEFILAMENTSENSOR]
initial_duration = 1
gcode = 
	SET_FILAMENT_SENSOR SENSOR=SFS_T0 ENABLE=0

[gcode_macro SFS_ENABLE]
description = Enable smart filament sensor
gcode = 
	M117 ENABLING the Smart Filament Sensor
	G92 E0
	SET_FILAMENT_SENSOR SENSOR=SFS_T0 ENABLE=1

[gcode_macro SFS_DISABLE]
description = Disable smart filament sensor
gcode = 
	M117 DISABLING the Smart Filament Sensor
	G92 E0
	SET_FILAMENT_SENSOR SENSOR=SFS_T0 ENABLE=0

[gcode_macro FILAMENT_RUNOUT]
gcode = 
	M117 Runout Detected!
	M300 S1 P10
	M600
	M300 S1 P10

[gcode_macro M300]
gcode = 
	{% set S = params.S|default(1000)|int %}
	{% set P = params.P|default(100)|int %}
	SET_PIN PIN=BEEPER VALUE=0.5 CYCLE_TIME={ 1.0/S if S > 0 else 1 }
	G4 P{P}
	SET_PIN PIN=BEEPER VALUE=0
	[gcode_macro M600]
	gcode:
	{% set X = params.X|default(25)|float %}
	{% set Y = params.Y|default(25)|float %}
	{% set Z = params.Z|default(10)|float %}
	SAVE_GCODE_STATE NAME=M600_state
	PAUSE
	G91
	G1 E-.8 F2700
	G1 Z{Z}
	G90
	G1 X{X} Y{Y} F3000
	G91
	G1 E-15 F1000
	RESTORE_GCODE_STATE NAME=M600_state

[gcode_arcs]
resolution = 1.0

[input_shaper]
shaper_freq_x = 73.5
shaper_type_x = ei
shaper_freq_y = 76.9
shaper_type_y = mzv
=======================
Loaded MCU 'mcu' 119 commands (v0.12.0-286-g81de9a861 / gcc: (15:8-2019-q3-1+b1) 8.3.1 20190703 (release) [gcc-8-branch revision 273027] binutils: (2.35.2-2+14+b2) 2.35.2)
MCU 'mcu' config: ADC_MAX=4095 BUS_PINS_i2c1=PB6,PB7 BUS_PINS_i2c1a=PB8,PB9 BUS_PINS_i2c2=PB10,PB11 BUS_PINS_spi1=PA6,PA7,PA5 BUS_PINS_spi1a=PB4,PB5,PB3 BUS_PINS_spi2=PB14,PB15,PB13 BUS_PINS_spi3=PB4,PB5,PB3 CLOCK_FREQ=72000000 MCU=stm32f103xe PWM_MAX=255 RECEIVE_WINDOW=192 RESERVE_PINS_serial=PA10,PA9 SERIAL_BAUD=250000 STATS_SUMSQ_BASE=256 STEPPER_BOTH_EDGE=1
Configured MCU 'mcu' (1024 moves)
Args: ['/home/coon/klipper/klippy/klippy.py', '/home/coon/printer_data/config/printer.cfg', '-l', '/home/coon/printer_data/logs/klippy.log', '-I', '/home/coon/printer_data/comms/klippy.serial', '-a', '/home/coon/printer_data/comms/klippy.sock']
Git version: 'v0.12.0-396-gb7233d119'
Branch: master
Remote: origin
Tracked URL: https://github.com/Klipper3d/klipper.git
CPU: 4 core ?
Python: '3.9.2 (default, Dec  1 2024, 12:12:57) \n[GCC 10.2.1 20210110]'
webhooks client 548562679696: {'program': 'Moonraker', 'version': 'v0.9.3-3-gccfe32f'}
=============== Log rollover at Sun Dec 22 14:52:43 2024 ===============
webhooks: registering remote method 'obico_remote_event' for connection id: 548562679696
webhooks client 548562679696: Disconnected
Starting Klippy...
Args: ['/home/coon/klipper/klippy/klippy.py', '/home/coon/printer_data/config/printer.cfg', '-l', '/home/coon/printer_data/logs/klippy.log', '-I', '/home/coon/printer_data/comms/klippy.serial', '-a', '/home/coon/printer_data/comms/klippy.sock']
Git version: 'v0.12.0-396-gb7233d119'
Branch: master
Remote: origin
Tracked URL: https://github.com/Klipper3d/klipper.git
CPU: 4 core ?
Python: '3.9.2 (default, Dec  1 2024, 12:12:57) \n[GCC 10.2.1 20210110]'
Start printer at Sun Dec 22 15:01:07 2024 (1734897667.2 20.6)
===== Config file =====
[virtual_sdcard]
path = ~/printer_data/gcodes
on_error_gcode = CANCEL_PRINT

[pause_resume]
recover_velocity = 25

[display_status]

[respond]
default_prefix = 

[gcode_macro CANCEL_PRINT]
description = Cancel the actual running print
rename_existing = BASE_CANCEL_PRINT
gcode = 
	G91
	G0 Z10 F600
	G90
	TURN_OFF_HEATERS
	G0 X5 Y220
	CLEAR_PAUSE
	
	BASE_CANCEL_PRINT

[gcode_macro PAUSE]
description = Pause the actual running print
rename_existing = PAUSE_BASE
gcode = 
	
	{% set x = params.X|default(5) %}
	{% set y = params.Y|default(225) %}
	{% set z = params.Z|default(10)|float %}
	{% set e = params.E|default(1) %}
	
	{% set max_z = printer.toolhead.axis_maximum.z|float %}
	{% set act_z = printer.toolhead.position.z|float %}
	{% set lift_z = z|abs %}
	{% if act_z < (max_z - lift_z) %}
	{% set z_safe = lift_z %}
	{% else %}
	{% set z_safe = max_z - act_z %}
	{% endif %}
	
	PAUSE_BASE
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E-{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	{% if "xyz" in printer.toolhead.homed_axes %}
	G1 Z{z_safe}
	G90
	G1 X{x} Y{y} F6000
	{% else %}
	{action_respond_info("Printer not homed")}
	{% endif %}

[gcode_macro RESUME]
description = Resume the actual running print
rename_existing = RESUME_BASE
variable_last_extruder_temp = {'restore': False, 'temp': 0}
variable_restore_idle_timeout = 0
variable_idle_state = False
gcode = 
	
	{% set e = params.E|default(1) %}
	
	{% if 'VELOCITY' in params|upper %}
	{% set get_params = ('VELOCITY=' + params.VELOCITY)  %}
	{%else %}
	{% set get_params = "" %}
	{% endif %}
	
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	RESUME_BASE {get_params}

[gcode_macro SET_PAUSE_NEXT_LAYER]
description = Enable a pause if the next layer is reached
gcode = 
	{% set pause_next_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_next_layer %}
	{% set ENABLE = params.ENABLE|default(1)|int != 0 %}
	{% set MACRO = params.MACRO|default(pause_next_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_next_layer VALUE="{{ 'enable': ENABLE, 'call': MACRO }}"

[gcode_macro SET_PAUSE_AT_LAYER]
description = Enable/disable a pause if a given layer number is reached
gcode = 
	{% set pause_at_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_at_layer %}
	{% set ENABLE = params.ENABLE|int != 0 if params.ENABLE is defined
	else params.LAYER is defined %}
	{% set LAYER = params.LAYER|default(pause_at_layer.layer)|int %}
	{% set MACRO = params.MACRO|default(pause_at_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_at_layer VALUE="{{ 'enable': ENABLE, 'layer': LAYER, 'call': MACRO }}"

[gcode_macro SET_PRINT_STATS_INFO]
rename_existing = SET_PRINT_STATS_INFO_BASE
description = Overwrite, to get pause_next_layer and pause_at_layer feature
variable_pause_next_layer = { 'enable': False, 'call': "PAUSE" }
variable_pause_at_layer = { 'enable': False, 'layer': 0, 'call': "PAUSE" }
gcode = 
	{% if pause_next_layer.enable %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_next_layer" % pause_next_layer.call}'
	{pause_next_layer.call}
	SET_PAUSE_NEXT_LAYER ENABLE=0
	{% elif pause_at_layer.enable and params.CURRENT_LAYER is defined and params.CURRENT_LAYER|int == pause_at_layer.layer %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_at_layer [%d]" % (pause_at_layer.call, pause_at_layer.layer)}'
	{pause_at_layer.call}
	SET_PAUSE_AT_LAYER ENABLE=0
	{% endif %}
	SET_PRINT_STATS_INFO_BASE {rawparams}

[gcode_macro _TOOLHEAD_PARK_PAUSE_CANCEL]
description = Helper: park toolhead used in PAUSE and CANCEL_PRINT
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set velocity = printer.configfile.settings.pause_resume.recover_velocity %}
	{% set use_custom     = client.use_custom_pos|default(false)|lower == 'true' %}
	{% set custom_park_x  = client.custom_park_x|default(0.0) %}
	{% set custom_park_y  = client.custom_park_y|default(0.0) %}
	{% set park_dz        = client.custom_park_dz|default(2.0)|abs %}
	{% set sp_hop         = client.speed_hop|default(15) * 60 %}
	{% set sp_move        = client.speed_move|default(velocity) * 60 %}
	
	{% set origin    = printer.gcode_move.homing_origin %}
	{% set act       = printer.gcode_move.gcode_position %}
	{% set max       = printer.toolhead.axis_maximum %}
	{% set cone      = printer.toolhead.cone_start_z|default(max.z) %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	
	{% set z_min = params.Z_MIN|default(0)|float %}
	{% set z_park = [[(act.z + park_dz), z_min]|max, (max.z - origin.z)]|min %}
	{% set x_park = params.X       if params.X is defined
	else custom_park_x  if use_custom
	else 0.0            if round_bed
	else (max.x - 5.0) %}
	{% set y_park = params.Y       if params.Y is defined
	else custom_park_y  if use_custom
	else (max.y - 5.0)  if round_bed and z_park < cone
	else 0.0            if round_bed
	else (max.y - 5.0) %}
	
	_CLIENT_RETRACT
	{% if "xyz" in printer.toolhead.homed_axes %}
	G90
	G1 Z{z_park} F{sp_hop}
	G1 X{x_park} Y{y_park} F{sp_move}
	{% if not printer.gcode_move.absolute_coordinates %} G91 {% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='Printer not homed'
	{% endif %}

[gcode_macro _CLIENT_EXTRUDE]
description = Extrudes, if the extruder is hot enough
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set use_fw_retract = (client.use_fw_retract|default(false)|lower == 'true') and (printer.firmware_retraction is defined) %}
	{% set length = params.LENGTH|default(client.unretract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_unretract)|default(35) %}
	{% set absolute_extrude = printer.gcode_move.absolute_extrude %}
	
	{% if printer.toolhead.extruder != '' %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if use_fw_retract %}
	{% if length < 0 %}
	G10
	{% else %}
	G11
	{% endif %}
	{% else %}
	M83
	G1 E{length} F{(speed|float|abs) * 60}
	{% if absolute_extrude %}
	M82
	{% endif %}
	{% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='{"\"%s\" not hot enough" % printer.toolhead.extruder}'
	{% endif %}
	{% endif %}

[gcode_macro _CLIENT_RETRACT]
description = Retracts, if the extruder is hot enough
gcode = 
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set length = params.LENGTH|default(client.retract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_retract)|default(35) %}
	
	_CLIENT_EXTRUDE LENGTH=-{length|float|abs} SPEED={speed|float|abs}

[gcode_macro _CLIENT_LINEAR_MOVE]
description = Linear move with save and restore of the gcode state
gcode = 
	{% set x_move = "X" ~ params.X if params.X is defined else "" %}
	{% set y_move = "Y" ~ params.Y if params.Y is defined else "" %}
	{% set z_move = "Z" ~ params.Z if params.Z is defined else "" %}
	{% set e_move = "E" ~ params.E if params.E is defined else "" %}
	{% set rate = "F" ~ params.F if params.F is defined else "" %}
	{% set ABSOLUTE = params.ABSOLUTE | default(0) | int != 0 %}
	{% set ABSOLUTE_E = params.ABSOLUTE_E | default(0) | int != 0 %}
	SAVE_GCODE_STATE NAME=_client_movement
	{% if x_move or y_move or z_move %}
	G9{ 0 if ABSOLUTE else 1 }
	{% endif %}
	{% if e_move %}
	M8{ 2 if ABSOLUTE_E else 3 }
	{% endif %}
	G1 { x_move } { y_move } { z_move } { e_move } { rate }
	RESTORE_GCODE_STATE NAME=_client_movement

[gcode_macro play_test]
gcode = 
	RESPOND TYPE=command MSG="action:prompt_begin Question"
	RESPOND TYPE=command MSG="action:prompt_text Do you wont to cancel the print?"
	RESPOND TYPE=command MSG="action:prompt_footer_button continue|RESPOND TYPE=command MSG=action:prompt_end"
	RESPOND TYPE=command MSG="action:prompt_footer_button CANCEL|CANCEL_PRINT|error"
	RESPOND TYPE=command MSG="action:prompt_show"

[gcode_macro PRINT_START]
gcode = 
	START_PRINT {rawparams}

[gcode_macro START_PRINT]
gcode = 
	{% set BED_TEMP = params.BED_TEMP|default(60)|float %}
	{% set EXTRUDER_TEMP = params.EXTRUDER_TEMP|default(190)|float %}
	
	M190 S{BED_TEMP}
	
	G90
	
	G28
	
	RESPOND MSG="Bed Meshing"
	
	
	
	
	
	
	
	
	BED_MESH_CLEAR
	BED_MESH_CALIBRATE ADAPTIVE=1
	
	
	
	
	
	
	
	RESPOND MSG="Heating to print temp"
	M104 S{EXTRUDER_TEMP}
	G0 Z40 F240
	M109 S{EXTRUDER_TEMP}
	RESPOND MSG="Enable Runout Sensor"
	SFS_ENABLE
	RESPOND MSG="Line Purge"
	LINE_PURGE
	RESPOND MSG="Print Started"

[gcode_macro LINE_PURGE]
gcode = 
	G92 E0
	G1 Z2.0 F3000
	G1 X0.1 Y20 Z0.3 F5000.0
	G1 X0.1 Y200.0 Z0.3 F1500.0 E15
	G1 X0.4 Y200.0 Z0.3 F5000.0
	G1 X0.4 Y20 Z0.3 F1500.0 E30
	G92 E0
	G1 Z2.0 F3000
	G1 X5 Y20 Z0.3 F5000.0

[gcode_macro PRINT_END]
gcode = 
	END_PRINT

[gcode_macro END_PRINT]
gcode = 
	
	
	RESPOND MSG="Print Finished"
	G91
	G1 E-.5 Z0.2 F2400
	G1 X5 Y5 F6000
	G1 Z10
	G90
	SFS_DISABLE
	
	G1 X0 Y220 F6000
	M106 S0
	M104 S0
	M140 S0
	
	M84 X Y E

[gcode_macro SET_ACTIVE_SPOOL]
gcode = 
	{% if params.ID %}
	{% set id = params.ID|int %}
	{action_call_remote_method(
	"spoolman_set_active_spool",
	spool_id=id
	)}
	{% else %}
	{action_respond_info("Parameter 'ID' is required")}
	{% endif %}

[gcode_macro CLEAR_ACTIVE_SPOOL]
gcode = 
	{action_call_remote_method(
	"spoolman_set_active_spool",
	spool_id=None
	)}

[gcode_macro G29]
gcode = 
	G28
	BED_MESH_CALIBRATE
	G0 X0 Y0 Z10 F6000
	BED_MESH_PROFILE save=default

[gcode_macro M125]
gcode = 
	SAVE_GCODE_STATE NAME=parking
	M117 Parking toolhead
	G91
	G1 Z10 F600
	G90
	G1 X5 Y225 F4000
	RESTORE_GCODE_STATE NAME=parking

[gcode_macro Load_Filament]
gcode = 
	SAVE_GCODE_STATE NAME=loading_filament
	M117 Loading Filament
	M83
	G92 E0.0
	G91
	G1 E50 F200
	G92 E50
	RESTORE_GCODE_STATE NAME=loading_filament

[gcode_macro Unload_Filament]
gcode = 
	SAVE_GCODE_STATE NAME=unloading_filament
	M117 Unloading Filament
	G91
	G1 E5 F100
	G92 E0.0
	G1 E-50 F5000
	G92 E-50
	RESTORE_GCODE_STATE NAME=unloading_filament

[gcode_macro Filament_Change]
gcode = 
	
	SAVE_GCODE_STATE NAME=filament_change
	
	Unload_Filament
	
	RESPOND TYPE=command MSG="action:prompt_begin Question"
	RESPOND TYPE=command MSG="action:prompt_text Please insert new filament and confirm"
	RESPOND TYPE=command MSG="action:prompt_footer_button CONFIRM|Load_Filament|RESPOND TYPE=command MSG=action:prompt_end"
	RESPOND TYPE=command MSG="action:prompt_footer_button CANCEL|RESPOND TYPE=command MSG=action:prompt_end"
	RESPOND TYPE=command MSG="action:prompt_show"
	
	RESTORE_GCODE_STATE NAME=filament_change

[gcode_macro Calibrate_Hotend_PID]
gcode = 
	PID_CALIBRATE HEATER=extruder TARGET=200

[gcode_macro Calibrate_Bed_PID]
gcode = 
	PID_CALIBRATE HEATER=heater_bed TARGET=60

[gcode_macro Calibrate_Zoffset]
gcode = 
	PROBE_CALIBRATE

[gcode_macro Tram_bed]
gcode = 
	SCREWS_TILT_CALCULATE

[gcode_macro TEST_SPEED]
description = Test for max speed and acceleration parameters for the printer. Procedure: Home -> ReadPositionFromMCU -> MovesToolhead@Vel&Accel -> Home -> ReadPositionfromMCU
gcode = 
	
	{% set speed  = params.SPEED|default(printer.configfile.settings.printer.max_velocity)|int %}
	
	{% set iterations = params.ITERATIONS|default(5)|int %}
	
	{% set accel  = params.ACCEL|default(printer.configfile.settings.printer.max_accel)|int %}
	
	{% set min_cruise_ratio = params.MIN_CRUISE_RATIO|default(0.5)|float %}
	
	{% set bound = params.BOUND|default(20)|int %}
	
	{% set smallpatternsize = SMALLPATTERNSIZE|default(20)|int %}
	
	
	
	{% set x_min = printer.toolhead.axis_minimum.x + bound %}
	{% set x_max = printer.toolhead.axis_maximum.x - bound %}
	{% set y_min = printer.toolhead.axis_minimum.y + bound %}
	{% set y_max = printer.toolhead.axis_maximum.y - bound %}
	
	
	
	{% set x_center = (printer.toolhead.axis_minimum.x|float + printer.toolhead.axis_maximum.x|float ) / 2 %}
	{% set y_center = (printer.toolhead.axis_minimum.y|float + printer.toolhead.axis_maximum.y|float ) / 2 %}
	
	
	{% set x_center_min = x_center - (smallpatternsize/2) %}
	{% set x_center_max = x_center + (smallpatternsize/2) %}
	{% set y_center_min = y_center - (smallpatternsize/2) %}
	{% set y_center_max = y_center + (smallpatternsize/2) %}
	
	
	SAVE_GCODE_STATE NAME=TEST_SPEED
	
	
	{ action_respond_info("TEST_SPEED: starting %d iterations at speed %d, accel %d" % (iterations, speed, accel)) }
	
	
	M400
	G28
	
	{% if printer.configfile.settings.quad_gantry_level %}
	{% if printer.quad_gantry_level.applied == False %}
	QUAD_GANTRY_LEVEL
	G28 Z
	{% endif %}
	{% endif %}
	
	G90
	G1 X{printer.toolhead.axis_maximum.x-50} Y{printer.toolhead.axis_maximum.y-50} F{30*60}
	M400
	G28 X Y
	G0 X{printer.toolhead.axis_maximum.x-1} Y{printer.toolhead.axis_maximum.y-1} F{30*60}
	G4 P1000
	GET_POSITION
	
	
	G0 X{x_min} Y{y_min} Z{bound + 10} F{speed*60}
	
	
	{% if printer.configfile.settings.printer.minimum_cruise_ratio is defined %}
	SET_VELOCITY_LIMIT VELOCITY={speed} ACCEL={accel} MINIMUM_CRUISE_RATIO={min_cruise_ratio}
	{% else %}
	SET_VELOCITY_LIMIT VELOCITY={speed} ACCEL={accel} ACCEL_TO_DECEL={accel / 2}
	{% endif %}
	
	{% for i in range(iterations) %}
	
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_max} Y{y_max} F{speed*60}
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	G0 X{x_min} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	
	
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_min} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	
	
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_max} Y{y_center_max} F{speed*60}
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	G0 X{x_center_min} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	
	
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_min} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	{% endfor %}
	
	
	{% if printer.configfile.settings.printer.minimum_cruise_ratio is defined %}
	SET_VELOCITY_LIMIT VELOCITY={printer.configfile.settings.printer.max_velocity} ACCEL={printer.configfile.settings.printer.max_accel} MINIMUM_CRUISE_RATIO={printer.configfile.settings.printer.minimum_cruise_ratio}
	{% else %}
	SET_VELOCITY_LIMIT VELOCITY={printer.configfile.settings.printer.max_velocity} ACCEL={printer.configfile.settings.printer.max_accel} ACCEL_TO_DECEL={printer.configfile.settings.printer.max_accel_to_decel}
	{% endif %}
	
	
	M400
	G28
	
	G90
	G0 X{printer.toolhead.axis_maximum.x-1} Y{printer.toolhead.axis_maximum.y-1} F{30*60}
	G4 P1000
	GET_POSITION
	
	
	RESTORE_GCODE_STATE NAME=TEST_SPEED

[gcode_macro GET_TIMELAPSE_SETUP]
description = Print the Timelapse setup
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% set output_txt = ["Timelapse Setup:"] %}
	{% set _dummy = output_txt.append("enable: %s" % tl.enable) %}
	{% set _dummy = output_txt.append("park: %s" % tl.park.enable) %}
	{% if tl.park.enable %}
	{% set _dummy = output_txt.append("park position: %s time: %s s" % (tl.park.pos, tl.park.time)) %}
	{% set _dummy = output_txt.append("park cord x:%s y:%s dz:%s" % (tl.park.coord.x, tl.park.coord.y, tl.park.coord.dz)) %}
	{% set _dummy = output_txt.append("travel speed: %s mm/s" % tl.speed.travel) %}
	{% endif %}
	{% set _dummy = output_txt.append("fw_retract: %s" % tl.extruder.fw_retract) %}
	{% if not tl.extruder.fw_retract %}
	{% set _dummy = output_txt.append("retract: %s mm speed: %s mm/s" % (tl.extruder.retract, tl.speed.retract)) %}
	{% set _dummy = output_txt.append("extrude: %s mm speed: %s mm/s" % (tl.extruder.extrude, tl.speed.extrude)) %}
	{% endif %}
	{% set _dummy = output_txt.append("verbose: %s" % tl.verbose) %}
	{action_respond_info(output_txt|join("\n"))}

[gcode_macro _SET_TIMELAPSE_SETUP]
description = Set user parameters for timelapse
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	
	{% set min = printer.toolhead.axis_minimum %}
	{% set max = printer.toolhead.axis_maximum %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	{% set park = {'min'   : {'x': (min.x / 1.42)|round(3) if round_bed else min.x|round(3),
	'y': (min.y / 1.42)|round(3) if round_bed else min.y|round(3)},
	'max'   : {'x': (max.x / 1.42)|round(3) if round_bed else max.x|round(3),
	'y': (max.y / 1.42)|round(3) if round_bed else max.y|round(3)},
	'center': {'x': (max.x-(max.x-min.x)/2)|round(3),
	'y': (max.y-(max.y-min.y)/2)|round(3)}} %}
	
	{% if params.ENABLE %}
	{% if params.ENABLE|lower is in ['true', 'false'] %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=enable VALUE={True if params.ENABLE|lower == 'true' else False}
	{% else %}
	{action_raise_error("ENABLE=%s not supported. Allowed values are [True, False]" % params.ENABLE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.VERBOSE %}
	{% if params.VERBOSE|lower is in ['true', 'false'] %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=verbose VALUE={True if params.VERBOSE|lower == 'true' else False}
	{% else %}
	{action_raise_error("VERBOSE=%s not supported. Allowed values are [True, False]" % params.VERBOSE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_X %}
	{% if params.CUSTOM_POS_X|float >= min.x and params.CUSTOM_POS_X|float <= max.x %}
	{% set _dummy = tl.park.custom.update({'x':params.CUSTOM_POS_X|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_X=%s must be within [%s - %s]" % (params.CUSTOM_POS_X, min.x, max.x))}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_Y %}
	{% if params.CUSTOM_POS_Y|float >= min.y and params.CUSTOM_POS_Y|float <= max.y %}
	{% set _dummy = tl.park.custom.update({'y':params.CUSTOM_POS_Y|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_Y=%s must be within [%s - %s]" % (params.CUSTOM_POS_Y, min.y, max.y))}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_DZ %}
	{% if params.CUSTOM_POS_DZ|float >= min.z and params.CUSTOM_POS_DZ|float <= max.z %}
	{% set _dummy = tl.park.custom.update({'dz':params.CUSTOM_POS_DZ|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_DZ=%s must be within [%s - %s]" % (params.CUSTOM_POS_DZ, min.z, max.z))}
	{% endif %}
	{% endif %}
	{% if params.PARK_ENABLE %}
	{% if params.PARK_ENABLE|lower is in ['true', 'false'] %}
	{% set _dummy = tl.park.update({'enable':True if params.PARK_ENABLE|lower == 'true' else False}) %}
	{% else %}
	{action_raise_error("PARK_ENABLE=%s not supported. Allowed values are [True, False]" % params.PARK_ENABLE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.PARK_POS %}
	{% if params.PARK_POS|lower is in ['center','front_left','front_right','back_left','back_right','custom','x_only','y_only'] %}
	{% set dic = {'center'      : {'x': park.center.x   , 'y': park.center.y   , 'dz': 1                },
	'front_left'  : {'x': park.min.x      , 'y': park.min.y      , 'dz': 0                },
	'front_right' : {'x': park.max.x      , 'y': park.min.y      , 'dz': 0                },
	'back_left'   : {'x': park.min.x      , 'y': park.max.y      , 'dz': 0                },
	'back_right'  : {'x': park.max.x      , 'y': park.max.y      , 'dz': 0                },
	'custom'      : {'x': tl.park.custom.x, 'y': tl.park.custom.y, 'dz': tl.park.custom.dz},
	'x_only'      : {'x': tl.park.custom.x, 'y': 'none'          , 'dz': tl.park.custom.dz},
	'y_only'      : {'x': 'none'          , 'y': tl.park.custom.y, 'dz': tl.park.custom.dz}} %}
	{% set _dummy = tl.park.update({'pos':params.PARK_POS|lower}) %}
	{% set _dummy = tl.park.update({'coord':dic[tl.park.pos]}) %}
	{% else %}
	{action_raise_error("PARK_POS=%s not supported. Allowed values are [CENTER, FRONT_LEFT, FRONT_RIGHT, BACK_LEFT, BACK_RIGHT, CUSTOM, X_ONLY, Y_ONLY]"
	% params.PARK_POS|upper)}
	{% endif %}
	{% endif %}
	{% if params.PARK_TIME %}
	{% if params.PARK_TIME|float >= 0.0 %}
	{% set _dummy = tl.park.update({'time':params.PARK_TIME|float|round(3)}) %}
	{% else %}
	{action_raise_error("PARK_TIME=%s must be a positive number" % params.PARK_TIME)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=park VALUE="{tl.park}"
	{% if params.TRAVEL_SPEED %}
	{% if params.TRAVEL_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'travel':params.TRAVEL_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("TRAVEL_SPEED=%s must be larger than 0" % params.TRAVEL_SPEED)}
	{% endif %}
	{% endif %}
	{% if params.RETRACT_SPEED %}
	{% if params.RETRACT_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'retract':params.RETRACT_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("RETRACT_SPEED=%s must be larger than 0" % params.RETRACT_SPEED)}
	{% endif %}
	{% endif %}
	{% if params.EXTRUDE_SPEED %}
	{% if params.EXTRUDE_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'extrude':params.EXTRUDE_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("EXTRUDE_SPEED=%s must be larger than 0" % params.EXTRUDE_SPEED)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=speed VALUE="{tl.speed}"
	{% if params.EXTRUDE_DISTANCE %}
	{% if params.EXTRUDE_DISTANCE|float >= 0.0 %}
	{% set _dummy = tl.extruder.update({'extrude':params.EXTRUDE_DISTANCE|float|round(3)}) %}
	{% else %}
	{action_raise_error("EXTRUDE_DISTANCE=%s must be specified as positiv number" % params.EXTRUDE_DISTANCE)}
	{% endif %}
	{% endif %}
	{% if params.RETRACT_DISTANCE %}
	{% if params.RETRACT_DISTANCE|float >= 0.0 %}
	{% set _dummy = tl.extruder.update({'retract':params.RETRACT_DISTANCE|float|round(3)}) %}
	{% else %}
	{action_raise_error("RETRACT_DISTANCE=%s must be specified as positiv number" % params.RETRACT_DISTANCE)}
	{% endif %}
	{% endif %}
	{% if params.FW_RETRACT %}
	{% if params.FW_RETRACT|lower is in ['true', 'false'] %}
	{% if 'firmware_retraction' in printer.configfile.settings %}
	{% set _dummy = tl.extruder.update({'fw_retract': True if params.FW_RETRACT|lower == 'true' else False}) %}
	{% else %}
	{% set _dummy = tl.extruder.update({'fw_retract':False}) %}
	{% if params.FW_RETRACT|capitalize == 'True' %}
	{action_raise_error("[firmware_retraction] not defined in printer.cfg. Can not enable fw_retract")}
	{% endif %}
	{% endif %}
	{% else %}
	{action_raise_error("FW_RETRACT=%s not supported. Allowed values are [True, False]" % params.FW_RETRACT|capitalize)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=extruder VALUE="{tl.extruder}"
	{% if printer.configfile.settings['gcode_macro pause'] is defined %}
	{% set _dummy = tl.macro.update({'pause': printer.configfile.settings['gcode_macro pause'].rename_existing}) %}
	{% endif %}
	{% if printer.configfile.settings['gcode_macro resume'] is defined %}
	{% set _dummy = tl.macro.update({'resume': printer.configfile.settings['gcode_macro resume'].rename_existing}) %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=macro VALUE="{tl.macro}"

[gcode_macro TIMELAPSE_TAKE_FRAME]
description = Take Timelapse shoot
variable_enable = False
variable_takingframe = False
variable_park = {'enable': False,
	'pos'   : 'center',
	'time'  : 0.1,
	'custom': {'x': 0, 'y': 0, 'dz': 0},
	'coord' : {'x': 0, 'y': 0, 'dz': 0}}
variable_extruder = {'fw_retract': False,
	'retract': 1.0,
	'extrude': 1.0}
variable_speed = {'travel': 100,
	'retract': 15,
	'extrude': 15}
variable_verbose = True
variable_check_time = 0.5
variable_restore = {'absolute': {'coordinates': True, 'extrude': True}, 'speed': 1500, 'e':0, 'factor': {'speed': 1.0, 'extrude': 1.0}}
variable_macro = {'pause': 'PAUSE', 'resume': 'RESUME'}
variable_is_paused = False
gcode = 
	{% set hyperlapse = True if params.HYPERLAPSE and params.HYPERLAPSE|lower =='true' else False %}
	{% if enable %}
	{% if (hyperlapse and printer['gcode_macro HYPERLAPSE'].run) or
	(not hyperlapse and not printer['gcode_macro HYPERLAPSE'].run) %}
	{% if park.enable %}
	{% set pos = {'x': 'X' + park.coord.x|string if park.pos != 'y_only' else '',
	'y': 'Y' + park.coord.y|string if park.pos != 'x_only' else '',
	'z': 'Z'+ [printer.gcode_move.gcode_position.z + park.coord.dz, printer.toolhead.axis_maximum.z]|min|string} %}
	{% set restore = {'absolute': {'coordinates': printer.gcode_move.absolute_coordinates,
	'extrude'    : printer.gcode_move.absolute_extrude},
	'speed'   : printer.gcode_move.speed,
	'e'       : printer.gcode_move.gcode_position.e,
	'factor'  : {'speed'  : printer.gcode_move.speed_factor,
	'extrude': printer.gcode_move.extrude_factor}} %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=restore VALUE="{restore}"
	{% if not printer[printer.toolhead.extruder].can_extrude %}
	{% if verbose %}{action_respond_info("Timelapse: Warning, minimum extruder temperature not reached!")}{% endif %}
	{% else %}
	{% if extruder.fw_retract %}
	G10
	{% else %}
	M83
	G0 E-{extruder.retract} F{speed.retract * 60}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=is_paused VALUE=True
	{macro.pause}
	SET_GCODE_OFFSET X=0 Y=0
	G90
	{% if "xyz" not in printer.toolhead.homed_axes %}
	{% if verbose %}{action_respond_info("Timelapse: Warning, axis not homed yet!")}{% endif %}
	{% else %}
	G0 {pos.x} {pos.y} {pos.z} F{speed.travel * 60}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=takingframe VALUE=True
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_TAKE_FRAME DURATION={check_time}
	M400
	{% endif %}
	_TIMELAPSE_NEW_FRAME HYPERLAPSE={hyperlapse}
	{% endif %}
	{% else %}
	{% if verbose %}{action_respond_info("Timelapse: disabled, take frame ignored")}{% endif %}
	{% endif %}

[gcode_macro _TIMELAPSE_NEW_FRAME]
description = action call for timelapse shoot. must be a seperate macro
gcode = 
	{action_call_remote_method("timelapse_newframe",
	macropark=printer['gcode_macro TIMELAPSE_TAKE_FRAME'].park,
	hyperlapse=params.HYPERLAPSE)}

[delayed_gcode _WAIT_TIMELAPSE_TAKE_FRAME]
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% set factor = {'speed': printer.gcode_move.speed_factor, 'extrude': printer.gcode_move.extrude_factor} %}
	{% if tl.takingframe %}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_TAKE_FRAME DURATION={tl.check_time}
	{% else %}
	{tl.macro.resume} VELOCITY={tl.speed.travel}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=is_paused VALUE=False
	{% if not printer[printer.toolhead.extruder].can_extrude %}
	{action_respond_info("Timelapse: Warning minimum extruder temperature not reached!")}
	{% else %}
	{% if tl.extruder.fw_retract %}
	G11
	{% else %}
	G0 E{tl.extruder.extrude} F{tl.speed.extrude * 60}
	G0 F{tl.restore.speed}
	{% if tl.restore.absolute.extrude %}
	M82
	G92 E{tl.restore.e}
	{% endif %}
	{% endif %}
	{% endif %}
	{% if tl.restore.factor.speed   != factor.speed   %} M220 S{(factor.speed*100)|round(0)}   {% endif %}
	{% if tl.restore.factor.extrude != factor.extrude %} M221 S{(factor.extrude*100)|round(0)} {% endif %}
	{% if not tl.restore.absolute.coordinates %} G91 {% endif %}
	{% endif %}

[gcode_macro HYPERLAPSE]
description = Start/Stop a hyperlapse recording
variable_cycle = 0
variable_run = False
gcode = 
	{% set cycle = params.CYCLE|default(30)|int %}
	{% if params.ACTION and params.ACTION|lower == 'start' %}
	{action_respond_info("Hyperlapse: frames started (Cycle %d sec)" % cycle)}
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=run VALUE=True
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=cycle VALUE={cycle}
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION={cycle}
	TIMELAPSE_TAKE_FRAME HYPERLAPSE=True
	{% elif params.ACTION and params.ACTION|lower == 'stop' %}
	{% if run %}{action_respond_info("Hyperlapse: frames stopped")}{% endif %}
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=run VALUE=False
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION=0
	{% else %}
	{action_raise_error("Hyperlapse: No valid input parameter
	Use:
	- HYPERLAPSE ACTION=START [CYCLE=time]
	- HYPERLAPSE ACTION=STOP")}
	{% endif %}

[delayed_gcode _HYPERLAPSE_LOOP]
gcode = 
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION={printer["gcode_macro HYPERLAPSE"].cycle}
	TIMELAPSE_TAKE_FRAME HYPERLAPSE=True

[gcode_macro TIMELAPSE_RENDER]
description = Render Timelapse video and wait for the result
variable_render = False
variable_run_identifier = 0
gcode = 
	{action_respond_info("Timelapse: Rendering started")}
	{action_call_remote_method("timelapse_render", byrendermacro="True")}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_RENDER VARIABLE=render VALUE=True
	{printer.configfile.settings['gcode_macro pause'].rename_existing}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_RENDER DURATION=0.5

[delayed_gcode _WAIT_TIMELAPSE_RENDER]
gcode = 
	{% set ri = printer['gcode_macro TIMELAPSE_RENDER'].run_identifier % 4 %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_RENDER VARIABLE=run_identifier VALUE={ri + 1}
	{% if printer['gcode_macro TIMELAPSE_RENDER'].render %}
	M117 Rendering {['-','\\','|','/'][ri]}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_RENDER DURATION=0.5
	{% else %}
	{action_respond_info("Timelapse: Rendering finished")}
	M117
	{printer.configfile.settings['gcode_macro resume'].rename_existing}
	{% endif %}

[gcode_macro TEST_STREAM_DELAY]
description = Helper macro to find stream and park delay
gcode = 
	{% set min = printer.toolhead.axis_minimum %}
	{% set max = printer.toolhead.axis_maximum %}
	{% set act = printer.toolhead.position %}
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% if act.z > 5.0 %}
	G0 X{min.x + 5.0} F{tl.speed.travel|int * 60}
	G0 X{(max.x-min.x)/2}
	G4 P{tl.park.time|float * 1000}
	_TIMELAPSE_NEW_FRAME HYPERLAPSE=FALSE
	G0 X{max.x - 5.0}
	{% else %}
	{action_raise_error("Toolhead z %.3f to low. Please place head above z = 5.0" % act.z)}
	{% endif %}

[gcode_macro _OBICO_LAYER_CHANGE]
description = Run a scan across the current print area
variable_first_layer_scan_retract_length = 6
variable_first_layer_scan_retract_speed = 15
variable_first_layer_scan_cooldown_temp = 170
variable_first_layer_scan_resume_speed = 50
variable_first_layer_scan_enabled = True
variable_first_layer_scan_stepover = 10
variable_first_layer_scan_speed = 10
variable_first_layer_scan_zhop = 4
variable_first_layer_scan_zhop_speed = 15
variable_verbose = False
variable_current_layer = -1
variable_first_layer_scanning = False
variable_wait = {'resume': "RESUME", 'absolute_coordinates': True, 'absolute_extrude': True, 'e': 0.0, 'previous_temp': 0}
gcode = 
	
	{% set pause_macro  = "PAUSE"  if printer.configfile.settings['gcode_macro pause']  is not defined
	else printer.configfile.settings['gcode_macro pause'].rename_existing %}
	{% set resume_macro = "RESUME" if printer.configfile.settings['gcode_macro resume'] is not defined
	else printer.configfile.settings['gcode_macro resume'].rename_existing %}
	
	{% set current_layer_default = printer.print_stats.info.current_layer if printer.print_stats.info.current_layer is not none else -1 %}
	{% set current_layer = params.CURRENT_LAYER|default(current_layer_default)|int %}
	
	{% set polygon_points = printer.exclude_object.objects|map(attribute='polygon')|sum(start=[]) if printer.exclude_object is defined else [] %}
	{% set min_x = params.MINX|default(polygon_points|map(attribute=0)|min|default(printer.toolhead.axis_minimum.x))|float %}
	{% set min_y = params.MINY|default(polygon_points|map(attribute=1)|min|default(printer.toolhead.axis_minimum.y))|float %}
	{% set max_x = params.MAXX|default(polygon_points|map(attribute=0)|max|default(printer.toolhead.axis_maximum.x))|float %}
	{% set max_y = params.MAXY|default(polygon_points|map(attribute=1)|max|default(printer.toolhead.axis_maximum.y))|float %}
	
	{% set stepoverCount = ((max_y - min_y) / first_layer_scan_stepover|float)|round(method='ceil')|int %}
	
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Layer %d" % (current_layer)}' {% endif %}
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=current_layer VALUE={current_layer}
	
	{% if first_layer_scan_enabled and current_layer == 2 %}
	
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=first_layer_scanning VALUE=True
	
	
	{% set wait_dic = {'resume'              : resume_macro,
	'absolute_coordinates': printer.gcode_move.absolute_coordinates,
	'absolute_extrude'    : printer.gcode_move.absolute_extrude,
	'e'                   : printer.gcode_move.gcode_position.e,
	'previous_temp'       : printer.extruder.target} %}
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=wait VALUE="{wait_dic}"
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Prepare scanning" {% endif %}
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Scan Coordinates: Min:[%.3f:%.3f] Max:[%.3f:%.3f]" % (min_x,min_y,max_x,max_y)}' {% endif %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Retract %.1fmm filament" % first_layer_scan_retract_length|abs}' {% endif %}
	M83
	G0 E-{first_layer_scan_retract_length|abs} F{first_layer_scan_retract_speed|float * 60}
	{% endif %}
	G91
	G0 Z{first_layer_scan_zhop|abs} F{first_layer_scan_zhop_speed|float * 60}
	
	
	M106 S255
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Fan on and lowering temperature to %.1f" % first_layer_scan_cooldown_temp}' {% endif %}
	M104 S{first_layer_scan_cooldown_temp}
	M109 S{first_layer_scan_cooldown_temp}
	
	{pause_macro}
	
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Start scanning" {% endif %}
	
	UPDATE_DELAYED_GCODE ID=_WAIT_OBICO_LAYER_CHANGE DURATION=1.0
	G90
	G0 X{min_x} Y{min_y} F{first_layer_scan_resume_speed|float * 60}
	{% for ystep in range(stepoverCount) %}
	G0 Y{min_y + first_layer_scan_stepover|float * ystep} F{first_layer_scan_speed|float * 60}
	G0 X{max_x if ystep % 2 == 0 else min_x}              F{first_layer_scan_speed|float * 60}
	{% endfor %}
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Finish scanning" {% endif %}
	
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=first_layer_scanning VALUE=False
	
	{% endif %}

[delayed_gcode _WAIT_OBICO_LAYER_CHANGE]
gcode = 
	{% set lc_macro = printer['gcode_macro _OBICO_LAYER_CHANGE'] %}
	{% if lc_macro.first_layer_scanning %}
	
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Waiting for first layer scan..." {% endif %}
	UPDATE_DELAYED_GCODE ID=_WAIT_OBICO_LAYER_CHANGE DURATION=1.0
	{% else %}
	
	M107
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Fan off and resume print" {% endif %}
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Call %s VELOCITY=%.1f" % (lc_macro.wait.resume, lc_macro.first_layer_scan_resume_speed)}' {% endif %}
	{lc_macro.wait.resume} VELOCITY={lc_macro.first_layer_scan_resume_speed}
	G91
	G0 Z-{lc_macro.first_layer_scan_zhop|abs} F{lc_macro.first_layer_scan_zhop_speed|float * 60}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% set first_layer_scan_unretract_length = lc_macro.first_layer_scan_retract_length + 0.5 %}
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Extrude %.1fmm filament" % first_layer_scan_unretract_length|abs}' {% endif %}
	M83
	G0 E{first_layer_scan_unretract_length|abs} F{lc_macro.first_layer_scan_retract_speed|float * 60}
	{% endif %}
	
	
	M104 S{lc_macro.wait.previous_temp}
	M109 S{lc_macro.wait.previous_temp}
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Heating back up to previous temperature"}' {% endif %}
	
	
	{% if lc_macro.wait.absolute_coordinates %} G90 {% endif %}
	{% if lc_macro.wait.absolute_extrude %}
	M82
	G92 E{lc_macro.wait.e}
	{% endif %}
	{% endif %}

[gcode_macro OBICO_LINK_STATUS]
description = Link to Obico server
variable_one_time_passcode = ''
variable_one_time_passlink = ''
variable_is_linked = False
gcode = 
	{action_respond_info('Obico one_time_passcode: {}'.format(one_time_passcode))}
	{action_respond_info('Obico one_time_passlink: {}'.format(one_time_passlink))}
	{action_respond_info('Obico is_linked: {}'.format(is_linked))}
	{% if not is_linked and one_time_passcode != '' %}
	M117 Code: {one_time_passcode}
	{% else %}
	M117 Obico linked
	{% endif %}

[gcode_macro _OBICO_RELINK]
description = Re-link to Obico server
gcode = 
	{action_respond_info('WARNING: Re-link to Obico server')}
	{action_call_remote_method("obico_remote_event", event_name='relink_obico', message='')}
	{action_respond_info('WARNING: relink_obico requested')}

[exclude_object]

[mcu]
serial = /dev/serial/by-id/usb-1a86_USB_Serial-if00-port0
restart_method = command

[temperature_sensor raspberry_pi]
sensor_type = temperature_host
min_temp = 10
max_temp = 100

[temperature_sensor mcu_temp]
sensor_type = temperature_mcu
min_temp = 0
max_temp = 100

[printer]
kinematics = cartesian
max_velocity = 200
max_accel = 4000
max_z_velocity = 10
max_z_accel = 100
minimum_cruise_ratio = 0.5
square_corner_velocity = 5

[stepper_x]
step_pin = PB9
dir_pin = PC2
enable_pin = !PC3
microsteps = 16
rotation_distance = 40
endstop_pin = ^PA5
position_endstop = 0
position_max = 230
homing_speed = 50

[stepper_y]
step_pin = PB7
dir_pin = PB8
enable_pin = !PC3
microsteps = 16
rotation_distance = 40
endstop_pin = ^PA6
position_endstop = 0
position_max = 231
homing_speed = 50

[stepper_z]
step_pin = PB5
dir_pin = !PB6
enable_pin = !PC3
microsteps = 16
rotation_distance = 8
endstop_pin = probe:z_virtual_endstop
position_max = 250
position_min = -4
homing_speed = 4
second_homing_speed = 1
homing_retract_dist = 2.0

[fan]
pin = PA0

[extruder]
max_extrude_only_distance = 100.0
step_pin = PB3
dir_pin = PB4
enable_pin = !PC3
microsteps = 16
gear_ratio = 42:12
rotation_distance = 26.359
nozzle_diameter = 0.400
filament_diameter = 1.750
heater_pin = PA1
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PC5
min_temp = 0
max_temp = 300
min_extrude_temp = 170
pressure_advance = .0369
pressure_advance_smooth_time = 0.04
control = pid
pid_kp = 19.195
pid_ki = 1.000
pid_kd = 92.135

[firmware_retraction]
retract_length = 0.3
retract_speed = 20

[idle_timeout]
gcode = 
	{% if printer.pause_resume.is_paused %}
	M118 Idle timeout while paused, turning off hotend
	SET_HEATER_TEMPERATURE HEATER=extruder TARGET=0
	{% else %}
	M118 Idle timeout
	TURN_OFF_HEATERS
	M84
	{% endif %}
timeout = 1800

[heater_bed]
heater_pin = PA2
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PC4
min_temp = 0
max_temp = 130
control = pid
pid_kp = 68.601
pid_ki = 1.185
pid_kd = 993.000

[bltouch]
sensor_pin = ^PB1
control_pin = PB0
x_offset = -31.8
y_offset = -40.5
speed = 35
samples = 2
samples_result = median
samples_tolerance = 0.05
samples_tolerance_retries = 2
sample_retract_dist = 5.0
probe_with_touch_mode = true
stow_on_each_sample = false
z_offset = 2.049

[safe_z_home]
home_xy_position = 147, 154
speed = 75
z_hop = 10
z_hop_speed = 5
move_to_previous = false

[bed_screws]
screw1 = 30,51
screw1_name = "FL"
screw2 = 200,51
screw2_name = "FR"
screw3 = 200,195
screw3_name = "RR"
screw4 = 30,195
screw4_name = "RL"

[screws_tilt_adjust]
screw1 = 67, 67
screw1_name = front left screw
screw2 = 230, 67
screw2_name = front right screw
screw3 = 230, 230
screw3_name = rear right screw
screw4 = 67.60, 230
screw4_name = rear left screw
horizontal_move_z = 10
speed = 200
screw_thread = CW-M4

[bed_mesh]
speed = 120
mesh_min = 10,11
mesh_max = 195,182
probe_count = 3,3
algorithm = bicubic
fade_start = 1
fade_end = 10
fade_target = 0

[filament_motion_sensor SFS_T0]
detection_length = 150.00
extruder = extruder
switch_pin = PA4
pause_on_runout = True
event_delay = 3.0
pause_delay = 0.5
runout_gcode = 
	M117 Runout Detected!

[delayed_gcode DISABLEFILAMENTSENSOR]
initial_duration = 1
gcode = 
	SET_FILAMENT_SENSOR SENSOR=SFS_T0 ENABLE=0

[gcode_macro SFS_ENABLE]
description = Enable smart filament sensor
gcode = 
	M117 ENABLING the Smart Filament Sensor
	G92 E0
	SET_FILAMENT_SENSOR SENSOR=SFS_T0 ENABLE=1

[gcode_macro SFS_DISABLE]
description = Disable smart filament sensor
gcode = 
	M117 DISABLING the Smart Filament Sensor
	G92 E0
	SET_FILAMENT_SENSOR SENSOR=SFS_T0 ENABLE=0

[gcode_macro FILAMENT_RUNOUT]
gcode = 
	M117 Runout Detected!
	M300 S1 P10
	M600
	M300 S1 P10

[gcode_macro M300]
gcode = 
	{% set S = params.S|default(1000)|int %}
	{% set P = params.P|default(100)|int %}
	SET_PIN PIN=BEEPER VALUE=0.5 CYCLE_TIME={ 1.0/S if S > 0 else 1 }
	G4 P{P}
	SET_PIN PIN=BEEPER VALUE=0
	[gcode_macro M600]
	gcode:
	{% set X = params.X|default(25)|float %}
	{% set Y = params.Y|default(25)|float %}
	{% set Z = params.Z|default(10)|float %}
	SAVE_GCODE_STATE NAME=M600_state
	PAUSE
	G91
	G1 E-.8 F2700
	G1 Z{Z}
	G90
	G1 X{X} Y{Y} F3000
	G91
	G1 E-15 F1000
	RESTORE_GCODE_STATE NAME=M600_state

[gcode_arcs]
resolution = 1.0

[input_shaper]
shaper_freq_x = 73.5
shaper_type_x = ei
shaper_freq_y = 76.9
shaper_type_y = mzv
=======================
bed_mesh: bicubic interpolation with a probe_count of less than 4 points detected.  Forcing lagrange interpolation. Configured Probe Count: 3, 3
Extruder max_extrude_ratio=0.266081
mcu 'mcu': Starting serial connect
mcu 'mcu': got {'oid': 17, 'next_clock': 1176114816, 'value': 31515, '#name': 'analog_in_state', '#sent_time': 22.916438245, '#receive_time': 22.922225208}
mcu 'mcu': got {'oid': 10, 'next_clock': 1192674816, 'value': 14022, '#name': 'analog_in_state', '#sent_time': 23.147395578, '#receive_time': 23.151577801000002}
mcu 'mcu': got {'oid': 12, 'next_clock': 1194114816, 'value': 31564, '#name': 'analog_in_state', '#sent_time': 23.147395578, '#receive_time': 23.171627597}
mcu 'mcu': got {'oid': 17, 'next_clock': 1197714816, 'value': 31511, '#name': 'analog_in_state', '#sent_time': 23.205379356, '#receive_time': 23.221693819000002}
Loaded MCU 'mcu' 119 commands (v0.12.0-286-g81de9a861 / gcc: (15:8-2019-q3-1+b1) 8.3.1 20190703 (release) [gcc-8-branch revision 273027] binutils: (2.35.2-2+14+b2) 2.35.2)
MCU 'mcu' config: ADC_MAX=4095 BUS_PINS_i2c1=PB6,PB7 BUS_PINS_i2c1a=PB8,PB9 BUS_PINS_i2c2=PB10,PB11 BUS_PINS_spi1=PA6,PA7,PA5 BUS_PINS_spi1a=PB4,PB5,PB3 BUS_PINS_spi2=PB14,PB15,PB13 BUS_PINS_spi3=PB4,PB5,PB3 CLOCK_FREQ=72000000 MCU=stm32f103xe PWM_MAX=255 RECEIVE_WINDOW=192 RESERVE_PINS_serial=PA10,PA9 SERIAL_BAUD=250000 STATS_SUMSQ_BASE=256 STEPPER_BOTH_EDGE=1
mcu_temperature 'mcu' nominal base=357.558140 slope=-767.441860
Configured MCU 'mcu' (1024 moves)
Starting heater checks for heater_bed
bed_mesh: generated points
Index |  Tool Adjusted  |   Probe
  0   | (41.8, 51.5)    | (10.0, 11.0)
  1   | (134.3, 51.5)   | (102.5, 11.0)
  2   | (226.8, 51.5)   | (195.0, 11.0)
  3   | (226.8, 137.0)  | (195.0, 96.5)
  4   | (134.3, 137.0)  | (102.5, 96.5)
  5   | (41.8, 137.0)   | (10.0, 96.5)
  6   | (41.8, 222.5)   | (10.0, 182.0)
  7   | (134.3, 222.5)  | (102.5, 182.0)
  8   | (226.8, 222.5)  | (195.0, 182.0)
Starting heater checks for extruder
Stats 24.4: gcodein=0  mcu: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=1136 bytes_read=4650 bytes_retransmit=9 bytes_invalid=0 send_seq=123 receive_seq=123 retransmit_seq=2 srtt=0.003 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71998948  raspberry_pi: temp=58.4 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.2 pwm=0.000 sysload=1.85 cputime=2.086 memavail=1506460 print_time=97191.418 buffer_time=0.249 print_stall=0 extruder: target=0 temp=0.0 pwm=0.000
webhooks client 548215707344: New connection
webhooks client 548215707344: Client info {'program': 'Moonraker', 'version': 'v0.9.3-3-gccfe32f'}
webhooks: registering remote method 'shutdown_machine' for connection id: 548215707344
webhooks: registering remote method 'reboot_machine' for connection id: 548215707344
webhooks: registering remote method 'pause_job_queue' for connection id: 548215707344
webhooks: registering remote method 'start_job_queue' for connection id: 548215707344
webhooks: registering remote method 'spoolman_set_active_spool' for connection id: 548215707344
Stats 25.4: gcodein=0  mcu: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=1142 bytes_read=4816 bytes_retransmit=9 bytes_invalid=0 send_seq=124 receive_seq=124 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000075  raspberry_pi: temp=60.9 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.2 pwm=0.000 sysload=2.02 cputime=2.120 memavail=1475816 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 26.4: gcodein=0  mcu: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=1148 bytes_read=4967 bytes_retransmit=9 bytes_invalid=0 send_seq=125 receive_seq=125 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000096  raspberry_pi: temp=59.4 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.02 cputime=2.151 memavail=1473456 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 27.4: gcodein=0  mcu: mcu_awake=0.006 mcu_task_avg=0.000027 mcu_task_stddev=0.000013 bytes_write=1154 bytes_read=5163 bytes_retransmit=9 bytes_invalid=0 send_seq=126 receive_seq=126 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71999974  raspberry_pi: temp=59.4 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.2 pwm=0.000 sysload=2.02 cputime=2.168 memavail=1578012 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
webhooks: registering remote method 'obico_remote_event' for connection id: 548215707344
Stats 28.4: gcodein=0  mcu: mcu_awake=0.006 mcu_task_avg=0.000027 mcu_task_stddev=0.000013 bytes_write=1160 bytes_read=5329 bytes_retransmit=9 bytes_invalid=0 send_seq=127 receive_seq=127 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000152  raspberry_pi: temp=57.9 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.02 cputime=2.183 memavail=1551244 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 29.4: gcodein=0  mcu: mcu_awake=0.006 mcu_task_avg=0.000027 mcu_task_stddev=0.000013 bytes_write=1166 bytes_read=5480 bytes_retransmit=9 bytes_invalid=0 send_seq=128 receive_seq=128 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000094  raspberry_pi: temp=59.9 mcu_temp: temp=29.0 heater_bed: target=0 temp=20.2 pwm=0.000 sysload=2.02 cputime=2.198 memavail=1550840 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 30.4: gcodein=0  mcu: mcu_awake=0.006 mcu_task_avg=0.000027 mcu_task_stddev=0.000013 bytes_write=1172 bytes_read=5661 bytes_retransmit=9 bytes_invalid=0 send_seq=129 receive_seq=129 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000052  raspberry_pi: temp=60.4 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.2 pwm=0.000 sysload=2.10 cputime=2.210 memavail=1541812 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 31.4: gcodein=0  mcu: mcu_awake=0.006 mcu_task_avg=0.000027 mcu_task_stddev=0.000013 bytes_write=1178 bytes_read=5827 bytes_retransmit=9 bytes_invalid=0 send_seq=130 receive_seq=130 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000061  raspberry_pi: temp=60.4 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.10 cputime=2.220 memavail=1519252 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 32.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1184 bytes_read=5992 bytes_retransmit=9 bytes_invalid=0 send_seq=131 receive_seq=131 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000061  raspberry_pi: temp=59.4 mcu_temp: temp=29.0 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.10 cputime=2.231 memavail=1494076 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 33.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1190 bytes_read=6173 bytes_retransmit=9 bytes_invalid=0 send_seq=132 receive_seq=132 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000056  raspberry_pi: temp=59.4 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.10 cputime=2.241 memavail=1463840 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 34.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1196 bytes_read=6339 bytes_retransmit=9 bytes_invalid=0 send_seq=133 receive_seq=133 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000113  raspberry_pi: temp=58.4 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.2 pwm=0.000 sysload=2.10 cputime=2.253 memavail=1491696 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 35.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1202 bytes_read=6490 bytes_retransmit=9 bytes_invalid=0 send_seq=134 receive_seq=134 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000106  raspberry_pi: temp=57.9 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.25 cputime=2.264 memavail=1545072 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 36.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1208 bytes_read=6671 bytes_retransmit=9 bytes_invalid=0 send_seq=135 receive_seq=135 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000139  raspberry_pi: temp=59.4 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.25 cputime=2.274 memavail=1536280 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 37.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1214 bytes_read=6837 bytes_retransmit=9 bytes_invalid=0 send_seq=136 receive_seq=136 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000134  raspberry_pi: temp=58.9 mcu_temp: temp=29.0 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.25 cputime=2.285 memavail=1522672 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 38.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1220 bytes_read=7002 bytes_retransmit=9 bytes_invalid=0 send_seq=137 receive_seq=137 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000126  raspberry_pi: temp=58.4 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.25 cputime=2.296 memavail=1503520 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 39.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1226 bytes_read=7198 bytes_retransmit=9 bytes_invalid=0 send_seq=138 receive_seq=138 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000128  raspberry_pi: temp=59.4 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.2 pwm=0.000 sysload=2.25 cputime=2.307 memavail=1485636 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 40.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1232 bytes_read=7349 bytes_retransmit=9 bytes_invalid=0 send_seq=139 receive_seq=139 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000128  raspberry_pi: temp=59.4 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.2 pwm=0.000 sysload=2.31 cputime=2.316 memavail=1457920 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 41.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1238 bytes_read=7500 bytes_retransmit=9 bytes_invalid=0 send_seq=140 receive_seq=140 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000135  raspberry_pi: temp=59.4 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.2 pwm=0.000 sysload=2.31 cputime=2.330 memavail=1498752 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.1 pwm=0.000
Stats 42.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1244 bytes_read=7696 bytes_retransmit=9 bytes_invalid=0 send_seq=141 receive_seq=141 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000139  raspberry_pi: temp=58.9 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.31 cputime=2.341 memavail=1538228 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 43.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1250 bytes_read=7861 bytes_retransmit=9 bytes_invalid=0 send_seq=142 receive_seq=142 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000151  raspberry_pi: temp=58.9 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.31 cputime=2.352 memavail=1535048 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 44.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1256 bytes_read=8012 bytes_retransmit=9 bytes_invalid=0 send_seq=143 receive_seq=143 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000149  raspberry_pi: temp=59.4 mcu_temp: temp=29.0 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.31 cputime=2.362 memavail=1514392 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 45.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1262 bytes_read=8208 bytes_retransmit=9 bytes_invalid=0 send_seq=144 receive_seq=144 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000156  raspberry_pi: temp=58.9 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.2 pwm=0.000 sysload=2.37 cputime=2.374 memavail=1500784 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 46.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1268 bytes_read=8359 bytes_retransmit=9 bytes_invalid=0 send_seq=145 receive_seq=145 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000170  raspberry_pi: temp=58.9 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.37 cputime=2.384 memavail=1476344 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 47.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1274 bytes_read=8510 bytes_retransmit=9 bytes_invalid=0 send_seq=146 receive_seq=146 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000198  raspberry_pi: temp=58.4 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.37 cputime=2.397 memavail=1454924 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 48.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1280 bytes_read=8720 bytes_retransmit=9 bytes_invalid=0 send_seq=147 receive_seq=147 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000201  raspberry_pi: temp=58.9 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.37 cputime=2.411 memavail=1559056 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 49.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1286 bytes_read=8871 bytes_retransmit=9 bytes_invalid=0 send_seq=148 receive_seq=148 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000198  raspberry_pi: temp=59.9 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.2 pwm=0.000 sysload=2.37 cputime=2.421 memavail=1539524 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 50.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1292 bytes_read=9022 bytes_retransmit=9 bytes_invalid=0 send_seq=149 receive_seq=149 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000195  raspberry_pi: temp=57.9 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.50 cputime=2.431 memavail=1533820 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 51.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1298 bytes_read=9218 bytes_retransmit=9 bytes_invalid=0 send_seq=150 receive_seq=150 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000192  raspberry_pi: temp=58.9 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.1 pwm=0.000 sysload=2.50 cputime=2.443 memavail=1510384 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 52.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1304 bytes_read=9369 bytes_retransmit=9 bytes_invalid=0 send_seq=151 receive_seq=151 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000234  raspberry_pi: temp=58.9 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.2 pwm=0.000 sysload=2.50 cputime=2.454 memavail=1498036 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 53.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1310 bytes_read=9534 bytes_retransmit=9 bytes_invalid=0 send_seq=152 receive_seq=152 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000245  raspberry_pi: temp=57.9 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.2 pwm=0.000 sysload=2.50 cputime=2.465 memavail=1470064 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 54.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1316 bytes_read=9730 bytes_retransmit=9 bytes_invalid=0 send_seq=153 receive_seq=153 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000256  raspberry_pi: temp=58.4 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.50 cputime=2.479 memavail=1492356 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 55.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1322 bytes_read=9881 bytes_retransmit=9 bytes_invalid=0 send_seq=154 receive_seq=154 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000243  raspberry_pi: temp=58.4 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.46 cputime=2.491 memavail=1553308 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 56.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1328 bytes_read=10032 bytes_retransmit=9 bytes_invalid=0 send_seq=155 receive_seq=155 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000242  raspberry_pi: temp=59.4 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.2 pwm=0.000 sysload=2.46 cputime=2.501 memavail=1537432 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 57.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1334 bytes_read=10228 bytes_retransmit=9 bytes_invalid=0 send_seq=156 receive_seq=156 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000236  raspberry_pi: temp=57.9 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.46 cputime=2.513 memavail=1527652 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 58.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1340 bytes_read=10393 bytes_retransmit=9 bytes_invalid=0 send_seq=157 receive_seq=157 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000229  raspberry_pi: temp=59.4 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.2 pwm=0.000 sysload=2.46 cputime=2.524 memavail=1504972 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 59.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1346 bytes_read=10544 bytes_retransmit=9 bytes_invalid=0 send_seq=158 receive_seq=158 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000224  raspberry_pi: temp=58.4 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.2 pwm=0.000 sysload=2.46 cputime=2.535 memavail=1492876 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 60.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1352 bytes_read=10740 bytes_retransmit=9 bytes_invalid=0 send_seq=159 receive_seq=159 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000220  raspberry_pi: temp=59.4 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.2 pwm=0.000 sysload=2.34 cputime=2.547 memavail=1463140 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 61.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1358 bytes_read=10891 bytes_retransmit=9 bytes_invalid=0 send_seq=160 receive_seq=160 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000223  raspberry_pi: temp=59.9 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.1 pwm=0.000 sysload=2.34 cputime=2.563 memavail=1492452 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 62.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1364 bytes_read=11042 bytes_retransmit=9 bytes_invalid=0 send_seq=161 receive_seq=161 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000217  raspberry_pi: temp=59.4 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.2 pwm=0.000 sysload=2.34 cputime=2.574 memavail=1545912 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 63.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1370 bytes_read=11252 bytes_retransmit=9 bytes_invalid=0 send_seq=162 receive_seq=162 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000215  raspberry_pi: temp=58.9 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.2 pwm=0.000 sysload=2.34 cputime=2.586 memavail=1537120 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 64.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1376 bytes_read=11403 bytes_retransmit=9 bytes_invalid=0 send_seq=163 receive_seq=163 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000213  raspberry_pi: temp=58.4 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.34 cputime=2.597 memavail=1522272 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 65.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1382 bytes_read=11554 bytes_retransmit=9 bytes_invalid=0 send_seq=164 receive_seq=164 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000212  raspberry_pi: temp=59.4 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.2 pwm=0.000 sysload=2.39 cputime=2.608 memavail=1503120 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 66.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1388 bytes_read=11737 bytes_retransmit=9 bytes_invalid=0 send_seq=165 receive_seq=165 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000211  raspberry_pi: temp=59.4 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.39 cputime=2.620 memavail=1483248 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 67.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1394 bytes_read=11878 bytes_retransmit=9 bytes_invalid=0 send_seq=166 receive_seq=166 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000209  raspberry_pi: temp=58.9 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.2 pwm=0.000 sysload=2.39 cputime=2.631 memavail=1457204 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 68.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1400 bytes_read=12033 bytes_retransmit=9 bytes_invalid=0 send_seq=167 receive_seq=167 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000224  raspberry_pi: temp=58.9 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.2 pwm=0.000 sysload=2.39 cputime=2.644 memavail=1560560 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 69.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1406 bytes_read=12222 bytes_retransmit=9 bytes_invalid=0 send_seq=168 receive_seq=168 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000220  raspberry_pi: temp=58.4 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.39 cputime=2.656 memavail=1528864 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 70.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1412 bytes_read=12373 bytes_retransmit=9 bytes_invalid=0 send_seq=169 receive_seq=169 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000217  raspberry_pi: temp=58.9 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.44 cputime=2.668 memavail=1530136 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 71.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1418 bytes_read=12524 bytes_retransmit=9 bytes_invalid=0 send_seq=170 receive_seq=170 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000215  raspberry_pi: temp=59.4 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.44 cputime=2.679 memavail=1511248 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 72.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1424 bytes_read=12720 bytes_retransmit=9 bytes_invalid=0 send_seq=171 receive_seq=171 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000214  raspberry_pi: temp=59.9 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.44 cputime=2.691 memavail=1495404 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 73.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1430 bytes_read=12885 bytes_retransmit=9 bytes_invalid=0 send_seq=172 receive_seq=172 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000222  raspberry_pi: temp=57.0 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.2 pwm=0.000 sysload=2.44 cputime=2.702 memavail=1469736 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 74.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1436 bytes_read=13036 bytes_retransmit=9 bytes_invalid=0 send_seq=173 receive_seq=173 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000219  raspberry_pi: temp=58.4 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.2 pwm=0.000 sysload=2.44 cputime=2.714 memavail=1446836 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 75.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1442 bytes_read=13232 bytes_retransmit=9 bytes_invalid=0 send_seq=174 receive_seq=174 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000220  raspberry_pi: temp=58.9 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.49 cputime=2.730 memavail=1551264 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 76.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1448 bytes_read=13383 bytes_retransmit=9 bytes_invalid=0 send_seq=175 receive_seq=175 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000221  raspberry_pi: temp=59.4 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.2 pwm=0.000 sysload=2.49 cputime=2.740 memavail=1530116 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 77.5: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1454 bytes_read=13534 bytes_retransmit=9 bytes_invalid=0 send_seq=176 receive_seq=176 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000219  raspberry_pi: temp=58.9 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.49 cputime=2.750 memavail=1526356 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 78.5: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1460 bytes_read=13744 bytes_retransmit=9 bytes_invalid=0 send_seq=177 receive_seq=177 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000217  raspberry_pi: temp=57.9 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.2 pwm=0.000 sysload=2.49 cputime=2.762 memavail=1504936 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 79.5: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1466 bytes_read=13895 bytes_retransmit=9 bytes_invalid=0 send_seq=178 receive_seq=178 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000215  raspberry_pi: temp=58.9 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.2 pwm=0.000 sysload=2.49 cputime=2.771 memavail=1491328 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 80.5: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1472 bytes_read=14061 bytes_retransmit=9 bytes_invalid=0 send_seq=179 receive_seq=179 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000213  raspberry_pi: temp=58.4 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.2 pwm=0.000 sysload=2.53 cputime=2.783 memavail=1467144 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 81.5: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1478 bytes_read=14242 bytes_retransmit=9 bytes_invalid=0 send_seq=180 receive_seq=180 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000211  raspberry_pi: temp=57.9 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.53 cputime=2.794 memavail=1447252 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 82.5: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1490 bytes_read=14393 bytes_retransmit=9 bytes_invalid=0 send_seq=182 receive_seq=181 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000211  raspberry_pi: temp=58.9 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.53 cputime=2.807 memavail=1552352 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 83.5: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1496 bytes_read=14589 bytes_retransmit=9 bytes_invalid=0 send_seq=183 receive_seq=183 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000209  raspberry_pi: temp=57.9 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.1 pwm=0.000 sysload=2.53 cputime=2.824 memavail=1529768 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 84.5: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1502 bytes_read=14770 bytes_retransmit=9 bytes_invalid=0 send_seq=184 receive_seq=184 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000208  raspberry_pi: temp=59.4 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.53 cputime=2.837 memavail=1526020 print_time=97191.418 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 744.9: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=5522 bytes_read=125899 bytes_retransmit=9 bytes_invalid=0 send_seq=854 receive_seq=854 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000222  raspberry_pi: temp=57.0 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=2.54 cputime=11.342 memavail=1450648 print_time=97911.705 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
webhooks client 548215707344: Disconnected
Restarting printer
Start printer at Sun Dec 22 15:13:24 2024 (1734898404.3 746.1)
===== Config file =====
[virtual_sdcard]
path = ~/printer_data/gcodes
on_error_gcode = CANCEL_PRINT

[pause_resume]
recover_velocity = 25

[display_status]

[respond]
default_prefix = 

[gcode_macro CANCEL_PRINT]
description = Cancel the actual running print
rename_existing = BASE_CANCEL_PRINT
gcode = 
	G91
	G0 Z10 F600
	G90
	TURN_OFF_HEATERS
	G0 X5 Y220
	CLEAR_PAUSE
	
	BASE_CANCEL_PRINT

[gcode_macro PAUSE]
description = Pause the actual running print
rename_existing = PAUSE_BASE
gcode = 
	
	{% set x = params.X|default(5) %}
	{% set y = params.Y|default(225) %}
	{% set z = params.Z|default(10)|float %}
	{% set e = params.E|default(1) %}
	
	{% set max_z = printer.toolhead.axis_maximum.z|float %}
	{% set act_z = printer.toolhead.position.z|float %}
	{% set lift_z = z|abs %}
	{% if act_z < (max_z - lift_z) %}
	{% set z_safe = lift_z %}
	{% else %}
	{% set z_safe = max_z - act_z %}
	{% endif %}
	
	PAUSE_BASE
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E-{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	{% if "xyz" in printer.toolhead.homed_axes %}
	G1 Z{z_safe}
	G90
	G1 X{x} Y{y} F6000
	{% else %}
	{action_respond_info("Printer not homed")}
	{% endif %}

[gcode_macro RESUME]
description = Resume the actual running print
rename_existing = RESUME_BASE
variable_last_extruder_temp = {'restore': False, 'temp': 0}
variable_restore_idle_timeout = 0
variable_idle_state = False
gcode = 
	
	{% set e = params.E|default(1) %}
	
	{% if 'VELOCITY' in params|upper %}
	{% set get_params = ('VELOCITY=' + params.VELOCITY)  %}
	{%else %}
	{% set get_params = "" %}
	{% endif %}
	
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	RESUME_BASE {get_params}

[gcode_macro SET_PAUSE_NEXT_LAYER]
description = Enable a pause if the next layer is reached
gcode = 
	{% set pause_next_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_next_layer %}
	{% set ENABLE = params.ENABLE|default(1)|int != 0 %}
	{% set MACRO = params.MACRO|default(pause_next_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_next_layer VALUE="{{ 'enable': ENABLE, 'call': MACRO }}"

[gcode_macro SET_PAUSE_AT_LAYER]
description = Enable/disable a pause if a given layer number is reached
gcode = 
	{% set pause_at_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_at_layer %}
	{% set ENABLE = params.ENABLE|int != 0 if params.ENABLE is defined
	else params.LAYER is defined %}
	{% set LAYER = params.LAYER|default(pause_at_layer.layer)|int %}
	{% set MACRO = params.MACRO|default(pause_at_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_at_layer VALUE="{{ 'enable': ENABLE, 'layer': LAYER, 'call': MACRO }}"

[gcode_macro SET_PRINT_STATS_INFO]
rename_existing = SET_PRINT_STATS_INFO_BASE
description = Overwrite, to get pause_next_layer and pause_at_layer feature
variable_pause_next_layer = { 'enable': False, 'call': "PAUSE" }
variable_pause_at_layer = { 'enable': False, 'layer': 0, 'call': "PAUSE" }
gcode = 
	{% if pause_next_layer.enable %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_next_layer" % pause_next_layer.call}'
	{pause_next_layer.call}
	SET_PAUSE_NEXT_LAYER ENABLE=0
	{% elif pause_at_layer.enable and params.CURRENT_LAYER is defined and params.CURRENT_LAYER|int == pause_at_layer.layer %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_at_layer [%d]" % (pause_at_layer.call, pause_at_layer.layer)}'
	{pause_at_layer.call}
	SET_PAUSE_AT_LAYER ENABLE=0
	{% endif %}
	SET_PRINT_STATS_INFO_BASE {rawparams}

[gcode_macro _TOOLHEAD_PARK_PAUSE_CANCEL]
description = Helper: park toolhead used in PAUSE and CANCEL_PRINT
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set velocity = printer.configfile.settings.pause_resume.recover_velocity %}
	{% set use_custom     = client.use_custom_pos|default(false)|lower == 'true' %}
	{% set custom_park_x  = client.custom_park_x|default(0.0) %}
	{% set custom_park_y  = client.custom_park_y|default(0.0) %}
	{% set park_dz        = client.custom_park_dz|default(2.0)|abs %}
	{% set sp_hop         = client.speed_hop|default(15) * 60 %}
	{% set sp_move        = client.speed_move|default(velocity) * 60 %}
	
	{% set origin    = printer.gcode_move.homing_origin %}
	{% set act       = printer.gcode_move.gcode_position %}
	{% set max       = printer.toolhead.axis_maximum %}
	{% set cone      = printer.toolhead.cone_start_z|default(max.z) %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	
	{% set z_min = params.Z_MIN|default(0)|float %}
	{% set z_park = [[(act.z + park_dz), z_min]|max, (max.z - origin.z)]|min %}
	{% set x_park = params.X       if params.X is defined
	else custom_park_x  if use_custom
	else 0.0            if round_bed
	else (max.x - 5.0) %}
	{% set y_park = params.Y       if params.Y is defined
	else custom_park_y  if use_custom
	else (max.y - 5.0)  if round_bed and z_park < cone
	else 0.0            if round_bed
	else (max.y - 5.0) %}
	
	_CLIENT_RETRACT
	{% if "xyz" in printer.toolhead.homed_axes %}
	G90
	G1 Z{z_park} F{sp_hop}
	G1 X{x_park} Y{y_park} F{sp_move}
	{% if not printer.gcode_move.absolute_coordinates %} G91 {% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='Printer not homed'
	{% endif %}

[gcode_macro _CLIENT_EXTRUDE]
description = Extrudes, if the extruder is hot enough
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set use_fw_retract = (client.use_fw_retract|default(false)|lower == 'true') and (printer.firmware_retraction is defined) %}
	{% set length = params.LENGTH|default(client.unretract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_unretract)|default(35) %}
	{% set absolute_extrude = printer.gcode_move.absolute_extrude %}
	
	{% if printer.toolhead.extruder != '' %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if use_fw_retract %}
	{% if length < 0 %}
	G10
	{% else %}
	G11
	{% endif %}
	{% else %}
	M83
	G1 E{length} F{(speed|float|abs) * 60}
	{% if absolute_extrude %}
	M82
	{% endif %}
	{% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='{"\"%s\" not hot enough" % printer.toolhead.extruder}'
	{% endif %}
	{% endif %}

[gcode_macro _CLIENT_RETRACT]
description = Retracts, if the extruder is hot enough
gcode = 
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set length = params.LENGTH|default(client.retract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_retract)|default(35) %}
	
	_CLIENT_EXTRUDE LENGTH=-{length|float|abs} SPEED={speed|float|abs}

[gcode_macro _CLIENT_LINEAR_MOVE]
description = Linear move with save and restore of the gcode state
gcode = 
	{% set x_move = "X" ~ params.X if params.X is defined else "" %}
	{% set y_move = "Y" ~ params.Y if params.Y is defined else "" %}
	{% set z_move = "Z" ~ params.Z if params.Z is defined else "" %}
	{% set e_move = "E" ~ params.E if params.E is defined else "" %}
	{% set rate = "F" ~ params.F if params.F is defined else "" %}
	{% set ABSOLUTE = params.ABSOLUTE | default(0) | int != 0 %}
	{% set ABSOLUTE_E = params.ABSOLUTE_E | default(0) | int != 0 %}
	SAVE_GCODE_STATE NAME=_client_movement
	{% if x_move or y_move or z_move %}
	G9{ 0 if ABSOLUTE else 1 }
	{% endif %}
	{% if e_move %}
	M8{ 2 if ABSOLUTE_E else 3 }
	{% endif %}
	G1 { x_move } { y_move } { z_move } { e_move } { rate }
	RESTORE_GCODE_STATE NAME=_client_movement

[gcode_macro play_test]
gcode = 
	RESPOND TYPE=command MSG="action:prompt_begin Question"
	RESPOND TYPE=command MSG="action:prompt_text Do you wont to cancel the print?"
	RESPOND TYPE=command MSG="action:prompt_footer_button continue|RESPOND TYPE=command MSG=action:prompt_end"
	RESPOND TYPE=command MSG="action:prompt_footer_button CANCEL|CANCEL_PRINT|error"
	RESPOND TYPE=command MSG="action:prompt_show"

[gcode_macro PRINT_START]
gcode = 
	START_PRINT {rawparams}

[gcode_macro START_PRINT]
gcode = 
	{% set BED_TEMP = params.BED_TEMP|default(60)|float %}
	{% set EXTRUDER_TEMP = params.EXTRUDER_TEMP|default(190)|float %}
	
	M190 S{BED_TEMP}
	
	G90
	
	G28
	
	RESPOND MSG="Bed Meshing"
	
	
	
	
	
	
	
	
	BED_MESH_CLEAR
	BED_MESH_CALIBRATE ADAPTIVE=1
	
	
	
	
	
	
	
	RESPOND MSG="Heating to print temp"
	M104 S{EXTRUDER_TEMP}
	G0 Z40 F240
	M109 S{EXTRUDER_TEMP}
	RESPOND MSG="Enable Runout Sensor"
	SFS_ENABLE
	RESPOND MSG="Line Purge"
	LINE_PURGE
	RESPOND MSG="Print Started"

[gcode_macro LINE_PURGE]
gcode = 
	G92 E0
	G1 Z2.0 F3000
	G1 X0.1 Y20 Z0.3 F5000.0
	G1 X0.1 Y200.0 Z0.3 F1500.0 E15
	G1 X0.4 Y200.0 Z0.3 F5000.0
	G1 X0.4 Y20 Z0.3 F1500.0 E30
	G92 E0
	G1 Z2.0 F3000
	G1 X5 Y20 Z0.3 F5000.0

[gcode_macro PRINT_END]
gcode = 
	END_PRINT

[gcode_macro END_PRINT]
gcode = 
	
	
	RESPOND MSG="Print Finished"
	G91
	G1 E-.5 Z0.2 F2400
	G1 X5 Y5 F6000
	G1 Z10
	G90
	SFS_DISABLE
	
	G1 X0 Y220 F6000
	M106 S0
	M104 S0
	M140 S0
	
	M84 X Y E

[gcode_macro SET_ACTIVE_SPOOL]
gcode = 
	{% if params.ID %}
	{% set id = params.ID|int %}
	{action_call_remote_method(
	"spoolman_set_active_spool",
	spool_id=id
	)}
	{% else %}
	{action_respond_info("Parameter 'ID' is required")}
	{% endif %}

[gcode_macro CLEAR_ACTIVE_SPOOL]
gcode = 
	{action_call_remote_method(
	"spoolman_set_active_spool",
	spool_id=None
	)}

[gcode_macro G29]
gcode = 
	G28
	BED_MESH_CALIBRATE
	G0 X0 Y0 Z10 F6000
	BED_MESH_PROFILE save=default

[gcode_macro M125]
gcode = 
	SAVE_GCODE_STATE NAME=parking
	M117 Parking toolhead
	G91
	G1 Z10 F600
	G90
	G1 X5 Y225 F4000
	RESTORE_GCODE_STATE NAME=parking

[gcode_macro Load_Filament]
gcode = 
	SAVE_GCODE_STATE NAME=loading_filament
	M117 Loading Filament
	M83
	G92 E0.0
	G91
	G1 E50 F200
	G92 E50
	RESTORE_GCODE_STATE NAME=loading_filament

[gcode_macro Unload_Filament]
gcode = 
	SAVE_GCODE_STATE NAME=unloading_filament
	M117 Unloading Filament
	G91
	G1 E5 F100
	G92 E0.0
	G1 E-50 F5000
	G92 E-50
	RESTORE_GCODE_STATE NAME=unloading_filament

[gcode_macro Filament_Change]
gcode = 
	
	SAVE_GCODE_STATE NAME=filament_change
	
	Unload_Filament
	
	RESPOND TYPE=command MSG="action:prompt_begin Question"
	RESPOND TYPE=command MSG="action:prompt_text Please insert new filament and confirm"
	RESPOND TYPE=command MSG="action:prompt_footer_button CONFIRM|Load_Filament|RESPOND TYPE=command MSG=action:prompt_end"
	RESPOND TYPE=command MSG="action:prompt_footer_button CANCEL|RESPOND TYPE=command MSG=action:prompt_end"
	RESPOND TYPE=command MSG="action:prompt_show"
	
	RESTORE_GCODE_STATE NAME=filament_change

[gcode_macro Calibrate_Hotend_PID]
gcode = 
	PID_CALIBRATE HEATER=extruder TARGET=200

[gcode_macro Calibrate_Bed_PID]
gcode = 
	PID_CALIBRATE HEATER=heater_bed TARGET=60

[gcode_macro Calibrate_Zoffset]
gcode = 
	PROBE_CALIBRATE

[gcode_macro Tram_bed]
gcode = 
	SCREWS_TILT_CALCULATE

[gcode_macro TEST_SPEED]
description = Test for max speed and acceleration parameters for the printer. Procedure: Home -> ReadPositionFromMCU -> MovesToolhead@Vel&Accel -> Home -> ReadPositionfromMCU
gcode = 
	
	{% set speed  = params.SPEED|default(printer.configfile.settings.printer.max_velocity)|int %}
	
	{% set iterations = params.ITERATIONS|default(5)|int %}
	
	{% set accel  = params.ACCEL|default(printer.configfile.settings.printer.max_accel)|int %}
	
	{% set min_cruise_ratio = params.MIN_CRUISE_RATIO|default(0.5)|float %}
	
	{% set bound = params.BOUND|default(20)|int %}
	
	{% set smallpatternsize = SMALLPATTERNSIZE|default(20)|int %}
	
	
	
	{% set x_min = printer.toolhead.axis_minimum.x + bound %}
	{% set x_max = printer.toolhead.axis_maximum.x - bound %}
	{% set y_min = printer.toolhead.axis_minimum.y + bound %}
	{% set y_max = printer.toolhead.axis_maximum.y - bound %}
	
	
	
	{% set x_center = (printer.toolhead.axis_minimum.x|float + printer.toolhead.axis_maximum.x|float ) / 2 %}
	{% set y_center = (printer.toolhead.axis_minimum.y|float + printer.toolhead.axis_maximum.y|float ) / 2 %}
	
	
	{% set x_center_min = x_center - (smallpatternsize/2) %}
	{% set x_center_max = x_center + (smallpatternsize/2) %}
	{% set y_center_min = y_center - (smallpatternsize/2) %}
	{% set y_center_max = y_center + (smallpatternsize/2) %}
	
	
	SAVE_GCODE_STATE NAME=TEST_SPEED
	
	
	{ action_respond_info("TEST_SPEED: starting %d iterations at speed %d, accel %d" % (iterations, speed, accel)) }
	
	
	M400
	G28
	
	{% if printer.configfile.settings.quad_gantry_level %}
	{% if printer.quad_gantry_level.applied == False %}
	QUAD_GANTRY_LEVEL
	G28 Z
	{% endif %}
	{% endif %}
	
	G90
	G1 X{printer.toolhead.axis_maximum.x-50} Y{printer.toolhead.axis_maximum.y-50} F{30*60}
	M400
	G28 X Y
	G0 X{printer.toolhead.axis_maximum.x-1} Y{printer.toolhead.axis_maximum.y-1} F{30*60}
	G4 P1000
	GET_POSITION
	
	
	G0 X{x_min} Y{y_min} Z{bound + 10} F{speed*60}
	
	
	{% if printer.configfile.settings.printer.minimum_cruise_ratio is defined %}
	SET_VELOCITY_LIMIT VELOCITY={speed} ACCEL={accel} MINIMUM_CRUISE_RATIO={min_cruise_ratio}
	{% else %}
	SET_VELOCITY_LIMIT VELOCITY={speed} ACCEL={accel} ACCEL_TO_DECEL={accel / 2}
	{% endif %}
	
	{% for i in range(iterations) %}
	
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_max} Y{y_max} F{speed*60}
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	G0 X{x_min} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	
	
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_min} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	
	
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_max} Y{y_center_max} F{speed*60}
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	G0 X{x_center_min} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	
	
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_min} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	{% endfor %}
	
	
	{% if printer.configfile.settings.printer.minimum_cruise_ratio is defined %}
	SET_VELOCITY_LIMIT VELOCITY={printer.configfile.settings.printer.max_velocity} ACCEL={printer.configfile.settings.printer.max_accel} MINIMUM_CRUISE_RATIO={printer.configfile.settings.printer.minimum_cruise_ratio}
	{% else %}
	SET_VELOCITY_LIMIT VELOCITY={printer.configfile.settings.printer.max_velocity} ACCEL={printer.configfile.settings.printer.max_accel} ACCEL_TO_DECEL={printer.configfile.settings.printer.max_accel_to_decel}
	{% endif %}
	
	
	M400
	G28
	
	G90
	G0 X{printer.toolhead.axis_maximum.x-1} Y{printer.toolhead.axis_maximum.y-1} F{30*60}
	G4 P1000
	GET_POSITION
	
	
	RESTORE_GCODE_STATE NAME=TEST_SPEED

[gcode_macro GET_TIMELAPSE_SETUP]
description = Print the Timelapse setup
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% set output_txt = ["Timelapse Setup:"] %}
	{% set _dummy = output_txt.append("enable: %s" % tl.enable) %}
	{% set _dummy = output_txt.append("park: %s" % tl.park.enable) %}
	{% if tl.park.enable %}
	{% set _dummy = output_txt.append("park position: %s time: %s s" % (tl.park.pos, tl.park.time)) %}
	{% set _dummy = output_txt.append("park cord x:%s y:%s dz:%s" % (tl.park.coord.x, tl.park.coord.y, tl.park.coord.dz)) %}
	{% set _dummy = output_txt.append("travel speed: %s mm/s" % tl.speed.travel) %}
	{% endif %}
	{% set _dummy = output_txt.append("fw_retract: %s" % tl.extruder.fw_retract) %}
	{% if not tl.extruder.fw_retract %}
	{% set _dummy = output_txt.append("retract: %s mm speed: %s mm/s" % (tl.extruder.retract, tl.speed.retract)) %}
	{% set _dummy = output_txt.append("extrude: %s mm speed: %s mm/s" % (tl.extruder.extrude, tl.speed.extrude)) %}
	{% endif %}
	{% set _dummy = output_txt.append("verbose: %s" % tl.verbose) %}
	{action_respond_info(output_txt|join("\n"))}

[gcode_macro _SET_TIMELAPSE_SETUP]
description = Set user parameters for timelapse
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	
	{% set min = printer.toolhead.axis_minimum %}
	{% set max = printer.toolhead.axis_maximum %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	{% set park = {'min'   : {'x': (min.x / 1.42)|round(3) if round_bed else min.x|round(3),
	'y': (min.y / 1.42)|round(3) if round_bed else min.y|round(3)},
	'max'   : {'x': (max.x / 1.42)|round(3) if round_bed else max.x|round(3),
	'y': (max.y / 1.42)|round(3) if round_bed else max.y|round(3)},
	'center': {'x': (max.x-(max.x-min.x)/2)|round(3),
	'y': (max.y-(max.y-min.y)/2)|round(3)}} %}
	
	{% if params.ENABLE %}
	{% if params.ENABLE|lower is in ['true', 'false'] %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=enable VALUE={True if params.ENABLE|lower == 'true' else False}
	{% else %}
	{action_raise_error("ENABLE=%s not supported. Allowed values are [True, False]" % params.ENABLE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.VERBOSE %}
	{% if params.VERBOSE|lower is in ['true', 'false'] %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=verbose VALUE={True if params.VERBOSE|lower == 'true' else False}
	{% else %}
	{action_raise_error("VERBOSE=%s not supported. Allowed values are [True, False]" % params.VERBOSE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_X %}
	{% if params.CUSTOM_POS_X|float >= min.x and params.CUSTOM_POS_X|float <= max.x %}
	{% set _dummy = tl.park.custom.update({'x':params.CUSTOM_POS_X|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_X=%s must be within [%s - %s]" % (params.CUSTOM_POS_X, min.x, max.x))}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_Y %}
	{% if params.CUSTOM_POS_Y|float >= min.y and params.CUSTOM_POS_Y|float <= max.y %}
	{% set _dummy = tl.park.custom.update({'y':params.CUSTOM_POS_Y|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_Y=%s must be within [%s - %s]" % (params.CUSTOM_POS_Y, min.y, max.y))}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_DZ %}
	{% if params.CUSTOM_POS_DZ|float >= min.z and params.CUSTOM_POS_DZ|float <= max.z %}
	{% set _dummy = tl.park.custom.update({'dz':params.CUSTOM_POS_DZ|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_DZ=%s must be within [%s - %s]" % (params.CUSTOM_POS_DZ, min.z, max.z))}
	{% endif %}
	{% endif %}
	{% if params.PARK_ENABLE %}
	{% if params.PARK_ENABLE|lower is in ['true', 'false'] %}
	{% set _dummy = tl.park.update({'enable':True if params.PARK_ENABLE|lower == 'true' else False}) %}
	{% else %}
	{action_raise_error("PARK_ENABLE=%s not supported. Allowed values are [True, False]" % params.PARK_ENABLE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.PARK_POS %}
	{% if params.PARK_POS|lower is in ['center','front_left','front_right','back_left','back_right','custom','x_only','y_only'] %}
	{% set dic = {'center'      : {'x': park.center.x   , 'y': park.center.y   , 'dz': 1                },
	'front_left'  : {'x': park.min.x      , 'y': park.min.y      , 'dz': 0                },
	'front_right' : {'x': park.max.x      , 'y': park.min.y      , 'dz': 0                },
	'back_left'   : {'x': park.min.x      , 'y': park.max.y      , 'dz': 0                },
	'back_right'  : {'x': park.max.x      , 'y': park.max.y      , 'dz': 0                },
	'custom'      : {'x': tl.park.custom.x, 'y': tl.park.custom.y, 'dz': tl.park.custom.dz},
	'x_only'      : {'x': tl.park.custom.x, 'y': 'none'          , 'dz': tl.park.custom.dz},
	'y_only'      : {'x': 'none'          , 'y': tl.park.custom.y, 'dz': tl.park.custom.dz}} %}
	{% set _dummy = tl.park.update({'pos':params.PARK_POS|lower}) %}
	{% set _dummy = tl.park.update({'coord':dic[tl.park.pos]}) %}
	{% else %}
	{action_raise_error("PARK_POS=%s not supported. Allowed values are [CENTER, FRONT_LEFT, FRONT_RIGHT, BACK_LEFT, BACK_RIGHT, CUSTOM, X_ONLY, Y_ONLY]"
	% params.PARK_POS|upper)}
	{% endif %}
	{% endif %}
	{% if params.PARK_TIME %}
	{% if params.PARK_TIME|float >= 0.0 %}
	{% set _dummy = tl.park.update({'time':params.PARK_TIME|float|round(3)}) %}
	{% else %}
	{action_raise_error("PARK_TIME=%s must be a positive number" % params.PARK_TIME)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=park VALUE="{tl.park}"
	{% if params.TRAVEL_SPEED %}
	{% if params.TRAVEL_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'travel':params.TRAVEL_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("TRAVEL_SPEED=%s must be larger than 0" % params.TRAVEL_SPEED)}
	{% endif %}
	{% endif %}
	{% if params.RETRACT_SPEED %}
	{% if params.RETRACT_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'retract':params.RETRACT_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("RETRACT_SPEED=%s must be larger than 0" % params.RETRACT_SPEED)}
	{% endif %}
	{% endif %}
	{% if params.EXTRUDE_SPEED %}
	{% if params.EXTRUDE_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'extrude':params.EXTRUDE_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("EXTRUDE_SPEED=%s must be larger than 0" % params.EXTRUDE_SPEED)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=speed VALUE="{tl.speed}"
	{% if params.EXTRUDE_DISTANCE %}
	{% if params.EXTRUDE_DISTANCE|float >= 0.0 %}
	{% set _dummy = tl.extruder.update({'extrude':params.EXTRUDE_DISTANCE|float|round(3)}) %}
	{% else %}
	{action_raise_error("EXTRUDE_DISTANCE=%s must be specified as positiv number" % params.EXTRUDE_DISTANCE)}
	{% endif %}
	{% endif %}
	{% if params.RETRACT_DISTANCE %}
	{% if params.RETRACT_DISTANCE|float >= 0.0 %}
	{% set _dummy = tl.extruder.update({'retract':params.RETRACT_DISTANCE|float|round(3)}) %}
	{% else %}
	{action_raise_error("RETRACT_DISTANCE=%s must be specified as positiv number" % params.RETRACT_DISTANCE)}
	{% endif %}
	{% endif %}
	{% if params.FW_RETRACT %}
	{% if params.FW_RETRACT|lower is in ['true', 'false'] %}
	{% if 'firmware_retraction' in printer.configfile.settings %}
	{% set _dummy = tl.extruder.update({'fw_retract': True if params.FW_RETRACT|lower == 'true' else False}) %}
	{% else %}
	{% set _dummy = tl.extruder.update({'fw_retract':False}) %}
	{% if params.FW_RETRACT|capitalize == 'True' %}
	{action_raise_error("[firmware_retraction] not defined in printer.cfg. Can not enable fw_retract")}
	{% endif %}
	{% endif %}
	{% else %}
	{action_raise_error("FW_RETRACT=%s not supported. Allowed values are [True, False]" % params.FW_RETRACT|capitalize)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=extruder VALUE="{tl.extruder}"
	{% if printer.configfile.settings['gcode_macro pause'] is defined %}
	{% set _dummy = tl.macro.update({'pause': printer.configfile.settings['gcode_macro pause'].rename_existing}) %}
	{% endif %}
	{% if printer.configfile.settings['gcode_macro resume'] is defined %}
	{% set _dummy = tl.macro.update({'resume': printer.configfile.settings['gcode_macro resume'].rename_existing}) %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=macro VALUE="{tl.macro}"

[gcode_macro TIMELAPSE_TAKE_FRAME]
description = Take Timelapse shoot
variable_enable = False
variable_takingframe = False
variable_park = {'enable': False,
	'pos'   : 'center',
	'time'  : 0.1,
	'custom': {'x': 0, 'y': 0, 'dz': 0},
	'coord' : {'x': 0, 'y': 0, 'dz': 0}}
variable_extruder = {'fw_retract': False,
	'retract': 1.0,
	'extrude': 1.0}
variable_speed = {'travel': 100,
	'retract': 15,
	'extrude': 15}
variable_verbose = True
variable_check_time = 0.5
variable_restore = {'absolute': {'coordinates': True, 'extrude': True}, 'speed': 1500, 'e':0, 'factor': {'speed': 1.0, 'extrude': 1.0}}
variable_macro = {'pause': 'PAUSE', 'resume': 'RESUME'}
variable_is_paused = False
gcode = 
	{% set hyperlapse = True if params.HYPERLAPSE and params.HYPERLAPSE|lower =='true' else False %}
	{% if enable %}
	{% if (hyperlapse and printer['gcode_macro HYPERLAPSE'].run) or
	(not hyperlapse and not printer['gcode_macro HYPERLAPSE'].run) %}
	{% if park.enable %}
	{% set pos = {'x': 'X' + park.coord.x|string if park.pos != 'y_only' else '',
	'y': 'Y' + park.coord.y|string if park.pos != 'x_only' else '',
	'z': 'Z'+ [printer.gcode_move.gcode_position.z + park.coord.dz, printer.toolhead.axis_maximum.z]|min|string} %}
	{% set restore = {'absolute': {'coordinates': printer.gcode_move.absolute_coordinates,
	'extrude'    : printer.gcode_move.absolute_extrude},
	'speed'   : printer.gcode_move.speed,
	'e'       : printer.gcode_move.gcode_position.e,
	'factor'  : {'speed'  : printer.gcode_move.speed_factor,
	'extrude': printer.gcode_move.extrude_factor}} %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=restore VALUE="{restore}"
	{% if not printer[printer.toolhead.extruder].can_extrude %}
	{% if verbose %}{action_respond_info("Timelapse: Warning, minimum extruder temperature not reached!")}{% endif %}
	{% else %}
	{% if extruder.fw_retract %}
	G10
	{% else %}
	M83
	G0 E-{extruder.retract} F{speed.retract * 60}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=is_paused VALUE=True
	{macro.pause}
	SET_GCODE_OFFSET X=0 Y=0
	G90
	{% if "xyz" not in printer.toolhead.homed_axes %}
	{% if verbose %}{action_respond_info("Timelapse: Warning, axis not homed yet!")}{% endif %}
	{% else %}
	G0 {pos.x} {pos.y} {pos.z} F{speed.travel * 60}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=takingframe VALUE=True
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_TAKE_FRAME DURATION={check_time}
	M400
	{% endif %}
	_TIMELAPSE_NEW_FRAME HYPERLAPSE={hyperlapse}
	{% endif %}
	{% else %}
	{% if verbose %}{action_respond_info("Timelapse: disabled, take frame ignored")}{% endif %}
	{% endif %}

[gcode_macro _TIMELAPSE_NEW_FRAME]
description = action call for timelapse shoot. must be a seperate macro
gcode = 
	{action_call_remote_method("timelapse_newframe",
	macropark=printer['gcode_macro TIMELAPSE_TAKE_FRAME'].park,
	hyperlapse=params.HYPERLAPSE)}

[delayed_gcode _WAIT_TIMELAPSE_TAKE_FRAME]
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% set factor = {'speed': printer.gcode_move.speed_factor, 'extrude': printer.gcode_move.extrude_factor} %}
	{% if tl.takingframe %}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_TAKE_FRAME DURATION={tl.check_time}
	{% else %}
	{tl.macro.resume} VELOCITY={tl.speed.travel}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=is_paused VALUE=False
	{% if not printer[printer.toolhead.extruder].can_extrude %}
	{action_respond_info("Timelapse: Warning minimum extruder temperature not reached!")}
	{% else %}
	{% if tl.extruder.fw_retract %}
	G11
	{% else %}
	G0 E{tl.extruder.extrude} F{tl.speed.extrude * 60}
	G0 F{tl.restore.speed}
	{% if tl.restore.absolute.extrude %}
	M82
	G92 E{tl.restore.e}
	{% endif %}
	{% endif %}
	{% endif %}
	{% if tl.restore.factor.speed   != factor.speed   %} M220 S{(factor.speed*100)|round(0)}   {% endif %}
	{% if tl.restore.factor.extrude != factor.extrude %} M221 S{(factor.extrude*100)|round(0)} {% endif %}
	{% if not tl.restore.absolute.coordinates %} G91 {% endif %}
	{% endif %}

[gcode_macro HYPERLAPSE]
description = Start/Stop a hyperlapse recording
variable_cycle = 0
variable_run = False
gcode = 
	{% set cycle = params.CYCLE|default(30)|int %}
	{% if params.ACTION and params.ACTION|lower == 'start' %}
	{action_respond_info("Hyperlapse: frames started (Cycle %d sec)" % cycle)}
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=run VALUE=True
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=cycle VALUE={cycle}
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION={cycle}
	TIMELAPSE_TAKE_FRAME HYPERLAPSE=True
	{% elif params.ACTION and params.ACTION|lower == 'stop' %}
	{% if run %}{action_respond_info("Hyperlapse: frames stopped")}{% endif %}
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=run VALUE=False
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION=0
	{% else %}
	{action_raise_error("Hyperlapse: No valid input parameter
	Use:
	- HYPERLAPSE ACTION=START [CYCLE=time]
	- HYPERLAPSE ACTION=STOP")}
	{% endif %}

[delayed_gcode _HYPERLAPSE_LOOP]
gcode = 
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION={printer["gcode_macro HYPERLAPSE"].cycle}
	TIMELAPSE_TAKE_FRAME HYPERLAPSE=True

[gcode_macro TIMELAPSE_RENDER]
description = Render Timelapse video and wait for the result
variable_render = False
variable_run_identifier = 0
gcode = 
	{action_respond_info("Timelapse: Rendering started")}
	{action_call_remote_method("timelapse_render", byrendermacro="True")}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_RENDER VARIABLE=render VALUE=True
	{printer.configfile.settings['gcode_macro pause'].rename_existing}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_RENDER DURATION=0.5

[delayed_gcode _WAIT_TIMELAPSE_RENDER]
gcode = 
	{% set ri = printer['gcode_macro TIMELAPSE_RENDER'].run_identifier % 4 %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_RENDER VARIABLE=run_identifier VALUE={ri + 1}
	{% if printer['gcode_macro TIMELAPSE_RENDER'].render %}
	M117 Rendering {['-','\\','|','/'][ri]}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_RENDER DURATION=0.5
	{% else %}
	{action_respond_info("Timelapse: Rendering finished")}
	M117
	{printer.configfile.settings['gcode_macro resume'].rename_existing}
	{% endif %}

[gcode_macro TEST_STREAM_DELAY]
description = Helper macro to find stream and park delay
gcode = 
	{% set min = printer.toolhead.axis_minimum %}
	{% set max = printer.toolhead.axis_maximum %}
	{% set act = printer.toolhead.position %}
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% if act.z > 5.0 %}
	G0 X{min.x + 5.0} F{tl.speed.travel|int * 60}
	G0 X{(max.x-min.x)/2}
	G4 P{tl.park.time|float * 1000}
	_TIMELAPSE_NEW_FRAME HYPERLAPSE=FALSE
	G0 X{max.x - 5.0}
	{% else %}
	{action_raise_error("Toolhead z %.3f to low. Please place head above z = 5.0" % act.z)}
	{% endif %}

[gcode_macro _OBICO_LAYER_CHANGE]
description = Run a scan across the current print area
variable_first_layer_scan_retract_length = 6
variable_first_layer_scan_retract_speed = 15
variable_first_layer_scan_cooldown_temp = 170
variable_first_layer_scan_resume_speed = 50
variable_first_layer_scan_enabled = True
variable_first_layer_scan_stepover = 10
variable_first_layer_scan_speed = 10
variable_first_layer_scan_zhop = 4
variable_first_layer_scan_zhop_speed = 15
variable_verbose = False
variable_current_layer = -1
variable_first_layer_scanning = False
variable_wait = {'resume': "RESUME", 'absolute_coordinates': True, 'absolute_extrude': True, 'e': 0.0, 'previous_temp': 0}
gcode = 
	
	{% set pause_macro  = "PAUSE"  if printer.configfile.settings['gcode_macro pause']  is not defined
	else printer.configfile.settings['gcode_macro pause'].rename_existing %}
	{% set resume_macro = "RESUME" if printer.configfile.settings['gcode_macro resume'] is not defined
	else printer.configfile.settings['gcode_macro resume'].rename_existing %}
	
	{% set current_layer_default = printer.print_stats.info.current_layer if printer.print_stats.info.current_layer is not none else -1 %}
	{% set current_layer = params.CURRENT_LAYER|default(current_layer_default)|int %}
	
	{% set polygon_points = printer.exclude_object.objects|map(attribute='polygon')|sum(start=[]) if printer.exclude_object is defined else [] %}
	{% set min_x = params.MINX|default(polygon_points|map(attribute=0)|min|default(printer.toolhead.axis_minimum.x))|float %}
	{% set min_y = params.MINY|default(polygon_points|map(attribute=1)|min|default(printer.toolhead.axis_minimum.y))|float %}
	{% set max_x = params.MAXX|default(polygon_points|map(attribute=0)|max|default(printer.toolhead.axis_maximum.x))|float %}
	{% set max_y = params.MAXY|default(polygon_points|map(attribute=1)|max|default(printer.toolhead.axis_maximum.y))|float %}
	
	{% set stepoverCount = ((max_y - min_y) / first_layer_scan_stepover|float)|round(method='ceil')|int %}
	
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Layer %d" % (current_layer)}' {% endif %}
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=current_layer VALUE={current_layer}
	
	{% if first_layer_scan_enabled and current_layer == 2 %}
	
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=first_layer_scanning VALUE=True
	
	
	{% set wait_dic = {'resume'              : resume_macro,
	'absolute_coordinates': printer.gcode_move.absolute_coordinates,
	'absolute_extrude'    : printer.gcode_move.absolute_extrude,
	'e'                   : printer.gcode_move.gcode_position.e,
	'previous_temp'       : printer.extruder.target} %}
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=wait VALUE="{wait_dic}"
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Prepare scanning" {% endif %}
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Scan Coordinates: Min:[%.3f:%.3f] Max:[%.3f:%.3f]" % (min_x,min_y,max_x,max_y)}' {% endif %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Retract %.1fmm filament" % first_layer_scan_retract_length|abs}' {% endif %}
	M83
	G0 E-{first_layer_scan_retract_length|abs} F{first_layer_scan_retract_speed|float * 60}
	{% endif %}
	G91
	G0 Z{first_layer_scan_zhop|abs} F{first_layer_scan_zhop_speed|float * 60}
	
	
	M106 S255
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Fan on and lowering temperature to %.1f" % first_layer_scan_cooldown_temp}' {% endif %}
	M104 S{first_layer_scan_cooldown_temp}
	M109 S{first_layer_scan_cooldown_temp}
	
	{pause_macro}
	
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Start scanning" {% endif %}
	
	UPDATE_DELAYED_GCODE ID=_WAIT_OBICO_LAYER_CHANGE DURATION=1.0
	G90
	G0 X{min_x} Y{min_y} F{first_layer_scan_resume_speed|float * 60}
	{% for ystep in range(stepoverCount) %}
	G0 Y{min_y + first_layer_scan_stepover|float * ystep} F{first_layer_scan_speed|float * 60}
	G0 X{max_x if ystep % 2 == 0 else min_x}              F{first_layer_scan_speed|float * 60}
	{% endfor %}
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Finish scanning" {% endif %}
	
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=first_layer_scanning VALUE=False
	
	{% endif %}

[delayed_gcode _WAIT_OBICO_LAYER_CHANGE]
gcode = 
	{% set lc_macro = printer['gcode_macro _OBICO_LAYER_CHANGE'] %}
	{% if lc_macro.first_layer_scanning %}
	
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Waiting for first layer scan..." {% endif %}
	UPDATE_DELAYED_GCODE ID=_WAIT_OBICO_LAYER_CHANGE DURATION=1.0
	{% else %}
	
	M107
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Fan off and resume print" {% endif %}
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Call %s VELOCITY=%.1f" % (lc_macro.wait.resume, lc_macro.first_layer_scan_resume_speed)}' {% endif %}
	{lc_macro.wait.resume} VELOCITY={lc_macro.first_layer_scan_resume_speed}
	G91
	G0 Z-{lc_macro.first_layer_scan_zhop|abs} F{lc_macro.first_layer_scan_zhop_speed|float * 60}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% set first_layer_scan_unretract_length = lc_macro.first_layer_scan_retract_length + 0.5 %}
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Extrude %.1fmm filament" % first_layer_scan_unretract_length|abs}' {% endif %}
	M83
	G0 E{first_layer_scan_unretract_length|abs} F{lc_macro.first_layer_scan_retract_speed|float * 60}
	{% endif %}
	
	
	M104 S{lc_macro.wait.previous_temp}
	M109 S{lc_macro.wait.previous_temp}
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Heating back up to previous temperature"}' {% endif %}
	
	
	{% if lc_macro.wait.absolute_coordinates %} G90 {% endif %}
	{% if lc_macro.wait.absolute_extrude %}
	M82
	G92 E{lc_macro.wait.e}
	{% endif %}
	{% endif %}

[gcode_macro OBICO_LINK_STATUS]
description = Link to Obico server
variable_one_time_passcode = ''
variable_one_time_passlink = ''
variable_is_linked = False
gcode = 
	{action_respond_info('Obico one_time_passcode: {}'.format(one_time_passcode))}
	{action_respond_info('Obico one_time_passlink: {}'.format(one_time_passlink))}
	{action_respond_info('Obico is_linked: {}'.format(is_linked))}
	{% if not is_linked and one_time_passcode != '' %}
	M117 Code: {one_time_passcode}
	{% else %}
	M117 Obico linked
	{% endif %}

[gcode_macro _OBICO_RELINK]
description = Re-link to Obico server
gcode = 
	{action_respond_info('WARNING: Re-link to Obico server')}
	{action_call_remote_method("obico_remote_event", event_name='relink_obico', message='')}
	{action_respond_info('WARNING: relink_obico requested')}

[exclude_object]

[mcu]
serial = /dev/serial/by-id/usb-1a86_USB_Serial-if00-port0
restart_method = command

[temperature_sensor raspberry_pi]
sensor_type = temperature_host
min_temp = 10
max_temp = 100

[temperature_sensor mcu_temp]
sensor_type = temperature_mcu
min_temp = 0
max_temp = 100

[printer]
kinematics = cartesian
max_velocity = 200
max_accel = 4000
max_z_velocity = 10
max_z_accel = 100
minimum_cruise_ratio = 0.5
square_corner_velocity = 5

[stepper_x]
step_pin = PB9
dir_pin = PC2
enable_pin = !PC3
microsteps = 16
rotation_distance = 40
endstop_pin = ^PA5
position_endstop = 0
position_max = 230
homing_speed = 50

[stepper_y]
step_pin = PB7
dir_pin = PB8
enable_pin = !PC3
microsteps = 16
rotation_distance = 40
endstop_pin = ^PA6
position_endstop = 0
position_max = 231
homing_speed = 50

[stepper_z]
step_pin = PB5
dir_pin = !PB6
enable_pin = !PC3
microsteps = 16
rotation_distance = 8
endstop_pin = probe:z_virtual_endstop
position_max = 250
position_min = -4
homing_speed = 4
second_homing_speed = 1
homing_retract_dist = 2.0

[fan]
pin = PA0

[extruder]
max_extrude_only_distance = 100.0
step_pin = PB3
dir_pin = PB4
enable_pin = !PC3
microsteps = 16
gear_ratio = 42:12
rotation_distance = 26.359
nozzle_diameter = 0.400
filament_diameter = 1.750
heater_pin = PA1
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PC5
min_temp = 0
max_temp = 300
min_extrude_temp = 170
pressure_advance = .0369
pressure_advance_smooth_time = 0.04
control = pid
pid_kp = 19.195
pid_ki = 1.000
pid_kd = 92.135

[firmware_retraction]
retract_length = 0.3
retract_speed = 20

[idle_timeout]
gcode = 
	{% if printer.pause_resume.is_paused %}
	M118 Idle timeout while paused, turning off hotend
	SET_HEATER_TEMPERATURE HEATER=extruder TARGET=0
	{% else %}
	M118 Idle timeout
	TURN_OFF_HEATERS
	M84
	{% endif %}
timeout = 1800

[heater_bed]
heater_pin = PA2
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PC4
min_temp = 0
max_temp = 130
control = pid
pid_kp = 68.601
pid_ki = 1.185
pid_kd = 993.000

[bltouch]
sensor_pin = ^PB1
control_pin = PB0
x_offset = -31.8
y_offset = -40.5
speed = 35
samples = 2
samples_result = median
samples_tolerance = 0.05
samples_tolerance_retries = 2
sample_retract_dist = 5.0
probe_with_touch_mode = true
stow_on_each_sample = false
z_offset = 2.049

[safe_z_home]
home_xy_position = 147, 154
speed = 75
z_hop = 10
z_hop_speed = 5
move_to_previous = false

[bed_screws]
screw1 = 30,51
screw1_name = "FL"
screw2 = 200,51
screw2_name = "FR"
screw3 = 200,195
screw3_name = "RR"
screw4 = 30,195
screw4_name = "RL"

[screws_tilt_adjust]
screw1 = 67, 67
screw1_name = front left screw
screw2 = 230, 67
screw2_name = front right screw
screw3 = 230, 230
screw3_name = rear right screw
screw4 = 67.60, 230
screw4_name = rear left screw
horizontal_move_z = 10
speed = 200
screw_thread = CW-M4

[bed_mesh]
speed = 120
mesh_min = 10,11
mesh_max = 195,182
probe_count = 3,3
algorithm = bicubic
fade_start = 1
fade_end = 10
fade_target = 0

[filament_motion_sensor SFS_T0]
detection_length = 150.00
extruder = extruder
switch_pin = PA4
pause_on_runout = True
event_delay = 3.0
pause_delay = 0.5
runout_gcode = 
	M117 Runout Detected!

[delayed_gcode DISABLEFILAMENTSENSOR]
initial_duration = 1
gcode = 
	SET_FILAMENT_SENSOR SENSOR=SFS_T0 ENABLE=0

[gcode_macro SFS_ENABLE]
description = Enable smart filament sensor
gcode = 
	M117 ENABLING the Smart Filament Sensor
	G92 E0
	SET_FILAMENT_SENSOR SENSOR=SFS_T0 ENABLE=1

[gcode_macro SFS_DISABLE]
description = Disable smart filament sensor
gcode = 
	M117 DISABLING the Smart Filament Sensor
	G92 E0
	SET_FILAMENT_SENSOR SENSOR=SFS_T0 ENABLE=0

[gcode_macro FILAMENT_RUNOUT]
gcode = 
	M117 Runout Detected!
	M300 S1 P10
	M600
	M300 S1 P10

[gcode_macro M300]
gcode = 
	{% set S = params.S|default(1000)|int %}
	{% set P = params.P|default(100)|int %}
	SET_PIN PIN=BEEPER VALUE=0.5 CYCLE_TIME={ 1.0/S if S > 0 else 1 }
	G4 P{P}
	SET_PIN PIN=BEEPER VALUE=0
	[gcode_macro M600]
	gcode:
	{% set X = params.X|default(25)|float %}
	{% set Y = params.Y|default(25)|float %}
	{% set Z = params.Z|default(10)|float %}
	SAVE_GCODE_STATE NAME=M600_state
	PAUSE
	G91
	G1 E-.8 F2700
	G1 Z{Z}
	G90
	G1 X{X} Y{Y} F3000
	G91
	G1 E-15 F1000
	RESTORE_GCODE_STATE NAME=M600_state

[gcode_arcs]
resolution = 1.0

[input_shaper]
shaper_freq_x = 73.5
shaper_type_x = ei
shaper_freq_y = 76.9
shaper_type_y = mzv
=======================
bed_mesh: bicubic interpolation with a probe_count of less than 4 points detected.  Forcing lagrange interpolation. Configured Probe Count: 3, 3
Extruder max_extrude_ratio=0.266081
mcu 'mcu': Starting serial connect
webhooks client 548212713696: New connection
webhooks client 548212713696: Client info {'program': 'Moonraker', 'version': 'v0.9.3-3-gccfe32f'}
mcu 'mcu': got {'oid': 10, 'next_clock': 1817067264, 'value': 14016, '#name': 'analog_in_state', '#sent_time': 747.639806887, '#receive_time': 747.649469424}
mcu 'mcu': got {'oid': 12, 'next_clock': 1818507264, 'value': 31564, '#name': 'analog_in_state', '#sent_time': 747.6491116469999, '#receive_time': 747.6692469980001}
mcu 'mcu': got {'oid': 17, 'next_clock': 1822107264, 'value': 31506, '#name': 'analog_in_state', '#sent_time': 747.7032910539999, '#receive_time': 747.7196202580001}
mcu 'mcu': got {'oid': 10, 'next_clock': 1838667264, 'value': 14016, '#name': 'analog_in_state', '#sent_time': 747.9202751089999, '#receive_time': 747.94930535}
mcu 'mcu': got {'oid': 12, 'next_clock': 1840107264, 'value': 31564, '#name': 'analog_in_state', '#sent_time': 747.9202751089999, '#receive_time': 747.969311313}
mcu 'mcu': got {'oid': 17, 'next_clock': 1843707264, 'value': 31509, '#name': 'analog_in_state', '#sent_time': 747.974438609, '#receive_time': 748.019286091}
Loaded MCU 'mcu' 119 commands (v0.12.0-286-g81de9a861 / gcc: (15:8-2019-q3-1+b1) 8.3.1 20190703 (release) [gcc-8-branch revision 273027] binutils: (2.35.2-2+14+b2) 2.35.2)
MCU 'mcu' config: ADC_MAX=4095 BUS_PINS_i2c1=PB6,PB7 BUS_PINS_i2c1a=PB8,PB9 BUS_PINS_i2c2=PB10,PB11 BUS_PINS_spi1=PA6,PA7,PA5 BUS_PINS_spi1a=PB4,PB5,PB3 BUS_PINS_spi2=PB14,PB15,PB13 BUS_PINS_spi3=PB4,PB5,PB3 CLOCK_FREQ=72000000 MCU=stm32f103xe PWM_MAX=255 RECEIVE_WINDOW=192 RESERVE_PINS_serial=PA10,PA9 SERIAL_BAUD=250000 STATS_SUMSQ_BASE=256 STEPPER_BOTH_EDGE=1
mcu_temperature 'mcu' nominal base=357.558140 slope=-767.441860
Configured MCU 'mcu' (1024 moves)
Starting heater checks for heater_bed
bed_mesh: generated points
Index |  Tool Adjusted  |   Probe
  0   | (41.8, 51.5)    | (10.0, 11.0)
  1   | (134.3, 51.5)   | (102.5, 11.0)
  2   | (226.8, 51.5)   | (195.0, 11.0)
  3   | (226.8, 137.0)  | (195.0, 96.5)
  4   | (134.3, 137.0)  | (102.5, 96.5)
  5   | (41.8, 137.0)   | (10.0, 96.5)
  6   | (41.8, 222.5)   | (10.0, 182.0)
  7   | (134.3, 222.5)  | (102.5, 182.0)
  8   | (226.8, 222.5)  | (195.0, 182.0)
Starting heater checks for extruder
Stats 749.1: gcodein=0  mcu: mcu_awake=0.006 mcu_task_avg=0.000028 mcu_task_stddev=0.000013 bytes_write=1141 bytes_read=4640 bytes_retransmit=0 bytes_invalid=0 send_seq=119 receive_seq=119 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71999822  raspberry_pi: temp=58.4 mcu_temp: temp=0.0 heater_bed: target=0 temp=0.0 pwm=0.000 sysload=2.58 cputime=12.490 memavail=1499500 print_time=97916.118 buffer_time=0.249 print_stall=0 extruder: target=0 temp=0.0 pwm=0.000
Stats 750.1: gcodein=0  mcu: mcu_awake=0.006 mcu_task_avg=0.000028 mcu_task_stddev=0.000013 bytes_write=1147 bytes_read=4791 bytes_retransmit=0 bytes_invalid=0 send_seq=120 receive_seq=120 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71999805  raspberry_pi: temp=58.4 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.58 cputime=12.512 memavail=1481504 print_time=97916.118 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
webhooks: registering remote method 'shutdown_machine' for connection id: 548212713696
webhooks: registering remote method 'reboot_machine' for connection id: 548212713696
webhooks: registering remote method 'pause_job_queue' for connection id: 548212713696
webhooks: registering remote method 'start_job_queue' for connection id: 548212713696
webhooks: registering remote method 'spoolman_set_active_spool' for connection id: 548212713696
webhooks: registering remote method 'obico_remote_event' for connection id: 548212713696
Stats 751.1: gcodein=0  mcu: mcu_awake=0.006 mcu_task_avg=0.000028 mcu_task_stddev=0.000013 bytes_write=1153 bytes_read=4942 bytes_retransmit=0 bytes_invalid=0 send_seq=121 receive_seq=121 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71999929  raspberry_pi: temp=57.5 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.69 cputime=12.546 memavail=1461860 print_time=97916.118 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 752.1: gcodein=0  mcu: mcu_awake=0.006 mcu_task_avg=0.000028 mcu_task_stddev=0.000013 bytes_write=1159 bytes_read=5123 bytes_retransmit=0 bytes_invalid=0 send_seq=122 receive_seq=122 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000079  raspberry_pi: temp=58.4 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.69 cputime=12.567 memavail=1433792 print_time=97916.118 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 753.1: gcodein=0  mcu: mcu_awake=0.006 mcu_task_avg=0.000028 mcu_task_stddev=0.000013 bytes_write=1165 bytes_read=5289 bytes_retransmit=0 bytes_invalid=0 send_seq=123 receive_seq=123 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000101  raspberry_pi: temp=57.9 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.69 cputime=12.581 memavail=1468332 print_time=97916.118 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 754.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000020 mcu_task_stddev=0.000009 bytes_write=1171 bytes_read=5454 bytes_retransmit=0 bytes_invalid=0 send_seq=124 receive_seq=124 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000127  raspberry_pi: temp=57.5 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=2.69 cputime=12.595 memavail=1525048 print_time=97916.118 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 755.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000020 mcu_task_stddev=0.000009 bytes_write=1177 bytes_read=5635 bytes_retransmit=0 bytes_invalid=0 send_seq=125 receive_seq=125 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000160  raspberry_pi: temp=58.4 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.69 cputime=12.609 memavail=1512168 print_time=97916.118 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 756.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000020 mcu_task_stddev=0.000009 bytes_write=1183 bytes_read=5801 bytes_retransmit=0 bytes_invalid=0 send_seq=126 receive_seq=126 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000217  raspberry_pi: temp=58.4 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.64 cputime=12.622 memavail=1489740 print_time=97916.118 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 757.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000020 mcu_task_stddev=0.000009 bytes_write=1189 bytes_read=5952 bytes_retransmit=0 bytes_invalid=0 send_seq=127 receive_seq=127 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000215  raspberry_pi: temp=57.9 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.64 cputime=12.635 memavail=1474124 print_time=97916.118 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 758.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000020 mcu_task_stddev=0.000009 bytes_write=1195 bytes_read=6133 bytes_retransmit=0 bytes_invalid=0 send_seq=128 receive_seq=128 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000205  raspberry_pi: temp=58.9 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.64 cputime=12.648 memavail=1446272 print_time=97916.118 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 759.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000020 mcu_task_stddev=0.000009 bytes_write=1201 bytes_read=6299 bytes_retransmit=0 bytes_invalid=0 send_seq=129 receive_seq=129 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000233  raspberry_pi: temp=57.9 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.64 cputime=12.664 memavail=1468356 print_time=97916.118 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 760.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1207 bytes_read=6464 bytes_retransmit=0 bytes_invalid=0 send_seq=130 receive_seq=130 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000200  raspberry_pi: temp=57.5 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.2 pwm=0.000 sysload=2.64 cputime=12.678 memavail=1533380 print_time=97916.118 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 761.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1213 bytes_read=6645 bytes_retransmit=0 bytes_invalid=0 send_seq=131 receive_seq=131 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000202  raspberry_pi: temp=58.4 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.51 cputime=12.691 memavail=1513692 print_time=97916.118 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 762.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1219 bytes_read=6811 bytes_retransmit=0 bytes_invalid=0 send_seq=132 receive_seq=132 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000208  raspberry_pi: temp=57.9 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.51 cputime=12.704 memavail=1494548 print_time=97916.118 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 763.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1225 bytes_read=6962 bytes_retransmit=0 bytes_invalid=0 send_seq=133 receive_seq=133 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000239  raspberry_pi: temp=57.5 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.2 pwm=0.000 sysload=2.51 cputime=12.717 memavail=1476404 print_time=97916.118 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 764.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1231 bytes_read=7143 bytes_retransmit=0 bytes_invalid=0 send_seq=134 receive_seq=134 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000235  raspberry_pi: temp=57.9 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.2 pwm=0.000 sysload=2.51 cputime=12.728 memavail=1450460 print_time=97916.118 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 765.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1237 bytes_read=7323 bytes_retransmit=0 bytes_invalid=0 send_seq=135 receive_seq=135 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000227  raspberry_pi: temp=57.5 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.2 pwm=0.000 sysload=2.51 cputime=12.743 memavail=1428356 print_time=97916.118 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 766.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1243 bytes_read=7474 bytes_retransmit=0 bytes_invalid=0 send_seq=136 receive_seq=136 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000240  raspberry_pi: temp=57.9 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.55 cputime=12.758 memavail=1540156 print_time=97916.118 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 767.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1249 bytes_read=7670 bytes_retransmit=0 bytes_invalid=0 send_seq=137 receive_seq=137 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000234  raspberry_pi: temp=57.5 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.2 pwm=0.000 sysload=2.55 cputime=12.771 memavail=1516448 print_time=97916.118 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 768.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1255 bytes_read=7821 bytes_retransmit=0 bytes_invalid=0 send_seq=138 receive_seq=138 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000239  raspberry_pi: temp=57.5 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.55 cputime=12.783 memavail=1502336 print_time=97916.118 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 769.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1261 bytes_read=7972 bytes_retransmit=0 bytes_invalid=0 send_seq=139 receive_seq=139 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000231  raspberry_pi: temp=57.5 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.55 cputime=12.795 memavail=1481196 print_time=97916.118 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 770.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1267 bytes_read=8182 bytes_retransmit=0 bytes_invalid=0 send_seq=140 receive_seq=140 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000235  raspberry_pi: temp=58.4 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.55 cputime=12.808 memavail=1461328 print_time=97916.118 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 771.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1273 bytes_read=8333 bytes_retransmit=0 bytes_invalid=0 send_seq=141 receive_seq=141 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000233  raspberry_pi: temp=59.4 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.58 cputime=12.820 memavail=1433108 print_time=97916.118 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 772.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1279 bytes_read=8484 bytes_retransmit=0 bytes_invalid=0 send_seq=142 receive_seq=142 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000237  raspberry_pi: temp=57.5 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.58 cputime=12.836 memavail=1469636 print_time=97916.118 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 773.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1285 bytes_read=8680 bytes_retransmit=0 bytes_invalid=0 send_seq=143 receive_seq=143 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000243  raspberry_pi: temp=57.9 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.58 cputime=12.849 memavail=1518712 print_time=97916.118 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 774.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1291 bytes_read=8831 bytes_retransmit=0 bytes_invalid=0 send_seq=144 receive_seq=144 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000237  raspberry_pi: temp=58.4 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.58 cputime=12.862 memavail=1507328 print_time=97916.118 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 775.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1297 bytes_read=8996 bytes_retransmit=0 bytes_invalid=0 send_seq=145 receive_seq=145 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000234  raspberry_pi: temp=57.9 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.58 cputime=12.874 memavail=1482380 print_time=97916.118 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 776.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1303 bytes_read=9192 bytes_retransmit=0 bytes_invalid=0 send_seq=146 receive_seq=146 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000230  raspberry_pi: temp=57.9 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.70 cputime=12.887 memavail=1470284 print_time=97916.118 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 777.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1309 bytes_read=9343 bytes_retransmit=0 bytes_invalid=0 send_seq=147 receive_seq=147 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000226  raspberry_pi: temp=57.5 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.70 cputime=12.897 memavail=1439552 print_time=97916.118 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 778.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1315 bytes_read=9494 bytes_retransmit=0 bytes_invalid=0 send_seq=148 receive_seq=148 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000224  raspberry_pi: temp=57.5 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.70 cputime=12.911 memavail=1467976 print_time=97916.118 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 779.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1321 bytes_read=9690 bytes_retransmit=0 bytes_invalid=0 send_seq=149 receive_seq=149 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000222  raspberry_pi: temp=57.5 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.70 cputime=12.926 memavail=1525612 print_time=97916.118 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 780.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1327 bytes_read=9855 bytes_retransmit=0 bytes_invalid=0 send_seq=150 receive_seq=150 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000221  raspberry_pi: temp=57.9 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.70 cputime=12.939 memavail=1512972 print_time=97916.118 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 781.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1333 bytes_read=10006 bytes_retransmit=0 bytes_invalid=0 send_seq=151 receive_seq=151 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000217  raspberry_pi: temp=57.9 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.72 cputime=12.952 memavail=1489536 print_time=97916.118 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 782.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1339 bytes_read=10188 bytes_retransmit=0 bytes_invalid=0 send_seq=152 receive_seq=152 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000231  raspberry_pi: temp=58.9 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.72 cputime=12.966 memavail=1473912 print_time=97916.118 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 783.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1345 bytes_read=10329 bytes_retransmit=0 bytes_invalid=0 send_seq=153 receive_seq=153 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000229  raspberry_pi: temp=57.9 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.2 pwm=0.000 sysload=2.72 cputime=12.978 memavail=1445952 print_time=97916.118 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 784.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1351 bytes_read=10470 bytes_retransmit=0 bytes_invalid=0 send_seq=154 receive_seq=154 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000231  raspberry_pi: temp=58.4 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.2 pwm=0.000 sysload=2.72 cputime=12.992 memavail=1469068 print_time=97916.118 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 785.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1357 bytes_read=10670 bytes_retransmit=0 bytes_invalid=0 send_seq=155 receive_seq=155 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000235  raspberry_pi: temp=57.0 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.2 pwm=0.000 sysload=2.72 cputime=13.008 memavail=1533456 print_time=97916.118 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 786.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1363 bytes_read=10821 bytes_retransmit=0 bytes_invalid=0 send_seq=156 receive_seq=156 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000233  raspberry_pi: temp=57.9 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.2 pwm=0.000 sysload=2.74 cputime=13.020 memavail=1514520 print_time=97916.118 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 787.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1369 bytes_read=10972 bytes_retransmit=0 bytes_invalid=0 send_seq=157 receive_seq=157 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000231  raspberry_pi: temp=58.4 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.74 cputime=13.032 memavail=1498900 print_time=97916.118 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 788.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1375 bytes_read=11168 bytes_retransmit=0 bytes_invalid=0 send_seq=158 receive_seq=158 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000232  raspberry_pi: temp=57.9 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.74 cputime=13.045 memavail=1479748 print_time=97916.118 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 789.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1381 bytes_read=11319 bytes_retransmit=0 bytes_invalid=0 send_seq=159 receive_seq=159 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000229  raspberry_pi: temp=57.5 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.74 cputime=13.056 memavail=1457076 print_time=97916.118 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 790.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1387 bytes_read=11484 bytes_retransmit=0 bytes_invalid=0 send_seq=160 receive_seq=160 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000226  raspberry_pi: temp=58.4 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.74 cputime=13.069 memavail=1432380 print_time=97916.118 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 791.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1393 bytes_read=11680 bytes_retransmit=0 bytes_invalid=0 send_seq=161 receive_seq=161 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000227  raspberry_pi: temp=58.9 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.76 cputime=13.085 memavail=1645748 print_time=97916.118 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
webhooks client 548212713696: Disconnected
Starting Klippy...
Args: ['/home/coon/klipper/klippy/klippy.py', '/home/coon/printer_data/config/printer.cfg', '-l', '/home/coon/printer_data/logs/klippy.log', '-I', '/home/coon/printer_data/comms/klippy.serial', '-a', '/home/coon/printer_data/comms/klippy.sock']
Git version: 'v0.12.0-396-gb7233d119'
Branch: master
Remote: origin
Tracked URL: https://github.com/Klipper3d/klipper.git
CPU: 4 core ?
Python: '3.9.2 (default, Dec  1 2024, 12:12:57) \n[GCC 10.2.1 20210110]'
Start printer at Sun Dec 22 15:14:28 2024 (1734898468.8 21.3)
===== Config file =====
[virtual_sdcard]
path = ~/printer_data/gcodes
on_error_gcode = CANCEL_PRINT

[pause_resume]
recover_velocity = 25

[display_status]

[respond]
default_prefix = 

[gcode_macro CANCEL_PRINT]
description = Cancel the actual running print
rename_existing = BASE_CANCEL_PRINT
gcode = 
	G91
	G0 Z10 F600
	G90
	TURN_OFF_HEATERS
	G0 X5 Y220
	CLEAR_PAUSE
	
	BASE_CANCEL_PRINT

[gcode_macro PAUSE]
description = Pause the actual running print
rename_existing = PAUSE_BASE
gcode = 
	
	{% set x = params.X|default(5) %}
	{% set y = params.Y|default(225) %}
	{% set z = params.Z|default(10)|float %}
	{% set e = params.E|default(1) %}
	
	{% set max_z = printer.toolhead.axis_maximum.z|float %}
	{% set act_z = printer.toolhead.position.z|float %}
	{% set lift_z = z|abs %}
	{% if act_z < (max_z - lift_z) %}
	{% set z_safe = lift_z %}
	{% else %}
	{% set z_safe = max_z - act_z %}
	{% endif %}
	
	PAUSE_BASE
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E-{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	{% if "xyz" in printer.toolhead.homed_axes %}
	G1 Z{z_safe}
	G90
	G1 X{x} Y{y} F6000
	{% else %}
	{action_respond_info("Printer not homed")}
	{% endif %}

[gcode_macro RESUME]
description = Resume the actual running print
rename_existing = RESUME_BASE
variable_last_extruder_temp = {'restore': False, 'temp': 0}
variable_restore_idle_timeout = 0
variable_idle_state = False
gcode = 
	
	{% set e = params.E|default(1) %}
	
	{% if 'VELOCITY' in params|upper %}
	{% set get_params = ('VELOCITY=' + params.VELOCITY)  %}
	{%else %}
	{% set get_params = "" %}
	{% endif %}
	
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	RESUME_BASE {get_params}

[gcode_macro SET_PAUSE_NEXT_LAYER]
description = Enable a pause if the next layer is reached
gcode = 
	{% set pause_next_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_next_layer %}
	{% set ENABLE = params.ENABLE|default(1)|int != 0 %}
	{% set MACRO = params.MACRO|default(pause_next_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_next_layer VALUE="{{ 'enable': ENABLE, 'call': MACRO }}"

[gcode_macro SET_PAUSE_AT_LAYER]
description = Enable/disable a pause if a given layer number is reached
gcode = 
	{% set pause_at_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_at_layer %}
	{% set ENABLE = params.ENABLE|int != 0 if params.ENABLE is defined
	else params.LAYER is defined %}
	{% set LAYER = params.LAYER|default(pause_at_layer.layer)|int %}
	{% set MACRO = params.MACRO|default(pause_at_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_at_layer VALUE="{{ 'enable': ENABLE, 'layer': LAYER, 'call': MACRO }}"

[gcode_macro SET_PRINT_STATS_INFO]
rename_existing = SET_PRINT_STATS_INFO_BASE
description = Overwrite, to get pause_next_layer and pause_at_layer feature
variable_pause_next_layer = { 'enable': False, 'call': "PAUSE" }
variable_pause_at_layer = { 'enable': False, 'layer': 0, 'call': "PAUSE" }
gcode = 
	{% if pause_next_layer.enable %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_next_layer" % pause_next_layer.call}'
	{pause_next_layer.call}
	SET_PAUSE_NEXT_LAYER ENABLE=0
	{% elif pause_at_layer.enable and params.CURRENT_LAYER is defined and params.CURRENT_LAYER|int == pause_at_layer.layer %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_at_layer [%d]" % (pause_at_layer.call, pause_at_layer.layer)}'
	{pause_at_layer.call}
	SET_PAUSE_AT_LAYER ENABLE=0
	{% endif %}
	SET_PRINT_STATS_INFO_BASE {rawparams}

[gcode_macro _TOOLHEAD_PARK_PAUSE_CANCEL]
description = Helper: park toolhead used in PAUSE and CANCEL_PRINT
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set velocity = printer.configfile.settings.pause_resume.recover_velocity %}
	{% set use_custom     = client.use_custom_pos|default(false)|lower == 'true' %}
	{% set custom_park_x  = client.custom_park_x|default(0.0) %}
	{% set custom_park_y  = client.custom_park_y|default(0.0) %}
	{% set park_dz        = client.custom_park_dz|default(2.0)|abs %}
	{% set sp_hop         = client.speed_hop|default(15) * 60 %}
	{% set sp_move        = client.speed_move|default(velocity) * 60 %}
	
	{% set origin    = printer.gcode_move.homing_origin %}
	{% set act       = printer.gcode_move.gcode_position %}
	{% set max       = printer.toolhead.axis_maximum %}
	{% set cone      = printer.toolhead.cone_start_z|default(max.z) %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	
	{% set z_min = params.Z_MIN|default(0)|float %}
	{% set z_park = [[(act.z + park_dz), z_min]|max, (max.z - origin.z)]|min %}
	{% set x_park = params.X       if params.X is defined
	else custom_park_x  if use_custom
	else 0.0            if round_bed
	else (max.x - 5.0) %}
	{% set y_park = params.Y       if params.Y is defined
	else custom_park_y  if use_custom
	else (max.y - 5.0)  if round_bed and z_park < cone
	else 0.0            if round_bed
	else (max.y - 5.0) %}
	
	_CLIENT_RETRACT
	{% if "xyz" in printer.toolhead.homed_axes %}
	G90
	G1 Z{z_park} F{sp_hop}
	G1 X{x_park} Y{y_park} F{sp_move}
	{% if not printer.gcode_move.absolute_coordinates %} G91 {% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='Printer not homed'
	{% endif %}

[gcode_macro _CLIENT_EXTRUDE]
description = Extrudes, if the extruder is hot enough
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set use_fw_retract = (client.use_fw_retract|default(false)|lower == 'true') and (printer.firmware_retraction is defined) %}
	{% set length = params.LENGTH|default(client.unretract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_unretract)|default(35) %}
	{% set absolute_extrude = printer.gcode_move.absolute_extrude %}
	
	{% if printer.toolhead.extruder != '' %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if use_fw_retract %}
	{% if length < 0 %}
	G10
	{% else %}
	G11
	{% endif %}
	{% else %}
	M83
	G1 E{length} F{(speed|float|abs) * 60}
	{% if absolute_extrude %}
	M82
	{% endif %}
	{% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='{"\"%s\" not hot enough" % printer.toolhead.extruder}'
	{% endif %}
	{% endif %}

[gcode_macro _CLIENT_RETRACT]
description = Retracts, if the extruder is hot enough
gcode = 
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set length = params.LENGTH|default(client.retract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_retract)|default(35) %}
	
	_CLIENT_EXTRUDE LENGTH=-{length|float|abs} SPEED={speed|float|abs}

[gcode_macro _CLIENT_LINEAR_MOVE]
description = Linear move with save and restore of the gcode state
gcode = 
	{% set x_move = "X" ~ params.X if params.X is defined else "" %}
	{% set y_move = "Y" ~ params.Y if params.Y is defined else "" %}
	{% set z_move = "Z" ~ params.Z if params.Z is defined else "" %}
	{% set e_move = "E" ~ params.E if params.E is defined else "" %}
	{% set rate = "F" ~ params.F if params.F is defined else "" %}
	{% set ABSOLUTE = params.ABSOLUTE | default(0) | int != 0 %}
	{% set ABSOLUTE_E = params.ABSOLUTE_E | default(0) | int != 0 %}
	SAVE_GCODE_STATE NAME=_client_movement
	{% if x_move or y_move or z_move %}
	G9{ 0 if ABSOLUTE else 1 }
	{% endif %}
	{% if e_move %}
	M8{ 2 if ABSOLUTE_E else 3 }
	{% endif %}
	G1 { x_move } { y_move } { z_move } { e_move } { rate }
	RESTORE_GCODE_STATE NAME=_client_movement

[gcode_macro play_test]
gcode = 
	RESPOND TYPE=command MSG="action:prompt_begin Question"
	RESPOND TYPE=command MSG="action:prompt_text Do you wont to cancel the print?"
	RESPOND TYPE=command MSG="action:prompt_footer_button continue|RESPOND TYPE=command MSG=action:prompt_end"
	RESPOND TYPE=command MSG="action:prompt_footer_button CANCEL|CANCEL_PRINT|error"
	RESPOND TYPE=command MSG="action:prompt_show"

[gcode_macro PRINT_START]
gcode = 
	START_PRINT {rawparams}

[gcode_macro START_PRINT]
gcode = 
	{% set BED_TEMP = params.BED_TEMP|default(60)|float %}
	{% set EXTRUDER_TEMP = params.EXTRUDER_TEMP|default(190)|float %}
	
	M190 S{BED_TEMP}
	
	G90
	
	G28
	
	RESPOND MSG="Bed Meshing"
	
	
	
	
	
	
	
	
	BED_MESH_CLEAR
	BED_MESH_CALIBRATE ADAPTIVE=1
	
	
	
	
	
	
	
	RESPOND MSG="Heating to print temp"
	M104 S{EXTRUDER_TEMP}
	G0 Z40 F240
	M109 S{EXTRUDER_TEMP}
	RESPOND MSG="Enable Runout Sensor"
	SFS_ENABLE
	RESPOND MSG="Line Purge"
	LINE_PURGE
	RESPOND MSG="Print Started"

[gcode_macro LINE_PURGE]
gcode = 
	G92 E0
	G1 Z2.0 F3000
	G1 X0.1 Y20 Z0.3 F5000.0
	G1 X0.1 Y200.0 Z0.3 F1500.0 E15
	G1 X0.4 Y200.0 Z0.3 F5000.0
	G1 X0.4 Y20 Z0.3 F1500.0 E30
	G92 E0
	G1 Z2.0 F3000
	G1 X5 Y20 Z0.3 F5000.0

[gcode_macro PRINT_END]
gcode = 
	END_PRINT

[gcode_macro END_PRINT]
gcode = 
	
	
	RESPOND MSG="Print Finished"
	G91
	G1 E-.5 Z0.2 F2400
	G1 X5 Y5 F6000
	G1 Z10
	G90
	SFS_DISABLE
	
	G1 X0 Y220 F6000
	M106 S0
	M104 S0
	M140 S0
	
	M84 X Y E

[gcode_macro SET_ACTIVE_SPOOL]
gcode = 
	{% if params.ID %}
	{% set id = params.ID|int %}
	{action_call_remote_method(
	"spoolman_set_active_spool",
	spool_id=id
	)}
	{% else %}
	{action_respond_info("Parameter 'ID' is required")}
	{% endif %}

[gcode_macro CLEAR_ACTIVE_SPOOL]
gcode = 
	{action_call_remote_method(
	"spoolman_set_active_spool",
	spool_id=None
	)}

[gcode_macro G29]
gcode = 
	G28
	BED_MESH_CALIBRATE
	G0 X0 Y0 Z10 F6000
	BED_MESH_PROFILE save=default

[gcode_macro M125]
gcode = 
	SAVE_GCODE_STATE NAME=parking
	M117 Parking toolhead
	G91
	G1 Z10 F600
	G90
	G1 X5 Y225 F4000
	RESTORE_GCODE_STATE NAME=parking

[gcode_macro Load_Filament]
gcode = 
	SAVE_GCODE_STATE NAME=loading_filament
	M117 Loading Filament
	M83
	G92 E0.0
	G91
	G1 E50 F200
	G92 E50
	RESTORE_GCODE_STATE NAME=loading_filament

[gcode_macro Unload_Filament]
gcode = 
	SAVE_GCODE_STATE NAME=unloading_filament
	M117 Unloading Filament
	G91
	G1 E5 F100
	G92 E0.0
	G1 E-50 F5000
	G92 E-50
	RESTORE_GCODE_STATE NAME=unloading_filament

[gcode_macro Filament_Change]
gcode = 
	
	SAVE_GCODE_STATE NAME=filament_change
	
	Unload_Filament
	
	RESPOND TYPE=command MSG="action:prompt_begin Question"
	RESPOND TYPE=command MSG="action:prompt_text Please insert new filament and confirm"
	RESPOND TYPE=command MSG="action:prompt_footer_button CONFIRM|Load_Filament|RESPOND TYPE=command MSG=action:prompt_end"
	RESPOND TYPE=command MSG="action:prompt_footer_button CANCEL|RESPOND TYPE=command MSG=action:prompt_end"
	RESPOND TYPE=command MSG="action:prompt_show"
	
	RESTORE_GCODE_STATE NAME=filament_change

[gcode_macro Calibrate_Hotend_PID]
gcode = 
	PID_CALIBRATE HEATER=extruder TARGET=200

[gcode_macro Calibrate_Bed_PID]
gcode = 
	PID_CALIBRATE HEATER=heater_bed TARGET=60

[gcode_macro Calibrate_Zoffset]
gcode = 
	PROBE_CALIBRATE

[gcode_macro Tram_bed]
gcode = 
	SCREWS_TILT_CALCULATE

[gcode_macro TEST_SPEED]
description = Test for max speed and acceleration parameters for the printer. Procedure: Home -> ReadPositionFromMCU -> MovesToolhead@Vel&Accel -> Home -> ReadPositionfromMCU
gcode = 
	
	{% set speed  = params.SPEED|default(printer.configfile.settings.printer.max_velocity)|int %}
	
	{% set iterations = params.ITERATIONS|default(5)|int %}
	
	{% set accel  = params.ACCEL|default(printer.configfile.settings.printer.max_accel)|int %}
	
	{% set min_cruise_ratio = params.MIN_CRUISE_RATIO|default(0.5)|float %}
	
	{% set bound = params.BOUND|default(20)|int %}
	
	{% set smallpatternsize = SMALLPATTERNSIZE|default(20)|int %}
	
	
	
	{% set x_min = printer.toolhead.axis_minimum.x + bound %}
	{% set x_max = printer.toolhead.axis_maximum.x - bound %}
	{% set y_min = printer.toolhead.axis_minimum.y + bound %}
	{% set y_max = printer.toolhead.axis_maximum.y - bound %}
	
	
	
	{% set x_center = (printer.toolhead.axis_minimum.x|float + printer.toolhead.axis_maximum.x|float ) / 2 %}
	{% set y_center = (printer.toolhead.axis_minimum.y|float + printer.toolhead.axis_maximum.y|float ) / 2 %}
	
	
	{% set x_center_min = x_center - (smallpatternsize/2) %}
	{% set x_center_max = x_center + (smallpatternsize/2) %}
	{% set y_center_min = y_center - (smallpatternsize/2) %}
	{% set y_center_max = y_center + (smallpatternsize/2) %}
	
	
	SAVE_GCODE_STATE NAME=TEST_SPEED
	
	
	{ action_respond_info("TEST_SPEED: starting %d iterations at speed %d, accel %d" % (iterations, speed, accel)) }
	
	
	M400
	G28
	
	{% if printer.configfile.settings.quad_gantry_level %}
	{% if printer.quad_gantry_level.applied == False %}
	QUAD_GANTRY_LEVEL
	G28 Z
	{% endif %}
	{% endif %}
	
	G90
	G1 X{printer.toolhead.axis_maximum.x-50} Y{printer.toolhead.axis_maximum.y-50} F{30*60}
	M400
	G28 X Y
	G0 X{printer.toolhead.axis_maximum.x-1} Y{printer.toolhead.axis_maximum.y-1} F{30*60}
	G4 P1000
	GET_POSITION
	
	
	G0 X{x_min} Y{y_min} Z{bound + 10} F{speed*60}
	
	
	{% if printer.configfile.settings.printer.minimum_cruise_ratio is defined %}
	SET_VELOCITY_LIMIT VELOCITY={speed} ACCEL={accel} MINIMUM_CRUISE_RATIO={min_cruise_ratio}
	{% else %}
	SET_VELOCITY_LIMIT VELOCITY={speed} ACCEL={accel} ACCEL_TO_DECEL={accel / 2}
	{% endif %}
	
	{% for i in range(iterations) %}
	
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_max} Y{y_max} F{speed*60}
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	G0 X{x_min} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	
	
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_min} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	
	
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_max} Y{y_center_max} F{speed*60}
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	G0 X{x_center_min} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	
	
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_min} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	{% endfor %}
	
	
	{% if printer.configfile.settings.printer.minimum_cruise_ratio is defined %}
	SET_VELOCITY_LIMIT VELOCITY={printer.configfile.settings.printer.max_velocity} ACCEL={printer.configfile.settings.printer.max_accel} MINIMUM_CRUISE_RATIO={printer.configfile.settings.printer.minimum_cruise_ratio}
	{% else %}
	SET_VELOCITY_LIMIT VELOCITY={printer.configfile.settings.printer.max_velocity} ACCEL={printer.configfile.settings.printer.max_accel} ACCEL_TO_DECEL={printer.configfile.settings.printer.max_accel_to_decel}
	{% endif %}
	
	
	M400
	G28
	
	G90
	G0 X{printer.toolhead.axis_maximum.x-1} Y{printer.toolhead.axis_maximum.y-1} F{30*60}
	G4 P1000
	GET_POSITION
	
	
	RESTORE_GCODE_STATE NAME=TEST_SPEED

[gcode_macro GET_TIMELAPSE_SETUP]
description = Print the Timelapse setup
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% set output_txt = ["Timelapse Setup:"] %}
	{% set _dummy = output_txt.append("enable: %s" % tl.enable) %}
	{% set _dummy = output_txt.append("park: %s" % tl.park.enable) %}
	{% if tl.park.enable %}
	{% set _dummy = output_txt.append("park position: %s time: %s s" % (tl.park.pos, tl.park.time)) %}
	{% set _dummy = output_txt.append("park cord x:%s y:%s dz:%s" % (tl.park.coord.x, tl.park.coord.y, tl.park.coord.dz)) %}
	{% set _dummy = output_txt.append("travel speed: %s mm/s" % tl.speed.travel) %}
	{% endif %}
	{% set _dummy = output_txt.append("fw_retract: %s" % tl.extruder.fw_retract) %}
	{% if not tl.extruder.fw_retract %}
	{% set _dummy = output_txt.append("retract: %s mm speed: %s mm/s" % (tl.extruder.retract, tl.speed.retract)) %}
	{% set _dummy = output_txt.append("extrude: %s mm speed: %s mm/s" % (tl.extruder.extrude, tl.speed.extrude)) %}
	{% endif %}
	{% set _dummy = output_txt.append("verbose: %s" % tl.verbose) %}
	{action_respond_info(output_txt|join("\n"))}

[gcode_macro _SET_TIMELAPSE_SETUP]
description = Set user parameters for timelapse
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	
	{% set min = printer.toolhead.axis_minimum %}
	{% set max = printer.toolhead.axis_maximum %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	{% set park = {'min'   : {'x': (min.x / 1.42)|round(3) if round_bed else min.x|round(3),
	'y': (min.y / 1.42)|round(3) if round_bed else min.y|round(3)},
	'max'   : {'x': (max.x / 1.42)|round(3) if round_bed else max.x|round(3),
	'y': (max.y / 1.42)|round(3) if round_bed else max.y|round(3)},
	'center': {'x': (max.x-(max.x-min.x)/2)|round(3),
	'y': (max.y-(max.y-min.y)/2)|round(3)}} %}
	
	{% if params.ENABLE %}
	{% if params.ENABLE|lower is in ['true', 'false'] %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=enable VALUE={True if params.ENABLE|lower == 'true' else False}
	{% else %}
	{action_raise_error("ENABLE=%s not supported. Allowed values are [True, False]" % params.ENABLE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.VERBOSE %}
	{% if params.VERBOSE|lower is in ['true', 'false'] %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=verbose VALUE={True if params.VERBOSE|lower == 'true' else False}
	{% else %}
	{action_raise_error("VERBOSE=%s not supported. Allowed values are [True, False]" % params.VERBOSE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_X %}
	{% if params.CUSTOM_POS_X|float >= min.x and params.CUSTOM_POS_X|float <= max.x %}
	{% set _dummy = tl.park.custom.update({'x':params.CUSTOM_POS_X|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_X=%s must be within [%s - %s]" % (params.CUSTOM_POS_X, min.x, max.x))}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_Y %}
	{% if params.CUSTOM_POS_Y|float >= min.y and params.CUSTOM_POS_Y|float <= max.y %}
	{% set _dummy = tl.park.custom.update({'y':params.CUSTOM_POS_Y|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_Y=%s must be within [%s - %s]" % (params.CUSTOM_POS_Y, min.y, max.y))}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_DZ %}
	{% if params.CUSTOM_POS_DZ|float >= min.z and params.CUSTOM_POS_DZ|float <= max.z %}
	{% set _dummy = tl.park.custom.update({'dz':params.CUSTOM_POS_DZ|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_DZ=%s must be within [%s - %s]" % (params.CUSTOM_POS_DZ, min.z, max.z))}
	{% endif %}
	{% endif %}
	{% if params.PARK_ENABLE %}
	{% if params.PARK_ENABLE|lower is in ['true', 'false'] %}
	{% set _dummy = tl.park.update({'enable':True if params.PARK_ENABLE|lower == 'true' else False}) %}
	{% else %}
	{action_raise_error("PARK_ENABLE=%s not supported. Allowed values are [True, False]" % params.PARK_ENABLE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.PARK_POS %}
	{% if params.PARK_POS|lower is in ['center','front_left','front_right','back_left','back_right','custom','x_only','y_only'] %}
	{% set dic = {'center'      : {'x': park.center.x   , 'y': park.center.y   , 'dz': 1                },
	'front_left'  : {'x': park.min.x      , 'y': park.min.y      , 'dz': 0                },
	'front_right' : {'x': park.max.x      , 'y': park.min.y      , 'dz': 0                },
	'back_left'   : {'x': park.min.x      , 'y': park.max.y      , 'dz': 0                },
	'back_right'  : {'x': park.max.x      , 'y': park.max.y      , 'dz': 0                },
	'custom'      : {'x': tl.park.custom.x, 'y': tl.park.custom.y, 'dz': tl.park.custom.dz},
	'x_only'      : {'x': tl.park.custom.x, 'y': 'none'          , 'dz': tl.park.custom.dz},
	'y_only'      : {'x': 'none'          , 'y': tl.park.custom.y, 'dz': tl.park.custom.dz}} %}
	{% set _dummy = tl.park.update({'pos':params.PARK_POS|lower}) %}
	{% set _dummy = tl.park.update({'coord':dic[tl.park.pos]}) %}
	{% else %}
	{action_raise_error("PARK_POS=%s not supported. Allowed values are [CENTER, FRONT_LEFT, FRONT_RIGHT, BACK_LEFT, BACK_RIGHT, CUSTOM, X_ONLY, Y_ONLY]"
	% params.PARK_POS|upper)}
	{% endif %}
	{% endif %}
	{% if params.PARK_TIME %}
	{% if params.PARK_TIME|float >= 0.0 %}
	{% set _dummy = tl.park.update({'time':params.PARK_TIME|float|round(3)}) %}
	{% else %}
	{action_raise_error("PARK_TIME=%s must be a positive number" % params.PARK_TIME)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=park VALUE="{tl.park}"
	{% if params.TRAVEL_SPEED %}
	{% if params.TRAVEL_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'travel':params.TRAVEL_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("TRAVEL_SPEED=%s must be larger than 0" % params.TRAVEL_SPEED)}
	{% endif %}
	{% endif %}
	{% if params.RETRACT_SPEED %}
	{% if params.RETRACT_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'retract':params.RETRACT_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("RETRACT_SPEED=%s must be larger than 0" % params.RETRACT_SPEED)}
	{% endif %}
	{% endif %}
	{% if params.EXTRUDE_SPEED %}
	{% if params.EXTRUDE_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'extrude':params.EXTRUDE_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("EXTRUDE_SPEED=%s must be larger than 0" % params.EXTRUDE_SPEED)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=speed VALUE="{tl.speed}"
	{% if params.EXTRUDE_DISTANCE %}
	{% if params.EXTRUDE_DISTANCE|float >= 0.0 %}
	{% set _dummy = tl.extruder.update({'extrude':params.EXTRUDE_DISTANCE|float|round(3)}) %}
	{% else %}
	{action_raise_error("EXTRUDE_DISTANCE=%s must be specified as positiv number" % params.EXTRUDE_DISTANCE)}
	{% endif %}
	{% endif %}
	{% if params.RETRACT_DISTANCE %}
	{% if params.RETRACT_DISTANCE|float >= 0.0 %}
	{% set _dummy = tl.extruder.update({'retract':params.RETRACT_DISTANCE|float|round(3)}) %}
	{% else %}
	{action_raise_error("RETRACT_DISTANCE=%s must be specified as positiv number" % params.RETRACT_DISTANCE)}
	{% endif %}
	{% endif %}
	{% if params.FW_RETRACT %}
	{% if params.FW_RETRACT|lower is in ['true', 'false'] %}
	{% if 'firmware_retraction' in printer.configfile.settings %}
	{% set _dummy = tl.extruder.update({'fw_retract': True if params.FW_RETRACT|lower == 'true' else False}) %}
	{% else %}
	{% set _dummy = tl.extruder.update({'fw_retract':False}) %}
	{% if params.FW_RETRACT|capitalize == 'True' %}
	{action_raise_error("[firmware_retraction] not defined in printer.cfg. Can not enable fw_retract")}
	{% endif %}
	{% endif %}
	{% else %}
	{action_raise_error("FW_RETRACT=%s not supported. Allowed values are [True, False]" % params.FW_RETRACT|capitalize)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=extruder VALUE="{tl.extruder}"
	{% if printer.configfile.settings['gcode_macro pause'] is defined %}
	{% set _dummy = tl.macro.update({'pause': printer.configfile.settings['gcode_macro pause'].rename_existing}) %}
	{% endif %}
	{% if printer.configfile.settings['gcode_macro resume'] is defined %}
	{% set _dummy = tl.macro.update({'resume': printer.configfile.settings['gcode_macro resume'].rename_existing}) %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=macro VALUE="{tl.macro}"

[gcode_macro TIMELAPSE_TAKE_FRAME]
description = Take Timelapse shoot
variable_enable = False
variable_takingframe = False
variable_park = {'enable': False,
	'pos'   : 'center',
	'time'  : 0.1,
	'custom': {'x': 0, 'y': 0, 'dz': 0},
	'coord' : {'x': 0, 'y': 0, 'dz': 0}}
variable_extruder = {'fw_retract': False,
	'retract': 1.0,
	'extrude': 1.0}
variable_speed = {'travel': 100,
	'retract': 15,
	'extrude': 15}
variable_verbose = True
variable_check_time = 0.5
variable_restore = {'absolute': {'coordinates': True, 'extrude': True}, 'speed': 1500, 'e':0, 'factor': {'speed': 1.0, 'extrude': 1.0}}
variable_macro = {'pause': 'PAUSE', 'resume': 'RESUME'}
variable_is_paused = False
gcode = 
	{% set hyperlapse = True if params.HYPERLAPSE and params.HYPERLAPSE|lower =='true' else False %}
	{% if enable %}
	{% if (hyperlapse and printer['gcode_macro HYPERLAPSE'].run) or
	(not hyperlapse and not printer['gcode_macro HYPERLAPSE'].run) %}
	{% if park.enable %}
	{% set pos = {'x': 'X' + park.coord.x|string if park.pos != 'y_only' else '',
	'y': 'Y' + park.coord.y|string if park.pos != 'x_only' else '',
	'z': 'Z'+ [printer.gcode_move.gcode_position.z + park.coord.dz, printer.toolhead.axis_maximum.z]|min|string} %}
	{% set restore = {'absolute': {'coordinates': printer.gcode_move.absolute_coordinates,
	'extrude'    : printer.gcode_move.absolute_extrude},
	'speed'   : printer.gcode_move.speed,
	'e'       : printer.gcode_move.gcode_position.e,
	'factor'  : {'speed'  : printer.gcode_move.speed_factor,
	'extrude': printer.gcode_move.extrude_factor}} %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=restore VALUE="{restore}"
	{% if not printer[printer.toolhead.extruder].can_extrude %}
	{% if verbose %}{action_respond_info("Timelapse: Warning, minimum extruder temperature not reached!")}{% endif %}
	{% else %}
	{% if extruder.fw_retract %}
	G10
	{% else %}
	M83
	G0 E-{extruder.retract} F{speed.retract * 60}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=is_paused VALUE=True
	{macro.pause}
	SET_GCODE_OFFSET X=0 Y=0
	G90
	{% if "xyz" not in printer.toolhead.homed_axes %}
	{% if verbose %}{action_respond_info("Timelapse: Warning, axis not homed yet!")}{% endif %}
	{% else %}
	G0 {pos.x} {pos.y} {pos.z} F{speed.travel * 60}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=takingframe VALUE=True
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_TAKE_FRAME DURATION={check_time}
	M400
	{% endif %}
	_TIMELAPSE_NEW_FRAME HYPERLAPSE={hyperlapse}
	{% endif %}
	{% else %}
	{% if verbose %}{action_respond_info("Timelapse: disabled, take frame ignored")}{% endif %}
	{% endif %}

[gcode_macro _TIMELAPSE_NEW_FRAME]
description = action call for timelapse shoot. must be a seperate macro
gcode = 
	{action_call_remote_method("timelapse_newframe",
	macropark=printer['gcode_macro TIMELAPSE_TAKE_FRAME'].park,
	hyperlapse=params.HYPERLAPSE)}

[delayed_gcode _WAIT_TIMELAPSE_TAKE_FRAME]
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% set factor = {'speed': printer.gcode_move.speed_factor, 'extrude': printer.gcode_move.extrude_factor} %}
	{% if tl.takingframe %}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_TAKE_FRAME DURATION={tl.check_time}
	{% else %}
	{tl.macro.resume} VELOCITY={tl.speed.travel}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=is_paused VALUE=False
	{% if not printer[printer.toolhead.extruder].can_extrude %}
	{action_respond_info("Timelapse: Warning minimum extruder temperature not reached!")}
	{% else %}
	{% if tl.extruder.fw_retract %}
	G11
	{% else %}
	G0 E{tl.extruder.extrude} F{tl.speed.extrude * 60}
	G0 F{tl.restore.speed}
	{% if tl.restore.absolute.extrude %}
	M82
	G92 E{tl.restore.e}
	{% endif %}
	{% endif %}
	{% endif %}
	{% if tl.restore.factor.speed   != factor.speed   %} M220 S{(factor.speed*100)|round(0)}   {% endif %}
	{% if tl.restore.factor.extrude != factor.extrude %} M221 S{(factor.extrude*100)|round(0)} {% endif %}
	{% if not tl.restore.absolute.coordinates %} G91 {% endif %}
	{% endif %}

[gcode_macro HYPERLAPSE]
description = Start/Stop a hyperlapse recording
variable_cycle = 0
variable_run = False
gcode = 
	{% set cycle = params.CYCLE|default(30)|int %}
	{% if params.ACTION and params.ACTION|lower == 'start' %}
	{action_respond_info("Hyperlapse: frames started (Cycle %d sec)" % cycle)}
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=run VALUE=True
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=cycle VALUE={cycle}
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION={cycle}
	TIMELAPSE_TAKE_FRAME HYPERLAPSE=True
	{% elif params.ACTION and params.ACTION|lower == 'stop' %}
	{% if run %}{action_respond_info("Hyperlapse: frames stopped")}{% endif %}
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=run VALUE=False
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION=0
	{% else %}
	{action_raise_error("Hyperlapse: No valid input parameter
	Use:
	- HYPERLAPSE ACTION=START [CYCLE=time]
	- HYPERLAPSE ACTION=STOP")}
	{% endif %}

[delayed_gcode _HYPERLAPSE_LOOP]
gcode = 
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION={printer["gcode_macro HYPERLAPSE"].cycle}
	TIMELAPSE_TAKE_FRAME HYPERLAPSE=True

[gcode_macro TIMELAPSE_RENDER]
description = Render Timelapse video and wait for the result
variable_render = False
variable_run_identifier = 0
gcode = 
	{action_respond_info("Timelapse: Rendering started")}
	{action_call_remote_method("timelapse_render", byrendermacro="True")}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_RENDER VARIABLE=render VALUE=True
	{printer.configfile.settings['gcode_macro pause'].rename_existing}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_RENDER DURATION=0.5

[delayed_gcode _WAIT_TIMELAPSE_RENDER]
gcode = 
	{% set ri = printer['gcode_macro TIMELAPSE_RENDER'].run_identifier % 4 %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_RENDER VARIABLE=run_identifier VALUE={ri + 1}
	{% if printer['gcode_macro TIMELAPSE_RENDER'].render %}
	M117 Rendering {['-','\\','|','/'][ri]}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_RENDER DURATION=0.5
	{% else %}
	{action_respond_info("Timelapse: Rendering finished")}
	M117
	{printer.configfile.settings['gcode_macro resume'].rename_existing}
	{% endif %}

[gcode_macro TEST_STREAM_DELAY]
description = Helper macro to find stream and park delay
gcode = 
	{% set min = printer.toolhead.axis_minimum %}
	{% set max = printer.toolhead.axis_maximum %}
	{% set act = printer.toolhead.position %}
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% if act.z > 5.0 %}
	G0 X{min.x + 5.0} F{tl.speed.travel|int * 60}
	G0 X{(max.x-min.x)/2}
	G4 P{tl.park.time|float * 1000}
	_TIMELAPSE_NEW_FRAME HYPERLAPSE=FALSE
	G0 X{max.x - 5.0}
	{% else %}
	{action_raise_error("Toolhead z %.3f to low. Please place head above z = 5.0" % act.z)}
	{% endif %}

[gcode_macro _OBICO_LAYER_CHANGE]
description = Run a scan across the current print area
variable_first_layer_scan_retract_length = 6
variable_first_layer_scan_retract_speed = 15
variable_first_layer_scan_cooldown_temp = 170
variable_first_layer_scan_resume_speed = 50
variable_first_layer_scan_enabled = True
variable_first_layer_scan_stepover = 10
variable_first_layer_scan_speed = 10
variable_first_layer_scan_zhop = 4
variable_first_layer_scan_zhop_speed = 15
variable_verbose = False
variable_current_layer = -1
variable_first_layer_scanning = False
variable_wait = {'resume': "RESUME", 'absolute_coordinates': True, 'absolute_extrude': True, 'e': 0.0, 'previous_temp': 0}
gcode = 
	
	{% set pause_macro  = "PAUSE"  if printer.configfile.settings['gcode_macro pause']  is not defined
	else printer.configfile.settings['gcode_macro pause'].rename_existing %}
	{% set resume_macro = "RESUME" if printer.configfile.settings['gcode_macro resume'] is not defined
	else printer.configfile.settings['gcode_macro resume'].rename_existing %}
	
	{% set current_layer_default = printer.print_stats.info.current_layer if printer.print_stats.info.current_layer is not none else -1 %}
	{% set current_layer = params.CURRENT_LAYER|default(current_layer_default)|int %}
	
	{% set polygon_points = printer.exclude_object.objects|map(attribute='polygon')|sum(start=[]) if printer.exclude_object is defined else [] %}
	{% set min_x = params.MINX|default(polygon_points|map(attribute=0)|min|default(printer.toolhead.axis_minimum.x))|float %}
	{% set min_y = params.MINY|default(polygon_points|map(attribute=1)|min|default(printer.toolhead.axis_minimum.y))|float %}
	{% set max_x = params.MAXX|default(polygon_points|map(attribute=0)|max|default(printer.toolhead.axis_maximum.x))|float %}
	{% set max_y = params.MAXY|default(polygon_points|map(attribute=1)|max|default(printer.toolhead.axis_maximum.y))|float %}
	
	{% set stepoverCount = ((max_y - min_y) / first_layer_scan_stepover|float)|round(method='ceil')|int %}
	
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Layer %d" % (current_layer)}' {% endif %}
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=current_layer VALUE={current_layer}
	
	{% if first_layer_scan_enabled and current_layer == 2 %}
	
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=first_layer_scanning VALUE=True
	
	
	{% set wait_dic = {'resume'              : resume_macro,
	'absolute_coordinates': printer.gcode_move.absolute_coordinates,
	'absolute_extrude'    : printer.gcode_move.absolute_extrude,
	'e'                   : printer.gcode_move.gcode_position.e,
	'previous_temp'       : printer.extruder.target} %}
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=wait VALUE="{wait_dic}"
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Prepare scanning" {% endif %}
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Scan Coordinates: Min:[%.3f:%.3f] Max:[%.3f:%.3f]" % (min_x,min_y,max_x,max_y)}' {% endif %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Retract %.1fmm filament" % first_layer_scan_retract_length|abs}' {% endif %}
	M83
	G0 E-{first_layer_scan_retract_length|abs} F{first_layer_scan_retract_speed|float * 60}
	{% endif %}
	G91
	G0 Z{first_layer_scan_zhop|abs} F{first_layer_scan_zhop_speed|float * 60}
	
	
	M106 S255
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Fan on and lowering temperature to %.1f" % first_layer_scan_cooldown_temp}' {% endif %}
	M104 S{first_layer_scan_cooldown_temp}
	M109 S{first_layer_scan_cooldown_temp}
	
	{pause_macro}
	
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Start scanning" {% endif %}
	
	UPDATE_DELAYED_GCODE ID=_WAIT_OBICO_LAYER_CHANGE DURATION=1.0
	G90
	G0 X{min_x} Y{min_y} F{first_layer_scan_resume_speed|float * 60}
	{% for ystep in range(stepoverCount) %}
	G0 Y{min_y + first_layer_scan_stepover|float * ystep} F{first_layer_scan_speed|float * 60}
	G0 X{max_x if ystep % 2 == 0 else min_x}              F{first_layer_scan_speed|float * 60}
	{% endfor %}
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Finish scanning" {% endif %}
	
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=first_layer_scanning VALUE=False
	
	{% endif %}

[delayed_gcode _WAIT_OBICO_LAYER_CHANGE]
gcode = 
	{% set lc_macro = printer['gcode_macro _OBICO_LAYER_CHANGE'] %}
	{% if lc_macro.first_layer_scanning %}
	
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Waiting for first layer scan..." {% endif %}
	UPDATE_DELAYED_GCODE ID=_WAIT_OBICO_LAYER_CHANGE DURATION=1.0
	{% else %}
	
	M107
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Fan off and resume print" {% endif %}
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Call %s VELOCITY=%.1f" % (lc_macro.wait.resume, lc_macro.first_layer_scan_resume_speed)}' {% endif %}
	{lc_macro.wait.resume} VELOCITY={lc_macro.first_layer_scan_resume_speed}
	G91
	G0 Z-{lc_macro.first_layer_scan_zhop|abs} F{lc_macro.first_layer_scan_zhop_speed|float * 60}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% set first_layer_scan_unretract_length = lc_macro.first_layer_scan_retract_length + 0.5 %}
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Extrude %.1fmm filament" % first_layer_scan_unretract_length|abs}' {% endif %}
	M83
	G0 E{first_layer_scan_unretract_length|abs} F{lc_macro.first_layer_scan_retract_speed|float * 60}
	{% endif %}
	
	
	M104 S{lc_macro.wait.previous_temp}
	M109 S{lc_macro.wait.previous_temp}
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Heating back up to previous temperature"}' {% endif %}
	
	
	{% if lc_macro.wait.absolute_coordinates %} G90 {% endif %}
	{% if lc_macro.wait.absolute_extrude %}
	M82
	G92 E{lc_macro.wait.e}
	{% endif %}
	{% endif %}

[gcode_macro OBICO_LINK_STATUS]
description = Link to Obico server
variable_one_time_passcode = ''
variable_one_time_passlink = ''
variable_is_linked = False
gcode = 
	{action_respond_info('Obico one_time_passcode: {}'.format(one_time_passcode))}
	{action_respond_info('Obico one_time_passlink: {}'.format(one_time_passlink))}
	{action_respond_info('Obico is_linked: {}'.format(is_linked))}
	{% if not is_linked and one_time_passcode != '' %}
	M117 Code: {one_time_passcode}
	{% else %}
	M117 Obico linked
	{% endif %}

[gcode_macro _OBICO_RELINK]
description = Re-link to Obico server
gcode = 
	{action_respond_info('WARNING: Re-link to Obico server')}
	{action_call_remote_method("obico_remote_event", event_name='relink_obico', message='')}
	{action_respond_info('WARNING: relink_obico requested')}

[exclude_object]

[mcu]
serial = /dev/serial/by-id/usb-1a86_USB_Serial-if00-port0
restart_method = command

[temperature_sensor raspberry_pi]
sensor_type = temperature_host
min_temp = 10
max_temp = 100

[temperature_sensor mcu_temp]
sensor_type = temperature_mcu
min_temp = 0
max_temp = 100

[printer]
kinematics = cartesian
max_velocity = 200
max_accel = 4000
max_z_velocity = 10
max_z_accel = 100
minimum_cruise_ratio = 0.5
square_corner_velocity = 5

[stepper_x]
step_pin = PB9
dir_pin = PC2
enable_pin = !PC3
microsteps = 16
rotation_distance = 40
endstop_pin = ^PA5
position_endstop = 0
position_max = 230
homing_speed = 50

[stepper_y]
step_pin = PB7
dir_pin = PB8
enable_pin = !PC3
microsteps = 16
rotation_distance = 40
endstop_pin = ^PA6
position_endstop = 0
position_max = 231
homing_speed = 50

[stepper_z]
step_pin = PB5
dir_pin = !PB6
enable_pin = !PC3
microsteps = 16
rotation_distance = 8
endstop_pin = probe:z_virtual_endstop
position_max = 250
position_min = -4
homing_speed = 4
second_homing_speed = 1
homing_retract_dist = 2.0

[fan]
pin = PA0

[extruder]
max_extrude_only_distance = 100.0
step_pin = PB3
dir_pin = PB4
enable_pin = !PC3
microsteps = 16
gear_ratio = 42:12
rotation_distance = 26.359
nozzle_diameter = 0.400
filament_diameter = 1.750
heater_pin = PA1
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PC5
min_temp = 0
max_temp = 300
min_extrude_temp = 170
pressure_advance = .0369
pressure_advance_smooth_time = 0.04
control = pid
pid_kp = 19.195
pid_ki = 1.000
pid_kd = 92.135

[firmware_retraction]
retract_length = 0.3
retract_speed = 20

[idle_timeout]
gcode = 
	{% if printer.pause_resume.is_paused %}
	M118 Idle timeout while paused, turning off hotend
	SET_HEATER_TEMPERATURE HEATER=extruder TARGET=0
	{% else %}
	M118 Idle timeout
	TURN_OFF_HEATERS
	M84
	{% endif %}
timeout = 1800

[heater_bed]
heater_pin = PA2
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PC4
min_temp = 0
max_temp = 130
control = pid
pid_kp = 68.601
pid_ki = 1.185
pid_kd = 993.000

[bltouch]
sensor_pin = ^PB1
control_pin = PB0
x_offset = -31.8
y_offset = -40.5
speed = 35
samples = 2
samples_result = median
samples_tolerance = 0.05
samples_tolerance_retries = 2
sample_retract_dist = 5.0
probe_with_touch_mode = true
stow_on_each_sample = false
z_offset = 2.049

[safe_z_home]
home_xy_position = 147, 154
speed = 75
z_hop = 10
z_hop_speed = 5
move_to_previous = false

[bed_screws]
screw1 = 30,51
screw1_name = "FL"
screw2 = 200,51
screw2_name = "FR"
screw3 = 200,195
screw3_name = "RR"
screw4 = 30,195
screw4_name = "RL"

[screws_tilt_adjust]
screw1 = 67, 67
screw1_name = front left screw
screw2 = 230, 67
screw2_name = front right screw
screw3 = 230, 230
screw3_name = rear right screw
screw4 = 67.60, 230
screw4_name = rear left screw
horizontal_move_z = 10
speed = 200
screw_thread = CW-M4

[bed_mesh]
speed = 120
mesh_min = 10,11
mesh_max = 195,182
probe_count = 3,3
algorithm = bicubic
fade_start = 1
fade_end = 10
fade_target = 0

[filament_motion_sensor SFS_T0]
detection_length = 150.00
extruder = extruder
switch_pin = PA4
pause_on_runout = True
event_delay = 3.0
pause_delay = 0.5
runout_gcode = 
	M117 Runout Detected!

[delayed_gcode DISABLEFILAMENTSENSOR]
initial_duration = 1
gcode = 
	SET_FILAMENT_SENSOR SENSOR=SFS_T0 ENABLE=0

[gcode_macro SFS_ENABLE]
description = Enable smart filament sensor
gcode = 
	M117 ENABLING the Smart Filament Sensor
	G92 E0
	SET_FILAMENT_SENSOR SENSOR=SFS_T0 ENABLE=1

[gcode_macro SFS_DISABLE]
description = Disable smart filament sensor
gcode = 
	M117 DISABLING the Smart Filament Sensor
	G92 E0
	SET_FILAMENT_SENSOR SENSOR=SFS_T0 ENABLE=0

[gcode_macro FILAMENT_RUNOUT]
gcode = 
	M117 Runout Detected!
	M300 S1 P10
	M600
	M300 S1 P10

[gcode_macro M300]
gcode = 
	{% set S = params.S|default(1000)|int %}
	{% set P = params.P|default(100)|int %}
	SET_PIN PIN=BEEPER VALUE=0.5 CYCLE_TIME={ 1.0/S if S > 0 else 1 }
	G4 P{P}
	SET_PIN PIN=BEEPER VALUE=0
	[gcode_macro M600]
	gcode:
	{% set X = params.X|default(25)|float %}
	{% set Y = params.Y|default(25)|float %}
	{% set Z = params.Z|default(10)|float %}
	SAVE_GCODE_STATE NAME=M600_state
	PAUSE
	G91
	G1 E-.8 F2700
	G1 Z{Z}
	G90
	G1 X{X} Y{Y} F3000
	G91
	G1 E-15 F1000
	RESTORE_GCODE_STATE NAME=M600_state

[gcode_arcs]
resolution = 1.0

[input_shaper]
shaper_freq_x = 73.5
shaper_type_x = ei
shaper_freq_y = 76.9
shaper_type_y = mzv
=======================
bed_mesh: bicubic interpolation with a probe_count of less than 4 points detected.  Forcing lagrange interpolation. Configured Probe Count: 3, 3
Extruder max_extrude_ratio=0.266081
mcu 'mcu': Starting serial connect
mcu 'mcu': got {'oid': 12, 'next_clock': 3045939968, 'value': 31566, '#name': 'analog_in_state', '#sent_time': 23.654211078000003, '#receive_time': 23.660881634000003}
mcu 'mcu': got {'oid': 17, 'next_clock': 3049539968, 'value': 31510, '#name': 'analog_in_state', '#sent_time': 23.654211078000003, '#receive_time': 23.710833115}
mcu 'mcu': got {'oid': 10, 'next_clock': 3066099968, 'value': 14017, '#name': 'analog_in_state', '#sent_time': 23.930473652, '#receive_time': 23.940726467}
mcu 'mcu': got {'oid': 12, 'next_clock': 3067539968, 'value': 31565, '#name': 'analog_in_state', '#sent_time': 23.930473652, '#receive_time': 23.960902596}
mcu 'mcu': got {'oid': 17, 'next_clock': 3071139968, 'value': 31507, '#name': 'analog_in_state', '#sent_time': 23.984725689, '#receive_time': 24.010808263}
Loaded MCU 'mcu' 119 commands (v0.12.0-286-g81de9a861 / gcc: (15:8-2019-q3-1+b1) 8.3.1 20190703 (release) [gcc-8-branch revision 273027] binutils: (2.35.2-2+14+b2) 2.35.2)
MCU 'mcu' config: ADC_MAX=4095 BUS_PINS_i2c1=PB6,PB7 BUS_PINS_i2c1a=PB8,PB9 BUS_PINS_i2c2=PB10,PB11 BUS_PINS_spi1=PA6,PA7,PA5 BUS_PINS_spi1a=PB4,PB5,PB3 BUS_PINS_spi2=PB14,PB15,PB13 BUS_PINS_spi3=PB4,PB5,PB3 CLOCK_FREQ=72000000 MCU=stm32f103xe PWM_MAX=255 RECEIVE_WINDOW=192 RESERVE_PINS_serial=PA10,PA9 SERIAL_BAUD=250000 STATS_SUMSQ_BASE=256 STEPPER_BOTH_EDGE=1
mcu_temperature 'mcu' nominal base=357.558140 slope=-767.441860
Configured MCU 'mcu' (1024 moves)
Starting heater checks for heater_bed
webhooks client 548615387984: New connection
bed_mesh: generated points
Index |  Tool Adjusted  |   Probe
  0   | (41.8, 51.5)    | (10.0, 11.0)
  1   | (134.3, 51.5)   | (102.5, 11.0)
  2   | (226.8, 51.5)   | (195.0, 11.0)
  3   | (226.8, 137.0)  | (195.0, 96.5)
  4   | (134.3, 137.0)  | (102.5, 96.5)
  5   | (41.8, 137.0)   | (10.0, 96.5)
  6   | (41.8, 222.5)   | (10.0, 182.0)
  7   | (134.3, 222.5)  | (102.5, 182.0)
  8   | (226.8, 222.5)  | (195.0, 182.0)
Starting heater checks for extruder
Stats 25.1: gcodein=0  mcu: mcu_awake=0.006 mcu_task_avg=0.000028 mcu_task_stddev=0.000013 bytes_write=1141 bytes_read=4640 bytes_retransmit=9 bytes_invalid=0 send_seq=115 receive_seq=115 retransmit_seq=2 srtt=0.003 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000885  raspberry_pi: temp=58.4 mcu_temp: temp=0.0 heater_bed: target=0 temp=0.0 pwm=0.000 sysload=1.79 cputime=2.106 memavail=1478832 print_time=97992.849 buffer_time=0.248 print_stall=0 extruder: target=0 temp=0.0 pwm=0.000
webhooks client 548615387984: Client info {'program': 'Moonraker', 'version': 'v0.9.3-3-gccfe32f'}
webhooks: registering remote method 'shutdown_machine' for connection id: 548615387984
webhooks: registering remote method 'reboot_machine' for connection id: 548615387984
webhooks: registering remote method 'pause_job_queue' for connection id: 548615387984
webhooks: registering remote method 'start_job_queue' for connection id: 548615387984
webhooks: registering remote method 'spoolman_set_active_spool' for connection id: 548615387984
Stats 26.1: gcodein=0  mcu: mcu_awake=0.006 mcu_task_avg=0.000028 mcu_task_stddev=0.000013 bytes_write=1147 bytes_read=4746 bytes_retransmit=9 bytes_invalid=0 send_seq=116 receive_seq=116 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000477  raspberry_pi: temp=57.0 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.79 cputime=2.141 memavail=1506124 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 27.1: gcodein=0  mcu: mcu_awake=0.006 mcu_task_avg=0.000028 mcu_task_stddev=0.000013 bytes_write=1153 bytes_read=4897 bytes_retransmit=9 bytes_invalid=0 send_seq=117 receive_seq=117 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000744  raspberry_pi: temp=59.4 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.79 cputime=2.178 memavail=1582696 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
webhooks: registering remote method 'obico_remote_event' for connection id: 548615387984
Stats 28.1: gcodein=0  mcu: mcu_awake=0.006 mcu_task_avg=0.000028 mcu_task_stddev=0.000013 bytes_write=1159 bytes_read=5093 bytes_retransmit=9 bytes_invalid=0 send_seq=118 receive_seq=118 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000752  raspberry_pi: temp=57.9 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.79 cputime=2.200 memavail=1564832 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 29.1: gcodein=0  mcu: mcu_awake=0.006 mcu_task_avg=0.000028 mcu_task_stddev=0.000013 bytes_write=1165 bytes_read=5244 bytes_retransmit=9 bytes_invalid=0 send_seq=119 receive_seq=119 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000612  raspberry_pi: temp=59.4 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.79 cputime=2.212 memavail=1547856 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 30.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000010 bytes_write=1171 bytes_read=5409 bytes_retransmit=9 bytes_invalid=0 send_seq=120 receive_seq=120 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000460  raspberry_pi: temp=59.9 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.05 cputime=2.226 memavail=1520744 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 31.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000010 bytes_write=1177 bytes_read=5605 bytes_retransmit=9 bytes_invalid=0 send_seq=121 receive_seq=121 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000381  raspberry_pi: temp=58.4 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.05 cputime=2.238 memavail=1508308 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 32.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000010 bytes_write=1183 bytes_read=5756 bytes_retransmit=9 bytes_invalid=0 send_seq=122 receive_seq=122 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000312  raspberry_pi: temp=58.9 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.05 cputime=2.248 memavail=1473040 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 33.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000010 bytes_write=1189 bytes_read=5907 bytes_retransmit=9 bytes_invalid=0 send_seq=123 receive_seq=123 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000304  raspberry_pi: temp=58.9 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.2 pwm=0.000 sysload=2.05 cputime=2.262 memavail=1453388 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 34.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000010 bytes_write=1195 bytes_read=6103 bytes_retransmit=9 bytes_invalid=0 send_seq=124 receive_seq=124 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000256  raspberry_pi: temp=57.5 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.05 cputime=2.276 memavail=1561652 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 35.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1201 bytes_read=6268 bytes_retransmit=9 bytes_invalid=0 send_seq=125 receive_seq=125 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000254  raspberry_pi: temp=58.4 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.20 cputime=2.288 memavail=1537364 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 36.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1207 bytes_read=6419 bytes_retransmit=9 bytes_invalid=0 send_seq=126 receive_seq=126 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000253  raspberry_pi: temp=58.4 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.20 cputime=2.298 memavail=1525832 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 37.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1213 bytes_read=6615 bytes_retransmit=9 bytes_invalid=0 send_seq=127 receive_seq=127 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000262  raspberry_pi: temp=57.9 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.2 pwm=0.000 sysload=2.20 cputime=2.310 memavail=1504420 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 38.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1219 bytes_read=6766 bytes_retransmit=9 bytes_invalid=0 send_seq=128 receive_seq=128 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000256  raspberry_pi: temp=57.5 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.20 cputime=2.321 memavail=1488292 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 39.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1225 bytes_read=6917 bytes_retransmit=9 bytes_invalid=0 send_seq=129 receive_seq=129 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000248  raspberry_pi: temp=58.4 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.2 pwm=0.000 sysload=2.20 cputime=2.333 memavail=1460076 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 40.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1231 bytes_read=7126 bytes_retransmit=9 bytes_invalid=0 send_seq=130 receive_seq=130 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000237  raspberry_pi: temp=57.9 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.27 cputime=2.347 memavail=1492784 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 41.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1237 bytes_read=7266 bytes_retransmit=9 bytes_invalid=0 send_seq=131 receive_seq=131 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000232  raspberry_pi: temp=56.5 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.27 cputime=2.358 memavail=1549512 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 42.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1243 bytes_read=7421 bytes_retransmit=9 bytes_invalid=0 send_seq=132 receive_seq=132 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000229  raspberry_pi: temp=57.5 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.27 cputime=2.368 memavail=1536416 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 43.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1249 bytes_read=7590 bytes_retransmit=9 bytes_invalid=0 send_seq=133 receive_seq=133 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000224  raspberry_pi: temp=57.0 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.27 cputime=2.379 memavail=1514000 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 44.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1255 bytes_read=7734 bytes_retransmit=9 bytes_invalid=0 send_seq=134 receive_seq=134 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000226  raspberry_pi: temp=58.4 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.2 pwm=0.000 sysload=2.27 cputime=2.390 memavail=1499384 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 45.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1261 bytes_read=7914 bytes_retransmit=9 bytes_invalid=0 send_seq=135 receive_seq=135 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000269  raspberry_pi: temp=57.9 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.33 cputime=2.402 memavail=1473188 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 46.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1267 bytes_read=8095 bytes_retransmit=9 bytes_invalid=0 send_seq=136 receive_seq=136 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000258  raspberry_pi: temp=57.9 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.33 cputime=2.414 memavail=1455304 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 47.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1273 bytes_read=8246 bytes_retransmit=9 bytes_invalid=0 send_seq=137 receive_seq=137 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000261  raspberry_pi: temp=57.9 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.33 cputime=2.426 memavail=1563992 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 48.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1279 bytes_read=8412 bytes_retransmit=9 bytes_invalid=0 send_seq=138 receive_seq=138 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000255  raspberry_pi: temp=58.4 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.33 cputime=2.437 memavail=1540284 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 49.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1285 bytes_read=8593 bytes_retransmit=9 bytes_invalid=0 send_seq=139 receive_seq=139 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000261  raspberry_pi: temp=56.5 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.33 cputime=2.448 memavail=1524408 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 50.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1291 bytes_read=8758 bytes_retransmit=9 bytes_invalid=0 send_seq=140 receive_seq=140 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000258  raspberry_pi: temp=58.4 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.38 cputime=2.460 memavail=1504500 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 51.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1297 bytes_read=8924 bytes_retransmit=9 bytes_invalid=0 send_seq=141 receive_seq=141 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000254  raspberry_pi: temp=58.4 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.38 cputime=2.471 memavail=1481824 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 52.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1303 bytes_read=9105 bytes_retransmit=9 bytes_invalid=0 send_seq=142 receive_seq=142 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000258  raspberry_pi: temp=58.4 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.38 cputime=2.483 memavail=1456132 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 53.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1309 bytes_read=9256 bytes_retransmit=9 bytes_invalid=0 send_seq=143 receive_seq=143 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000279  raspberry_pi: temp=57.9 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.38 cputime=2.499 memavail=1560892 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 54.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1315 bytes_read=9422 bytes_retransmit=9 bytes_invalid=0 send_seq=144 receive_seq=144 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000273  raspberry_pi: temp=58.4 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.38 cputime=2.510 memavail=1540156 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 55.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1321 bytes_read=9617 bytes_retransmit=9 bytes_invalid=0 send_seq=145 receive_seq=145 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000268  raspberry_pi: temp=58.4 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.51 cputime=2.521 memavail=1527052 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 56.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1327 bytes_read=9768 bytes_retransmit=9 bytes_invalid=0 send_seq=146 receive_seq=146 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000263  raspberry_pi: temp=57.5 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.51 cputime=2.531 memavail=1505128 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 57.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1333 bytes_read=9934 bytes_retransmit=9 bytes_invalid=0 send_seq=147 receive_seq=147 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000258  raspberry_pi: temp=58.4 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.51 cputime=2.543 memavail=1486996 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 58.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1339 bytes_read=10115 bytes_retransmit=9 bytes_invalid=0 send_seq=148 receive_seq=148 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000253  raspberry_pi: temp=58.9 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.2 pwm=0.000 sysload=2.51 cputime=2.554 memavail=1459276 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 59.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1345 bytes_read=10266 bytes_retransmit=9 bytes_invalid=0 send_seq=149 receive_seq=149 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000262  raspberry_pi: temp=57.5 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.51 cputime=2.567 memavail=1492264 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 60.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1351 bytes_read=10446 bytes_retransmit=9 bytes_invalid=0 send_seq=150 receive_seq=150 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000265  raspberry_pi: temp=57.9 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.47 cputime=2.578 memavail=1544884 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 61.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1357 bytes_read=10627 bytes_retransmit=9 bytes_invalid=0 send_seq=151 receive_seq=151 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000260  raspberry_pi: temp=57.5 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.47 cputime=2.590 memavail=1533996 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 62.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1363 bytes_read=10778 bytes_retransmit=9 bytes_invalid=0 send_seq=152 receive_seq=152 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000257  raspberry_pi: temp=57.5 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.47 cputime=2.600 memavail=1510560 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 63.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1369 bytes_read=10944 bytes_retransmit=9 bytes_invalid=0 send_seq=153 receive_seq=153 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000257  raspberry_pi: temp=57.9 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=2.47 cputime=2.611 memavail=1496952 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 64.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1375 bytes_read=11125 bytes_retransmit=9 bytes_invalid=0 send_seq=154 receive_seq=154 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000251  raspberry_pi: temp=57.5 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.47 cputime=2.622 memavail=1468736 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 65.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1381 bytes_read=11276 bytes_retransmit=9 bytes_invalid=0 send_seq=155 receive_seq=155 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000251  raspberry_pi: temp=57.9 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.51 cputime=2.635 memavail=1492204 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 66.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1387 bytes_read=11456 bytes_retransmit=9 bytes_invalid=0 send_seq=156 receive_seq=156 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000251  raspberry_pi: temp=58.4 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.51 cputime=2.649 memavail=1554556 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 67.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1393 bytes_read=11637 bytes_retransmit=9 bytes_invalid=0 send_seq=157 receive_seq=157 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000248  raspberry_pi: temp=57.9 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.51 cputime=2.670 memavail=1537688 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 68.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1399 bytes_read=11788 bytes_retransmit=9 bytes_invalid=0 send_seq=158 receive_seq=158 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000244  raspberry_pi: temp=58.4 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.51 cputime=2.682 memavail=1518312 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 69.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1405 bytes_read=11954 bytes_retransmit=9 bytes_invalid=0 send_seq=159 receive_seq=159 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000244  raspberry_pi: temp=58.4 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.51 cputime=2.696 memavail=1499668 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 70.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1411 bytes_read=12135 bytes_retransmit=9 bytes_invalid=0 send_seq=160 receive_seq=160 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000241  raspberry_pi: temp=57.9 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.55 cputime=2.709 memavail=1474228 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 71.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1417 bytes_read=12300 bytes_retransmit=9 bytes_invalid=0 send_seq=161 receive_seq=161 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000238  raspberry_pi: temp=58.4 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.55 cputime=2.724 memavail=1452332 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 72.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1423 bytes_read=12481 bytes_retransmit=9 bytes_invalid=0 send_seq=162 receive_seq=162 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000255  raspberry_pi: temp=57.5 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.55 cputime=2.739 memavail=1561980 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 73.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1429 bytes_read=12647 bytes_retransmit=9 bytes_invalid=0 send_seq=163 receive_seq=163 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000252  raspberry_pi: temp=57.9 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.55 cputime=2.754 memavail=1539016 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 74.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1435 bytes_read=12798 bytes_retransmit=9 bytes_invalid=0 send_seq=164 receive_seq=164 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000249  raspberry_pi: temp=58.4 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.55 cputime=2.766 memavail=1527012 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 75.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1441 bytes_read=12979 bytes_retransmit=9 bytes_invalid=0 send_seq=165 receive_seq=165 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000245  raspberry_pi: temp=57.9 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.59 cputime=2.780 memavail=1503840 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 76.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1447 bytes_read=13159 bytes_retransmit=9 bytes_invalid=0 send_seq=166 receive_seq=166 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000242  raspberry_pi: temp=57.0 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.59 cputime=2.793 memavail=1487212 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 77.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1453 bytes_read=13310 bytes_retransmit=9 bytes_invalid=0 send_seq=167 receive_seq=167 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000239  raspberry_pi: temp=58.9 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.59 cputime=2.805 memavail=1459756 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 78.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1459 bytes_read=13491 bytes_retransmit=9 bytes_invalid=0 send_seq=168 receive_seq=168 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000237  raspberry_pi: temp=57.5 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.59 cputime=2.823 memavail=1491472 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 79.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1465 bytes_read=13657 bytes_retransmit=9 bytes_invalid=0 send_seq=169 receive_seq=169 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000240  raspberry_pi: temp=57.5 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.59 cputime=2.836 memavail=1542904 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 80.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1471 bytes_read=13808 bytes_retransmit=9 bytes_invalid=0 send_seq=170 receive_seq=170 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000239  raspberry_pi: temp=57.5 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.62 cputime=2.848 memavail=1531012 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 81.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1477 bytes_read=14003 bytes_retransmit=9 bytes_invalid=0 send_seq=171 receive_seq=171 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000237  raspberry_pi: temp=57.9 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.62 cputime=2.861 memavail=1506600 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 82.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1483 bytes_read=14169 bytes_retransmit=9 bytes_invalid=0 send_seq=172 receive_seq=172 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000236  raspberry_pi: temp=57.9 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.62 cputime=2.873 memavail=1493244 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 83.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1489 bytes_read=14320 bytes_retransmit=9 bytes_invalid=0 send_seq=173 receive_seq=173 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000239  raspberry_pi: temp=59.4 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.62 cputime=2.886 memavail=1463536 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 84.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1501 bytes_read=14517 bytes_retransmit=9 bytes_invalid=0 send_seq=175 receive_seq=175 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000243  raspberry_pi: temp=57.9 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.2 pwm=0.000 sysload=2.62 cputime=2.902 memavail=1489952 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 85.2: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1507 bytes_read=14683 bytes_retransmit=9 bytes_invalid=0 send_seq=176 receive_seq=176 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000240  raspberry_pi: temp=58.4 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.2 pwm=0.000 sysload=2.65 cputime=2.916 memavail=1549796 print_time=97992.849 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
webhooks client 548615387984: Disconnected
Starting Klippy...
Args: ['/home/coon/klipper/klippy/klippy.py', '/home/coon/printer_data/config/printer.cfg', '-l', '/home/coon/printer_data/logs/klippy.log', '-I', '/home/coon/printer_data/comms/klippy.serial', '-a', '/home/coon/printer_data/comms/klippy.sock']
Git version: 'v0.12.0-396-gb7233d119'
Branch: master
Remote: origin
Tracked URL: https://github.com/Klipper3d/klipper.git
CPU: 4 core ?
Python: '3.9.2 (default, Dec  1 2024, 12:12:57) \n[GCC 10.2.1 20210110]'
Start printer at Sun Dec 22 17:25:15 2024 (1734906315.1 43.6)
===== Config file =====
[virtual_sdcard]
path = ~/printer_data/gcodes
on_error_gcode = CANCEL_PRINT

[pause_resume]
recover_velocity = 25

[display_status]

[respond]
default_prefix = 

[gcode_macro CANCEL_PRINT]
description = Cancel the actual running print
rename_existing = BASE_CANCEL_PRINT
gcode = 
	G91
	G0 Z10 F600
	G90
	TURN_OFF_HEATERS
	G0 X5 Y220
	CLEAR_PAUSE
	
	BASE_CANCEL_PRINT

[gcode_macro PAUSE]
description = Pause the actual running print
rename_existing = PAUSE_BASE
gcode = 
	
	{% set x = params.X|default(5) %}
	{% set y = params.Y|default(225) %}
	{% set z = params.Z|default(10)|float %}
	{% set e = params.E|default(1) %}
	
	{% set max_z = printer.toolhead.axis_maximum.z|float %}
	{% set act_z = printer.toolhead.position.z|float %}
	{% set lift_z = z|abs %}
	{% if act_z < (max_z - lift_z) %}
	{% set z_safe = lift_z %}
	{% else %}
	{% set z_safe = max_z - act_z %}
	{% endif %}
	
	PAUSE_BASE
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E-{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	{% if "xyz" in printer.toolhead.homed_axes %}
	G1 Z{z_safe}
	G90
	G1 X{x} Y{y} F6000
	{% else %}
	{action_respond_info("Printer not homed")}
	{% endif %}

[gcode_macro RESUME]
description = Resume the actual running print
rename_existing = RESUME_BASE
variable_last_extruder_temp = {'restore': False, 'temp': 0}
variable_restore_idle_timeout = 0
variable_idle_state = False
gcode = 
	
	{% set e = params.E|default(1) %}
	
	{% if 'VELOCITY' in params|upper %}
	{% set get_params = ('VELOCITY=' + params.VELOCITY)  %}
	{%else %}
	{% set get_params = "" %}
	{% endif %}
	
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	RESUME_BASE {get_params}

[gcode_macro SET_PAUSE_NEXT_LAYER]
description = Enable a pause if the next layer is reached
gcode = 
	{% set pause_next_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_next_layer %}
	{% set ENABLE = params.ENABLE|default(1)|int != 0 %}
	{% set MACRO = params.MACRO|default(pause_next_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_next_layer VALUE="{{ 'enable': ENABLE, 'call': MACRO }}"

[gcode_macro SET_PAUSE_AT_LAYER]
description = Enable/disable a pause if a given layer number is reached
gcode = 
	{% set pause_at_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_at_layer %}
	{% set ENABLE = params.ENABLE|int != 0 if params.ENABLE is defined
	else params.LAYER is defined %}
	{% set LAYER = params.LAYER|default(pause_at_layer.layer)|int %}
	{% set MACRO = params.MACRO|default(pause_at_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_at_layer VALUE="{{ 'enable': ENABLE, 'layer': LAYER, 'call': MACRO }}"

[gcode_macro SET_PRINT_STATS_INFO]
rename_existing = SET_PRINT_STATS_INFO_BASE
description = Overwrite, to get pause_next_layer and pause_at_layer feature
variable_pause_next_layer = { 'enable': False, 'call': "PAUSE" }
variable_pause_at_layer = { 'enable': False, 'layer': 0, 'call': "PAUSE" }
gcode = 
	{% if pause_next_layer.enable %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_next_layer" % pause_next_layer.call}'
	{pause_next_layer.call}
	SET_PAUSE_NEXT_LAYER ENABLE=0
	{% elif pause_at_layer.enable and params.CURRENT_LAYER is defined and params.CURRENT_LAYER|int == pause_at_layer.layer %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_at_layer [%d]" % (pause_at_layer.call, pause_at_layer.layer)}'
	{pause_at_layer.call}
	SET_PAUSE_AT_LAYER ENABLE=0
	{% endif %}
	SET_PRINT_STATS_INFO_BASE {rawparams}

[gcode_macro _TOOLHEAD_PARK_PAUSE_CANCEL]
description = Helper: park toolhead used in PAUSE and CANCEL_PRINT
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set velocity = printer.configfile.settings.pause_resume.recover_velocity %}
	{% set use_custom     = client.use_custom_pos|default(false)|lower == 'true' %}
	{% set custom_park_x  = client.custom_park_x|default(0.0) %}
	{% set custom_park_y  = client.custom_park_y|default(0.0) %}
	{% set park_dz        = client.custom_park_dz|default(2.0)|abs %}
	{% set sp_hop         = client.speed_hop|default(15) * 60 %}
	{% set sp_move        = client.speed_move|default(velocity) * 60 %}
	
	{% set origin    = printer.gcode_move.homing_origin %}
	{% set act       = printer.gcode_move.gcode_position %}
	{% set max       = printer.toolhead.axis_maximum %}
	{% set cone      = printer.toolhead.cone_start_z|default(max.z) %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	
	{% set z_min = params.Z_MIN|default(0)|float %}
	{% set z_park = [[(act.z + park_dz), z_min]|max, (max.z - origin.z)]|min %}
	{% set x_park = params.X       if params.X is defined
	else custom_park_x  if use_custom
	else 0.0            if round_bed
	else (max.x - 5.0) %}
	{% set y_park = params.Y       if params.Y is defined
	else custom_park_y  if use_custom
	else (max.y - 5.0)  if round_bed and z_park < cone
	else 0.0            if round_bed
	else (max.y - 5.0) %}
	
	_CLIENT_RETRACT
	{% if "xyz" in printer.toolhead.homed_axes %}
	G90
	G1 Z{z_park} F{sp_hop}
	G1 X{x_park} Y{y_park} F{sp_move}
	{% if not printer.gcode_move.absolute_coordinates %} G91 {% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='Printer not homed'
	{% endif %}

[gcode_macro _CLIENT_EXTRUDE]
description = Extrudes, if the extruder is hot enough
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set use_fw_retract = (client.use_fw_retract|default(false)|lower == 'true') and (printer.firmware_retraction is defined) %}
	{% set length = params.LENGTH|default(client.unretract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_unretract)|default(35) %}
	{% set absolute_extrude = printer.gcode_move.absolute_extrude %}
	
	{% if printer.toolhead.extruder != '' %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if use_fw_retract %}
	{% if length < 0 %}
	G10
	{% else %}
	G11
	{% endif %}
	{% else %}
	M83
	G1 E{length} F{(speed|float|abs) * 60}
	{% if absolute_extrude %}
	M82
	{% endif %}
	{% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='{"\"%s\" not hot enough" % printer.toolhead.extruder}'
	{% endif %}
	{% endif %}

[gcode_macro _CLIENT_RETRACT]
description = Retracts, if the extruder is hot enough
gcode = 
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set length = params.LENGTH|default(client.retract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_retract)|default(35) %}
	
	_CLIENT_EXTRUDE LENGTH=-{length|float|abs} SPEED={speed|float|abs}

[gcode_macro _CLIENT_LINEAR_MOVE]
description = Linear move with save and restore of the gcode state
gcode = 
	{% set x_move = "X" ~ params.X if params.X is defined else "" %}
	{% set y_move = "Y" ~ params.Y if params.Y is defined else "" %}
	{% set z_move = "Z" ~ params.Z if params.Z is defined else "" %}
	{% set e_move = "E" ~ params.E if params.E is defined else "" %}
	{% set rate = "F" ~ params.F if params.F is defined else "" %}
	{% set ABSOLUTE = params.ABSOLUTE | default(0) | int != 0 %}
	{% set ABSOLUTE_E = params.ABSOLUTE_E | default(0) | int != 0 %}
	SAVE_GCODE_STATE NAME=_client_movement
	{% if x_move or y_move or z_move %}
	G9{ 0 if ABSOLUTE else 1 }
	{% endif %}
	{% if e_move %}
	M8{ 2 if ABSOLUTE_E else 3 }
	{% endif %}
	G1 { x_move } { y_move } { z_move } { e_move } { rate }
	RESTORE_GCODE_STATE NAME=_client_movement

[gcode_macro play_test]
gcode = 
	RESPOND TYPE=command MSG="action:prompt_begin Question"
	RESPOND TYPE=command MSG="action:prompt_text Do you wont to cancel the print?"
	RESPOND TYPE=command MSG="action:prompt_footer_button continue|RESPOND TYPE=command MSG=action:prompt_end"
	RESPOND TYPE=command MSG="action:prompt_footer_button CANCEL|CANCEL_PRINT|error"
	RESPOND TYPE=command MSG="action:prompt_show"

[gcode_macro PRINT_START]
gcode = 
	START_PRINT {rawparams}

[gcode_macro START_PRINT]
gcode = 
	{% set BED_TEMP = params.BED_TEMP|default(60)|float %}
	{% set EXTRUDER_TEMP = params.EXTRUDER_TEMP|default(190)|float %}
	
	M190 S{BED_TEMP}
	
	G90
	
	G28
	
	RESPOND MSG="Bed Meshing"
	
	
	
	
	
	
	
	
	BED_MESH_CLEAR
	BED_MESH_CALIBRATE ADAPTIVE=1
	
	
	
	
	
	
	
	RESPOND MSG="Heating to print temp"
	M104 S{EXTRUDER_TEMP}
	G0 Z40 F240
	M109 S{EXTRUDER_TEMP}
	RESPOND MSG="Enable Runout Sensor"
	SFS_ENABLE
	RESPOND MSG="Line Purge"
	LINE_PURGE
	RESPOND MSG="Print Started"

[gcode_macro LINE_PURGE]
gcode = 
	G92 E0
	G1 Z2.0 F3000
	G1 X0.1 Y20 Z0.3 F5000.0
	G1 X0.1 Y200.0 Z0.3 F1500.0 E15
	G1 X0.4 Y200.0 Z0.3 F5000.0
	G1 X0.4 Y20 Z0.3 F1500.0 E30
	G92 E0
	G1 Z2.0 F3000
	G1 X5 Y20 Z0.3 F5000.0

[gcode_macro PRINT_END]
gcode = 
	END_PRINT

[gcode_macro END_PRINT]
gcode = 
	
	
	RESPOND MSG="Print Finished"
	G91
	G1 E-.5 Z0.2 F2400
	G1 X5 Y5 F6000
	G1 Z10
	G90
	SFS_DISABLE
	
	G1 X0 Y220 F6000
	M106 S0
	M104 S0
	M140 S0
	
	M84 X Y E

[gcode_macro SET_ACTIVE_SPOOL]
gcode = 
	{% if params.ID %}
	{% set id = params.ID|int %}
	{action_call_remote_method(
	"spoolman_set_active_spool",
	spool_id=id
	)}
	{% else %}
	{action_respond_info("Parameter 'ID' is required")}
	{% endif %}

[gcode_macro CLEAR_ACTIVE_SPOOL]
gcode = 
	{action_call_remote_method(
	"spoolman_set_active_spool",
	spool_id=None
	)}

[gcode_macro G29]
gcode = 
	G28
	BED_MESH_CALIBRATE
	G0 X0 Y0 Z10 F6000
	BED_MESH_PROFILE save=default

[gcode_macro M125]
gcode = 
	SAVE_GCODE_STATE NAME=parking
	M117 Parking toolhead
	G91
	G1 Z10 F600
	G90
	G1 X5 Y225 F4000
	RESTORE_GCODE_STATE NAME=parking

[gcode_macro Load_Filament]
gcode = 
	SAVE_GCODE_STATE NAME=loading_filament
	M117 Loading Filament
	M83
	G92 E0.0
	G91
	G1 E50 F200
	G92 E50
	RESTORE_GCODE_STATE NAME=loading_filament

[gcode_macro Unload_Filament]
gcode = 
	SAVE_GCODE_STATE NAME=unloading_filament
	M117 Unloading Filament
	G91
	G1 E5 F100
	G92 E0.0
	G1 E-50 F5000
	G92 E-50
	RESTORE_GCODE_STATE NAME=unloading_filament

[gcode_macro Filament_Change]
gcode = 
	
	SAVE_GCODE_STATE NAME=filament_change
	
	Unload_Filament
	
	RESPOND TYPE=command MSG="action:prompt_begin Question"
	RESPOND TYPE=command MSG="action:prompt_text Please insert new filament and confirm"
	RESPOND TYPE=command MSG="action:prompt_footer_button CONFIRM|Load_Filament|RESPOND TYPE=command MSG=action:prompt_end"
	RESPOND TYPE=command MSG="action:prompt_footer_button CANCEL|RESPOND TYPE=command MSG=action:prompt_end"
	RESPOND TYPE=command MSG="action:prompt_show"
	
	RESTORE_GCODE_STATE NAME=filament_change

[gcode_macro Calibrate_Hotend_PID]
gcode = 
	PID_CALIBRATE HEATER=extruder TARGET=200

[gcode_macro Calibrate_Bed_PID]
gcode = 
	PID_CALIBRATE HEATER=heater_bed TARGET=60

[gcode_macro Calibrate_Zoffset]
gcode = 
	PROBE_CALIBRATE

[gcode_macro Tram_bed]
gcode = 
	SCREWS_TILT_CALCULATE

[gcode_macro TEST_SPEED]
description = Test for max speed and acceleration parameters for the printer. Procedure: Home -> ReadPositionFromMCU -> MovesToolhead@Vel&Accel -> Home -> ReadPositionfromMCU
gcode = 
	
	{% set speed  = params.SPEED|default(printer.configfile.settings.printer.max_velocity)|int %}
	
	{% set iterations = params.ITERATIONS|default(5)|int %}
	
	{% set accel  = params.ACCEL|default(printer.configfile.settings.printer.max_accel)|int %}
	
	{% set min_cruise_ratio = params.MIN_CRUISE_RATIO|default(0.5)|float %}
	
	{% set bound = params.BOUND|default(20)|int %}
	
	{% set smallpatternsize = SMALLPATTERNSIZE|default(20)|int %}
	
	
	
	{% set x_min = printer.toolhead.axis_minimum.x + bound %}
	{% set x_max = printer.toolhead.axis_maximum.x - bound %}
	{% set y_min = printer.toolhead.axis_minimum.y + bound %}
	{% set y_max = printer.toolhead.axis_maximum.y - bound %}
	
	
	
	{% set x_center = (printer.toolhead.axis_minimum.x|float + printer.toolhead.axis_maximum.x|float ) / 2 %}
	{% set y_center = (printer.toolhead.axis_minimum.y|float + printer.toolhead.axis_maximum.y|float ) / 2 %}
	
	
	{% set x_center_min = x_center - (smallpatternsize/2) %}
	{% set x_center_max = x_center + (smallpatternsize/2) %}
	{% set y_center_min = y_center - (smallpatternsize/2) %}
	{% set y_center_max = y_center + (smallpatternsize/2) %}
	
	
	SAVE_GCODE_STATE NAME=TEST_SPEED
	
	
	{ action_respond_info("TEST_SPEED: starting %d iterations at speed %d, accel %d" % (iterations, speed, accel)) }
	
	
	M400
	G28
	
	{% if printer.configfile.settings.quad_gantry_level %}
	{% if printer.quad_gantry_level.applied == False %}
	QUAD_GANTRY_LEVEL
	G28 Z
	{% endif %}
	{% endif %}
	
	G90
	G1 X{printer.toolhead.axis_maximum.x-50} Y{printer.toolhead.axis_maximum.y-50} F{30*60}
	M400
	G28 X Y
	G0 X{printer.toolhead.axis_maximum.x-1} Y{printer.toolhead.axis_maximum.y-1} F{30*60}
	G4 P1000
	GET_POSITION
	
	
	G0 X{x_min} Y{y_min} Z{bound + 10} F{speed*60}
	
	
	{% if printer.configfile.settings.printer.minimum_cruise_ratio is defined %}
	SET_VELOCITY_LIMIT VELOCITY={speed} ACCEL={accel} MINIMUM_CRUISE_RATIO={min_cruise_ratio}
	{% else %}
	SET_VELOCITY_LIMIT VELOCITY={speed} ACCEL={accel} ACCEL_TO_DECEL={accel / 2}
	{% endif %}
	
	{% for i in range(iterations) %}
	
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_max} Y{y_max} F{speed*60}
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	G0 X{x_min} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	
	
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_min} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	
	
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_max} Y{y_center_max} F{speed*60}
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	G0 X{x_center_min} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	
	
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_min} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	{% endfor %}
	
	
	{% if printer.configfile.settings.printer.minimum_cruise_ratio is defined %}
	SET_VELOCITY_LIMIT VELOCITY={printer.configfile.settings.printer.max_velocity} ACCEL={printer.configfile.settings.printer.max_accel} MINIMUM_CRUISE_RATIO={printer.configfile.settings.printer.minimum_cruise_ratio}
	{% else %}
	SET_VELOCITY_LIMIT VELOCITY={printer.configfile.settings.printer.max_velocity} ACCEL={printer.configfile.settings.printer.max_accel} ACCEL_TO_DECEL={printer.configfile.settings.printer.max_accel_to_decel}
	{% endif %}
	
	
	M400
	G28
	
	G90
	G0 X{printer.toolhead.axis_maximum.x-1} Y{printer.toolhead.axis_maximum.y-1} F{30*60}
	G4 P1000
	GET_POSITION
	
	
	RESTORE_GCODE_STATE NAME=TEST_SPEED

[gcode_macro GET_TIMELAPSE_SETUP]
description = Print the Timelapse setup
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% set output_txt = ["Timelapse Setup:"] %}
	{% set _dummy = output_txt.append("enable: %s" % tl.enable) %}
	{% set _dummy = output_txt.append("park: %s" % tl.park.enable) %}
	{% if tl.park.enable %}
	{% set _dummy = output_txt.append("park position: %s time: %s s" % (tl.park.pos, tl.park.time)) %}
	{% set _dummy = output_txt.append("park cord x:%s y:%s dz:%s" % (tl.park.coord.x, tl.park.coord.y, tl.park.coord.dz)) %}
	{% set _dummy = output_txt.append("travel speed: %s mm/s" % tl.speed.travel) %}
	{% endif %}
	{% set _dummy = output_txt.append("fw_retract: %s" % tl.extruder.fw_retract) %}
	{% if not tl.extruder.fw_retract %}
	{% set _dummy = output_txt.append("retract: %s mm speed: %s mm/s" % (tl.extruder.retract, tl.speed.retract)) %}
	{% set _dummy = output_txt.append("extrude: %s mm speed: %s mm/s" % (tl.extruder.extrude, tl.speed.extrude)) %}
	{% endif %}
	{% set _dummy = output_txt.append("verbose: %s" % tl.verbose) %}
	{action_respond_info(output_txt|join("\n"))}

[gcode_macro _SET_TIMELAPSE_SETUP]
description = Set user parameters for timelapse
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	
	{% set min = printer.toolhead.axis_minimum %}
	{% set max = printer.toolhead.axis_maximum %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	{% set park = {'min'   : {'x': (min.x / 1.42)|round(3) if round_bed else min.x|round(3),
	'y': (min.y / 1.42)|round(3) if round_bed else min.y|round(3)},
	'max'   : {'x': (max.x / 1.42)|round(3) if round_bed else max.x|round(3),
	'y': (max.y / 1.42)|round(3) if round_bed else max.y|round(3)},
	'center': {'x': (max.x-(max.x-min.x)/2)|round(3),
	'y': (max.y-(max.y-min.y)/2)|round(3)}} %}
	
	{% if params.ENABLE %}
	{% if params.ENABLE|lower is in ['true', 'false'] %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=enable VALUE={True if params.ENABLE|lower == 'true' else False}
	{% else %}
	{action_raise_error("ENABLE=%s not supported. Allowed values are [True, False]" % params.ENABLE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.VERBOSE %}
	{% if params.VERBOSE|lower is in ['true', 'false'] %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=verbose VALUE={True if params.VERBOSE|lower == 'true' else False}
	{% else %}
	{action_raise_error("VERBOSE=%s not supported. Allowed values are [True, False]" % params.VERBOSE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_X %}
	{% if params.CUSTOM_POS_X|float >= min.x and params.CUSTOM_POS_X|float <= max.x %}
	{% set _dummy = tl.park.custom.update({'x':params.CUSTOM_POS_X|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_X=%s must be within [%s - %s]" % (params.CUSTOM_POS_X, min.x, max.x))}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_Y %}
	{% if params.CUSTOM_POS_Y|float >= min.y and params.CUSTOM_POS_Y|float <= max.y %}
	{% set _dummy = tl.park.custom.update({'y':params.CUSTOM_POS_Y|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_Y=%s must be within [%s - %s]" % (params.CUSTOM_POS_Y, min.y, max.y))}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_DZ %}
	{% if params.CUSTOM_POS_DZ|float >= min.z and params.CUSTOM_POS_DZ|float <= max.z %}
	{% set _dummy = tl.park.custom.update({'dz':params.CUSTOM_POS_DZ|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_DZ=%s must be within [%s - %s]" % (params.CUSTOM_POS_DZ, min.z, max.z))}
	{% endif %}
	{% endif %}
	{% if params.PARK_ENABLE %}
	{% if params.PARK_ENABLE|lower is in ['true', 'false'] %}
	{% set _dummy = tl.park.update({'enable':True if params.PARK_ENABLE|lower == 'true' else False}) %}
	{% else %}
	{action_raise_error("PARK_ENABLE=%s not supported. Allowed values are [True, False]" % params.PARK_ENABLE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.PARK_POS %}
	{% if params.PARK_POS|lower is in ['center','front_left','front_right','back_left','back_right','custom','x_only','y_only'] %}
	{% set dic = {'center'      : {'x': park.center.x   , 'y': park.center.y   , 'dz': 1                },
	'front_left'  : {'x': park.min.x      , 'y': park.min.y      , 'dz': 0                },
	'front_right' : {'x': park.max.x      , 'y': park.min.y      , 'dz': 0                },
	'back_left'   : {'x': park.min.x      , 'y': park.max.y      , 'dz': 0                },
	'back_right'  : {'x': park.max.x      , 'y': park.max.y      , 'dz': 0                },
	'custom'      : {'x': tl.park.custom.x, 'y': tl.park.custom.y, 'dz': tl.park.custom.dz},
	'x_only'      : {'x': tl.park.custom.x, 'y': 'none'          , 'dz': tl.park.custom.dz},
	'y_only'      : {'x': 'none'          , 'y': tl.park.custom.y, 'dz': tl.park.custom.dz}} %}
	{% set _dummy = tl.park.update({'pos':params.PARK_POS|lower}) %}
	{% set _dummy = tl.park.update({'coord':dic[tl.park.pos]}) %}
	{% else %}
	{action_raise_error("PARK_POS=%s not supported. Allowed values are [CENTER, FRONT_LEFT, FRONT_RIGHT, BACK_LEFT, BACK_RIGHT, CUSTOM, X_ONLY, Y_ONLY]"
	% params.PARK_POS|upper)}
	{% endif %}
	{% endif %}
	{% if params.PARK_TIME %}
	{% if params.PARK_TIME|float >= 0.0 %}
	{% set _dummy = tl.park.update({'time':params.PARK_TIME|float|round(3)}) %}
	{% else %}
	{action_raise_error("PARK_TIME=%s must be a positive number" % params.PARK_TIME)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=park VALUE="{tl.park}"
	{% if params.TRAVEL_SPEED %}
	{% if params.TRAVEL_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'travel':params.TRAVEL_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("TRAVEL_SPEED=%s must be larger than 0" % params.TRAVEL_SPEED)}
	{% endif %}
	{% endif %}
	{% if params.RETRACT_SPEED %}
	{% if params.RETRACT_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'retract':params.RETRACT_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("RETRACT_SPEED=%s must be larger than 0" % params.RETRACT_SPEED)}
	{% endif %}
	{% endif %}
	{% if params.EXTRUDE_SPEED %}
	{% if params.EXTRUDE_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'extrude':params.EXTRUDE_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("EXTRUDE_SPEED=%s must be larger than 0" % params.EXTRUDE_SPEED)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=speed VALUE="{tl.speed}"
	{% if params.EXTRUDE_DISTANCE %}
	{% if params.EXTRUDE_DISTANCE|float >= 0.0 %}
	{% set _dummy = tl.extruder.update({'extrude':params.EXTRUDE_DISTANCE|float|round(3)}) %}
	{% else %}
	{action_raise_error("EXTRUDE_DISTANCE=%s must be specified as positiv number" % params.EXTRUDE_DISTANCE)}
	{% endif %}
	{% endif %}
	{% if params.RETRACT_DISTANCE %}
	{% if params.RETRACT_DISTANCE|float >= 0.0 %}
	{% set _dummy = tl.extruder.update({'retract':params.RETRACT_DISTANCE|float|round(3)}) %}
	{% else %}
	{action_raise_error("RETRACT_DISTANCE=%s must be specified as positiv number" % params.RETRACT_DISTANCE)}
	{% endif %}
	{% endif %}
	{% if params.FW_RETRACT %}
	{% if params.FW_RETRACT|lower is in ['true', 'false'] %}
	{% if 'firmware_retraction' in printer.configfile.settings %}
	{% set _dummy = tl.extruder.update({'fw_retract': True if params.FW_RETRACT|lower == 'true' else False}) %}
	{% else %}
	{% set _dummy = tl.extruder.update({'fw_retract':False}) %}
	{% if params.FW_RETRACT|capitalize == 'True' %}
	{action_raise_error("[firmware_retraction] not defined in printer.cfg. Can not enable fw_retract")}
	{% endif %}
	{% endif %}
	{% else %}
	{action_raise_error("FW_RETRACT=%s not supported. Allowed values are [True, False]" % params.FW_RETRACT|capitalize)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=extruder VALUE="{tl.extruder}"
	{% if printer.configfile.settings['gcode_macro pause'] is defined %}
	{% set _dummy = tl.macro.update({'pause': printer.configfile.settings['gcode_macro pause'].rename_existing}) %}
	{% endif %}
	{% if printer.configfile.settings['gcode_macro resume'] is defined %}
	{% set _dummy = tl.macro.update({'resume': printer.configfile.settings['gcode_macro resume'].rename_existing}) %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=macro VALUE="{tl.macro}"

[gcode_macro TIMELAPSE_TAKE_FRAME]
description = Take Timelapse shoot
variable_enable = False
variable_takingframe = False
variable_park = {'enable': False,
	'pos'   : 'center',
	'time'  : 0.1,
	'custom': {'x': 0, 'y': 0, 'dz': 0},
	'coord' : {'x': 0, 'y': 0, 'dz': 0}}
variable_extruder = {'fw_retract': False,
	'retract': 1.0,
	'extrude': 1.0}
variable_speed = {'travel': 100,
	'retract': 15,
	'extrude': 15}
variable_verbose = True
variable_check_time = 0.5
variable_restore = {'absolute': {'coordinates': True, 'extrude': True}, 'speed': 1500, 'e':0, 'factor': {'speed': 1.0, 'extrude': 1.0}}
variable_macro = {'pause': 'PAUSE', 'resume': 'RESUME'}
variable_is_paused = False
gcode = 
	{% set hyperlapse = True if params.HYPERLAPSE and params.HYPERLAPSE|lower =='true' else False %}
	{% if enable %}
	{% if (hyperlapse and printer['gcode_macro HYPERLAPSE'].run) or
	(not hyperlapse and not printer['gcode_macro HYPERLAPSE'].run) %}
	{% if park.enable %}
	{% set pos = {'x': 'X' + park.coord.x|string if park.pos != 'y_only' else '',
	'y': 'Y' + park.coord.y|string if park.pos != 'x_only' else '',
	'z': 'Z'+ [printer.gcode_move.gcode_position.z + park.coord.dz, printer.toolhead.axis_maximum.z]|min|string} %}
	{% set restore = {'absolute': {'coordinates': printer.gcode_move.absolute_coordinates,
	'extrude'    : printer.gcode_move.absolute_extrude},
	'speed'   : printer.gcode_move.speed,
	'e'       : printer.gcode_move.gcode_position.e,
	'factor'  : {'speed'  : printer.gcode_move.speed_factor,
	'extrude': printer.gcode_move.extrude_factor}} %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=restore VALUE="{restore}"
	{% if not printer[printer.toolhead.extruder].can_extrude %}
	{% if verbose %}{action_respond_info("Timelapse: Warning, minimum extruder temperature not reached!")}{% endif %}
	{% else %}
	{% if extruder.fw_retract %}
	G10
	{% else %}
	M83
	G0 E-{extruder.retract} F{speed.retract * 60}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=is_paused VALUE=True
	{macro.pause}
	SET_GCODE_OFFSET X=0 Y=0
	G90
	{% if "xyz" not in printer.toolhead.homed_axes %}
	{% if verbose %}{action_respond_info("Timelapse: Warning, axis not homed yet!")}{% endif %}
	{% else %}
	G0 {pos.x} {pos.y} {pos.z} F{speed.travel * 60}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=takingframe VALUE=True
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_TAKE_FRAME DURATION={check_time}
	M400
	{% endif %}
	_TIMELAPSE_NEW_FRAME HYPERLAPSE={hyperlapse}
	{% endif %}
	{% else %}
	{% if verbose %}{action_respond_info("Timelapse: disabled, take frame ignored")}{% endif %}
	{% endif %}

[gcode_macro _TIMELAPSE_NEW_FRAME]
description = action call for timelapse shoot. must be a seperate macro
gcode = 
	{action_call_remote_method("timelapse_newframe",
	macropark=printer['gcode_macro TIMELAPSE_TAKE_FRAME'].park,
	hyperlapse=params.HYPERLAPSE)}

[delayed_gcode _WAIT_TIMELAPSE_TAKE_FRAME]
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% set factor = {'speed': printer.gcode_move.speed_factor, 'extrude': printer.gcode_move.extrude_factor} %}
	{% if tl.takingframe %}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_TAKE_FRAME DURATION={tl.check_time}
	{% else %}
	{tl.macro.resume} VELOCITY={tl.speed.travel}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=is_paused VALUE=False
	{% if not printer[printer.toolhead.extruder].can_extrude %}
	{action_respond_info("Timelapse: Warning minimum extruder temperature not reached!")}
	{% else %}
	{% if tl.extruder.fw_retract %}
	G11
	{% else %}
	G0 E{tl.extruder.extrude} F{tl.speed.extrude * 60}
	G0 F{tl.restore.speed}
	{% if tl.restore.absolute.extrude %}
	M82
	G92 E{tl.restore.e}
	{% endif %}
	{% endif %}
	{% endif %}
	{% if tl.restore.factor.speed   != factor.speed   %} M220 S{(factor.speed*100)|round(0)}   {% endif %}
	{% if tl.restore.factor.extrude != factor.extrude %} M221 S{(factor.extrude*100)|round(0)} {% endif %}
	{% if not tl.restore.absolute.coordinates %} G91 {% endif %}
	{% endif %}

[gcode_macro HYPERLAPSE]
description = Start/Stop a hyperlapse recording
variable_cycle = 0
variable_run = False
gcode = 
	{% set cycle = params.CYCLE|default(30)|int %}
	{% if params.ACTION and params.ACTION|lower == 'start' %}
	{action_respond_info("Hyperlapse: frames started (Cycle %d sec)" % cycle)}
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=run VALUE=True
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=cycle VALUE={cycle}
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION={cycle}
	TIMELAPSE_TAKE_FRAME HYPERLAPSE=True
	{% elif params.ACTION and params.ACTION|lower == 'stop' %}
	{% if run %}{action_respond_info("Hyperlapse: frames stopped")}{% endif %}
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=run VALUE=False
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION=0
	{% else %}
	{action_raise_error("Hyperlapse: No valid input parameter
	Use:
	- HYPERLAPSE ACTION=START [CYCLE=time]
	- HYPERLAPSE ACTION=STOP")}
	{% endif %}

[delayed_gcode _HYPERLAPSE_LOOP]
gcode = 
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION={printer["gcode_macro HYPERLAPSE"].cycle}
	TIMELAPSE_TAKE_FRAME HYPERLAPSE=True

[gcode_macro TIMELAPSE_RENDER]
description = Render Timelapse video and wait for the result
variable_render = False
variable_run_identifier = 0
gcode = 
	{action_respond_info("Timelapse: Rendering started")}
	{action_call_remote_method("timelapse_render", byrendermacro="True")}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_RENDER VARIABLE=render VALUE=True
	{printer.configfile.settings['gcode_macro pause'].rename_existing}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_RENDER DURATION=0.5

[delayed_gcode _WAIT_TIMELAPSE_RENDER]
gcode = 
	{% set ri = printer['gcode_macro TIMELAPSE_RENDER'].run_identifier % 4 %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_RENDER VARIABLE=run_identifier VALUE={ri + 1}
	{% if printer['gcode_macro TIMELAPSE_RENDER'].render %}
	M117 Rendering {['-','\\','|','/'][ri]}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_RENDER DURATION=0.5
	{% else %}
	{action_respond_info("Timelapse: Rendering finished")}
	M117
	{printer.configfile.settings['gcode_macro resume'].rename_existing}
	{% endif %}

[gcode_macro TEST_STREAM_DELAY]
description = Helper macro to find stream and park delay
gcode = 
	{% set min = printer.toolhead.axis_minimum %}
	{% set max = printer.toolhead.axis_maximum %}
	{% set act = printer.toolhead.position %}
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% if act.z > 5.0 %}
	G0 X{min.x + 5.0} F{tl.speed.travel|int * 60}
	G0 X{(max.x-min.x)/2}
	G4 P{tl.park.time|float * 1000}
	_TIMELAPSE_NEW_FRAME HYPERLAPSE=FALSE
	G0 X{max.x - 5.0}
	{% else %}
	{action_raise_error("Toolhead z %.3f to low. Please place head above z = 5.0" % act.z)}
	{% endif %}

[gcode_macro _OBICO_LAYER_CHANGE]
description = Run a scan across the current print area
variable_first_layer_scan_retract_length = 6
variable_first_layer_scan_retract_speed = 15
variable_first_layer_scan_cooldown_temp = 170
variable_first_layer_scan_resume_speed = 50
variable_first_layer_scan_enabled = True
variable_first_layer_scan_stepover = 10
variable_first_layer_scan_speed = 10
variable_first_layer_scan_zhop = 4
variable_first_layer_scan_zhop_speed = 15
variable_verbose = False
variable_current_layer = -1
variable_first_layer_scanning = False
variable_wait = {'resume': "RESUME", 'absolute_coordinates': True, 'absolute_extrude': True, 'e': 0.0, 'previous_temp': 0}
gcode = 
	
	{% set pause_macro  = "PAUSE"  if printer.configfile.settings['gcode_macro pause']  is not defined
	else printer.configfile.settings['gcode_macro pause'].rename_existing %}
	{% set resume_macro = "RESUME" if printer.configfile.settings['gcode_macro resume'] is not defined
	else printer.configfile.settings['gcode_macro resume'].rename_existing %}
	
	{% set current_layer_default = printer.print_stats.info.current_layer if printer.print_stats.info.current_layer is not none else -1 %}
	{% set current_layer = params.CURRENT_LAYER|default(current_layer_default)|int %}
	
	{% set polygon_points = printer.exclude_object.objects|map(attribute='polygon')|sum(start=[]) if printer.exclude_object is defined else [] %}
	{% set min_x = params.MINX|default(polygon_points|map(attribute=0)|min|default(printer.toolhead.axis_minimum.x))|float %}
	{% set min_y = params.MINY|default(polygon_points|map(attribute=1)|min|default(printer.toolhead.axis_minimum.y))|float %}
	{% set max_x = params.MAXX|default(polygon_points|map(attribute=0)|max|default(printer.toolhead.axis_maximum.x))|float %}
	{% set max_y = params.MAXY|default(polygon_points|map(attribute=1)|max|default(printer.toolhead.axis_maximum.y))|float %}
	
	{% set stepoverCount = ((max_y - min_y) / first_layer_scan_stepover|float)|round(method='ceil')|int %}
	
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Layer %d" % (current_layer)}' {% endif %}
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=current_layer VALUE={current_layer}
	
	{% if first_layer_scan_enabled and current_layer == 2 %}
	
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=first_layer_scanning VALUE=True
	
	
	{% set wait_dic = {'resume'              : resume_macro,
	'absolute_coordinates': printer.gcode_move.absolute_coordinates,
	'absolute_extrude'    : printer.gcode_move.absolute_extrude,
	'e'                   : printer.gcode_move.gcode_position.e,
	'previous_temp'       : printer.extruder.target} %}
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=wait VALUE="{wait_dic}"
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Prepare scanning" {% endif %}
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Scan Coordinates: Min:[%.3f:%.3f] Max:[%.3f:%.3f]" % (min_x,min_y,max_x,max_y)}' {% endif %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Retract %.1fmm filament" % first_layer_scan_retract_length|abs}' {% endif %}
	M83
	G0 E-{first_layer_scan_retract_length|abs} F{first_layer_scan_retract_speed|float * 60}
	{% endif %}
	G91
	G0 Z{first_layer_scan_zhop|abs} F{first_layer_scan_zhop_speed|float * 60}
	
	
	M106 S255
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Fan on and lowering temperature to %.1f" % first_layer_scan_cooldown_temp}' {% endif %}
	M104 S{first_layer_scan_cooldown_temp}
	M109 S{first_layer_scan_cooldown_temp}
	
	{pause_macro}
	
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Start scanning" {% endif %}
	
	UPDATE_DELAYED_GCODE ID=_WAIT_OBICO_LAYER_CHANGE DURATION=1.0
	G90
	G0 X{min_x} Y{min_y} F{first_layer_scan_resume_speed|float * 60}
	{% for ystep in range(stepoverCount) %}
	G0 Y{min_y + first_layer_scan_stepover|float * ystep} F{first_layer_scan_speed|float * 60}
	G0 X{max_x if ystep % 2 == 0 else min_x}              F{first_layer_scan_speed|float * 60}
	{% endfor %}
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Finish scanning" {% endif %}
	
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=first_layer_scanning VALUE=False
	
	{% endif %}

[delayed_gcode _WAIT_OBICO_LAYER_CHANGE]
gcode = 
	{% set lc_macro = printer['gcode_macro _OBICO_LAYER_CHANGE'] %}
	{% if lc_macro.first_layer_scanning %}
	
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Waiting for first layer scan..." {% endif %}
	UPDATE_DELAYED_GCODE ID=_WAIT_OBICO_LAYER_CHANGE DURATION=1.0
	{% else %}
	
	M107
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Fan off and resume print" {% endif %}
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Call %s VELOCITY=%.1f" % (lc_macro.wait.resume, lc_macro.first_layer_scan_resume_speed)}' {% endif %}
	{lc_macro.wait.resume} VELOCITY={lc_macro.first_layer_scan_resume_speed}
	G91
	G0 Z-{lc_macro.first_layer_scan_zhop|abs} F{lc_macro.first_layer_scan_zhop_speed|float * 60}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% set first_layer_scan_unretract_length = lc_macro.first_layer_scan_retract_length + 0.5 %}
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Extrude %.1fmm filament" % first_layer_scan_unretract_length|abs}' {% endif %}
	M83
	G0 E{first_layer_scan_unretract_length|abs} F{lc_macro.first_layer_scan_retract_speed|float * 60}
	{% endif %}
	
	
	M104 S{lc_macro.wait.previous_temp}
	M109 S{lc_macro.wait.previous_temp}
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Heating back up to previous temperature"}' {% endif %}
	
	
	{% if lc_macro.wait.absolute_coordinates %} G90 {% endif %}
	{% if lc_macro.wait.absolute_extrude %}
	M82
	G92 E{lc_macro.wait.e}
	{% endif %}
	{% endif %}

[gcode_macro OBICO_LINK_STATUS]
description = Link to Obico server
variable_one_time_passcode = ''
variable_one_time_passlink = ''
variable_is_linked = False
gcode = 
	{action_respond_info('Obico one_time_passcode: {}'.format(one_time_passcode))}
	{action_respond_info('Obico one_time_passlink: {}'.format(one_time_passlink))}
	{action_respond_info('Obico is_linked: {}'.format(is_linked))}
	{% if not is_linked and one_time_passcode != '' %}
	M117 Code: {one_time_passcode}
	{% else %}
	M117 Obico linked
	{% endif %}

[gcode_macro _OBICO_RELINK]
description = Re-link to Obico server
gcode = 
	{action_respond_info('WARNING: Re-link to Obico server')}
	{action_call_remote_method("obico_remote_event", event_name='relink_obico', message='')}
	{action_respond_info('WARNING: relink_obico requested')}

[exclude_object]

[mcu]
serial = /dev/serial/by-id/usb-1a86_USB_Serial-if00-port0
restart_method = command

[temperature_sensor raspberry_pi]
sensor_type = temperature_host
min_temp = 10
max_temp = 100

[temperature_sensor mcu_temp]
sensor_type = temperature_mcu
min_temp = 0
max_temp = 100

[printer]
kinematics = cartesian
max_velocity = 200
max_accel = 4000
max_z_velocity = 10
max_z_accel = 100
minimum_cruise_ratio = 0.5
square_corner_velocity = 5

[stepper_x]
step_pin = PB9
dir_pin = PC2
enable_pin = !PC3
microsteps = 16
rotation_distance = 40
endstop_pin = ^PA5
position_endstop = 0
position_max = 230
homing_speed = 50

[stepper_y]
step_pin = PB7
dir_pin = PB8
enable_pin = !PC3
microsteps = 16
rotation_distance = 40
endstop_pin = ^PA6
position_endstop = 0
position_max = 231
homing_speed = 50

[stepper_z]
step_pin = PB5
dir_pin = !PB6
enable_pin = !PC3
microsteps = 16
rotation_distance = 8
endstop_pin = probe:z_virtual_endstop
position_max = 250
position_min = -4
homing_speed = 4
second_homing_speed = 1
homing_retract_dist = 2.0

[fan]
pin = PA0

[extruder]
max_extrude_only_distance = 100.0
step_pin = PB3
dir_pin = PB4
enable_pin = !PC3
microsteps = 16
gear_ratio = 42:12
rotation_distance = 26.359
nozzle_diameter = 0.400
filament_diameter = 1.750
heater_pin = PA1
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PC5
min_temp = 0
max_temp = 300
min_extrude_temp = 170
pressure_advance = .0369
pressure_advance_smooth_time = 0.04
control = pid
pid_kp = 19.195
pid_ki = 1.000
pid_kd = 92.135

[firmware_retraction]
retract_length = 0.3
retract_speed = 20

[idle_timeout]
gcode = 
	{% if printer.pause_resume.is_paused %}
	M118 Idle timeout while paused, turning off hotend
	SET_HEATER_TEMPERATURE HEATER=extruder TARGET=0
	{% else %}
	M118 Idle timeout
	TURN_OFF_HEATERS
	M84
	{% endif %}
timeout = 1800

[heater_bed]
heater_pin = PA2
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PC4
min_temp = 0
max_temp = 130
control = pid
pid_kp = 68.601
pid_ki = 1.185
pid_kd = 993.000

[bltouch]
sensor_pin = ^PB1
control_pin = PB0
x_offset = -31.8
y_offset = -40.5
speed = 35
samples = 2
samples_result = median
samples_tolerance = 0.05
samples_tolerance_retries = 2
sample_retract_dist = 5.0
probe_with_touch_mode = true
stow_on_each_sample = false
z_offset = 2.049

[safe_z_home]
home_xy_position = 147, 154
speed = 75
z_hop = 10
z_hop_speed = 5
move_to_previous = false

[bed_screws]
screw1 = 30,51
screw1_name = "FL"
screw2 = 200,51
screw2_name = "FR"
screw3 = 200,195
screw3_name = "RR"
screw4 = 30,195
screw4_name = "RL"

[screws_tilt_adjust]
screw1 = 67, 67
screw1_name = front left screw
screw2 = 230, 67
screw2_name = front right screw
screw3 = 230, 230
screw3_name = rear right screw
screw4 = 67.60, 230
screw4_name = rear left screw
horizontal_move_z = 10
speed = 200
screw_thread = CW-M4

[bed_mesh]
speed = 120
mesh_min = 10,11
mesh_max = 195,182
probe_count = 3,3
algorithm = bicubic
fade_start = 1
fade_end = 10
fade_target = 0

[filament_motion_sensor SFS_T0]
detection_length = 150.00
extruder = extruder
switch_pin = PA4
pause_on_runout = True
event_delay = 3.0
pause_delay = 0.5
runout_gcode = 
	M117 Runout Detected!

[delayed_gcode DISABLEFILAMENTSENSOR]
initial_duration = 1
gcode = 
	SET_FILAMENT_SENSOR SENSOR=SFS_T0 ENABLE=0

[gcode_macro SFS_ENABLE]
description = Enable smart filament sensor
gcode = 
	M117 ENABLING the Smart Filament Sensor
	G92 E0
	SET_FILAMENT_SENSOR SENSOR=SFS_T0 ENABLE=1

[gcode_macro SFS_DISABLE]
description = Disable smart filament sensor
gcode = 
	M117 DISABLING the Smart Filament Sensor
	G92 E0
	SET_FILAMENT_SENSOR SENSOR=SFS_T0 ENABLE=0

[gcode_macro FILAMENT_RUNOUT]
gcode = 
	M117 Runout Detected!
	M300 S1 P10
	M600
	M300 S1 P10

[gcode_macro M300]
gcode = 
	{% set S = params.S|default(1000)|int %}
	{% set P = params.P|default(100)|int %}
	SET_PIN PIN=BEEPER VALUE=0.5 CYCLE_TIME={ 1.0/S if S > 0 else 1 }
	G4 P{P}
	SET_PIN PIN=BEEPER VALUE=0
	[gcode_macro M600]
	gcode:
	{% set X = params.X|default(25)|float %}
	{% set Y = params.Y|default(25)|float %}
	{% set Z = params.Z|default(10)|float %}
	SAVE_GCODE_STATE NAME=M600_state
	PAUSE
	G91
	G1 E-.8 F2700
	G1 Z{Z}
	G90
	G1 X{X} Y{Y} F3000
	G91
	G1 E-15 F1000
	RESTORE_GCODE_STATE NAME=M600_state

[gcode_arcs]
resolution = 1.0

[input_shaper]
shaper_freq_x = 73.5
shaper_type_x = ei
shaper_freq_y = 76.9
shaper_type_y = mzv
=======================
bed_mesh: bicubic interpolation with a probe_count of less than 4 points detected.  Forcing lagrange interpolation. Configured Probe Count: 3, 3
Extruder max_extrude_ratio=0.266081
mcu 'mcu': Starting serial connect
mcu 'mcu': got {'oid': 10, 'next_clock': 1049616896, 'value': 14018, '#name': 'analog_in_state', '#sent_time': 45.717423454, '#receive_time': 45.726526306000004}
mcu 'mcu': got {'oid': 12, 'next_clock': 1051056896, 'value': 31557, '#name': 'analog_in_state', '#sent_time': 45.717423454, '#receive_time': 45.746489695}
mcu 'mcu': got {'oid': 17, 'next_clock': 1054656896, 'value': 31511, '#name': 'analog_in_state', '#sent_time': 45.771783157, '#receive_time': 45.796602028}
mcu 'mcu': got {'oid': 10, 'next_clock': 1071216896, 'value': 14014, '#name': 'analog_in_state', '#sent_time': 45.989012527999996, '#receive_time': 46.026586824}
mcu 'mcu': got {'oid': 12, 'next_clock': 1072656896, 'value': 31560, '#name': 'analog_in_state', '#sent_time': 46.043555231, '#receive_time': 46.046599065}
Loaded MCU 'mcu' 119 commands (v0.12.0-286-g81de9a861 / gcc: (15:8-2019-q3-1+b1) 8.3.1 20190703 (release) [gcc-8-branch revision 273027] binutils: (2.35.2-2+14+b2) 2.35.2)
MCU 'mcu' config: ADC_MAX=4095 BUS_PINS_i2c1=PB6,PB7 BUS_PINS_i2c1a=PB8,PB9 BUS_PINS_i2c2=PB10,PB11 BUS_PINS_spi1=PA6,PA7,PA5 BUS_PINS_spi1a=PB4,PB5,PB3 BUS_PINS_spi2=PB14,PB15,PB13 BUS_PINS_spi3=PB4,PB5,PB3 CLOCK_FREQ=72000000 MCU=stm32f103xe PWM_MAX=255 RECEIVE_WINDOW=192 RESERVE_PINS_serial=PA10,PA9 SERIAL_BAUD=250000 STATS_SUMSQ_BASE=256 STEPPER_BOTH_EDGE=1
mcu_temperature 'mcu' nominal base=357.558140 slope=-767.441860
Configured MCU 'mcu' (1024 moves)
Starting heater checks for heater_bed
webhooks client 547583321616: New connection
bed_mesh: generated points
Index |  Tool Adjusted  |   Probe
  0   | (41.8, 51.5)    | (10.0, 11.0)
  1   | (134.3, 51.5)   | (102.5, 11.0)
  2   | (226.8, 51.5)   | (195.0, 11.0)
  3   | (226.8, 137.0)  | (195.0, 96.5)
  4   | (134.3, 137.0)  | (102.5, 96.5)
  5   | (41.8, 137.0)   | (10.0, 96.5)
  6   | (41.8, 222.5)   | (10.0, 182.0)
  7   | (134.3, 222.5)  | (102.5, 182.0)
  8   | (226.8, 222.5)  | (195.0, 182.0)
Starting heater checks for extruder
Stats 47.1: gcodein=0  mcu: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=1133 bytes_read=4635 bytes_retransmit=9 bytes_invalid=0 send_seq=122 receive_seq=122 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000098  raspberry_pi: temp=59.4 mcu_temp: temp=0.0 heater_bed: target=0 temp=0.0 pwm=0.000 sysload=1.69 cputime=2.054 memavail=1500040 print_time=105839.116 buffer_time=0.249 print_stall=0 extruder: target=0 temp=0.0 pwm=0.000
webhooks client 547583321616: Client info {'program': 'Moonraker', 'version': 'v0.9.3-3-gccfe32f'}
webhooks: registering remote method 'shutdown_machine' for connection id: 547583321616
webhooks: registering remote method 'reboot_machine' for connection id: 547583321616
webhooks: registering remote method 'pause_job_queue' for connection id: 547583321616
webhooks: registering remote method 'start_job_queue' for connection id: 547583321616
webhooks: registering remote method 'spoolman_set_active_spool' for connection id: 547583321616
webhooks: registering remote method 'obico_remote_event' for connection id: 547583321616
Stats 48.1: gcodein=0  mcu: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=1139 bytes_read=4786 bytes_retransmit=9 bytes_invalid=0 send_seq=123 receive_seq=123 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000746  raspberry_pi: temp=60.9 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.69 cputime=2.089 memavail=1473736 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 49.1: gcodein=0  mcu: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=1145 bytes_read=4937 bytes_retransmit=9 bytes_invalid=0 send_seq=124 receive_seq=124 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72001144  raspberry_pi: temp=59.4 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.69 cputime=2.111 memavail=1503216 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 50.1: gcodein=0  mcu: mcu_awake=0.006 mcu_task_avg=0.000028 mcu_task_stddev=0.000013 bytes_write=1151 bytes_read=5133 bytes_retransmit=9 bytes_invalid=0 send_seq=125 receive_seq=125 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000767  raspberry_pi: temp=60.4 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.95 cputime=2.133 memavail=1563092 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 51.1: gcodein=0  mcu: mcu_awake=0.006 mcu_task_avg=0.000028 mcu_task_stddev=0.000013 bytes_write=1157 bytes_read=5299 bytes_retransmit=9 bytes_invalid=0 send_seq=126 receive_seq=126 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000420  raspberry_pi: temp=59.4 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.95 cputime=2.144 memavail=1559316 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 52.1: gcodein=0  mcu: mcu_awake=0.006 mcu_task_avg=0.000028 mcu_task_stddev=0.000013 bytes_write=1163 bytes_read=5450 bytes_retransmit=9 bytes_invalid=0 send_seq=127 receive_seq=127 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000452  raspberry_pi: temp=59.4 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.2 pwm=0.000 sysload=1.95 cputime=2.155 memavail=1526316 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.1 pwm=0.000
Stats 53.1: gcodein=0  mcu: mcu_awake=0.006 mcu_task_avg=0.000028 mcu_task_stddev=0.000013 bytes_write=1169 bytes_read=5631 bytes_retransmit=9 bytes_invalid=0 send_seq=128 receive_seq=128 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000453  raspberry_pi: temp=59.4 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.95 cputime=2.167 memavail=1506496 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 54.1: gcodein=0  mcu: mcu_awake=0.006 mcu_task_avg=0.000028 mcu_task_stddev=0.000013 bytes_write=1175 bytes_read=5797 bytes_retransmit=9 bytes_invalid=0 send_seq=129 receive_seq=129 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000341  raspberry_pi: temp=59.4 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.95 cputime=2.177 memavail=1489864 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 55.1: gcodein=0  mcu: mcu_awake=0.006 mcu_task_avg=0.000028 mcu_task_stddev=0.000013 bytes_write=1181 bytes_read=5948 bytes_retransmit=9 bytes_invalid=0 send_seq=130 receive_seq=130 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000276  raspberry_pi: temp=58.4 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.04 cputime=2.188 memavail=1462176 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 56.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1187 bytes_read=6143 bytes_retransmit=9 bytes_invalid=0 send_seq=131 receive_seq=131 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000368  raspberry_pi: temp=59.4 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.04 cputime=2.201 memavail=1494408 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 57.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1193 bytes_read=6309 bytes_retransmit=9 bytes_invalid=0 send_seq=132 receive_seq=132 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000302  raspberry_pi: temp=59.9 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.04 cputime=2.212 memavail=1546860 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 58.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1199 bytes_read=6460 bytes_retransmit=9 bytes_invalid=0 send_seq=133 receive_seq=133 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000275  raspberry_pi: temp=59.9 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.04 cputime=2.222 memavail=1535024 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 59.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1205 bytes_read=6641 bytes_retransmit=9 bytes_invalid=0 send_seq=134 receive_seq=134 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000243  raspberry_pi: temp=58.9 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.04 cputime=2.233 memavail=1510328 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 60.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1211 bytes_read=6807 bytes_retransmit=9 bytes_invalid=0 send_seq=135 receive_seq=135 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000228  raspberry_pi: temp=58.4 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.11 cputime=2.242 memavail=1497224 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 61.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1217 bytes_read=6972 bytes_retransmit=9 bytes_invalid=0 send_seq=136 receive_seq=136 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000212  raspberry_pi: temp=58.9 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.11 cputime=2.252 memavail=1469016 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 62.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1223 bytes_read=7153 bytes_retransmit=9 bytes_invalid=0 send_seq=137 receive_seq=137 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000213  raspberry_pi: temp=58.9 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.11 cputime=2.265 memavail=1496080 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 63.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1229 bytes_read=7319 bytes_retransmit=9 bytes_invalid=0 send_seq=138 receive_seq=138 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000199  raspberry_pi: temp=59.4 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.11 cputime=2.276 memavail=1555488 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 64.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1235 bytes_read=7470 bytes_retransmit=9 bytes_invalid=0 send_seq=139 receive_seq=139 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000197  raspberry_pi: temp=58.4 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.11 cputime=2.286 memavail=1540836 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 65.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1241 bytes_read=7666 bytes_retransmit=9 bytes_invalid=0 send_seq=140 receive_seq=140 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000189  raspberry_pi: temp=58.4 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.18 cputime=2.296 memavail=1518408 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 66.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1247 bytes_read=7831 bytes_retransmit=9 bytes_invalid=0 send_seq=141 receive_seq=141 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000199  raspberry_pi: temp=59.4 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.18 cputime=2.306 memavail=1502536 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 67.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1253 bytes_read=7982 bytes_retransmit=9 bytes_invalid=0 send_seq=142 receive_seq=142 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000207  raspberry_pi: temp=58.4 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.18 cputime=2.315 memavail=1476140 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 68.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1259 bytes_read=8178 bytes_retransmit=9 bytes_invalid=0 send_seq=143 receive_seq=143 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000200  raspberry_pi: temp=59.4 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.18 cputime=2.328 memavail=1456988 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 69.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1265 bytes_read=8329 bytes_retransmit=9 bytes_invalid=0 send_seq=144 receive_seq=144 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000205  raspberry_pi: temp=59.4 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.18 cputime=2.339 memavail=1564616 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 70.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1271 bytes_read=8480 bytes_retransmit=9 bytes_invalid=0 send_seq=145 receive_seq=145 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000199  raspberry_pi: temp=57.5 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.25 cputime=2.349 memavail=1543508 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 71.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1277 bytes_read=8690 bytes_retransmit=9 bytes_invalid=0 send_seq=146 receive_seq=146 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000208  raspberry_pi: temp=59.9 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=2.25 cputime=2.359 memavail=1525868 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 72.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1283 bytes_read=8841 bytes_retransmit=9 bytes_invalid=0 send_seq=147 receive_seq=147 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000205  raspberry_pi: temp=59.9 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.25 cputime=2.369 memavail=1506212 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 73.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1289 bytes_read=8992 bytes_retransmit=9 bytes_invalid=0 send_seq=148 receive_seq=148 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000202  raspberry_pi: temp=60.4 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.25 cputime=2.378 memavail=1480508 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 74.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1295 bytes_read=9188 bytes_retransmit=9 bytes_invalid=0 send_seq=149 receive_seq=149 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000206  raspberry_pi: temp=58.9 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.25 cputime=2.389 memavail=1457836 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 75.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1301 bytes_read=9339 bytes_retransmit=9 bytes_invalid=0 send_seq=150 receive_seq=150 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000205  raspberry_pi: temp=57.9 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.23 cputime=2.400 memavail=1565524 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 76.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1307 bytes_read=9504 bytes_retransmit=9 bytes_invalid=0 send_seq=151 receive_seq=151 retransmit_seq=10 srtt=0.003 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000205  raspberry_pi: temp=58.4 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.23 cputime=2.410 memavail=1543048 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 77.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1313 bytes_read=9700 bytes_retransmit=9 bytes_invalid=0 send_seq=152 receive_seq=152 retransmit_seq=10 srtt=0.003 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000205  raspberry_pi: temp=59.4 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.23 cputime=2.420 memavail=1530708 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 78.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1319 bytes_read=9851 bytes_retransmit=9 bytes_invalid=0 send_seq=153 receive_seq=153 retransmit_seq=10 srtt=0.003 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000206  raspberry_pi: temp=58.9 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=2.23 cputime=2.429 memavail=1508028 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 79.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1325 bytes_read=10002 bytes_retransmit=9 bytes_invalid=0 send_seq=154 receive_seq=154 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000205  raspberry_pi: temp=58.4 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.2 pwm=0.000 sysload=2.23 cputime=2.439 memavail=1489384 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 80.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1331 bytes_read=10198 bytes_retransmit=9 bytes_invalid=0 send_seq=155 receive_seq=155 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000203  raspberry_pi: temp=57.9 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=2.29 cputime=2.449 memavail=1461412 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 81.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1337 bytes_read=10363 bytes_retransmit=9 bytes_invalid=0 send_seq=156 receive_seq=156 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000206  raspberry_pi: temp=57.9 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.29 cputime=2.464 memavail=1495260 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.1 pwm=0.000
Stats 82.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1343 bytes_read=10514 bytes_retransmit=9 bytes_invalid=0 send_seq=157 receive_seq=157 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000201  raspberry_pi: temp=58.9 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.29 cputime=2.473 memavail=1545920 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 83.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1349 bytes_read=10710 bytes_retransmit=9 bytes_invalid=0 send_seq=158 receive_seq=158 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000209  raspberry_pi: temp=57.9 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.29 cputime=2.484 memavail=1534276 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 84.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1355 bytes_read=10861 bytes_retransmit=9 bytes_invalid=0 send_seq=159 receive_seq=159 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000207  raspberry_pi: temp=57.9 mcu_temp: temp=29.4 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.29 cputime=2.494 memavail=1509580 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 85.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1361 bytes_read=11012 bytes_retransmit=9 bytes_invalid=0 send_seq=160 receive_seq=160 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000208  raspberry_pi: temp=58.9 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=2.35 cputime=2.504 memavail=1496476 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 86.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1367 bytes_read=11222 bytes_retransmit=9 bytes_invalid=0 send_seq=161 receive_seq=161 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000211  raspberry_pi: temp=58.9 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.35 cputime=2.515 memavail=1468348 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 87.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1373 bytes_read=11373 bytes_retransmit=9 bytes_invalid=0 send_seq=162 receive_seq=162 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000212  raspberry_pi: temp=58.4 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.35 cputime=2.527 memavail=1495624 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 88.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1379 bytes_read=11524 bytes_retransmit=9 bytes_invalid=0 send_seq=163 receive_seq=163 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000216  raspberry_pi: temp=58.4 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=2.35 cputime=2.538 memavail=1555516 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 89.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1385 bytes_read=11720 bytes_retransmit=9 bytes_invalid=0 send_seq=164 receive_seq=164 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000214  raspberry_pi: temp=59.4 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.35 cputime=2.551 memavail=1539512 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.1 pwm=0.000
Stats 90.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1391 bytes_read=11868 bytes_retransmit=9 bytes_invalid=0 send_seq=165 receive_seq=165 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000213  raspberry_pi: temp=58.4 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.40 cputime=2.570 memavail=1518396 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 91.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1397 bytes_read=12023 bytes_retransmit=9 bytes_invalid=0 send_seq=166 receive_seq=166 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000212  raspberry_pi: temp=58.4 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.40 cputime=2.581 memavail=1501260 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.1 pwm=0.000
Stats 92.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1403 bytes_read=12206 bytes_retransmit=9 bytes_invalid=0 send_seq=167 receive_seq=167 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000211  raspberry_pi: temp=58.9 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=2.40 cputime=2.593 memavail=1475812 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 93.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1409 bytes_read=12347 bytes_retransmit=9 bytes_invalid=0 send_seq=168 receive_seq=168 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000208  raspberry_pi: temp=58.9 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.40 cputime=2.605 memavail=1455404 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 94.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1415 bytes_read=12491 bytes_retransmit=9 bytes_invalid=0 send_seq=169 receive_seq=169 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000211  raspberry_pi: temp=58.4 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.40 cputime=2.617 memavail=1562040 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 95.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1421 bytes_read=12687 bytes_retransmit=9 bytes_invalid=0 send_seq=170 receive_seq=170 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000211  raspberry_pi: temp=59.4 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.40 cputime=2.630 memavail=1541192 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 96.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1427 bytes_read=12852 bytes_retransmit=9 bytes_invalid=0 send_seq=171 receive_seq=171 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000209  raspberry_pi: temp=59.4 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.45 cputime=2.642 memavail=1522808 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 97.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1433 bytes_read=13003 bytes_retransmit=9 bytes_invalid=0 send_seq=172 receive_seq=172 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000208  raspberry_pi: temp=59.4 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.45 cputime=2.655 memavail=1502916 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 98.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1439 bytes_read=13199 bytes_retransmit=9 bytes_invalid=0 send_seq=173 receive_seq=173 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000208  raspberry_pi: temp=58.4 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.2 pwm=0.000 sysload=2.45 cputime=2.668 memavail=1478356 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 99.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1445 bytes_read=13350 bytes_retransmit=9 bytes_invalid=0 send_seq=174 receive_seq=174 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000207  raspberry_pi: temp=58.9 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.45 cputime=2.681 memavail=1455172 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 100.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1451 bytes_read=13501 bytes_retransmit=9 bytes_invalid=0 send_seq=175 receive_seq=175 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000213  raspberry_pi: temp=58.4 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.45 cputime=2.695 memavail=1565568 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.1 pwm=0.000
Stats 101.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1457 bytes_read=13711 bytes_retransmit=9 bytes_invalid=0 send_seq=176 receive_seq=176 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000209  raspberry_pi: temp=58.4 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.25 cputime=2.708 memavail=1542612 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 102.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1463 bytes_read=13862 bytes_retransmit=9 bytes_invalid=0 send_seq=177 receive_seq=177 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000209  raspberry_pi: temp=59.4 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.25 cputime=2.720 memavail=1532096 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 103.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1469 bytes_read=14013 bytes_retransmit=9 bytes_invalid=0 send_seq=178 receive_seq=178 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000208  raspberry_pi: temp=58.4 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.25 cputime=2.731 memavail=1508436 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 104.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1475 bytes_read=14209 bytes_retransmit=9 bytes_invalid=0 send_seq=179 receive_seq=179 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000206  raspberry_pi: temp=58.4 mcu_temp: temp=29.4 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.25 cputime=2.745 memavail=1493316 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.1 pwm=0.000
Stats 105.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1481 bytes_read=14360 bytes_retransmit=9 bytes_invalid=0 send_seq=180 receive_seq=180 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000206  raspberry_pi: temp=59.4 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.15 cputime=2.758 memavail=1463844 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 106.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1493 bytes_read=14541 bytes_retransmit=9 bytes_invalid=0 send_seq=182 receive_seq=182 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000213  raspberry_pi: temp=58.4 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.15 cputime=2.774 memavail=1494796 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 107.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1499 bytes_read=14737 bytes_retransmit=9 bytes_invalid=0 send_seq=183 receive_seq=183 retransmit_seq=10 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000210  raspberry_pi: temp=58.4 mcu_temp: temp=29.4 heater_bed: target=0 temp=20.2 pwm=0.000 sysload=2.15 cputime=2.787 memavail=1547636 print_time=105839.116 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
webhooks client 547583321616: Disconnected
Starting Klippy...
Args: ['/home/coon/klipper/klippy/klippy.py', '/home/coon/printer_data/config/printer.cfg', '-l', '/home/coon/printer_data/logs/klippy.log', '-I', '/home/coon/printer_data/comms/klippy.serial', '-a', '/home/coon/printer_data/comms/klippy.sock']
Git version: 'v0.12.0-396-gb7233d119'
Branch: master
Remote: origin
Tracked URL: https://github.com/Klipper3d/klipper.git
CPU: 4 core ?
Python: '3.9.2 (default, Dec  1 2024, 12:12:57) \n[GCC 10.2.1 20210110]'
Start printer at Sun Dec 22 17:59:18 2024 (1734908358.4 20.8)
===== Config file =====
[virtual_sdcard]
path = ~/printer_data/gcodes
on_error_gcode = CANCEL_PRINT

[pause_resume]
recover_velocity = 25

[display_status]

[respond]
default_prefix = 

[gcode_macro CANCEL_PRINT]
description = Cancel the actual running print
rename_existing = BASE_CANCEL_PRINT
gcode = 
	G91
	G0 Z10 F600
	G90
	TURN_OFF_HEATERS
	G0 X5 Y220
	CLEAR_PAUSE
	
	BASE_CANCEL_PRINT

[gcode_macro PAUSE]
description = Pause the actual running print
rename_existing = PAUSE_BASE
gcode = 
	
	{% set x = params.X|default(5) %}
	{% set y = params.Y|default(225) %}
	{% set z = params.Z|default(10)|float %}
	{% set e = params.E|default(1) %}
	
	{% set max_z = printer.toolhead.axis_maximum.z|float %}
	{% set act_z = printer.toolhead.position.z|float %}
	{% set lift_z = z|abs %}
	{% if act_z < (max_z - lift_z) %}
	{% set z_safe = lift_z %}
	{% else %}
	{% set z_safe = max_z - act_z %}
	{% endif %}
	
	PAUSE_BASE
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E-{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	{% if "xyz" in printer.toolhead.homed_axes %}
	G1 Z{z_safe}
	G90
	G1 X{x} Y{y} F6000
	{% else %}
	{action_respond_info("Printer not homed")}
	{% endif %}

[gcode_macro RESUME]
description = Resume the actual running print
rename_existing = RESUME_BASE
variable_last_extruder_temp = {'restore': False, 'temp': 0}
variable_restore_idle_timeout = 0
variable_idle_state = False
gcode = 
	
	{% set e = params.E|default(1) %}
	
	{% if 'VELOCITY' in params|upper %}
	{% set get_params = ('VELOCITY=' + params.VELOCITY)  %}
	{%else %}
	{% set get_params = "" %}
	{% endif %}
	
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	RESUME_BASE {get_params}

[gcode_macro SET_PAUSE_NEXT_LAYER]
description = Enable a pause if the next layer is reached
gcode = 
	{% set pause_next_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_next_layer %}
	{% set ENABLE = params.ENABLE|default(1)|int != 0 %}
	{% set MACRO = params.MACRO|default(pause_next_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_next_layer VALUE="{{ 'enable': ENABLE, 'call': MACRO }}"

[gcode_macro SET_PAUSE_AT_LAYER]
description = Enable/disable a pause if a given layer number is reached
gcode = 
	{% set pause_at_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_at_layer %}
	{% set ENABLE = params.ENABLE|int != 0 if params.ENABLE is defined
	else params.LAYER is defined %}
	{% set LAYER = params.LAYER|default(pause_at_layer.layer)|int %}
	{% set MACRO = params.MACRO|default(pause_at_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_at_layer VALUE="{{ 'enable': ENABLE, 'layer': LAYER, 'call': MACRO }}"

[gcode_macro SET_PRINT_STATS_INFO]
rename_existing = SET_PRINT_STATS_INFO_BASE
description = Overwrite, to get pause_next_layer and pause_at_layer feature
variable_pause_next_layer = { 'enable': False, 'call': "PAUSE" }
variable_pause_at_layer = { 'enable': False, 'layer': 0, 'call': "PAUSE" }
gcode = 
	{% if pause_next_layer.enable %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_next_layer" % pause_next_layer.call}'
	{pause_next_layer.call}
	SET_PAUSE_NEXT_LAYER ENABLE=0
	{% elif pause_at_layer.enable and params.CURRENT_LAYER is defined and params.CURRENT_LAYER|int == pause_at_layer.layer %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_at_layer [%d]" % (pause_at_layer.call, pause_at_layer.layer)}'
	{pause_at_layer.call}
	SET_PAUSE_AT_LAYER ENABLE=0
	{% endif %}
	SET_PRINT_STATS_INFO_BASE {rawparams}

[gcode_macro _TOOLHEAD_PARK_PAUSE_CANCEL]
description = Helper: park toolhead used in PAUSE and CANCEL_PRINT
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set velocity = printer.configfile.settings.pause_resume.recover_velocity %}
	{% set use_custom     = client.use_custom_pos|default(false)|lower == 'true' %}
	{% set custom_park_x  = client.custom_park_x|default(0.0) %}
	{% set custom_park_y  = client.custom_park_y|default(0.0) %}
	{% set park_dz        = client.custom_park_dz|default(2.0)|abs %}
	{% set sp_hop         = client.speed_hop|default(15) * 60 %}
	{% set sp_move        = client.speed_move|default(velocity) * 60 %}
	
	{% set origin    = printer.gcode_move.homing_origin %}
	{% set act       = printer.gcode_move.gcode_position %}
	{% set max       = printer.toolhead.axis_maximum %}
	{% set cone      = printer.toolhead.cone_start_z|default(max.z) %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	
	{% set z_min = params.Z_MIN|default(0)|float %}
	{% set z_park = [[(act.z + park_dz), z_min]|max, (max.z - origin.z)]|min %}
	{% set x_park = params.X       if params.X is defined
	else custom_park_x  if use_custom
	else 0.0            if round_bed
	else (max.x - 5.0) %}
	{% set y_park = params.Y       if params.Y is defined
	else custom_park_y  if use_custom
	else (max.y - 5.0)  if round_bed and z_park < cone
	else 0.0            if round_bed
	else (max.y - 5.0) %}
	
	_CLIENT_RETRACT
	{% if "xyz" in printer.toolhead.homed_axes %}
	G90
	G1 Z{z_park} F{sp_hop}
	G1 X{x_park} Y{y_park} F{sp_move}
	{% if not printer.gcode_move.absolute_coordinates %} G91 {% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='Printer not homed'
	{% endif %}

[gcode_macro _CLIENT_EXTRUDE]
description = Extrudes, if the extruder is hot enough
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set use_fw_retract = (client.use_fw_retract|default(false)|lower == 'true') and (printer.firmware_retraction is defined) %}
	{% set length = params.LENGTH|default(client.unretract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_unretract)|default(35) %}
	{% set absolute_extrude = printer.gcode_move.absolute_extrude %}
	
	{% if printer.toolhead.extruder != '' %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if use_fw_retract %}
	{% if length < 0 %}
	G10
	{% else %}
	G11
	{% endif %}
	{% else %}
	M83
	G1 E{length} F{(speed|float|abs) * 60}
	{% if absolute_extrude %}
	M82
	{% endif %}
	{% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='{"\"%s\" not hot enough" % printer.toolhead.extruder}'
	{% endif %}
	{% endif %}

[gcode_macro _CLIENT_RETRACT]
description = Retracts, if the extruder is hot enough
gcode = 
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set length = params.LENGTH|default(client.retract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_retract)|default(35) %}
	
	_CLIENT_EXTRUDE LENGTH=-{length|float|abs} SPEED={speed|float|abs}

[gcode_macro _CLIENT_LINEAR_MOVE]
description = Linear move with save and restore of the gcode state
gcode = 
	{% set x_move = "X" ~ params.X if params.X is defined else "" %}
	{% set y_move = "Y" ~ params.Y if params.Y is defined else "" %}
	{% set z_move = "Z" ~ params.Z if params.Z is defined else "" %}
	{% set e_move = "E" ~ params.E if params.E is defined else "" %}
	{% set rate = "F" ~ params.F if params.F is defined else "" %}
	{% set ABSOLUTE = params.ABSOLUTE | default(0) | int != 0 %}
	{% set ABSOLUTE_E = params.ABSOLUTE_E | default(0) | int != 0 %}
	SAVE_GCODE_STATE NAME=_client_movement
	{% if x_move or y_move or z_move %}
	G9{ 0 if ABSOLUTE else 1 }
	{% endif %}
	{% if e_move %}
	M8{ 2 if ABSOLUTE_E else 3 }
	{% endif %}
	G1 { x_move } { y_move } { z_move } { e_move } { rate }
	RESTORE_GCODE_STATE NAME=_client_movement

[gcode_macro play_test]
gcode = 
	RESPOND TYPE=command MSG="action:prompt_begin Question"
	RESPOND TYPE=command MSG="action:prompt_text Do you wont to cancel the print?"
	RESPOND TYPE=command MSG="action:prompt_footer_button continue|RESPOND TYPE=command MSG=action:prompt_end"
	RESPOND TYPE=command MSG="action:prompt_footer_button CANCEL|CANCEL_PRINT|error"
	RESPOND TYPE=command MSG="action:prompt_show"

[gcode_macro PRINT_START]
gcode = 
	START_PRINT {rawparams}

[gcode_macro START_PRINT]
gcode = 
	{% set BED_TEMP = params.BED_TEMP|default(60)|float %}
	{% set EXTRUDER_TEMP = params.EXTRUDER_TEMP|default(190)|float %}
	
	M190 S{BED_TEMP}
	
	G90
	
	G28
	
	RESPOND MSG="Bed Meshing"
	
	
	
	
	
	
	
	
	BED_MESH_CLEAR
	BED_MESH_CALIBRATE ADAPTIVE=1
	
	
	
	
	
	
	
	RESPOND MSG="Heating to print temp"
	M104 S{EXTRUDER_TEMP}
	G0 Z40 F240
	M109 S{EXTRUDER_TEMP}
	RESPOND MSG="Enable Runout Sensor"
	SFS_ENABLE
	RESPOND MSG="Line Purge"
	LINE_PURGE
	RESPOND MSG="Print Started"

[gcode_macro LINE_PURGE]
gcode = 
	G92 E0
	G1 Z2.0 F3000
	G1 X0.1 Y20 Z0.3 F5000.0
	G1 X0.1 Y200.0 Z0.3 F1500.0 E15
	G1 X0.4 Y200.0 Z0.3 F5000.0
	G1 X0.4 Y20 Z0.3 F1500.0 E30
	G92 E0
	G1 Z2.0 F3000
	G1 X5 Y20 Z0.3 F5000.0

[gcode_macro PRINT_END]
gcode = 
	END_PRINT

[gcode_macro END_PRINT]
gcode = 
	
	
	RESPOND MSG="Print Finished"
	G91
	G1 E-.5 Z0.2 F2400
	G1 X5 Y5 F6000
	G1 Z10
	G90
	SFS_DISABLE
	
	G1 X0 Y220 F6000
	M106 S0
	M104 S0
	M140 S0
	
	M84 X Y E

[gcode_macro SET_ACTIVE_SPOOL]
gcode = 
	{% if params.ID %}
	{% set id = params.ID|int %}
	{action_call_remote_method(
	"spoolman_set_active_spool",
	spool_id=id
	)}
	{% else %}
	{action_respond_info("Parameter 'ID' is required")}
	{% endif %}

[gcode_macro CLEAR_ACTIVE_SPOOL]
gcode = 
	{action_call_remote_method(
	"spoolman_set_active_spool",
	spool_id=None
	)}

[gcode_macro G29]
gcode = 
	G28
	BED_MESH_CALIBRATE
	G0 X0 Y0 Z10 F6000
	BED_MESH_PROFILE save=default

[gcode_macro M125]
gcode = 
	SAVE_GCODE_STATE NAME=parking
	M117 Parking toolhead
	G91
	G1 Z10 F600
	G90
	G1 X5 Y225 F4000
	RESTORE_GCODE_STATE NAME=parking

[gcode_macro Load_Filament]
gcode = 
	SAVE_GCODE_STATE NAME=loading_filament
	M117 Loading Filament
	M83
	G92 E0.0
	G91
	G1 E50 F200
	G92 E50
	RESTORE_GCODE_STATE NAME=loading_filament

[gcode_macro Unload_Filament]
gcode = 
	SAVE_GCODE_STATE NAME=unloading_filament
	M117 Unloading Filament
	G91
	G1 E5 F100
	G92 E0.0
	G1 E-50 F5000
	G92 E-50
	RESTORE_GCODE_STATE NAME=unloading_filament

[gcode_macro Filament_Change]
gcode = 
	
	SAVE_GCODE_STATE NAME=filament_change
	
	Unload_Filament
	
	RESPOND TYPE=command MSG="action:prompt_begin Question"
	RESPOND TYPE=command MSG="action:prompt_text Please insert new filament and confirm"
	RESPOND TYPE=command MSG="action:prompt_footer_button CONFIRM|Load_Filament|RESPOND TYPE=command MSG=action:prompt_end"
	RESPOND TYPE=command MSG="action:prompt_footer_button CANCEL|RESPOND TYPE=command MSG=action:prompt_end"
	RESPOND TYPE=command MSG="action:prompt_show"
	
	RESTORE_GCODE_STATE NAME=filament_change

[gcode_macro Calibrate_Hotend_PID]
gcode = 
	PID_CALIBRATE HEATER=extruder TARGET=200

[gcode_macro Calibrate_Bed_PID]
gcode = 
	PID_CALIBRATE HEATER=heater_bed TARGET=60

[gcode_macro Calibrate_Zoffset]
gcode = 
	PROBE_CALIBRATE

[gcode_macro Tram_bed]
gcode = 
	SCREWS_TILT_CALCULATE

[gcode_macro TEST_SPEED]
description = Test for max speed and acceleration parameters for the printer. Procedure: Home -> ReadPositionFromMCU -> MovesToolhead@Vel&Accel -> Home -> ReadPositionfromMCU
gcode = 
	
	{% set speed  = params.SPEED|default(printer.configfile.settings.printer.max_velocity)|int %}
	
	{% set iterations = params.ITERATIONS|default(5)|int %}
	
	{% set accel  = params.ACCEL|default(printer.configfile.settings.printer.max_accel)|int %}
	
	{% set min_cruise_ratio = params.MIN_CRUISE_RATIO|default(0.5)|float %}
	
	{% set bound = params.BOUND|default(20)|int %}
	
	{% set smallpatternsize = SMALLPATTERNSIZE|default(20)|int %}
	
	
	
	{% set x_min = printer.toolhead.axis_minimum.x + bound %}
	{% set x_max = printer.toolhead.axis_maximum.x - bound %}
	{% set y_min = printer.toolhead.axis_minimum.y + bound %}
	{% set y_max = printer.toolhead.axis_maximum.y - bound %}
	
	
	
	{% set x_center = (printer.toolhead.axis_minimum.x|float + printer.toolhead.axis_maximum.x|float ) / 2 %}
	{% set y_center = (printer.toolhead.axis_minimum.y|float + printer.toolhead.axis_maximum.y|float ) / 2 %}
	
	
	{% set x_center_min = x_center - (smallpatternsize/2) %}
	{% set x_center_max = x_center + (smallpatternsize/2) %}
	{% set y_center_min = y_center - (smallpatternsize/2) %}
	{% set y_center_max = y_center + (smallpatternsize/2) %}
	
	
	SAVE_GCODE_STATE NAME=TEST_SPEED
	
	
	{ action_respond_info("TEST_SPEED: starting %d iterations at speed %d, accel %d" % (iterations, speed, accel)) }
	
	
	M400
	G28
	
	{% if printer.configfile.settings.quad_gantry_level %}
	{% if printer.quad_gantry_level.applied == False %}
	QUAD_GANTRY_LEVEL
	G28 Z
	{% endif %}
	{% endif %}
	
	G90
	G1 X{printer.toolhead.axis_maximum.x-50} Y{printer.toolhead.axis_maximum.y-50} F{30*60}
	M400
	G28 X Y
	G0 X{printer.toolhead.axis_maximum.x-1} Y{printer.toolhead.axis_maximum.y-1} F{30*60}
	G4 P1000
	GET_POSITION
	
	
	G0 X{x_min} Y{y_min} Z{bound + 10} F{speed*60}
	
	
	{% if printer.configfile.settings.printer.minimum_cruise_ratio is defined %}
	SET_VELOCITY_LIMIT VELOCITY={speed} ACCEL={accel} MINIMUM_CRUISE_RATIO={min_cruise_ratio}
	{% else %}
	SET_VELOCITY_LIMIT VELOCITY={speed} ACCEL={accel} ACCEL_TO_DECEL={accel / 2}
	{% endif %}
	
	{% for i in range(iterations) %}
	
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_max} Y{y_max} F{speed*60}
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	G0 X{x_min} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	
	
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_min} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	
	
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_max} Y{y_center_max} F{speed*60}
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	G0 X{x_center_min} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	
	
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_min} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	{% endfor %}
	
	
	{% if printer.configfile.settings.printer.minimum_cruise_ratio is defined %}
	SET_VELOCITY_LIMIT VELOCITY={printer.configfile.settings.printer.max_velocity} ACCEL={printer.configfile.settings.printer.max_accel} MINIMUM_CRUISE_RATIO={printer.configfile.settings.printer.minimum_cruise_ratio}
	{% else %}
	SET_VELOCITY_LIMIT VELOCITY={printer.configfile.settings.printer.max_velocity} ACCEL={printer.configfile.settings.printer.max_accel} ACCEL_TO_DECEL={printer.configfile.settings.printer.max_accel_to_decel}
	{% endif %}
	
	
	M400
	G28
	
	G90
	G0 X{printer.toolhead.axis_maximum.x-1} Y{printer.toolhead.axis_maximum.y-1} F{30*60}
	G4 P1000
	GET_POSITION
	
	
	RESTORE_GCODE_STATE NAME=TEST_SPEED

[gcode_macro GET_TIMELAPSE_SETUP]
description = Print the Timelapse setup
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% set output_txt = ["Timelapse Setup:"] %}
	{% set _dummy = output_txt.append("enable: %s" % tl.enable) %}
	{% set _dummy = output_txt.append("park: %s" % tl.park.enable) %}
	{% if tl.park.enable %}
	{% set _dummy = output_txt.append("park position: %s time: %s s" % (tl.park.pos, tl.park.time)) %}
	{% set _dummy = output_txt.append("park cord x:%s y:%s dz:%s" % (tl.park.coord.x, tl.park.coord.y, tl.park.coord.dz)) %}
	{% set _dummy = output_txt.append("travel speed: %s mm/s" % tl.speed.travel) %}
	{% endif %}
	{% set _dummy = output_txt.append("fw_retract: %s" % tl.extruder.fw_retract) %}
	{% if not tl.extruder.fw_retract %}
	{% set _dummy = output_txt.append("retract: %s mm speed: %s mm/s" % (tl.extruder.retract, tl.speed.retract)) %}
	{% set _dummy = output_txt.append("extrude: %s mm speed: %s mm/s" % (tl.extruder.extrude, tl.speed.extrude)) %}
	{% endif %}
	{% set _dummy = output_txt.append("verbose: %s" % tl.verbose) %}
	{action_respond_info(output_txt|join("\n"))}

[gcode_macro _SET_TIMELAPSE_SETUP]
description = Set user parameters for timelapse
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	
	{% set min = printer.toolhead.axis_minimum %}
	{% set max = printer.toolhead.axis_maximum %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	{% set park = {'min'   : {'x': (min.x / 1.42)|round(3) if round_bed else min.x|round(3),
	'y': (min.y / 1.42)|round(3) if round_bed else min.y|round(3)},
	'max'   : {'x': (max.x / 1.42)|round(3) if round_bed else max.x|round(3),
	'y': (max.y / 1.42)|round(3) if round_bed else max.y|round(3)},
	'center': {'x': (max.x-(max.x-min.x)/2)|round(3),
	'y': (max.y-(max.y-min.y)/2)|round(3)}} %}
	
	{% if params.ENABLE %}
	{% if params.ENABLE|lower is in ['true', 'false'] %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=enable VALUE={True if params.ENABLE|lower == 'true' else False}
	{% else %}
	{action_raise_error("ENABLE=%s not supported. Allowed values are [True, False]" % params.ENABLE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.VERBOSE %}
	{% if params.VERBOSE|lower is in ['true', 'false'] %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=verbose VALUE={True if params.VERBOSE|lower == 'true' else False}
	{% else %}
	{action_raise_error("VERBOSE=%s not supported. Allowed values are [True, False]" % params.VERBOSE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_X %}
	{% if params.CUSTOM_POS_X|float >= min.x and params.CUSTOM_POS_X|float <= max.x %}
	{% set _dummy = tl.park.custom.update({'x':params.CUSTOM_POS_X|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_X=%s must be within [%s - %s]" % (params.CUSTOM_POS_X, min.x, max.x))}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_Y %}
	{% if params.CUSTOM_POS_Y|float >= min.y and params.CUSTOM_POS_Y|float <= max.y %}
	{% set _dummy = tl.park.custom.update({'y':params.CUSTOM_POS_Y|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_Y=%s must be within [%s - %s]" % (params.CUSTOM_POS_Y, min.y, max.y))}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_DZ %}
	{% if params.CUSTOM_POS_DZ|float >= min.z and params.CUSTOM_POS_DZ|float <= max.z %}
	{% set _dummy = tl.park.custom.update({'dz':params.CUSTOM_POS_DZ|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_DZ=%s must be within [%s - %s]" % (params.CUSTOM_POS_DZ, min.z, max.z))}
	{% endif %}
	{% endif %}
	{% if params.PARK_ENABLE %}
	{% if params.PARK_ENABLE|lower is in ['true', 'false'] %}
	{% set _dummy = tl.park.update({'enable':True if params.PARK_ENABLE|lower == 'true' else False}) %}
	{% else %}
	{action_raise_error("PARK_ENABLE=%s not supported. Allowed values are [True, False]" % params.PARK_ENABLE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.PARK_POS %}
	{% if params.PARK_POS|lower is in ['center','front_left','front_right','back_left','back_right','custom','x_only','y_only'] %}
	{% set dic = {'center'      : {'x': park.center.x   , 'y': park.center.y   , 'dz': 1                },
	'front_left'  : {'x': park.min.x      , 'y': park.min.y      , 'dz': 0                },
	'front_right' : {'x': park.max.x      , 'y': park.min.y      , 'dz': 0                },
	'back_left'   : {'x': park.min.x      , 'y': park.max.y      , 'dz': 0                },
	'back_right'  : {'x': park.max.x      , 'y': park.max.y      , 'dz': 0                },
	'custom'      : {'x': tl.park.custom.x, 'y': tl.park.custom.y, 'dz': tl.park.custom.dz},
	'x_only'      : {'x': tl.park.custom.x, 'y': 'none'          , 'dz': tl.park.custom.dz},
	'y_only'      : {'x': 'none'          , 'y': tl.park.custom.y, 'dz': tl.park.custom.dz}} %}
	{% set _dummy = tl.park.update({'pos':params.PARK_POS|lower}) %}
	{% set _dummy = tl.park.update({'coord':dic[tl.park.pos]}) %}
	{% else %}
	{action_raise_error("PARK_POS=%s not supported. Allowed values are [CENTER, FRONT_LEFT, FRONT_RIGHT, BACK_LEFT, BACK_RIGHT, CUSTOM, X_ONLY, Y_ONLY]"
	% params.PARK_POS|upper)}
	{% endif %}
	{% endif %}
	{% if params.PARK_TIME %}
	{% if params.PARK_TIME|float >= 0.0 %}
	{% set _dummy = tl.park.update({'time':params.PARK_TIME|float|round(3)}) %}
	{% else %}
	{action_raise_error("PARK_TIME=%s must be a positive number" % params.PARK_TIME)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=park VALUE="{tl.park}"
	{% if params.TRAVEL_SPEED %}
	{% if params.TRAVEL_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'travel':params.TRAVEL_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("TRAVEL_SPEED=%s must be larger than 0" % params.TRAVEL_SPEED)}
	{% endif %}
	{% endif %}
	{% if params.RETRACT_SPEED %}
	{% if params.RETRACT_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'retract':params.RETRACT_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("RETRACT_SPEED=%s must be larger than 0" % params.RETRACT_SPEED)}
	{% endif %}
	{% endif %}
	{% if params.EXTRUDE_SPEED %}
	{% if params.EXTRUDE_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'extrude':params.EXTRUDE_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("EXTRUDE_SPEED=%s must be larger than 0" % params.EXTRUDE_SPEED)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=speed VALUE="{tl.speed}"
	{% if params.EXTRUDE_DISTANCE %}
	{% if params.EXTRUDE_DISTANCE|float >= 0.0 %}
	{% set _dummy = tl.extruder.update({'extrude':params.EXTRUDE_DISTANCE|float|round(3)}) %}
	{% else %}
	{action_raise_error("EXTRUDE_DISTANCE=%s must be specified as positiv number" % params.EXTRUDE_DISTANCE)}
	{% endif %}
	{% endif %}
	{% if params.RETRACT_DISTANCE %}
	{% if params.RETRACT_DISTANCE|float >= 0.0 %}
	{% set _dummy = tl.extruder.update({'retract':params.RETRACT_DISTANCE|float|round(3)}) %}
	{% else %}
	{action_raise_error("RETRACT_DISTANCE=%s must be specified as positiv number" % params.RETRACT_DISTANCE)}
	{% endif %}
	{% endif %}
	{% if params.FW_RETRACT %}
	{% if params.FW_RETRACT|lower is in ['true', 'false'] %}
	{% if 'firmware_retraction' in printer.configfile.settings %}
	{% set _dummy = tl.extruder.update({'fw_retract': True if params.FW_RETRACT|lower == 'true' else False}) %}
	{% else %}
	{% set _dummy = tl.extruder.update({'fw_retract':False}) %}
	{% if params.FW_RETRACT|capitalize == 'True' %}
	{action_raise_error("[firmware_retraction] not defined in printer.cfg. Can not enable fw_retract")}
	{% endif %}
	{% endif %}
	{% else %}
	{action_raise_error("FW_RETRACT=%s not supported. Allowed values are [True, False]" % params.FW_RETRACT|capitalize)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=extruder VALUE="{tl.extruder}"
	{% if printer.configfile.settings['gcode_macro pause'] is defined %}
	{% set _dummy = tl.macro.update({'pause': printer.configfile.settings['gcode_macro pause'].rename_existing}) %}
	{% endif %}
	{% if printer.configfile.settings['gcode_macro resume'] is defined %}
	{% set _dummy = tl.macro.update({'resume': printer.configfile.settings['gcode_macro resume'].rename_existing}) %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=macro VALUE="{tl.macro}"

[gcode_macro TIMELAPSE_TAKE_FRAME]
description = Take Timelapse shoot
variable_enable = False
variable_takingframe = False
variable_park = {'enable': False,
	'pos'   : 'center',
	'time'  : 0.1,
	'custom': {'x': 0, 'y': 0, 'dz': 0},
	'coord' : {'x': 0, 'y': 0, 'dz': 0}}
variable_extruder = {'fw_retract': False,
	'retract': 1.0,
	'extrude': 1.0}
variable_speed = {'travel': 100,
	'retract': 15,
	'extrude': 15}
variable_verbose = True
variable_check_time = 0.5
variable_restore = {'absolute': {'coordinates': True, 'extrude': True}, 'speed': 1500, 'e':0, 'factor': {'speed': 1.0, 'extrude': 1.0}}
variable_macro = {'pause': 'PAUSE', 'resume': 'RESUME'}
variable_is_paused = False
gcode = 
	{% set hyperlapse = True if params.HYPERLAPSE and params.HYPERLAPSE|lower =='true' else False %}
	{% if enable %}
	{% if (hyperlapse and printer['gcode_macro HYPERLAPSE'].run) or
	(not hyperlapse and not printer['gcode_macro HYPERLAPSE'].run) %}
	{% if park.enable %}
	{% set pos = {'x': 'X' + park.coord.x|string if park.pos != 'y_only' else '',
	'y': 'Y' + park.coord.y|string if park.pos != 'x_only' else '',
	'z': 'Z'+ [printer.gcode_move.gcode_position.z + park.coord.dz, printer.toolhead.axis_maximum.z]|min|string} %}
	{% set restore = {'absolute': {'coordinates': printer.gcode_move.absolute_coordinates,
	'extrude'    : printer.gcode_move.absolute_extrude},
	'speed'   : printer.gcode_move.speed,
	'e'       : printer.gcode_move.gcode_position.e,
	'factor'  : {'speed'  : printer.gcode_move.speed_factor,
	'extrude': printer.gcode_move.extrude_factor}} %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=restore VALUE="{restore}"
	{% if not printer[printer.toolhead.extruder].can_extrude %}
	{% if verbose %}{action_respond_info("Timelapse: Warning, minimum extruder temperature not reached!")}{% endif %}
	{% else %}
	{% if extruder.fw_retract %}
	G10
	{% else %}
	M83
	G0 E-{extruder.retract} F{speed.retract * 60}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=is_paused VALUE=True
	{macro.pause}
	SET_GCODE_OFFSET X=0 Y=0
	G90
	{% if "xyz" not in printer.toolhead.homed_axes %}
	{% if verbose %}{action_respond_info("Timelapse: Warning, axis not homed yet!")}{% endif %}
	{% else %}
	G0 {pos.x} {pos.y} {pos.z} F{speed.travel * 60}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=takingframe VALUE=True
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_TAKE_FRAME DURATION={check_time}
	M400
	{% endif %}
	_TIMELAPSE_NEW_FRAME HYPERLAPSE={hyperlapse}
	{% endif %}
	{% else %}
	{% if verbose %}{action_respond_info("Timelapse: disabled, take frame ignored")}{% endif %}
	{% endif %}

[gcode_macro _TIMELAPSE_NEW_FRAME]
description = action call for timelapse shoot. must be a seperate macro
gcode = 
	{action_call_remote_method("timelapse_newframe",
	macropark=printer['gcode_macro TIMELAPSE_TAKE_FRAME'].park,
	hyperlapse=params.HYPERLAPSE)}

[delayed_gcode _WAIT_TIMELAPSE_TAKE_FRAME]
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% set factor = {'speed': printer.gcode_move.speed_factor, 'extrude': printer.gcode_move.extrude_factor} %}
	{% if tl.takingframe %}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_TAKE_FRAME DURATION={tl.check_time}
	{% else %}
	{tl.macro.resume} VELOCITY={tl.speed.travel}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=is_paused VALUE=False
	{% if not printer[printer.toolhead.extruder].can_extrude %}
	{action_respond_info("Timelapse: Warning minimum extruder temperature not reached!")}
	{% else %}
	{% if tl.extruder.fw_retract %}
	G11
	{% else %}
	G0 E{tl.extruder.extrude} F{tl.speed.extrude * 60}
	G0 F{tl.restore.speed}
	{% if tl.restore.absolute.extrude %}
	M82
	G92 E{tl.restore.e}
	{% endif %}
	{% endif %}
	{% endif %}
	{% if tl.restore.factor.speed   != factor.speed   %} M220 S{(factor.speed*100)|round(0)}   {% endif %}
	{% if tl.restore.factor.extrude != factor.extrude %} M221 S{(factor.extrude*100)|round(0)} {% endif %}
	{% if not tl.restore.absolute.coordinates %} G91 {% endif %}
	{% endif %}

[gcode_macro HYPERLAPSE]
description = Start/Stop a hyperlapse recording
variable_cycle = 0
variable_run = False
gcode = 
	{% set cycle = params.CYCLE|default(30)|int %}
	{% if params.ACTION and params.ACTION|lower == 'start' %}
	{action_respond_info("Hyperlapse: frames started (Cycle %d sec)" % cycle)}
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=run VALUE=True
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=cycle VALUE={cycle}
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION={cycle}
	TIMELAPSE_TAKE_FRAME HYPERLAPSE=True
	{% elif params.ACTION and params.ACTION|lower == 'stop' %}
	{% if run %}{action_respond_info("Hyperlapse: frames stopped")}{% endif %}
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=run VALUE=False
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION=0
	{% else %}
	{action_raise_error("Hyperlapse: No valid input parameter
	Use:
	- HYPERLAPSE ACTION=START [CYCLE=time]
	- HYPERLAPSE ACTION=STOP")}
	{% endif %}

[delayed_gcode _HYPERLAPSE_LOOP]
gcode = 
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION={printer["gcode_macro HYPERLAPSE"].cycle}
	TIMELAPSE_TAKE_FRAME HYPERLAPSE=True

[gcode_macro TIMELAPSE_RENDER]
description = Render Timelapse video and wait for the result
variable_render = False
variable_run_identifier = 0
gcode = 
	{action_respond_info("Timelapse: Rendering started")}
	{action_call_remote_method("timelapse_render", byrendermacro="True")}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_RENDER VARIABLE=render VALUE=True
	{printer.configfile.settings['gcode_macro pause'].rename_existing}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_RENDER DURATION=0.5

[delayed_gcode _WAIT_TIMELAPSE_RENDER]
gcode = 
	{% set ri = printer['gcode_macro TIMELAPSE_RENDER'].run_identifier % 4 %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_RENDER VARIABLE=run_identifier VALUE={ri + 1}
	{% if printer['gcode_macro TIMELAPSE_RENDER'].render %}
	M117 Rendering {['-','\\','|','/'][ri]}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_RENDER DURATION=0.5
	{% else %}
	{action_respond_info("Timelapse: Rendering finished")}
	M117
	{printer.configfile.settings['gcode_macro resume'].rename_existing}
	{% endif %}

[gcode_macro TEST_STREAM_DELAY]
description = Helper macro to find stream and park delay
gcode = 
	{% set min = printer.toolhead.axis_minimum %}
	{% set max = printer.toolhead.axis_maximum %}
	{% set act = printer.toolhead.position %}
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% if act.z > 5.0 %}
	G0 X{min.x + 5.0} F{tl.speed.travel|int * 60}
	G0 X{(max.x-min.x)/2}
	G4 P{tl.park.time|float * 1000}
	_TIMELAPSE_NEW_FRAME HYPERLAPSE=FALSE
	G0 X{max.x - 5.0}
	{% else %}
	{action_raise_error("Toolhead z %.3f to low. Please place head above z = 5.0" % act.z)}
	{% endif %}

[gcode_macro _OBICO_LAYER_CHANGE]
description = Run a scan across the current print area
variable_first_layer_scan_retract_length = 6
variable_first_layer_scan_retract_speed = 15
variable_first_layer_scan_cooldown_temp = 170
variable_first_layer_scan_resume_speed = 50
variable_first_layer_scan_enabled = True
variable_first_layer_scan_stepover = 10
variable_first_layer_scan_speed = 10
variable_first_layer_scan_zhop = 4
variable_first_layer_scan_zhop_speed = 15
variable_verbose = False
variable_current_layer = -1
variable_first_layer_scanning = False
variable_wait = {'resume': "RESUME", 'absolute_coordinates': True, 'absolute_extrude': True, 'e': 0.0, 'previous_temp': 0}
gcode = 
	
	{% set pause_macro  = "PAUSE"  if printer.configfile.settings['gcode_macro pause']  is not defined
	else printer.configfile.settings['gcode_macro pause'].rename_existing %}
	{% set resume_macro = "RESUME" if printer.configfile.settings['gcode_macro resume'] is not defined
	else printer.configfile.settings['gcode_macro resume'].rename_existing %}
	
	{% set current_layer_default = printer.print_stats.info.current_layer if printer.print_stats.info.current_layer is not none else -1 %}
	{% set current_layer = params.CURRENT_LAYER|default(current_layer_default)|int %}
	
	{% set polygon_points = printer.exclude_object.objects|map(attribute='polygon')|sum(start=[]) if printer.exclude_object is defined else [] %}
	{% set min_x = params.MINX|default(polygon_points|map(attribute=0)|min|default(printer.toolhead.axis_minimum.x))|float %}
	{% set min_y = params.MINY|default(polygon_points|map(attribute=1)|min|default(printer.toolhead.axis_minimum.y))|float %}
	{% set max_x = params.MAXX|default(polygon_points|map(attribute=0)|max|default(printer.toolhead.axis_maximum.x))|float %}
	{% set max_y = params.MAXY|default(polygon_points|map(attribute=1)|max|default(printer.toolhead.axis_maximum.y))|float %}
	
	{% set stepoverCount = ((max_y - min_y) / first_layer_scan_stepover|float)|round(method='ceil')|int %}
	
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Layer %d" % (current_layer)}' {% endif %}
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=current_layer VALUE={current_layer}
	
	{% if first_layer_scan_enabled and current_layer == 2 %}
	
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=first_layer_scanning VALUE=True
	
	
	{% set wait_dic = {'resume'              : resume_macro,
	'absolute_coordinates': printer.gcode_move.absolute_coordinates,
	'absolute_extrude'    : printer.gcode_move.absolute_extrude,
	'e'                   : printer.gcode_move.gcode_position.e,
	'previous_temp'       : printer.extruder.target} %}
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=wait VALUE="{wait_dic}"
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Prepare scanning" {% endif %}
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Scan Coordinates: Min:[%.3f:%.3f] Max:[%.3f:%.3f]" % (min_x,min_y,max_x,max_y)}' {% endif %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Retract %.1fmm filament" % first_layer_scan_retract_length|abs}' {% endif %}
	M83
	G0 E-{first_layer_scan_retract_length|abs} F{first_layer_scan_retract_speed|float * 60}
	{% endif %}
	G91
	G0 Z{first_layer_scan_zhop|abs} F{first_layer_scan_zhop_speed|float * 60}
	
	
	M106 S255
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Fan on and lowering temperature to %.1f" % first_layer_scan_cooldown_temp}' {% endif %}
	M104 S{first_layer_scan_cooldown_temp}
	M109 S{first_layer_scan_cooldown_temp}
	
	{pause_macro}
	
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Start scanning" {% endif %}
	
	UPDATE_DELAYED_GCODE ID=_WAIT_OBICO_LAYER_CHANGE DURATION=1.0
	G90
	G0 X{min_x} Y{min_y} F{first_layer_scan_resume_speed|float * 60}
	{% for ystep in range(stepoverCount) %}
	G0 Y{min_y + first_layer_scan_stepover|float * ystep} F{first_layer_scan_speed|float * 60}
	G0 X{max_x if ystep % 2 == 0 else min_x}              F{first_layer_scan_speed|float * 60}
	{% endfor %}
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Finish scanning" {% endif %}
	
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=first_layer_scanning VALUE=False
	
	{% endif %}

[delayed_gcode _WAIT_OBICO_LAYER_CHANGE]
gcode = 
	{% set lc_macro = printer['gcode_macro _OBICO_LAYER_CHANGE'] %}
	{% if lc_macro.first_layer_scanning %}
	
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Waiting for first layer scan..." {% endif %}
	UPDATE_DELAYED_GCODE ID=_WAIT_OBICO_LAYER_CHANGE DURATION=1.0
	{% else %}
	
	M107
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Fan off and resume print" {% endif %}
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Call %s VELOCITY=%.1f" % (lc_macro.wait.resume, lc_macro.first_layer_scan_resume_speed)}' {% endif %}
	{lc_macro.wait.resume} VELOCITY={lc_macro.first_layer_scan_resume_speed}
	G91
	G0 Z-{lc_macro.first_layer_scan_zhop|abs} F{lc_macro.first_layer_scan_zhop_speed|float * 60}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% set first_layer_scan_unretract_length = lc_macro.first_layer_scan_retract_length + 0.5 %}
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Extrude %.1fmm filament" % first_layer_scan_unretract_length|abs}' {% endif %}
	M83
	G0 E{first_layer_scan_unretract_length|abs} F{lc_macro.first_layer_scan_retract_speed|float * 60}
	{% endif %}
	
	
	M104 S{lc_macro.wait.previous_temp}
	M109 S{lc_macro.wait.previous_temp}
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Heating back up to previous temperature"}' {% endif %}
	
	
	{% if lc_macro.wait.absolute_coordinates %} G90 {% endif %}
	{% if lc_macro.wait.absolute_extrude %}
	M82
	G92 E{lc_macro.wait.e}
	{% endif %}
	{% endif %}

[gcode_macro OBICO_LINK_STATUS]
description = Link to Obico server
variable_one_time_passcode = ''
variable_one_time_passlink = ''
variable_is_linked = False
gcode = 
	{action_respond_info('Obico one_time_passcode: {}'.format(one_time_passcode))}
	{action_respond_info('Obico one_time_passlink: {}'.format(one_time_passlink))}
	{action_respond_info('Obico is_linked: {}'.format(is_linked))}
	{% if not is_linked and one_time_passcode != '' %}
	M117 Code: {one_time_passcode}
	{% else %}
	M117 Obico linked
	{% endif %}

[gcode_macro _OBICO_RELINK]
description = Re-link to Obico server
gcode = 
	{action_respond_info('WARNING: Re-link to Obico server')}
	{action_call_remote_method("obico_remote_event", event_name='relink_obico', message='')}
	{action_respond_info('WARNING: relink_obico requested')}

[exclude_object]

[mcu]
serial = /dev/serial/by-id/usb-1a86_USB_Serial-if00-port0
restart_method = command

[temperature_sensor raspberry_pi]
sensor_type = temperature_host
min_temp = 10
max_temp = 100

[temperature_sensor mcu_temp]
sensor_type = temperature_mcu
min_temp = 0
max_temp = 100

[printer]
kinematics = cartesian
max_velocity = 200
max_accel = 4000
max_z_velocity = 10
max_z_accel = 100
minimum_cruise_ratio = 0.5
square_corner_velocity = 5

[stepper_x]
step_pin = PB9
dir_pin = PC2
enable_pin = !PC3
microsteps = 16
rotation_distance = 40
endstop_pin = ^PA5
position_endstop = 0
position_max = 230
homing_speed = 50

[stepper_y]
step_pin = PB7
dir_pin = PB8
enable_pin = !PC3
microsteps = 16
rotation_distance = 40
endstop_pin = ^PA6
position_endstop = 0
position_max = 231
homing_speed = 50

[stepper_z]
step_pin = PB5
dir_pin = !PB6
enable_pin = !PC3
microsteps = 16
rotation_distance = 8
endstop_pin = probe:z_virtual_endstop
position_max = 250
position_min = -4
homing_speed = 4
second_homing_speed = 1
homing_retract_dist = 2.0

[fan]
pin = PA0

[extruder]
max_extrude_only_distance = 100.0
step_pin = PB3
dir_pin = PB4
enable_pin = !PC3
microsteps = 16
gear_ratio = 42:12
rotation_distance = 26.359
nozzle_diameter = 0.400
filament_diameter = 1.750
heater_pin = PA1
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PC5
min_temp = 0
max_temp = 300
min_extrude_temp = 170
pressure_advance = .0369
pressure_advance_smooth_time = 0.04
control = pid
pid_kp = 19.195
pid_ki = 1.000
pid_kd = 92.135

[firmware_retraction]
retract_length = 0.3
retract_speed = 20

[idle_timeout]
gcode = 
	{% if printer.pause_resume.is_paused %}
	M118 Idle timeout while paused, turning off hotend
	SET_HEATER_TEMPERATURE HEATER=extruder TARGET=0
	{% else %}
	M118 Idle timeout
	TURN_OFF_HEATERS
	M84
	{% endif %}
timeout = 1800

[heater_bed]
heater_pin = PA2
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PC4
min_temp = 0
max_temp = 130
control = pid
pid_kp = 68.601
pid_ki = 1.185
pid_kd = 993.000

[bltouch]
sensor_pin = ^PB1
control_pin = PB0
x_offset = -31.8
y_offset = -40.5
speed = 35
samples = 2
samples_result = median
samples_tolerance = 0.05
samples_tolerance_retries = 2
sample_retract_dist = 5.0
probe_with_touch_mode = true
stow_on_each_sample = false
z_offset = 2.049

[safe_z_home]
home_xy_position = 147, 154
speed = 75
z_hop = 10
z_hop_speed = 5
move_to_previous = false

[bed_screws]
screw1 = 30,51
screw1_name = "FL"
screw2 = 200,51
screw2_name = "FR"
screw3 = 200,195
screw3_name = "RR"
screw4 = 30,195
screw4_name = "RL"

[screws_tilt_adjust]
screw1 = 67, 67
screw1_name = front left screw
screw2 = 230, 67
screw2_name = front right screw
screw3 = 230, 230
screw3_name = rear right screw
screw4 = 67.60, 230
screw4_name = rear left screw
horizontal_move_z = 10
speed = 200
screw_thread = CW-M4

[bed_mesh]
speed = 120
mesh_min = 10,11
mesh_max = 195,182
probe_count = 3,3
algorithm = bicubic
fade_start = 1
fade_end = 10
fade_target = 0

[filament_motion_sensor SFS_T0]
detection_length = 150.00
extruder = extruder
switch_pin = PA4
pause_on_runout = True
event_delay = 3.0
pause_delay = 0.5
runout_gcode = 
	M117 Runout Detected!

[delayed_gcode DISABLEFILAMENTSENSOR]
initial_duration = 1
gcode = 
	SET_FILAMENT_SENSOR SENSOR=SFS_T0 ENABLE=0

[gcode_macro SFS_ENABLE]
description = Enable smart filament sensor
gcode = 
	M117 ENABLING the Smart Filament Sensor
	G92 E0
	SET_FILAMENT_SENSOR SENSOR=SFS_T0 ENABLE=1

[gcode_macro SFS_DISABLE]
description = Disable smart filament sensor
gcode = 
	M117 DISABLING the Smart Filament Sensor
	G92 E0
	SET_FILAMENT_SENSOR SENSOR=SFS_T0 ENABLE=0

[gcode_macro FILAMENT_RUNOUT]
gcode = 
	M117 Runout Detected!
	M300 S1 P10
	M600
	M300 S1 P10

[gcode_macro M300]
gcode = 
	{% set S = params.S|default(1000)|int %}
	{% set P = params.P|default(100)|int %}
	SET_PIN PIN=BEEPER VALUE=0.5 CYCLE_TIME={ 1.0/S if S > 0 else 1 }
	G4 P{P}
	SET_PIN PIN=BEEPER VALUE=0
	[gcode_macro M600]
	gcode:
	{% set X = params.X|default(25)|float %}
	{% set Y = params.Y|default(25)|float %}
	{% set Z = params.Z|default(10)|float %}
	SAVE_GCODE_STATE NAME=M600_state
	PAUSE
	G91
	G1 E-.8 F2700
	G1 Z{Z}
	G90
	G1 X{X} Y{Y} F3000
	G91
	G1 E-15 F1000
	RESTORE_GCODE_STATE NAME=M600_state

[gcode_arcs]
resolution = 1.0

[input_shaper]
shaper_freq_x = 73.5
shaper_type_x = ei
shaper_freq_y = 76.9
shaper_type_y = mzv
=======================
bed_mesh: bicubic interpolation with a probe_count of less than 4 points detected.  Forcing lagrange interpolation. Configured Probe Count: 3, 3
Extruder max_extrude_ratio=0.266081
mcu 'mcu': Starting serial connect
mcu 'mcu': got {'oid': 17, 'next_clock': 2150568832, 'value': 31505, '#name': 'analog_in_state', '#sent_time': 22.801108912, '#receive_time': 22.843095338}
mcu 'mcu': got {'count': 185, 'sum': 367735, 'sumsq': 3463984, '#name': 'stats', '#sent_time': 22.90961519, '#receive_time': 22.912602949}
mcu 'mcu': got {'oid': 10, 'next_clock': 2167128832, 'value': 14013, '#name': 'analog_in_state', '#sent_time': 23.019300412000003, '#receive_time': 23.073098727}
mcu 'mcu': got {'oid': 12, 'next_clock': 2168568832, 'value': 31558, '#name': 'analog_in_state', '#sent_time': 23.073793838, '#receive_time': 23.093120004000003}
mcu 'mcu': got {'oid': 17, 'next_clock': 2172168832, 'value': 31505, '#name': 'analog_in_state', '#sent_time': 23.128394023000002, '#receive_time': 23.143112949000002}
Loaded MCU 'mcu' 119 commands (v0.12.0-286-g81de9a861 / gcc: (15:8-2019-q3-1+b1) 8.3.1 20190703 (release) [gcc-8-branch revision 273027] binutils: (2.35.2-2+14+b2) 2.35.2)
MCU 'mcu' config: ADC_MAX=4095 BUS_PINS_i2c1=PB6,PB7 BUS_PINS_i2c1a=PB8,PB9 BUS_PINS_i2c2=PB10,PB11 BUS_PINS_spi1=PA6,PA7,PA5 BUS_PINS_spi1a=PB4,PB5,PB3 BUS_PINS_spi2=PB14,PB15,PB13 BUS_PINS_spi3=PB4,PB5,PB3 CLOCK_FREQ=72000000 MCU=stm32f103xe PWM_MAX=255 RECEIVE_WINDOW=192 RESERVE_PINS_serial=PA10,PA9 SERIAL_BAUD=250000 STATS_SUMSQ_BASE=256 STEPPER_BOTH_EDGE=1
mcu_temperature 'mcu' nominal base=357.558140 slope=-767.441860
Configured MCU 'mcu' (1024 moves)
Starting heater checks for heater_bed
webhooks client 547837629920: New connection
bed_mesh: generated points
Index |  Tool Adjusted  |   Probe
  0   | (41.8, 51.5)    | (10.0, 11.0)
  1   | (134.3, 51.5)   | (102.5, 11.0)
  2   | (226.8, 51.5)   | (195.0, 11.0)
  3   | (226.8, 137.0)  | (195.0, 96.5)
  4   | (134.3, 137.0)  | (102.5, 96.5)
  5   | (41.8, 137.0)   | (10.0, 96.5)
  6   | (41.8, 222.5)   | (10.0, 182.0)
  7   | (134.3, 222.5)  | (102.5, 182.0)
  8   | (226.8, 222.5)  | (195.0, 182.0)
Starting heater checks for extruder
Stats 24.3: gcodein=0  mcu: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=1146 bytes_read=4690 bytes_retransmit=9 bytes_invalid=0 send_seq=118 receive_seq=118 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72001624  raspberry_pi: temp=52.6 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.26 cputime=1.895 memavail=1591692 print_time=107882.654 buffer_time=0.249 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
webhooks client 547837629920: Client info {'program': 'Moonraker', 'version': 'v0.9.3-3-gccfe32f'}
webhooks: registering remote method 'shutdown_machine' for connection id: 547837629920
webhooks: registering remote method 'reboot_machine' for connection id: 547837629920
webhooks: registering remote method 'pause_job_queue' for connection id: 547837629920
webhooks: registering remote method 'start_job_queue' for connection id: 547837629920
webhooks: registering remote method 'spoolman_set_active_spool' for connection id: 547837629920
Stats 25.3: gcodein=0  mcu: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=1152 bytes_read=4886 bytes_retransmit=9 bytes_invalid=0 send_seq=119 receive_seq=119 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72001113  raspberry_pi: temp=53.6 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.72 cputime=1.934 memavail=1587984 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 26.3: gcodein=0  mcu: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=1158 bytes_read=5037 bytes_retransmit=9 bytes_invalid=0 send_seq=120 receive_seq=120 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000448  raspberry_pi: temp=54.0 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.72 cputime=1.954 memavail=1588176 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
webhooks: registering remote method 'obico_remote_event' for connection id: 547837629920
Stats 27.3: gcodein=0  mcu: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=1164 bytes_read=5188 bytes_retransmit=9 bytes_invalid=0 send_seq=121 receive_seq=121 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000346  raspberry_pi: temp=52.6 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.72 cputime=1.969 memavail=1575672 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 28.3: gcodein=0  mcu: mcu_awake=0.003 mcu_task_avg=0.000021 mcu_task_stddev=0.000012 bytes_write=1170 bytes_read=5399 bytes_retransmit=9 bytes_invalid=0 send_seq=122 receive_seq=122 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000510  raspberry_pi: temp=54.0 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.72 cputime=1.982 memavail=1572460 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 29.3: gcodein=0  mcu: mcu_awake=0.003 mcu_task_avg=0.000021 mcu_task_stddev=0.000012 bytes_write=1176 bytes_read=5550 bytes_retransmit=9 bytes_invalid=0 send_seq=123 receive_seq=123 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000582  raspberry_pi: temp=53.1 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.72 cputime=1.994 memavail=1575604 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 30.3: gcodein=0  mcu: mcu_awake=0.003 mcu_task_avg=0.000021 mcu_task_stddev=0.000012 bytes_write=1182 bytes_read=5701 bytes_retransmit=9 bytes_invalid=0 send_seq=124 receive_seq=124 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000574  raspberry_pi: temp=53.1 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.74 cputime=2.007 memavail=1562496 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 31.3: gcodein=0  mcu: mcu_awake=0.003 mcu_task_avg=0.000021 mcu_task_stddev=0.000012 bytes_write=1188 bytes_read=5897 bytes_retransmit=9 bytes_invalid=0 send_seq=125 receive_seq=125 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000403  raspberry_pi: temp=53.1 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.74 cputime=2.017 memavail=1561692 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 32.3: gcodein=0  mcu: mcu_awake=0.003 mcu_task_avg=0.000021 mcu_task_stddev=0.000012 bytes_write=1194 bytes_read=6048 bytes_retransmit=9 bytes_invalid=0 send_seq=126 receive_seq=126 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000297  raspberry_pi: temp=52.1 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.74 cputime=2.026 memavail=1561468 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 33.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1200 bytes_read=6228 bytes_retransmit=9 bytes_invalid=0 send_seq=127 receive_seq=127 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000296  raspberry_pi: temp=53.1 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.74 cputime=2.035 memavail=1561244 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 34.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1206 bytes_read=6409 bytes_retransmit=9 bytes_invalid=0 send_seq=128 receive_seq=128 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000242  raspberry_pi: temp=51.6 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.74 cputime=2.045 memavail=1555540 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 35.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1212 bytes_read=6560 bytes_retransmit=9 bytes_invalid=0 send_seq=129 receive_seq=129 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000254  raspberry_pi: temp=52.6 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.92 cputime=2.056 memavail=1555104 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 36.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1218 bytes_read=6726 bytes_retransmit=9 bytes_invalid=0 send_seq=130 receive_seq=130 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000242  raspberry_pi: temp=51.1 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.92 cputime=2.071 memavail=1555120 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 37.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1224 bytes_read=6907 bytes_retransmit=9 bytes_invalid=0 send_seq=131 receive_seq=131 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000249  raspberry_pi: temp=52.1 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.92 cputime=2.086 memavail=1555120 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 38.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1230 bytes_read=7072 bytes_retransmit=9 bytes_invalid=0 send_seq=132 receive_seq=132 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000240  raspberry_pi: temp=51.6 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.92 cputime=2.101 memavail=1555124 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 39.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1236 bytes_read=7238 bytes_retransmit=9 bytes_invalid=0 send_seq=133 receive_seq=133 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000237  raspberry_pi: temp=51.1 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.92 cputime=2.115 memavail=1555380 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 40.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1242 bytes_read=7419 bytes_retransmit=9 bytes_invalid=0 send_seq=134 receive_seq=134 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000246  raspberry_pi: temp=51.1 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.01 cputime=2.131 memavail=1556712 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 41.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1248 bytes_read=7570 bytes_retransmit=9 bytes_invalid=0 send_seq=135 receive_seq=135 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000252  raspberry_pi: temp=52.1 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=2.01 cputime=2.145 memavail=1556212 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 42.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1254 bytes_read=7736 bytes_retransmit=9 bytes_invalid=0 send_seq=136 receive_seq=136 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000247  raspberry_pi: temp=52.1 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.01 cputime=2.160 memavail=1555988 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 43.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1260 bytes_read=7931 bytes_retransmit=9 bytes_invalid=0 send_seq=137 receive_seq=137 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000239  raspberry_pi: temp=51.6 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.01 cputime=2.175 memavail=1555988 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 44.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1266 bytes_read=8082 bytes_retransmit=9 bytes_invalid=0 send_seq=138 receive_seq=138 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000235  raspberry_pi: temp=51.1 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.01 cputime=2.190 memavail=1555744 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 45.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1272 bytes_read=8248 bytes_retransmit=9 bytes_invalid=0 send_seq=139 receive_seq=139 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000237  raspberry_pi: temp=51.1 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.09 cputime=2.204 memavail=1555744 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 46.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1278 bytes_read=8429 bytes_retransmit=9 bytes_invalid=0 send_seq=140 receive_seq=140 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000232  raspberry_pi: temp=51.1 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.09 cputime=2.218 memavail=1555784 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 47.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1284 bytes_read=8580 bytes_retransmit=9 bytes_invalid=0 send_seq=141 receive_seq=141 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000229  raspberry_pi: temp=51.1 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.09 cputime=2.233 memavail=1555784 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 48.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1290 bytes_read=8760 bytes_retransmit=9 bytes_invalid=0 send_seq=142 receive_seq=142 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000228  raspberry_pi: temp=51.1 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.09 cputime=2.247 memavail=1555784 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 49.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1296 bytes_read=8941 bytes_retransmit=9 bytes_invalid=0 send_seq=143 receive_seq=143 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000228  raspberry_pi: temp=51.1 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.09 cputime=2.262 memavail=1555784 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 50.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1302 bytes_read=9092 bytes_retransmit=9 bytes_invalid=0 send_seq=144 receive_seq=144 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000228  raspberry_pi: temp=51.1 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.16 cputime=2.276 memavail=1555784 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 51.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1308 bytes_read=9258 bytes_retransmit=9 bytes_invalid=0 send_seq=145 receive_seq=145 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000225  raspberry_pi: temp=51.6 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.16 cputime=2.292 memavail=1555796 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 52.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1314 bytes_read=9433 bytes_retransmit=9 bytes_invalid=0 send_seq=146 receive_seq=146 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000224  raspberry_pi: temp=51.6 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.16 cputime=2.307 memavail=1555796 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 53.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1320 bytes_read=9588 bytes_retransmit=9 bytes_invalid=0 send_seq=147 receive_seq=147 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000222  raspberry_pi: temp=51.6 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.16 cputime=2.322 memavail=1555796 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 54.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1326 bytes_read=9743 bytes_retransmit=9 bytes_invalid=0 send_seq=148 receive_seq=148 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000226  raspberry_pi: temp=51.6 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.16 cputime=2.336 memavail=1555560 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 55.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1332 bytes_read=9912 bytes_retransmit=9 bytes_invalid=0 send_seq=149 receive_seq=149 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000223  raspberry_pi: temp=50.1 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.15 cputime=2.352 memavail=1555308 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 56.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1338 bytes_read=10063 bytes_retransmit=9 bytes_invalid=0 send_seq=150 receive_seq=150 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000220  raspberry_pi: temp=51.1 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.15 cputime=2.366 memavail=1555124 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 57.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1344 bytes_read=10229 bytes_retransmit=9 bytes_invalid=0 send_seq=151 receive_seq=151 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000216  raspberry_pi: temp=50.6 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.15 cputime=2.380 memavail=1555124 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 58.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1350 bytes_read=10410 bytes_retransmit=9 bytes_invalid=0 send_seq=152 receive_seq=152 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000220  raspberry_pi: temp=50.6 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.15 cputime=2.395 memavail=1555124 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 59.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1356 bytes_read=10575 bytes_retransmit=9 bytes_invalid=0 send_seq=153 receive_seq=153 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000220  raspberry_pi: temp=50.1 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.15 cputime=2.410 memavail=1555124 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 60.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1362 bytes_read=10741 bytes_retransmit=9 bytes_invalid=0 send_seq=154 receive_seq=154 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000216  raspberry_pi: temp=50.1 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=2.22 cputime=2.423 memavail=1555124 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 61.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1368 bytes_read=10922 bytes_retransmit=9 bytes_invalid=0 send_seq=155 receive_seq=155 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000216  raspberry_pi: temp=51.1 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.22 cputime=2.437 memavail=1555124 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 62.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1374 bytes_read=11073 bytes_retransmit=9 bytes_invalid=0 send_seq=156 receive_seq=156 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000220  raspberry_pi: temp=49.7 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=2.22 cputime=2.451 memavail=1555124 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 63.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1380 bytes_read=11239 bytes_retransmit=9 bytes_invalid=0 send_seq=157 receive_seq=157 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000218  raspberry_pi: temp=50.6 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.22 cputime=2.467 memavail=1555144 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 64.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1386 bytes_read=11434 bytes_retransmit=9 bytes_invalid=0 send_seq=158 receive_seq=158 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000218  raspberry_pi: temp=50.1 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.22 cputime=2.483 memavail=1555144 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 65.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1392 bytes_read=11585 bytes_retransmit=9 bytes_invalid=0 send_seq=159 receive_seq=159 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000216  raspberry_pi: temp=51.1 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.20 cputime=2.497 memavail=1555144 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 66.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1398 bytes_read=11766 bytes_retransmit=9 bytes_invalid=0 send_seq=160 receive_seq=160 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000213  raspberry_pi: temp=50.6 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.20 cputime=2.512 memavail=1555144 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 67.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1404 bytes_read=11932 bytes_retransmit=9 bytes_invalid=0 send_seq=161 receive_seq=161 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000214  raspberry_pi: temp=50.1 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=2.20 cputime=2.526 memavail=1555144 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 68.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1410 bytes_read=12083 bytes_retransmit=9 bytes_invalid=0 send_seq=162 receive_seq=162 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000213  raspberry_pi: temp=51.1 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.20 cputime=2.542 memavail=1555144 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 69.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1416 bytes_read=12278 bytes_retransmit=9 bytes_invalid=0 send_seq=163 receive_seq=163 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000213  raspberry_pi: temp=50.1 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=2.20 cputime=2.557 memavail=1555144 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 70.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1422 bytes_read=12444 bytes_retransmit=9 bytes_invalid=0 send_seq=164 receive_seq=164 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000213  raspberry_pi: temp=51.1 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.18 cputime=2.571 memavail=1555144 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 71.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1428 bytes_read=12595 bytes_retransmit=9 bytes_invalid=0 send_seq=165 receive_seq=165 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000214  raspberry_pi: temp=50.6 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.18 cputime=2.586 memavail=1555148 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 72.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1434 bytes_read=12776 bytes_retransmit=9 bytes_invalid=0 send_seq=166 receive_seq=166 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000212  raspberry_pi: temp=50.1 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=2.18 cputime=2.601 memavail=1555148 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 73.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1440 bytes_read=12942 bytes_retransmit=9 bytes_invalid=0 send_seq=167 receive_seq=167 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000211  raspberry_pi: temp=51.6 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.18 cputime=2.616 memavail=1555148 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 74.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1446 bytes_read=13107 bytes_retransmit=9 bytes_invalid=0 send_seq=168 receive_seq=168 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000210  raspberry_pi: temp=51.1 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=2.18 cputime=2.630 memavail=1554660 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 75.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1452 bytes_read=13288 bytes_retransmit=9 bytes_invalid=0 send_seq=169 receive_seq=169 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000207  raspberry_pi: temp=49.7 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=2.33 cputime=2.644 memavail=1554660 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 76.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1458 bytes_read=13454 bytes_retransmit=9 bytes_invalid=0 send_seq=170 receive_seq=170 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000208  raspberry_pi: temp=49.7 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.33 cputime=2.659 memavail=1554468 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 77.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1464 bytes_read=13605 bytes_retransmit=9 bytes_invalid=0 send_seq=171 receive_seq=171 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000207  raspberry_pi: temp=50.6 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.33 cputime=2.673 memavail=1554468 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 78.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1470 bytes_read=13786 bytes_retransmit=9 bytes_invalid=0 send_seq=172 receive_seq=172 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000204  raspberry_pi: temp=49.7 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.33 cputime=2.687 memavail=1554244 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 79.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1476 bytes_read=13966 bytes_retransmit=9 bytes_invalid=0 send_seq=173 receive_seq=173 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000205  raspberry_pi: temp=49.7 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.33 cputime=2.702 memavail=1554244 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 80.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1482 bytes_read=14117 bytes_retransmit=9 bytes_invalid=0 send_seq=174 receive_seq=174 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000205  raspberry_pi: temp=50.1 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.22 cputime=2.716 memavail=1554244 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 81.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1488 bytes_read=14298 bytes_retransmit=9 bytes_invalid=0 send_seq=175 receive_seq=175 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000204  raspberry_pi: temp=50.6 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.22 cputime=2.731 memavail=1554244 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 82.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1494 bytes_read=14464 bytes_retransmit=9 bytes_invalid=0 send_seq=176 receive_seq=176 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000204  raspberry_pi: temp=50.1 mcu_temp: temp=29.1 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.22 cputime=2.745 memavail=1554248 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 83.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1506 bytes_read=14615 bytes_retransmit=9 bytes_invalid=0 send_seq=178 receive_seq=177 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000202  raspberry_pi: temp=51.6 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=2.22 cputime=2.761 memavail=1554248 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 84.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1512 bytes_read=14826 bytes_retransmit=9 bytes_invalid=0 send_seq=179 receive_seq=179 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000203  raspberry_pi: temp=50.6 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.22 cputime=2.776 memavail=1553996 print_time=107882.654 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Starting Klippy...
Args: ['/home/coon/klipper/klippy/klippy.py', '/home/coon/printer_data/config/printer.cfg', '-l', '/home/coon/printer_data/logs/klippy.log', '-I', '/home/coon/printer_data/comms/klippy.serial', '-a', '/home/coon/printer_data/comms/klippy.sock']
Git version: 'v0.12.0-404-g80d185c94'
Branch: master
Remote: origin
Tracked URL: https://github.com/Klipper3d/klipper.git
CPU: 4 core ?
Python: '3.9.2 (default, Dec  1 2024, 12:12:57) \n[GCC 10.2.1 20210110]'
Start printer at Sun Dec 22 18:42:01 2024 (1734910921.4 2572.0)
===== Config file =====
[virtual_sdcard]
path = ~/printer_data/gcodes
on_error_gcode = CANCEL_PRINT

[pause_resume]
recover_velocity = 25

[display_status]

[respond]
default_prefix = 

[gcode_macro CANCEL_PRINT]
description = Cancel the actual running print
rename_existing = BASE_CANCEL_PRINT
gcode = 
	G91
	G0 Z10 F600
	G90
	TURN_OFF_HEATERS
	G0 X5 Y220
	CLEAR_PAUSE
	
	BASE_CANCEL_PRINT

[gcode_macro PAUSE]
description = Pause the actual running print
rename_existing = PAUSE_BASE
gcode = 
	
	{% set x = params.X|default(5) %}
	{% set y = params.Y|default(225) %}
	{% set z = params.Z|default(10)|float %}
	{% set e = params.E|default(1) %}
	
	{% set max_z = printer.toolhead.axis_maximum.z|float %}
	{% set act_z = printer.toolhead.position.z|float %}
	{% set lift_z = z|abs %}
	{% if act_z < (max_z - lift_z) %}
	{% set z_safe = lift_z %}
	{% else %}
	{% set z_safe = max_z - act_z %}
	{% endif %}
	
	PAUSE_BASE
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E-{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	{% if "xyz" in printer.toolhead.homed_axes %}
	G1 Z{z_safe}
	G90
	G1 X{x} Y{y} F6000
	{% else %}
	{action_respond_info("Printer not homed")}
	{% endif %}

[gcode_macro RESUME]
description = Resume the actual running print
rename_existing = RESUME_BASE
variable_last_extruder_temp = {'restore': False, 'temp': 0}
variable_restore_idle_timeout = 0
variable_idle_state = False
gcode = 
	
	{% set e = params.E|default(1) %}
	
	{% if 'VELOCITY' in params|upper %}
	{% set get_params = ('VELOCITY=' + params.VELOCITY)  %}
	{%else %}
	{% set get_params = "" %}
	{% endif %}
	
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	RESUME_BASE {get_params}

[gcode_macro SET_PAUSE_NEXT_LAYER]
description = Enable a pause if the next layer is reached
gcode = 
	{% set pause_next_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_next_layer %}
	{% set ENABLE = params.ENABLE|default(1)|int != 0 %}
	{% set MACRO = params.MACRO|default(pause_next_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_next_layer VALUE="{{ 'enable': ENABLE, 'call': MACRO }}"

[gcode_macro SET_PAUSE_AT_LAYER]
description = Enable/disable a pause if a given layer number is reached
gcode = 
	{% set pause_at_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_at_layer %}
	{% set ENABLE = params.ENABLE|int != 0 if params.ENABLE is defined
	else params.LAYER is defined %}
	{% set LAYER = params.LAYER|default(pause_at_layer.layer)|int %}
	{% set MACRO = params.MACRO|default(pause_at_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_at_layer VALUE="{{ 'enable': ENABLE, 'layer': LAYER, 'call': MACRO }}"

[gcode_macro SET_PRINT_STATS_INFO]
rename_existing = SET_PRINT_STATS_INFO_BASE
description = Overwrite, to get pause_next_layer and pause_at_layer feature
variable_pause_next_layer = { 'enable': False, 'call': "PAUSE" }
variable_pause_at_layer = { 'enable': False, 'layer': 0, 'call': "PAUSE" }
gcode = 
	{% if pause_next_layer.enable %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_next_layer" % pause_next_layer.call}'
	{pause_next_layer.call}
	SET_PAUSE_NEXT_LAYER ENABLE=0
	{% elif pause_at_layer.enable and params.CURRENT_LAYER is defined and params.CURRENT_LAYER|int == pause_at_layer.layer %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_at_layer [%d]" % (pause_at_layer.call, pause_at_layer.layer)}'
	{pause_at_layer.call}
	SET_PAUSE_AT_LAYER ENABLE=0
	{% endif %}
	SET_PRINT_STATS_INFO_BASE {rawparams}

[gcode_macro _TOOLHEAD_PARK_PAUSE_CANCEL]
description = Helper: park toolhead used in PAUSE and CANCEL_PRINT
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set velocity = printer.configfile.settings.pause_resume.recover_velocity %}
	{% set use_custom     = client.use_custom_pos|default(false)|lower == 'true' %}
	{% set custom_park_x  = client.custom_park_x|default(0.0) %}
	{% set custom_park_y  = client.custom_park_y|default(0.0) %}
	{% set park_dz        = client.custom_park_dz|default(2.0)|abs %}
	{% set sp_hop         = client.speed_hop|default(15) * 60 %}
	{% set sp_move        = client.speed_move|default(velocity) * 60 %}
	
	{% set origin    = printer.gcode_move.homing_origin %}
	{% set act       = printer.gcode_move.gcode_position %}
	{% set max       = printer.toolhead.axis_maximum %}
	{% set cone      = printer.toolhead.cone_start_z|default(max.z) %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	
	{% set z_min = params.Z_MIN|default(0)|float %}
	{% set z_park = [[(act.z + park_dz), z_min]|max, (max.z - origin.z)]|min %}
	{% set x_park = params.X       if params.X is defined
	else custom_park_x  if use_custom
	else 0.0            if round_bed
	else (max.x - 5.0) %}
	{% set y_park = params.Y       if params.Y is defined
	else custom_park_y  if use_custom
	else (max.y - 5.0)  if round_bed and z_park < cone
	else 0.0            if round_bed
	else (max.y - 5.0) %}
	
	_CLIENT_RETRACT
	{% if "xyz" in printer.toolhead.homed_axes %}
	G90
	G1 Z{z_park} F{sp_hop}
	G1 X{x_park} Y{y_park} F{sp_move}
	{% if not printer.gcode_move.absolute_coordinates %} G91 {% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='Printer not homed'
	{% endif %}

[gcode_macro _CLIENT_EXTRUDE]
description = Extrudes, if the extruder is hot enough
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set use_fw_retract = (client.use_fw_retract|default(false)|lower == 'true') and (printer.firmware_retraction is defined) %}
	{% set length = params.LENGTH|default(client.unretract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_unretract)|default(35) %}
	{% set absolute_extrude = printer.gcode_move.absolute_extrude %}
	
	{% if printer.toolhead.extruder != '' %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if use_fw_retract %}
	{% if length < 0 %}
	G10
	{% else %}
	G11
	{% endif %}
	{% else %}
	M83
	G1 E{length} F{(speed|float|abs) * 60}
	{% if absolute_extrude %}
	M82
	{% endif %}
	{% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='{"\"%s\" not hot enough" % printer.toolhead.extruder}'
	{% endif %}
	{% endif %}

[gcode_macro _CLIENT_RETRACT]
description = Retracts, if the extruder is hot enough
gcode = 
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set length = params.LENGTH|default(client.retract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_retract)|default(35) %}
	
	_CLIENT_EXTRUDE LENGTH=-{length|float|abs} SPEED={speed|float|abs}

[gcode_macro _CLIENT_LINEAR_MOVE]
description = Linear move with save and restore of the gcode state
gcode = 
	{% set x_move = "X" ~ params.X if params.X is defined else "" %}
	{% set y_move = "Y" ~ params.Y if params.Y is defined else "" %}
	{% set z_move = "Z" ~ params.Z if params.Z is defined else "" %}
	{% set e_move = "E" ~ params.E if params.E is defined else "" %}
	{% set rate = "F" ~ params.F if params.F is defined else "" %}
	{% set ABSOLUTE = params.ABSOLUTE | default(0) | int != 0 %}
	{% set ABSOLUTE_E = params.ABSOLUTE_E | default(0) | int != 0 %}
	SAVE_GCODE_STATE NAME=_client_movement
	{% if x_move or y_move or z_move %}
	G9{ 0 if ABSOLUTE else 1 }
	{% endif %}
	{% if e_move %}
	M8{ 2 if ABSOLUTE_E else 3 }
	{% endif %}
	G1 { x_move } { y_move } { z_move } { e_move } { rate }
	RESTORE_GCODE_STATE NAME=_client_movement

[gcode_macro play_test]
gcode = 
	RESPOND TYPE=command MSG="action:prompt_begin Question"
	RESPOND TYPE=command MSG="action:prompt_text Do you wont to cancel the print?"
	RESPOND TYPE=command MSG="action:prompt_footer_button continue|RESPOND TYPE=command MSG=action:prompt_end"
	RESPOND TYPE=command MSG="action:prompt_footer_button CANCEL|CANCEL_PRINT|error"
	RESPOND TYPE=command MSG="action:prompt_show"

[gcode_macro PRINT_START]
gcode = 
	START_PRINT {rawparams}

[gcode_macro START_PRINT]
gcode = 
	{% set BED_TEMP = params.BED_TEMP|default(60)|float %}
	{% set EXTRUDER_TEMP = params.EXTRUDER_TEMP|default(190)|float %}
	
	M190 S{BED_TEMP}
	
	G90
	
	G28
	
	RESPOND MSG="Bed Meshing"
	
	
	
	
	
	
	
	
	BED_MESH_CLEAR
	BED_MESH_CALIBRATE ADAPTIVE=1
	
	
	
	
	
	
	
	RESPOND MSG="Heating to print temp"
	M104 S{EXTRUDER_TEMP}
	G0 Z40 F240
	M109 S{EXTRUDER_TEMP}
	RESPOND MSG="Enable Runout Sensor"
	SFS_ENABLE
	RESPOND MSG="Line Purge"
	LINE_PURGE
	RESPOND MSG="Print Started"

[gcode_macro LINE_PURGE]
gcode = 
	G92 E0
	G1 Z2.0 F3000
	G1 X0.1 Y20 Z0.3 F5000.0
	G1 X0.1 Y200.0 Z0.3 F1500.0 E15
	G1 X0.4 Y200.0 Z0.3 F5000.0
	G1 X0.4 Y20 Z0.3 F1500.0 E30
	G92 E0
	G1 Z2.0 F3000
	G1 X5 Y20 Z0.3 F5000.0

[gcode_macro PRINT_END]
gcode = 
	END_PRINT

[gcode_macro END_PRINT]
gcode = 
	
	
	RESPOND MSG="Print Finished"
	G91
	G1 E-.5 Z0.2 F2400
	G1 X5 Y5 F6000
	G1 Z10
	G90
	SFS_DISABLE
	
	G1 X0 Y220 F6000
	M106 S0
	M104 S0
	M140 S0
	
	M84 X Y E

[gcode_macro SET_ACTIVE_SPOOL]
gcode = 
	{% if params.ID %}
	{% set id = params.ID|int %}
	{action_call_remote_method(
	"spoolman_set_active_spool",
	spool_id=id
	)}
	{% else %}
	{action_respond_info("Parameter 'ID' is required")}
	{% endif %}

[gcode_macro CLEAR_ACTIVE_SPOOL]
gcode = 
	{action_call_remote_method(
	"spoolman_set_active_spool",
	spool_id=None
	)}

[gcode_macro G29]
gcode = 
	G28
	BED_MESH_CALIBRATE
	G0 X0 Y0 Z10 F6000
	BED_MESH_PROFILE save=default

[gcode_macro M125]
gcode = 
	SAVE_GCODE_STATE NAME=parking
	M117 Parking toolhead
	G91
	G1 Z10 F600
	G90
	G1 X5 Y225 F4000
	RESTORE_GCODE_STATE NAME=parking

[gcode_macro Load_Filament]
gcode = 
	SAVE_GCODE_STATE NAME=loading_filament
	M117 Loading Filament
	M83
	G92 E0.0
	G91
	G1 E50 F200
	G92 E50
	RESTORE_GCODE_STATE NAME=loading_filament

[gcode_macro Unload_Filament]
gcode = 
	SAVE_GCODE_STATE NAME=unloading_filament
	M117 Unloading Filament
	G91
	G1 E5 F100
	G92 E0.0
	G1 E-50 F5000
	G92 E-50
	RESTORE_GCODE_STATE NAME=unloading_filament

[gcode_macro Filament_Change]
gcode = 
	
	SAVE_GCODE_STATE NAME=filament_change
	
	Unload_Filament
	
	RESPOND TYPE=command MSG="action:prompt_begin Question"
	RESPOND TYPE=command MSG="action:prompt_text Please insert new filament and confirm"
	RESPOND TYPE=command MSG="action:prompt_footer_button CONFIRM|Load_Filament|RESPOND TYPE=command MSG=action:prompt_end"
	RESPOND TYPE=command MSG="action:prompt_footer_button CANCEL|RESPOND TYPE=command MSG=action:prompt_end"
	RESPOND TYPE=command MSG="action:prompt_show"
	
	RESTORE_GCODE_STATE NAME=filament_change

[gcode_macro Calibrate_Hotend_PID]
gcode = 
	PID_CALIBRATE HEATER=extruder TARGET=200

[gcode_macro Calibrate_Bed_PID]
gcode = 
	PID_CALIBRATE HEATER=heater_bed TARGET=60

[gcode_macro Calibrate_Zoffset]
gcode = 
	PROBE_CALIBRATE

[gcode_macro Tram_bed]
gcode = 
	SCREWS_TILT_CALCULATE

[gcode_macro TEST_SPEED]
description = Test for max speed and acceleration parameters for the printer. Procedure: Home -> ReadPositionFromMCU -> MovesToolhead@Vel&Accel -> Home -> ReadPositionfromMCU
gcode = 
	
	{% set speed  = params.SPEED|default(printer.configfile.settings.printer.max_velocity)|int %}
	
	{% set iterations = params.ITERATIONS|default(5)|int %}
	
	{% set accel  = params.ACCEL|default(printer.configfile.settings.printer.max_accel)|int %}
	
	{% set min_cruise_ratio = params.MIN_CRUISE_RATIO|default(0.5)|float %}
	
	{% set bound = params.BOUND|default(20)|int %}
	
	{% set smallpatternsize = SMALLPATTERNSIZE|default(20)|int %}
	
	
	
	{% set x_min = printer.toolhead.axis_minimum.x + bound %}
	{% set x_max = printer.toolhead.axis_maximum.x - bound %}
	{% set y_min = printer.toolhead.axis_minimum.y + bound %}
	{% set y_max = printer.toolhead.axis_maximum.y - bound %}
	
	
	
	{% set x_center = (printer.toolhead.axis_minimum.x|float + printer.toolhead.axis_maximum.x|float ) / 2 %}
	{% set y_center = (printer.toolhead.axis_minimum.y|float + printer.toolhead.axis_maximum.y|float ) / 2 %}
	
	
	{% set x_center_min = x_center - (smallpatternsize/2) %}
	{% set x_center_max = x_center + (smallpatternsize/2) %}
	{% set y_center_min = y_center - (smallpatternsize/2) %}
	{% set y_center_max = y_center + (smallpatternsize/2) %}
	
	
	SAVE_GCODE_STATE NAME=TEST_SPEED
	
	
	{ action_respond_info("TEST_SPEED: starting %d iterations at speed %d, accel %d" % (iterations, speed, accel)) }
	
	
	M400
	G28
	
	{% if printer.configfile.settings.quad_gantry_level %}
	{% if printer.quad_gantry_level.applied == False %}
	QUAD_GANTRY_LEVEL
	G28 Z
	{% endif %}
	{% endif %}
	
	G90
	G1 X{printer.toolhead.axis_maximum.x-50} Y{printer.toolhead.axis_maximum.y-50} F{30*60}
	M400
	G28 X Y
	G0 X{printer.toolhead.axis_maximum.x-1} Y{printer.toolhead.axis_maximum.y-1} F{30*60}
	G4 P1000
	GET_POSITION
	
	
	G0 X{x_min} Y{y_min} Z{bound + 10} F{speed*60}
	
	
	{% if printer.configfile.settings.printer.minimum_cruise_ratio is defined %}
	SET_VELOCITY_LIMIT VELOCITY={speed} ACCEL={accel} MINIMUM_CRUISE_RATIO={min_cruise_ratio}
	{% else %}
	SET_VELOCITY_LIMIT VELOCITY={speed} ACCEL={accel} ACCEL_TO_DECEL={accel / 2}
	{% endif %}
	
	{% for i in range(iterations) %}
	
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_max} Y{y_max} F{speed*60}
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	G0 X{x_min} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	
	
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_min} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	
	
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_max} Y{y_center_max} F{speed*60}
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	G0 X{x_center_min} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	
	
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_min} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	{% endfor %}
	
	
	{% if printer.configfile.settings.printer.minimum_cruise_ratio is defined %}
	SET_VELOCITY_LIMIT VELOCITY={printer.configfile.settings.printer.max_velocity} ACCEL={printer.configfile.settings.printer.max_accel} MINIMUM_CRUISE_RATIO={printer.configfile.settings.printer.minimum_cruise_ratio}
	{% else %}
	SET_VELOCITY_LIMIT VELOCITY={printer.configfile.settings.printer.max_velocity} ACCEL={printer.configfile.settings.printer.max_accel} ACCEL_TO_DECEL={printer.configfile.settings.printer.max_accel_to_decel}
	{% endif %}
	
	
	M400
	G28
	
	G90
	G0 X{printer.toolhead.axis_maximum.x-1} Y{printer.toolhead.axis_maximum.y-1} F{30*60}
	G4 P1000
	GET_POSITION
	
	
	RESTORE_GCODE_STATE NAME=TEST_SPEED

[gcode_macro GET_TIMELAPSE_SETUP]
description = Print the Timelapse setup
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% set output_txt = ["Timelapse Setup:"] %}
	{% set _dummy = output_txt.append("enable: %s" % tl.enable) %}
	{% set _dummy = output_txt.append("park: %s" % tl.park.enable) %}
	{% if tl.park.enable %}
	{% set _dummy = output_txt.append("park position: %s time: %s s" % (tl.park.pos, tl.park.time)) %}
	{% set _dummy = output_txt.append("park cord x:%s y:%s dz:%s" % (tl.park.coord.x, tl.park.coord.y, tl.park.coord.dz)) %}
	{% set _dummy = output_txt.append("travel speed: %s mm/s" % tl.speed.travel) %}
	{% endif %}
	{% set _dummy = output_txt.append("fw_retract: %s" % tl.extruder.fw_retract) %}
	{% if not tl.extruder.fw_retract %}
	{% set _dummy = output_txt.append("retract: %s mm speed: %s mm/s" % (tl.extruder.retract, tl.speed.retract)) %}
	{% set _dummy = output_txt.append("extrude: %s mm speed: %s mm/s" % (tl.extruder.extrude, tl.speed.extrude)) %}
	{% endif %}
	{% set _dummy = output_txt.append("verbose: %s" % tl.verbose) %}
	{action_respond_info(output_txt|join("\n"))}

[gcode_macro _SET_TIMELAPSE_SETUP]
description = Set user parameters for timelapse
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	
	{% set min = printer.toolhead.axis_minimum %}
	{% set max = printer.toolhead.axis_maximum %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	{% set park = {'min'   : {'x': (min.x / 1.42)|round(3) if round_bed else min.x|round(3),
	'y': (min.y / 1.42)|round(3) if round_bed else min.y|round(3)},
	'max'   : {'x': (max.x / 1.42)|round(3) if round_bed else max.x|round(3),
	'y': (max.y / 1.42)|round(3) if round_bed else max.y|round(3)},
	'center': {'x': (max.x-(max.x-min.x)/2)|round(3),
	'y': (max.y-(max.y-min.y)/2)|round(3)}} %}
	
	{% if params.ENABLE %}
	{% if params.ENABLE|lower is in ['true', 'false'] %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=enable VALUE={True if params.ENABLE|lower == 'true' else False}
	{% else %}
	{action_raise_error("ENABLE=%s not supported. Allowed values are [True, False]" % params.ENABLE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.VERBOSE %}
	{% if params.VERBOSE|lower is in ['true', 'false'] %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=verbose VALUE={True if params.VERBOSE|lower == 'true' else False}
	{% else %}
	{action_raise_error("VERBOSE=%s not supported. Allowed values are [True, False]" % params.VERBOSE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_X %}
	{% if params.CUSTOM_POS_X|float >= min.x and params.CUSTOM_POS_X|float <= max.x %}
	{% set _dummy = tl.park.custom.update({'x':params.CUSTOM_POS_X|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_X=%s must be within [%s - %s]" % (params.CUSTOM_POS_X, min.x, max.x))}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_Y %}
	{% if params.CUSTOM_POS_Y|float >= min.y and params.CUSTOM_POS_Y|float <= max.y %}
	{% set _dummy = tl.park.custom.update({'y':params.CUSTOM_POS_Y|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_Y=%s must be within [%s - %s]" % (params.CUSTOM_POS_Y, min.y, max.y))}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_DZ %}
	{% if params.CUSTOM_POS_DZ|float >= min.z and params.CUSTOM_POS_DZ|float <= max.z %}
	{% set _dummy = tl.park.custom.update({'dz':params.CUSTOM_POS_DZ|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_DZ=%s must be within [%s - %s]" % (params.CUSTOM_POS_DZ, min.z, max.z))}
	{% endif %}
	{% endif %}
	{% if params.PARK_ENABLE %}
	{% if params.PARK_ENABLE|lower is in ['true', 'false'] %}
	{% set _dummy = tl.park.update({'enable':True if params.PARK_ENABLE|lower == 'true' else False}) %}
	{% else %}
	{action_raise_error("PARK_ENABLE=%s not supported. Allowed values are [True, False]" % params.PARK_ENABLE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.PARK_POS %}
	{% if params.PARK_POS|lower is in ['center','front_left','front_right','back_left','back_right','custom','x_only','y_only'] %}
	{% set dic = {'center'      : {'x': park.center.x   , 'y': park.center.y   , 'dz': 1                },
	'front_left'  : {'x': park.min.x      , 'y': park.min.y      , 'dz': 0                },
	'front_right' : {'x': park.max.x      , 'y': park.min.y      , 'dz': 0                },
	'back_left'   : {'x': park.min.x      , 'y': park.max.y      , 'dz': 0                },
	'back_right'  : {'x': park.max.x      , 'y': park.max.y      , 'dz': 0                },
	'custom'      : {'x': tl.park.custom.x, 'y': tl.park.custom.y, 'dz': tl.park.custom.dz},
	'x_only'      : {'x': tl.park.custom.x, 'y': 'none'          , 'dz': tl.park.custom.dz},
	'y_only'      : {'x': 'none'          , 'y': tl.park.custom.y, 'dz': tl.park.custom.dz}} %}
	{% set _dummy = tl.park.update({'pos':params.PARK_POS|lower}) %}
	{% set _dummy = tl.park.update({'coord':dic[tl.park.pos]}) %}
	{% else %}
	{action_raise_error("PARK_POS=%s not supported. Allowed values are [CENTER, FRONT_LEFT, FRONT_RIGHT, BACK_LEFT, BACK_RIGHT, CUSTOM, X_ONLY, Y_ONLY]"
	% params.PARK_POS|upper)}
	{% endif %}
	{% endif %}
	{% if params.PARK_TIME %}
	{% if params.PARK_TIME|float >= 0.0 %}
	{% set _dummy = tl.park.update({'time':params.PARK_TIME|float|round(3)}) %}
	{% else %}
	{action_raise_error("PARK_TIME=%s must be a positive number" % params.PARK_TIME)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=park VALUE="{tl.park}"
	{% if params.TRAVEL_SPEED %}
	{% if params.TRAVEL_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'travel':params.TRAVEL_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("TRAVEL_SPEED=%s must be larger than 0" % params.TRAVEL_SPEED)}
	{% endif %}
	{% endif %}
	{% if params.RETRACT_SPEED %}
	{% if params.RETRACT_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'retract':params.RETRACT_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("RETRACT_SPEED=%s must be larger than 0" % params.RETRACT_SPEED)}
	{% endif %}
	{% endif %}
	{% if params.EXTRUDE_SPEED %}
	{% if params.EXTRUDE_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'extrude':params.EXTRUDE_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("EXTRUDE_SPEED=%s must be larger than 0" % params.EXTRUDE_SPEED)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=speed VALUE="{tl.speed}"
	{% if params.EXTRUDE_DISTANCE %}
	{% if params.EXTRUDE_DISTANCE|float >= 0.0 %}
	{% set _dummy = tl.extruder.update({'extrude':params.EXTRUDE_DISTANCE|float|round(3)}) %}
	{% else %}
	{action_raise_error("EXTRUDE_DISTANCE=%s must be specified as positiv number" % params.EXTRUDE_DISTANCE)}
	{% endif %}
	{% endif %}
	{% if params.RETRACT_DISTANCE %}
	{% if params.RETRACT_DISTANCE|float >= 0.0 %}
	{% set _dummy = tl.extruder.update({'retract':params.RETRACT_DISTANCE|float|round(3)}) %}
	{% else %}
	{action_raise_error("RETRACT_DISTANCE=%s must be specified as positiv number" % params.RETRACT_DISTANCE)}
	{% endif %}
	{% endif %}
	{% if params.FW_RETRACT %}
	{% if params.FW_RETRACT|lower is in ['true', 'false'] %}
	{% if 'firmware_retraction' in printer.configfile.settings %}
	{% set _dummy = tl.extruder.update({'fw_retract': True if params.FW_RETRACT|lower == 'true' else False}) %}
	{% else %}
	{% set _dummy = tl.extruder.update({'fw_retract':False}) %}
	{% if params.FW_RETRACT|capitalize == 'True' %}
	{action_raise_error("[firmware_retraction] not defined in printer.cfg. Can not enable fw_retract")}
	{% endif %}
	{% endif %}
	{% else %}
	{action_raise_error("FW_RETRACT=%s not supported. Allowed values are [True, False]" % params.FW_RETRACT|capitalize)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=extruder VALUE="{tl.extruder}"
	{% if printer.configfile.settings['gcode_macro pause'] is defined %}
	{% set _dummy = tl.macro.update({'pause': printer.configfile.settings['gcode_macro pause'].rename_existing}) %}
	{% endif %}
	{% if printer.configfile.settings['gcode_macro resume'] is defined %}
	{% set _dummy = tl.macro.update({'resume': printer.configfile.settings['gcode_macro resume'].rename_existing}) %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=macro VALUE="{tl.macro}"

[gcode_macro TIMELAPSE_TAKE_FRAME]
description = Take Timelapse shoot
variable_enable = False
variable_takingframe = False
variable_park = {'enable': False,
	'pos'   : 'center',
	'time'  : 0.1,
	'custom': {'x': 0, 'y': 0, 'dz': 0},
	'coord' : {'x': 0, 'y': 0, 'dz': 0}}
variable_extruder = {'fw_retract': False,
	'retract': 1.0,
	'extrude': 1.0}
variable_speed = {'travel': 100,
	'retract': 15,
	'extrude': 15}
variable_verbose = True
variable_check_time = 0.5
variable_restore = {'absolute': {'coordinates': True, 'extrude': True}, 'speed': 1500, 'e':0, 'factor': {'speed': 1.0, 'extrude': 1.0}}
variable_macro = {'pause': 'PAUSE', 'resume': 'RESUME'}
variable_is_paused = False
gcode = 
	{% set hyperlapse = True if params.HYPERLAPSE and params.HYPERLAPSE|lower =='true' else False %}
	{% if enable %}
	{% if (hyperlapse and printer['gcode_macro HYPERLAPSE'].run) or
	(not hyperlapse and not printer['gcode_macro HYPERLAPSE'].run) %}
	{% if park.enable %}
	{% set pos = {'x': 'X' + park.coord.x|string if park.pos != 'y_only' else '',
	'y': 'Y' + park.coord.y|string if park.pos != 'x_only' else '',
	'z': 'Z'+ [printer.gcode_move.gcode_position.z + park.coord.dz, printer.toolhead.axis_maximum.z]|min|string} %}
	{% set restore = {'absolute': {'coordinates': printer.gcode_move.absolute_coordinates,
	'extrude'    : printer.gcode_move.absolute_extrude},
	'speed'   : printer.gcode_move.speed,
	'e'       : printer.gcode_move.gcode_position.e,
	'factor'  : {'speed'  : printer.gcode_move.speed_factor,
	'extrude': printer.gcode_move.extrude_factor}} %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=restore VALUE="{restore}"
	{% if not printer[printer.toolhead.extruder].can_extrude %}
	{% if verbose %}{action_respond_info("Timelapse: Warning, minimum extruder temperature not reached!")}{% endif %}
	{% else %}
	{% if extruder.fw_retract %}
	G10
	{% else %}
	M83
	G0 E-{extruder.retract} F{speed.retract * 60}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=is_paused VALUE=True
	{macro.pause}
	SET_GCODE_OFFSET X=0 Y=0
	G90
	{% if "xyz" not in printer.toolhead.homed_axes %}
	{% if verbose %}{action_respond_info("Timelapse: Warning, axis not homed yet!")}{% endif %}
	{% else %}
	G0 {pos.x} {pos.y} {pos.z} F{speed.travel * 60}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=takingframe VALUE=True
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_TAKE_FRAME DURATION={check_time}
	M400
	{% endif %}
	_TIMELAPSE_NEW_FRAME HYPERLAPSE={hyperlapse}
	{% endif %}
	{% else %}
	{% if verbose %}{action_respond_info("Timelapse: disabled, take frame ignored")}{% endif %}
	{% endif %}

[gcode_macro _TIMELAPSE_NEW_FRAME]
description = action call for timelapse shoot. must be a seperate macro
gcode = 
	{action_call_remote_method("timelapse_newframe",
	macropark=printer['gcode_macro TIMELAPSE_TAKE_FRAME'].park,
	hyperlapse=params.HYPERLAPSE)}

[delayed_gcode _WAIT_TIMELAPSE_TAKE_FRAME]
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% set factor = {'speed': printer.gcode_move.speed_factor, 'extrude': printer.gcode_move.extrude_factor} %}
	{% if tl.takingframe %}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_TAKE_FRAME DURATION={tl.check_time}
	{% else %}
	{tl.macro.resume} VELOCITY={tl.speed.travel}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=is_paused VALUE=False
	{% if not printer[printer.toolhead.extruder].can_extrude %}
	{action_respond_info("Timelapse: Warning minimum extruder temperature not reached!")}
	{% else %}
	{% if tl.extruder.fw_retract %}
	G11
	{% else %}
	G0 E{tl.extruder.extrude} F{tl.speed.extrude * 60}
	G0 F{tl.restore.speed}
	{% if tl.restore.absolute.extrude %}
	M82
	G92 E{tl.restore.e}
	{% endif %}
	{% endif %}
	{% endif %}
	{% if tl.restore.factor.speed   != factor.speed   %} M220 S{(factor.speed*100)|round(0)}   {% endif %}
	{% if tl.restore.factor.extrude != factor.extrude %} M221 S{(factor.extrude*100)|round(0)} {% endif %}
	{% if not tl.restore.absolute.coordinates %} G91 {% endif %}
	{% endif %}

[gcode_macro HYPERLAPSE]
description = Start/Stop a hyperlapse recording
variable_cycle = 0
variable_run = False
gcode = 
	{% set cycle = params.CYCLE|default(30)|int %}
	{% if params.ACTION and params.ACTION|lower == 'start' %}
	{action_respond_info("Hyperlapse: frames started (Cycle %d sec)" % cycle)}
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=run VALUE=True
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=cycle VALUE={cycle}
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION={cycle}
	TIMELAPSE_TAKE_FRAME HYPERLAPSE=True
	{% elif params.ACTION and params.ACTION|lower == 'stop' %}
	{% if run %}{action_respond_info("Hyperlapse: frames stopped")}{% endif %}
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=run VALUE=False
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION=0
	{% else %}
	{action_raise_error("Hyperlapse: No valid input parameter
	Use:
	- HYPERLAPSE ACTION=START [CYCLE=time]
	- HYPERLAPSE ACTION=STOP")}
	{% endif %}

[delayed_gcode _HYPERLAPSE_LOOP]
gcode = 
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION={printer["gcode_macro HYPERLAPSE"].cycle}
	TIMELAPSE_TAKE_FRAME HYPERLAPSE=True

[gcode_macro TIMELAPSE_RENDER]
description = Render Timelapse video and wait for the result
variable_render = False
variable_run_identifier = 0
gcode = 
	{action_respond_info("Timelapse: Rendering started")}
	{action_call_remote_method("timelapse_render", byrendermacro="True")}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_RENDER VARIABLE=render VALUE=True
	{printer.configfile.settings['gcode_macro pause'].rename_existing}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_RENDER DURATION=0.5

[delayed_gcode _WAIT_TIMELAPSE_RENDER]
gcode = 
	{% set ri = printer['gcode_macro TIMELAPSE_RENDER'].run_identifier % 4 %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_RENDER VARIABLE=run_identifier VALUE={ri + 1}
	{% if printer['gcode_macro TIMELAPSE_RENDER'].render %}
	M117 Rendering {['-','\\','|','/'][ri]}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_RENDER DURATION=0.5
	{% else %}
	{action_respond_info("Timelapse: Rendering finished")}
	M117
	{printer.configfile.settings['gcode_macro resume'].rename_existing}
	{% endif %}

[gcode_macro TEST_STREAM_DELAY]
description = Helper macro to find stream and park delay
gcode = 
	{% set min = printer.toolhead.axis_minimum %}
	{% set max = printer.toolhead.axis_maximum %}
	{% set act = printer.toolhead.position %}
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% if act.z > 5.0 %}
	G0 X{min.x + 5.0} F{tl.speed.travel|int * 60}
	G0 X{(max.x-min.x)/2}
	G4 P{tl.park.time|float * 1000}
	_TIMELAPSE_NEW_FRAME HYPERLAPSE=FALSE
	G0 X{max.x - 5.0}
	{% else %}
	{action_raise_error("Toolhead z %.3f to low. Please place head above z = 5.0" % act.z)}
	{% endif %}

[gcode_macro _OBICO_LAYER_CHANGE]
description = Run a scan across the current print area
variable_first_layer_scan_retract_length = 6
variable_first_layer_scan_retract_speed = 15
variable_first_layer_scan_cooldown_temp = 170
variable_first_layer_scan_resume_speed = 50
variable_first_layer_scan_enabled = True
variable_first_layer_scan_stepover = 10
variable_first_layer_scan_speed = 10
variable_first_layer_scan_zhop = 4
variable_first_layer_scan_zhop_speed = 15
variable_verbose = False
variable_current_layer = -1
variable_first_layer_scanning = False
variable_wait = {'resume': "RESUME", 'absolute_coordinates': True, 'absolute_extrude': True, 'e': 0.0, 'previous_temp': 0}
gcode = 
	
	{% set pause_macro  = "PAUSE"  if printer.configfile.settings['gcode_macro pause']  is not defined
	else printer.configfile.settings['gcode_macro pause'].rename_existing %}
	{% set resume_macro = "RESUME" if printer.configfile.settings['gcode_macro resume'] is not defined
	else printer.configfile.settings['gcode_macro resume'].rename_existing %}
	
	{% set current_layer_default = printer.print_stats.info.current_layer if printer.print_stats.info.current_layer is not none else -1 %}
	{% set current_layer = params.CURRENT_LAYER|default(current_layer_default)|int %}
	
	{% set polygon_points = printer.exclude_object.objects|map(attribute='polygon')|sum(start=[]) if printer.exclude_object is defined else [] %}
	{% set min_x = params.MINX|default(polygon_points|map(attribute=0)|min|default(printer.toolhead.axis_minimum.x))|float %}
	{% set min_y = params.MINY|default(polygon_points|map(attribute=1)|min|default(printer.toolhead.axis_minimum.y))|float %}
	{% set max_x = params.MAXX|default(polygon_points|map(attribute=0)|max|default(printer.toolhead.axis_maximum.x))|float %}
	{% set max_y = params.MAXY|default(polygon_points|map(attribute=1)|max|default(printer.toolhead.axis_maximum.y))|float %}
	
	{% set stepoverCount = ((max_y - min_y) / first_layer_scan_stepover|float)|round(method='ceil')|int %}
	
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Layer %d" % (current_layer)}' {% endif %}
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=current_layer VALUE={current_layer}
	
	{% if first_layer_scan_enabled and current_layer == 2 %}
	
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=first_layer_scanning VALUE=True
	
	
	{% set wait_dic = {'resume'              : resume_macro,
	'absolute_coordinates': printer.gcode_move.absolute_coordinates,
	'absolute_extrude'    : printer.gcode_move.absolute_extrude,
	'e'                   : printer.gcode_move.gcode_position.e,
	'previous_temp'       : printer.extruder.target} %}
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=wait VALUE="{wait_dic}"
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Prepare scanning" {% endif %}
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Scan Coordinates: Min:[%.3f:%.3f] Max:[%.3f:%.3f]" % (min_x,min_y,max_x,max_y)}' {% endif %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Retract %.1fmm filament" % first_layer_scan_retract_length|abs}' {% endif %}
	M83
	G0 E-{first_layer_scan_retract_length|abs} F{first_layer_scan_retract_speed|float * 60}
	{% endif %}
	G91
	G0 Z{first_layer_scan_zhop|abs} F{first_layer_scan_zhop_speed|float * 60}
	
	
	M106 S255
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Fan on and lowering temperature to %.1f" % first_layer_scan_cooldown_temp}' {% endif %}
	M104 S{first_layer_scan_cooldown_temp}
	M109 S{first_layer_scan_cooldown_temp}
	
	{pause_macro}
	
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Start scanning" {% endif %}
	
	UPDATE_DELAYED_GCODE ID=_WAIT_OBICO_LAYER_CHANGE DURATION=1.0
	G90
	G0 X{min_x} Y{min_y} F{first_layer_scan_resume_speed|float * 60}
	{% for ystep in range(stepoverCount) %}
	G0 Y{min_y + first_layer_scan_stepover|float * ystep} F{first_layer_scan_speed|float * 60}
	G0 X{max_x if ystep % 2 == 0 else min_x}              F{first_layer_scan_speed|float * 60}
	{% endfor %}
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Finish scanning" {% endif %}
	
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=first_layer_scanning VALUE=False
	
	{% endif %}

[delayed_gcode _WAIT_OBICO_LAYER_CHANGE]
gcode = 
	{% set lc_macro = printer['gcode_macro _OBICO_LAYER_CHANGE'] %}
	{% if lc_macro.first_layer_scanning %}
	
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Waiting for first layer scan..." {% endif %}
	UPDATE_DELAYED_GCODE ID=_WAIT_OBICO_LAYER_CHANGE DURATION=1.0
	{% else %}
	
	M107
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Fan off and resume print" {% endif %}
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Call %s VELOCITY=%.1f" % (lc_macro.wait.resume, lc_macro.first_layer_scan_resume_speed)}' {% endif %}
	{lc_macro.wait.resume} VELOCITY={lc_macro.first_layer_scan_resume_speed}
	G91
	G0 Z-{lc_macro.first_layer_scan_zhop|abs} F{lc_macro.first_layer_scan_zhop_speed|float * 60}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% set first_layer_scan_unretract_length = lc_macro.first_layer_scan_retract_length + 0.5 %}
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Extrude %.1fmm filament" % first_layer_scan_unretract_length|abs}' {% endif %}
	M83
	G0 E{first_layer_scan_unretract_length|abs} F{lc_macro.first_layer_scan_retract_speed|float * 60}
	{% endif %}
	
	
	M104 S{lc_macro.wait.previous_temp}
	M109 S{lc_macro.wait.previous_temp}
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Heating back up to previous temperature"}' {% endif %}
	
	
	{% if lc_macro.wait.absolute_coordinates %} G90 {% endif %}
	{% if lc_macro.wait.absolute_extrude %}
	M82
	G92 E{lc_macro.wait.e}
	{% endif %}
	{% endif %}

[gcode_macro OBICO_LINK_STATUS]
description = Link to Obico server
variable_one_time_passcode = ''
variable_one_time_passlink = ''
variable_is_linked = False
gcode = 
	{action_respond_info('Obico one_time_passcode: {}'.format(one_time_passcode))}
	{action_respond_info('Obico one_time_passlink: {}'.format(one_time_passlink))}
	{action_respond_info('Obico is_linked: {}'.format(is_linked))}
	{% if not is_linked and one_time_passcode != '' %}
	M117 Code: {one_time_passcode}
	{% else %}
	M117 Obico linked
	{% endif %}

[gcode_macro _OBICO_RELINK]
description = Re-link to Obico server
gcode = 
	{action_respond_info('WARNING: Re-link to Obico server')}
	{action_call_remote_method("obico_remote_event", event_name='relink_obico', message='')}
	{action_respond_info('WARNING: relink_obico requested')}

[exclude_object]

[mcu]
serial = /dev/serial/by-id/usb-1a86_USB_Serial-if00-port0
restart_method = command

[temperature_sensor raspberry_pi]
sensor_type = temperature_host
min_temp = 10
max_temp = 100

[temperature_sensor mcu_temp]
sensor_type = temperature_mcu
min_temp = 0
max_temp = 100

[printer]
kinematics = cartesian
max_velocity = 200
max_accel = 4000
max_z_velocity = 10
max_z_accel = 100
minimum_cruise_ratio = 0.5
square_corner_velocity = 5

[stepper_x]
step_pin = PB9
dir_pin = PC2
enable_pin = !PC3
microsteps = 16
rotation_distance = 40
endstop_pin = ^PA5
position_endstop = 0
position_max = 230
homing_speed = 50

[stepper_y]
step_pin = PB7
dir_pin = PB8
enable_pin = !PC3
microsteps = 16
rotation_distance = 40
endstop_pin = ^PA6
position_endstop = 0
position_max = 231
homing_speed = 50

[stepper_z]
step_pin = PB5
dir_pin = !PB6
enable_pin = !PC3
microsteps = 16
rotation_distance = 8
endstop_pin = probe:z_virtual_endstop
position_max = 250
position_min = -4
homing_speed = 4
second_homing_speed = 1
homing_retract_dist = 2.0

[fan]
pin = PA0

[extruder]
max_extrude_only_distance = 100.0
step_pin = PB3
dir_pin = PB4
enable_pin = !PC3
microsteps = 16
gear_ratio = 42:12
rotation_distance = 26.359
nozzle_diameter = 0.400
filament_diameter = 1.750
heater_pin = PA1
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PC5
min_temp = 0
max_temp = 300
min_extrude_temp = 170
pressure_advance = .0369
pressure_advance_smooth_time = 0.04
control = pid
pid_kp = 19.195
pid_ki = 1.000
pid_kd = 92.135

[firmware_retraction]
retract_length = 0.3
retract_speed = 20

[idle_timeout]
gcode = 
	{% if printer.pause_resume.is_paused %}
	M118 Idle timeout while paused, turning off hotend
	SET_HEATER_TEMPERATURE HEATER=extruder TARGET=0
	{% else %}
	M118 Idle timeout
	TURN_OFF_HEATERS
	M84
	{% endif %}
timeout = 1800

[heater_bed]
heater_pin = PA2
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PC4
min_temp = 0
max_temp = 130
control = pid
pid_kp = 68.601
pid_ki = 1.185
pid_kd = 993.000

[bltouch]
sensor_pin = ^PB1
control_pin = PB0
x_offset = -31.8
y_offset = -40.5
speed = 35
samples = 2
samples_result = median
samples_tolerance = 0.05
samples_tolerance_retries = 2
sample_retract_dist = 5.0
probe_with_touch_mode = true
stow_on_each_sample = false
z_offset = 2.049

[safe_z_home]
home_xy_position = 147, 154
speed = 75
z_hop = 10
z_hop_speed = 5
move_to_previous = false

[bed_screws]
screw1 = 30,51
screw1_name = "FL"
screw2 = 200,51
screw2_name = "FR"
screw3 = 200,195
screw3_name = "RR"
screw4 = 30,195
screw4_name = "RL"

[screws_tilt_adjust]
screw1 = 67, 67
screw1_name = front left screw
screw2 = 230, 67
screw2_name = front right screw
screw3 = 230, 230
screw3_name = rear right screw
screw4 = 67.60, 230
screw4_name = rear left screw
horizontal_move_z = 10
speed = 200
screw_thread = CW-M4

[bed_mesh]
speed = 120
mesh_min = 10,11
mesh_max = 195,182
probe_count = 3,3
algorithm = bicubic
fade_start = 1
fade_end = 10
fade_target = 0

[filament_motion_sensor SFS_T0]
detection_length = 150.00
extruder = extruder
switch_pin = PA4
pause_on_runout = True
event_delay = 3.0
pause_delay = 0.5
runout_gcode = 
	M117 Runout Detected!

[delayed_gcode DISABLEFILAMENTSENSOR]
initial_duration = 1
gcode = 
	SET_FILAMENT_SENSOR SENSOR=SFS_T0 ENABLE=0

[gcode_macro SFS_ENABLE]
description = Enable smart filament sensor
gcode = 
	M117 ENABLING the Smart Filament Sensor
	G92 E0
	SET_FILAMENT_SENSOR SENSOR=SFS_T0 ENABLE=1

[gcode_macro SFS_DISABLE]
description = Disable smart filament sensor
gcode = 
	M117 DISABLING the Smart Filament Sensor
	G92 E0
	SET_FILAMENT_SENSOR SENSOR=SFS_T0 ENABLE=0

[gcode_macro FILAMENT_RUNOUT]
gcode = 
	M117 Runout Detected!
	M300 S1 P10
	M600
	M300 S1 P10

[gcode_macro M300]
gcode = 
	{% set S = params.S|default(1000)|int %}
	{% set P = params.P|default(100)|int %}
	SET_PIN PIN=BEEPER VALUE=0.5 CYCLE_TIME={ 1.0/S if S > 0 else 1 }
	G4 P{P}
	SET_PIN PIN=BEEPER VALUE=0
	[gcode_macro M600]
	gcode:
	{% set X = params.X|default(25)|float %}
	{% set Y = params.Y|default(25)|float %}
	{% set Z = params.Z|default(10)|float %}
	SAVE_GCODE_STATE NAME=M600_state
	PAUSE
	G91
	G1 E-.8 F2700
	G1 Z{Z}
	G90
	G1 X{X} Y{Y} F3000
	G91
	G1 E-15 F1000
	RESTORE_GCODE_STATE NAME=M600_state

[gcode_arcs]
resolution = 1.0

[input_shaper]
shaper_freq_x = 73.5
shaper_type_x = ei
shaper_freq_y = 76.9
shaper_type_y = mzv
=======================
bed_mesh: bicubic interpolation with a probe_count of less than 4 points detected.  Forcing lagrange interpolation. Configured Probe Count: 3, 3
Extruder max_extrude_ratio=0.266081
mcu 'mcu': Starting serial connect
webhooks client 548511456944: New connection
webhooks client 548511456944: Client info {'program': 'Moonraker', 'version': 'v0.9.3-3-gccfe32f'}
mcu 'mcu': got {'oid': 10, 'next_clock': 1126735104, 'value': 14012, '#name': 'analog_in_state', '#sent_time': 2573.659365169, '#receive_time': 2573.666438558}
mcu 'mcu': got {'oid': 12, 'next_clock': 1128175104, 'value': 31558, '#name': 'analog_in_state', '#sent_time': 2573.659365169, '#receive_time': 2573.686664095}
mcu 'mcu': got {'oid': 17, 'next_clock': 1131775104, 'value': 31508, '#name': 'analog_in_state', '#sent_time': 2573.7133580209997, '#receive_time': 2573.736719114}
mcu 'mcu': got {'oid': 10, 'next_clock': 1148335104, 'value': 14012, '#name': 'analog_in_state', '#sent_time': 2573.929206243, '#receive_time': 2573.966496651}
mcu 'mcu': got {'oid': 12, 'next_clock': 1149775104, 'value': 31556, '#name': 'analog_in_state', '#sent_time': 2573.983611799, '#receive_time': 2573.986465595}
Loaded MCU 'mcu' 119 commands (v0.12.0-286-g81de9a861 / gcc: (15:8-2019-q3-1+b1) 8.3.1 20190703 (release) [gcc-8-branch revision 273027] binutils: (2.35.2-2+14+b2) 2.35.2)
MCU 'mcu' config: ADC_MAX=4095 BUS_PINS_i2c1=PB6,PB7 BUS_PINS_i2c1a=PB8,PB9 BUS_PINS_i2c2=PB10,PB11 BUS_PINS_spi1=PA6,PA7,PA5 BUS_PINS_spi1a=PB4,PB5,PB3 BUS_PINS_spi2=PB14,PB15,PB13 BUS_PINS_spi3=PB4,PB5,PB3 CLOCK_FREQ=72000000 MCU=stm32f103xe PWM_MAX=255 RECEIVE_WINDOW=192 RESERVE_PINS_serial=PA10,PA9 SERIAL_BAUD=250000 STATS_SUMSQ_BASE=256 STEPPER_BOTH_EDGE=1
mcu_temperature 'mcu' nominal base=357.558140 slope=-767.441860
Configured MCU 'mcu' (1024 moves)
Starting heater checks for heater_bed
bed_mesh: generated points
Index |  Tool Adjusted  |   Probe
  0   | (41.8, 51.5)    | (10.0, 11.0)
  1   | (134.3, 51.5)   | (102.5, 11.0)
  2   | (226.8, 51.5)   | (195.0, 11.0)
  3   | (226.8, 137.0)  | (195.0, 96.5)
  4   | (134.3, 137.0)  | (102.5, 96.5)
  5   | (41.8, 137.0)   | (10.0, 96.5)
  6   | (41.8, 222.5)   | (10.0, 182.0)
  7   | (134.3, 222.5)  | (102.5, 182.0)
  8   | (226.8, 222.5)  | (195.0, 182.0)
Starting heater checks for extruder
Stats 2575.0: gcodein=0  mcu: mcu_awake=0.005 mcu_task_avg=0.000028 mcu_task_stddev=0.000015 bytes_write=1091 bytes_read=4615 bytes_retransmit=0 bytes_invalid=0 send_seq=110 receive_seq=110 retransmit_seq=0 srtt=0.003 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71999077  raspberry_pi: temp=51.1 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.48 cputime=1.435 memavail=1529168 print_time=110433.400 buffer_time=0.249 print_stall=0 extruder: target=0 temp=0.0 pwm=0.000
webhooks: registering remote method 'shutdown_machine' for connection id: 548511456944
webhooks: registering remote method 'reboot_machine' for connection id: 548511456944
webhooks: registering remote method 'pause_job_queue' for connection id: 548511456944
webhooks: registering remote method 'start_job_queue' for connection id: 548511456944
webhooks: registering remote method 'spoolman_set_active_spool' for connection id: 548511456944
webhooks: registering remote method 'obico_remote_event' for connection id: 548511456944
Stats 2576.0: gcodein=0  mcu: mcu_awake=0.005 mcu_task_avg=0.000028 mcu_task_stddev=0.000015 bytes_write=1097 bytes_read=4781 bytes_retransmit=0 bytes_invalid=0 send_seq=111 receive_seq=111 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71999441  raspberry_pi: temp=51.6 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.48 cputime=1.466 memavail=1528856 print_time=110433.400 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 2577.0: gcodein=0  mcu: mcu_awake=0.005 mcu_task_avg=0.000028 mcu_task_stddev=0.000015 bytes_write=1103 bytes_read=4932 bytes_retransmit=0 bytes_invalid=0 send_seq=112 receive_seq=112 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71999672  raspberry_pi: temp=52.6 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.48 cputime=1.481 memavail=1526604 print_time=110433.400 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 2578.0: gcodein=0  mcu: mcu_awake=0.005 mcu_task_avg=0.000028 mcu_task_stddev=0.000015 bytes_write=1109 bytes_read=5113 bytes_retransmit=0 bytes_invalid=0 send_seq=113 receive_seq=113 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71999973  raspberry_pi: temp=50.6 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.44 cputime=1.495 memavail=1526380 print_time=110433.400 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Starting Klippy...
Args: ['/home/coon/klipper/klippy/klippy.py', '/home/coon/printer_data/config/printer.cfg', '-l', '/home/coon/printer_data/logs/klippy.log', '-I', '/home/coon/printer_data/comms/klippy.serial', '-a', '/home/coon/printer_data/comms/klippy.sock']
Git version: 'v0.12.0-404-g80d185c94'
Branch: master
Remote: origin
Tracked URL: https://github.com/Klipper3d/klipper.git
CPU: 4 core ?
Python: '3.9.2 (default, Dec  1 2024, 12:12:57) \n[GCC 10.2.1 20210110]'
Start printer at Sun Dec 22 18:42:15 2024 (1734910935.8 2586.4)
===== Config file =====
[virtual_sdcard]
path = ~/printer_data/gcodes
on_error_gcode = CANCEL_PRINT

[pause_resume]
recover_velocity = 25

[display_status]

[respond]
default_prefix = 

[gcode_macro CANCEL_PRINT]
description = Cancel the actual running print
rename_existing = BASE_CANCEL_PRINT
gcode = 
	G91
	G0 Z10 F600
	G90
	TURN_OFF_HEATERS
	G0 X5 Y220
	CLEAR_PAUSE
	
	BASE_CANCEL_PRINT

[gcode_macro PAUSE]
description = Pause the actual running print
rename_existing = PAUSE_BASE
gcode = 
	
	{% set x = params.X|default(5) %}
	{% set y = params.Y|default(225) %}
	{% set z = params.Z|default(10)|float %}
	{% set e = params.E|default(1) %}
	
	{% set max_z = printer.toolhead.axis_maximum.z|float %}
	{% set act_z = printer.toolhead.position.z|float %}
	{% set lift_z = z|abs %}
	{% if act_z < (max_z - lift_z) %}
	{% set z_safe = lift_z %}
	{% else %}
	{% set z_safe = max_z - act_z %}
	{% endif %}
	
	PAUSE_BASE
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E-{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	{% if "xyz" in printer.toolhead.homed_axes %}
	G1 Z{z_safe}
	G90
	G1 X{x} Y{y} F6000
	{% else %}
	{action_respond_info("Printer not homed")}
	{% endif %}

[gcode_macro RESUME]
description = Resume the actual running print
rename_existing = RESUME_BASE
variable_last_extruder_temp = {'restore': False, 'temp': 0}
variable_restore_idle_timeout = 0
variable_idle_state = False
gcode = 
	
	{% set e = params.E|default(1) %}
	
	{% if 'VELOCITY' in params|upper %}
	{% set get_params = ('VELOCITY=' + params.VELOCITY)  %}
	{%else %}
	{% set get_params = "" %}
	{% endif %}
	
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	RESUME_BASE {get_params}

[gcode_macro SET_PAUSE_NEXT_LAYER]
description = Enable a pause if the next layer is reached
gcode = 
	{% set pause_next_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_next_layer %}
	{% set ENABLE = params.ENABLE|default(1)|int != 0 %}
	{% set MACRO = params.MACRO|default(pause_next_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_next_layer VALUE="{{ 'enable': ENABLE, 'call': MACRO }}"

[gcode_macro SET_PAUSE_AT_LAYER]
description = Enable/disable a pause if a given layer number is reached
gcode = 
	{% set pause_at_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_at_layer %}
	{% set ENABLE = params.ENABLE|int != 0 if params.ENABLE is defined
	else params.LAYER is defined %}
	{% set LAYER = params.LAYER|default(pause_at_layer.layer)|int %}
	{% set MACRO = params.MACRO|default(pause_at_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_at_layer VALUE="{{ 'enable': ENABLE, 'layer': LAYER, 'call': MACRO }}"

[gcode_macro SET_PRINT_STATS_INFO]
rename_existing = SET_PRINT_STATS_INFO_BASE
description = Overwrite, to get pause_next_layer and pause_at_layer feature
variable_pause_next_layer = { 'enable': False, 'call': "PAUSE" }
variable_pause_at_layer = { 'enable': False, 'layer': 0, 'call': "PAUSE" }
gcode = 
	{% if pause_next_layer.enable %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_next_layer" % pause_next_layer.call}'
	{pause_next_layer.call}
	SET_PAUSE_NEXT_LAYER ENABLE=0
	{% elif pause_at_layer.enable and params.CURRENT_LAYER is defined and params.CURRENT_LAYER|int == pause_at_layer.layer %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_at_layer [%d]" % (pause_at_layer.call, pause_at_layer.layer)}'
	{pause_at_layer.call}
	SET_PAUSE_AT_LAYER ENABLE=0
	{% endif %}
	SET_PRINT_STATS_INFO_BASE {rawparams}

[gcode_macro _TOOLHEAD_PARK_PAUSE_CANCEL]
description = Helper: park toolhead used in PAUSE and CANCEL_PRINT
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set velocity = printer.configfile.settings.pause_resume.recover_velocity %}
	{% set use_custom     = client.use_custom_pos|default(false)|lower == 'true' %}
	{% set custom_park_x  = client.custom_park_x|default(0.0) %}
	{% set custom_park_y  = client.custom_park_y|default(0.0) %}
	{% set park_dz        = client.custom_park_dz|default(2.0)|abs %}
	{% set sp_hop         = client.speed_hop|default(15) * 60 %}
	{% set sp_move        = client.speed_move|default(velocity) * 60 %}
	
	{% set origin    = printer.gcode_move.homing_origin %}
	{% set act       = printer.gcode_move.gcode_position %}
	{% set max       = printer.toolhead.axis_maximum %}
	{% set cone      = printer.toolhead.cone_start_z|default(max.z) %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	
	{% set z_min = params.Z_MIN|default(0)|float %}
	{% set z_park = [[(act.z + park_dz), z_min]|max, (max.z - origin.z)]|min %}
	{% set x_park = params.X       if params.X is defined
	else custom_park_x  if use_custom
	else 0.0            if round_bed
	else (max.x - 5.0) %}
	{% set y_park = params.Y       if params.Y is defined
	else custom_park_y  if use_custom
	else (max.y - 5.0)  if round_bed and z_park < cone
	else 0.0            if round_bed
	else (max.y - 5.0) %}
	
	_CLIENT_RETRACT
	{% if "xyz" in printer.toolhead.homed_axes %}
	G90
	G1 Z{z_park} F{sp_hop}
	G1 X{x_park} Y{y_park} F{sp_move}
	{% if not printer.gcode_move.absolute_coordinates %} G91 {% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='Printer not homed'
	{% endif %}

[gcode_macro _CLIENT_EXTRUDE]
description = Extrudes, if the extruder is hot enough
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set use_fw_retract = (client.use_fw_retract|default(false)|lower == 'true') and (printer.firmware_retraction is defined) %}
	{% set length = params.LENGTH|default(client.unretract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_unretract)|default(35) %}
	{% set absolute_extrude = printer.gcode_move.absolute_extrude %}
	
	{% if printer.toolhead.extruder != '' %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if use_fw_retract %}
	{% if length < 0 %}
	G10
	{% else %}
	G11
	{% endif %}
	{% else %}
	M83
	G1 E{length} F{(speed|float|abs) * 60}
	{% if absolute_extrude %}
	M82
	{% endif %}
	{% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='{"\"%s\" not hot enough" % printer.toolhead.extruder}'
	{% endif %}
	{% endif %}

[gcode_macro _CLIENT_RETRACT]
description = Retracts, if the extruder is hot enough
gcode = 
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set length = params.LENGTH|default(client.retract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_retract)|default(35) %}
	
	_CLIENT_EXTRUDE LENGTH=-{length|float|abs} SPEED={speed|float|abs}

[gcode_macro _CLIENT_LINEAR_MOVE]
description = Linear move with save and restore of the gcode state
gcode = 
	{% set x_move = "X" ~ params.X if params.X is defined else "" %}
	{% set y_move = "Y" ~ params.Y if params.Y is defined else "" %}
	{% set z_move = "Z" ~ params.Z if params.Z is defined else "" %}
	{% set e_move = "E" ~ params.E if params.E is defined else "" %}
	{% set rate = "F" ~ params.F if params.F is defined else "" %}
	{% set ABSOLUTE = params.ABSOLUTE | default(0) | int != 0 %}
	{% set ABSOLUTE_E = params.ABSOLUTE_E | default(0) | int != 0 %}
	SAVE_GCODE_STATE NAME=_client_movement
	{% if x_move or y_move or z_move %}
	G9{ 0 if ABSOLUTE else 1 }
	{% endif %}
	{% if e_move %}
	M8{ 2 if ABSOLUTE_E else 3 }
	{% endif %}
	G1 { x_move } { y_move } { z_move } { e_move } { rate }
	RESTORE_GCODE_STATE NAME=_client_movement

[gcode_macro play_test]
gcode = 
	RESPOND TYPE=command MSG="action:prompt_begin Question"
	RESPOND TYPE=command MSG="action:prompt_text Do you wont to cancel the print?"
	RESPOND TYPE=command MSG="action:prompt_footer_button continue|RESPOND TYPE=command MSG=action:prompt_end"
	RESPOND TYPE=command MSG="action:prompt_footer_button CANCEL|CANCEL_PRINT|error"
	RESPOND TYPE=command MSG="action:prompt_show"

[gcode_macro PRINT_START]
gcode = 
	START_PRINT {rawparams}

[gcode_macro START_PRINT]
gcode = 
	{% set BED_TEMP = params.BED_TEMP|default(60)|float %}
	{% set EXTRUDER_TEMP = params.EXTRUDER_TEMP|default(190)|float %}
	
	M190 S{BED_TEMP}
	
	G90
	
	G28
	
	RESPOND MSG="Bed Meshing"
	
	
	
	
	
	
	
	
	BED_MESH_CLEAR
	BED_MESH_CALIBRATE ADAPTIVE=1
	
	
	
	
	
	
	
	RESPOND MSG="Heating to print temp"
	M104 S{EXTRUDER_TEMP}
	G0 Z40 F240
	M109 S{EXTRUDER_TEMP}
	RESPOND MSG="Enable Runout Sensor"
	SFS_ENABLE
	RESPOND MSG="Line Purge"
	LINE_PURGE
	RESPOND MSG="Print Started"

[gcode_macro LINE_PURGE]
gcode = 
	G92 E0
	G1 Z2.0 F3000
	G1 X0.1 Y20 Z0.3 F5000.0
	G1 X0.1 Y200.0 Z0.3 F1500.0 E15
	G1 X0.4 Y200.0 Z0.3 F5000.0
	G1 X0.4 Y20 Z0.3 F1500.0 E30
	G92 E0
	G1 Z2.0 F3000
	G1 X5 Y20 Z0.3 F5000.0

[gcode_macro PRINT_END]
gcode = 
	END_PRINT

[gcode_macro END_PRINT]
gcode = 
	
	
	RESPOND MSG="Print Finished"
	G91
	G1 E-.5 Z0.2 F2400
	G1 X5 Y5 F6000
	G1 Z10
	G90
	SFS_DISABLE
	
	G1 X0 Y220 F6000
	M106 S0
	M104 S0
	M140 S0
	
	M84 X Y E

[gcode_macro SET_ACTIVE_SPOOL]
gcode = 
	{% if params.ID %}
	{% set id = params.ID|int %}
	{action_call_remote_method(
	"spoolman_set_active_spool",
	spool_id=id
	)}
	{% else %}
	{action_respond_info("Parameter 'ID' is required")}
	{% endif %}

[gcode_macro CLEAR_ACTIVE_SPOOL]
gcode = 
	{action_call_remote_method(
	"spoolman_set_active_spool",
	spool_id=None
	)}

[gcode_macro G29]
gcode = 
	G28
	BED_MESH_CALIBRATE
	G0 X0 Y0 Z10 F6000
	BED_MESH_PROFILE save=default

[gcode_macro M125]
gcode = 
	SAVE_GCODE_STATE NAME=parking
	M117 Parking toolhead
	G91
	G1 Z10 F600
	G90
	G1 X5 Y225 F4000
	RESTORE_GCODE_STATE NAME=parking

[gcode_macro Load_Filament]
gcode = 
	SAVE_GCODE_STATE NAME=loading_filament
	M117 Loading Filament
	M83
	G92 E0.0
	G91
	G1 E50 F200
	G92 E50
	RESTORE_GCODE_STATE NAME=loading_filament

[gcode_macro Unload_Filament]
gcode = 
	SAVE_GCODE_STATE NAME=unloading_filament
	M117 Unloading Filament
	G91
	G1 E5 F100
	G92 E0.0
	G1 E-50 F5000
	G92 E-50
	RESTORE_GCODE_STATE NAME=unloading_filament

[gcode_macro Filament_Change]
gcode = 
	
	SAVE_GCODE_STATE NAME=filament_change
	
	Unload_Filament
	
	RESPOND TYPE=command MSG="action:prompt_begin Question"
	RESPOND TYPE=command MSG="action:prompt_text Please insert new filament and confirm"
	RESPOND TYPE=command MSG="action:prompt_footer_button CONFIRM|Load_Filament|RESPOND TYPE=command MSG=action:prompt_end"
	RESPOND TYPE=command MSG="action:prompt_footer_button CANCEL|RESPOND TYPE=command MSG=action:prompt_end"
	RESPOND TYPE=command MSG="action:prompt_show"
	
	RESTORE_GCODE_STATE NAME=filament_change

[gcode_macro Calibrate_Hotend_PID]
gcode = 
	PID_CALIBRATE HEATER=extruder TARGET=200

[gcode_macro Calibrate_Bed_PID]
gcode = 
	PID_CALIBRATE HEATER=heater_bed TARGET=60

[gcode_macro Calibrate_Zoffset]
gcode = 
	PROBE_CALIBRATE

[gcode_macro Tram_bed]
gcode = 
	SCREWS_TILT_CALCULATE

[gcode_macro TEST_SPEED]
description = Test for max speed and acceleration parameters for the printer. Procedure: Home -> ReadPositionFromMCU -> MovesToolhead@Vel&Accel -> Home -> ReadPositionfromMCU
gcode = 
	
	{% set speed  = params.SPEED|default(printer.configfile.settings.printer.max_velocity)|int %}
	
	{% set iterations = params.ITERATIONS|default(5)|int %}
	
	{% set accel  = params.ACCEL|default(printer.configfile.settings.printer.max_accel)|int %}
	
	{% set min_cruise_ratio = params.MIN_CRUISE_RATIO|default(0.5)|float %}
	
	{% set bound = params.BOUND|default(20)|int %}
	
	{% set smallpatternsize = SMALLPATTERNSIZE|default(20)|int %}
	
	
	
	{% set x_min = printer.toolhead.axis_minimum.x + bound %}
	{% set x_max = printer.toolhead.axis_maximum.x - bound %}
	{% set y_min = printer.toolhead.axis_minimum.y + bound %}
	{% set y_max = printer.toolhead.axis_maximum.y - bound %}
	
	
	
	{% set x_center = (printer.toolhead.axis_minimum.x|float + printer.toolhead.axis_maximum.x|float ) / 2 %}
	{% set y_center = (printer.toolhead.axis_minimum.y|float + printer.toolhead.axis_maximum.y|float ) / 2 %}
	
	
	{% set x_center_min = x_center - (smallpatternsize/2) %}
	{% set x_center_max = x_center + (smallpatternsize/2) %}
	{% set y_center_min = y_center - (smallpatternsize/2) %}
	{% set y_center_max = y_center + (smallpatternsize/2) %}
	
	
	SAVE_GCODE_STATE NAME=TEST_SPEED
	
	
	{ action_respond_info("TEST_SPEED: starting %d iterations at speed %d, accel %d" % (iterations, speed, accel)) }
	
	
	M400
	G28
	
	{% if printer.configfile.settings.quad_gantry_level %}
	{% if printer.quad_gantry_level.applied == False %}
	QUAD_GANTRY_LEVEL
	G28 Z
	{% endif %}
	{% endif %}
	
	G90
	G1 X{printer.toolhead.axis_maximum.x-50} Y{printer.toolhead.axis_maximum.y-50} F{30*60}
	M400
	G28 X Y
	G0 X{printer.toolhead.axis_maximum.x-1} Y{printer.toolhead.axis_maximum.y-1} F{30*60}
	G4 P1000
	GET_POSITION
	
	
	G0 X{x_min} Y{y_min} Z{bound + 10} F{speed*60}
	
	
	{% if printer.configfile.settings.printer.minimum_cruise_ratio is defined %}
	SET_VELOCITY_LIMIT VELOCITY={speed} ACCEL={accel} MINIMUM_CRUISE_RATIO={min_cruise_ratio}
	{% else %}
	SET_VELOCITY_LIMIT VELOCITY={speed} ACCEL={accel} ACCEL_TO_DECEL={accel / 2}
	{% endif %}
	
	{% for i in range(iterations) %}
	
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_max} Y{y_max} F{speed*60}
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	G0 X{x_min} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	
	
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_min} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	
	
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_max} Y{y_center_max} F{speed*60}
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	G0 X{x_center_min} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	
	
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_min} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	{% endfor %}
	
	
	{% if printer.configfile.settings.printer.minimum_cruise_ratio is defined %}
	SET_VELOCITY_LIMIT VELOCITY={printer.configfile.settings.printer.max_velocity} ACCEL={printer.configfile.settings.printer.max_accel} MINIMUM_CRUISE_RATIO={printer.configfile.settings.printer.minimum_cruise_ratio}
	{% else %}
	SET_VELOCITY_LIMIT VELOCITY={printer.configfile.settings.printer.max_velocity} ACCEL={printer.configfile.settings.printer.max_accel} ACCEL_TO_DECEL={printer.configfile.settings.printer.max_accel_to_decel}
	{% endif %}
	
	
	M400
	G28
	
	G90
	G0 X{printer.toolhead.axis_maximum.x-1} Y{printer.toolhead.axis_maximum.y-1} F{30*60}
	G4 P1000
	GET_POSITION
	
	
	RESTORE_GCODE_STATE NAME=TEST_SPEED

[gcode_macro GET_TIMELAPSE_SETUP]
description = Print the Timelapse setup
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% set output_txt = ["Timelapse Setup:"] %}
	{% set _dummy = output_txt.append("enable: %s" % tl.enable) %}
	{% set _dummy = output_txt.append("park: %s" % tl.park.enable) %}
	{% if tl.park.enable %}
	{% set _dummy = output_txt.append("park position: %s time: %s s" % (tl.park.pos, tl.park.time)) %}
	{% set _dummy = output_txt.append("park cord x:%s y:%s dz:%s" % (tl.park.coord.x, tl.park.coord.y, tl.park.coord.dz)) %}
	{% set _dummy = output_txt.append("travel speed: %s mm/s" % tl.speed.travel) %}
	{% endif %}
	{% set _dummy = output_txt.append("fw_retract: %s" % tl.extruder.fw_retract) %}
	{% if not tl.extruder.fw_retract %}
	{% set _dummy = output_txt.append("retract: %s mm speed: %s mm/s" % (tl.extruder.retract, tl.speed.retract)) %}
	{% set _dummy = output_txt.append("extrude: %s mm speed: %s mm/s" % (tl.extruder.extrude, tl.speed.extrude)) %}
	{% endif %}
	{% set _dummy = output_txt.append("verbose: %s" % tl.verbose) %}
	{action_respond_info(output_txt|join("\n"))}

[gcode_macro _SET_TIMELAPSE_SETUP]
description = Set user parameters for timelapse
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	
	{% set min = printer.toolhead.axis_minimum %}
	{% set max = printer.toolhead.axis_maximum %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	{% set park = {'min'   : {'x': (min.x / 1.42)|round(3) if round_bed else min.x|round(3),
	'y': (min.y / 1.42)|round(3) if round_bed else min.y|round(3)},
	'max'   : {'x': (max.x / 1.42)|round(3) if round_bed else max.x|round(3),
	'y': (max.y / 1.42)|round(3) if round_bed else max.y|round(3)},
	'center': {'x': (max.x-(max.x-min.x)/2)|round(3),
	'y': (max.y-(max.y-min.y)/2)|round(3)}} %}
	
	{% if params.ENABLE %}
	{% if params.ENABLE|lower is in ['true', 'false'] %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=enable VALUE={True if params.ENABLE|lower == 'true' else False}
	{% else %}
	{action_raise_error("ENABLE=%s not supported. Allowed values are [True, False]" % params.ENABLE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.VERBOSE %}
	{% if params.VERBOSE|lower is in ['true', 'false'] %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=verbose VALUE={True if params.VERBOSE|lower == 'true' else False}
	{% else %}
	{action_raise_error("VERBOSE=%s not supported. Allowed values are [True, False]" % params.VERBOSE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_X %}
	{% if params.CUSTOM_POS_X|float >= min.x and params.CUSTOM_POS_X|float <= max.x %}
	{% set _dummy = tl.park.custom.update({'x':params.CUSTOM_POS_X|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_X=%s must be within [%s - %s]" % (params.CUSTOM_POS_X, min.x, max.x))}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_Y %}
	{% if params.CUSTOM_POS_Y|float >= min.y and params.CUSTOM_POS_Y|float <= max.y %}
	{% set _dummy = tl.park.custom.update({'y':params.CUSTOM_POS_Y|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_Y=%s must be within [%s - %s]" % (params.CUSTOM_POS_Y, min.y, max.y))}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_DZ %}
	{% if params.CUSTOM_POS_DZ|float >= min.z and params.CUSTOM_POS_DZ|float <= max.z %}
	{% set _dummy = tl.park.custom.update({'dz':params.CUSTOM_POS_DZ|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_DZ=%s must be within [%s - %s]" % (params.CUSTOM_POS_DZ, min.z, max.z))}
	{% endif %}
	{% endif %}
	{% if params.PARK_ENABLE %}
	{% if params.PARK_ENABLE|lower is in ['true', 'false'] %}
	{% set _dummy = tl.park.update({'enable':True if params.PARK_ENABLE|lower == 'true' else False}) %}
	{% else %}
	{action_raise_error("PARK_ENABLE=%s not supported. Allowed values are [True, False]" % params.PARK_ENABLE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.PARK_POS %}
	{% if params.PARK_POS|lower is in ['center','front_left','front_right','back_left','back_right','custom','x_only','y_only'] %}
	{% set dic = {'center'      : {'x': park.center.x   , 'y': park.center.y   , 'dz': 1                },
	'front_left'  : {'x': park.min.x      , 'y': park.min.y      , 'dz': 0                },
	'front_right' : {'x': park.max.x      , 'y': park.min.y      , 'dz': 0                },
	'back_left'   : {'x': park.min.x      , 'y': park.max.y      , 'dz': 0                },
	'back_right'  : {'x': park.max.x      , 'y': park.max.y      , 'dz': 0                },
	'custom'      : {'x': tl.park.custom.x, 'y': tl.park.custom.y, 'dz': tl.park.custom.dz},
	'x_only'      : {'x': tl.park.custom.x, 'y': 'none'          , 'dz': tl.park.custom.dz},
	'y_only'      : {'x': 'none'          , 'y': tl.park.custom.y, 'dz': tl.park.custom.dz}} %}
	{% set _dummy = tl.park.update({'pos':params.PARK_POS|lower}) %}
	{% set _dummy = tl.park.update({'coord':dic[tl.park.pos]}) %}
	{% else %}
	{action_raise_error("PARK_POS=%s not supported. Allowed values are [CENTER, FRONT_LEFT, FRONT_RIGHT, BACK_LEFT, BACK_RIGHT, CUSTOM, X_ONLY, Y_ONLY]"
	% params.PARK_POS|upper)}
	{% endif %}
	{% endif %}
	{% if params.PARK_TIME %}
	{% if params.PARK_TIME|float >= 0.0 %}
	{% set _dummy = tl.park.update({'time':params.PARK_TIME|float|round(3)}) %}
	{% else %}
	{action_raise_error("PARK_TIME=%s must be a positive number" % params.PARK_TIME)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=park VALUE="{tl.park}"
	{% if params.TRAVEL_SPEED %}
	{% if params.TRAVEL_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'travel':params.TRAVEL_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("TRAVEL_SPEED=%s must be larger than 0" % params.TRAVEL_SPEED)}
	{% endif %}
	{% endif %}
	{% if params.RETRACT_SPEED %}
	{% if params.RETRACT_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'retract':params.RETRACT_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("RETRACT_SPEED=%s must be larger than 0" % params.RETRACT_SPEED)}
	{% endif %}
	{% endif %}
	{% if params.EXTRUDE_SPEED %}
	{% if params.EXTRUDE_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'extrude':params.EXTRUDE_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("EXTRUDE_SPEED=%s must be larger than 0" % params.EXTRUDE_SPEED)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=speed VALUE="{tl.speed}"
	{% if params.EXTRUDE_DISTANCE %}
	{% if params.EXTRUDE_DISTANCE|float >= 0.0 %}
	{% set _dummy = tl.extruder.update({'extrude':params.EXTRUDE_DISTANCE|float|round(3)}) %}
	{% else %}
	{action_raise_error("EXTRUDE_DISTANCE=%s must be specified as positiv number" % params.EXTRUDE_DISTANCE)}
	{% endif %}
	{% endif %}
	{% if params.RETRACT_DISTANCE %}
	{% if params.RETRACT_DISTANCE|float >= 0.0 %}
	{% set _dummy = tl.extruder.update({'retract':params.RETRACT_DISTANCE|float|round(3)}) %}
	{% else %}
	{action_raise_error("RETRACT_DISTANCE=%s must be specified as positiv number" % params.RETRACT_DISTANCE)}
	{% endif %}
	{% endif %}
	{% if params.FW_RETRACT %}
	{% if params.FW_RETRACT|lower is in ['true', 'false'] %}
	{% if 'firmware_retraction' in printer.configfile.settings %}
	{% set _dummy = tl.extruder.update({'fw_retract': True if params.FW_RETRACT|lower == 'true' else False}) %}
	{% else %}
	{% set _dummy = tl.extruder.update({'fw_retract':False}) %}
	{% if params.FW_RETRACT|capitalize == 'True' %}
	{action_raise_error("[firmware_retraction] not defined in printer.cfg. Can not enable fw_retract")}
	{% endif %}
	{% endif %}
	{% else %}
	{action_raise_error("FW_RETRACT=%s not supported. Allowed values are [True, False]" % params.FW_RETRACT|capitalize)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=extruder VALUE="{tl.extruder}"
	{% if printer.configfile.settings['gcode_macro pause'] is defined %}
	{% set _dummy = tl.macro.update({'pause': printer.configfile.settings['gcode_macro pause'].rename_existing}) %}
	{% endif %}
	{% if printer.configfile.settings['gcode_macro resume'] is defined %}
	{% set _dummy = tl.macro.update({'resume': printer.configfile.settings['gcode_macro resume'].rename_existing}) %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=macro VALUE="{tl.macro}"

[gcode_macro TIMELAPSE_TAKE_FRAME]
description = Take Timelapse shoot
variable_enable = False
variable_takingframe = False
variable_park = {'enable': False,
	'pos'   : 'center',
	'time'  : 0.1,
	'custom': {'x': 0, 'y': 0, 'dz': 0},
	'coord' : {'x': 0, 'y': 0, 'dz': 0}}
variable_extruder = {'fw_retract': False,
	'retract': 1.0,
	'extrude': 1.0}
variable_speed = {'travel': 100,
	'retract': 15,
	'extrude': 15}
variable_verbose = True
variable_check_time = 0.5
variable_restore = {'absolute': {'coordinates': True, 'extrude': True}, 'speed': 1500, 'e':0, 'factor': {'speed': 1.0, 'extrude': 1.0}}
variable_macro = {'pause': 'PAUSE', 'resume': 'RESUME'}
variable_is_paused = False
gcode = 
	{% set hyperlapse = True if params.HYPERLAPSE and params.HYPERLAPSE|lower =='true' else False %}
	{% if enable %}
	{% if (hyperlapse and printer['gcode_macro HYPERLAPSE'].run) or
	(not hyperlapse and not printer['gcode_macro HYPERLAPSE'].run) %}
	{% if park.enable %}
	{% set pos = {'x': 'X' + park.coord.x|string if park.pos != 'y_only' else '',
	'y': 'Y' + park.coord.y|string if park.pos != 'x_only' else '',
	'z': 'Z'+ [printer.gcode_move.gcode_position.z + park.coord.dz, printer.toolhead.axis_maximum.z]|min|string} %}
	{% set restore = {'absolute': {'coordinates': printer.gcode_move.absolute_coordinates,
	'extrude'    : printer.gcode_move.absolute_extrude},
	'speed'   : printer.gcode_move.speed,
	'e'       : printer.gcode_move.gcode_position.e,
	'factor'  : {'speed'  : printer.gcode_move.speed_factor,
	'extrude': printer.gcode_move.extrude_factor}} %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=restore VALUE="{restore}"
	{% if not printer[printer.toolhead.extruder].can_extrude %}
	{% if verbose %}{action_respond_info("Timelapse: Warning, minimum extruder temperature not reached!")}{% endif %}
	{% else %}
	{% if extruder.fw_retract %}
	G10
	{% else %}
	M83
	G0 E-{extruder.retract} F{speed.retract * 60}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=is_paused VALUE=True
	{macro.pause}
	SET_GCODE_OFFSET X=0 Y=0
	G90
	{% if "xyz" not in printer.toolhead.homed_axes %}
	{% if verbose %}{action_respond_info("Timelapse: Warning, axis not homed yet!")}{% endif %}
	{% else %}
	G0 {pos.x} {pos.y} {pos.z} F{speed.travel * 60}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=takingframe VALUE=True
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_TAKE_FRAME DURATION={check_time}
	M400
	{% endif %}
	_TIMELAPSE_NEW_FRAME HYPERLAPSE={hyperlapse}
	{% endif %}
	{% else %}
	{% if verbose %}{action_respond_info("Timelapse: disabled, take frame ignored")}{% endif %}
	{% endif %}

[gcode_macro _TIMELAPSE_NEW_FRAME]
description = action call for timelapse shoot. must be a seperate macro
gcode = 
	{action_call_remote_method("timelapse_newframe",
	macropark=printer['gcode_macro TIMELAPSE_TAKE_FRAME'].park,
	hyperlapse=params.HYPERLAPSE)}

[delayed_gcode _WAIT_TIMELAPSE_TAKE_FRAME]
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% set factor = {'speed': printer.gcode_move.speed_factor, 'extrude': printer.gcode_move.extrude_factor} %}
	{% if tl.takingframe %}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_TAKE_FRAME DURATION={tl.check_time}
	{% else %}
	{tl.macro.resume} VELOCITY={tl.speed.travel}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=is_paused VALUE=False
	{% if not printer[printer.toolhead.extruder].can_extrude %}
	{action_respond_info("Timelapse: Warning minimum extruder temperature not reached!")}
	{% else %}
	{% if tl.extruder.fw_retract %}
	G11
	{% else %}
	G0 E{tl.extruder.extrude} F{tl.speed.extrude * 60}
	G0 F{tl.restore.speed}
	{% if tl.restore.absolute.extrude %}
	M82
	G92 E{tl.restore.e}
	{% endif %}
	{% endif %}
	{% endif %}
	{% if tl.restore.factor.speed   != factor.speed   %} M220 S{(factor.speed*100)|round(0)}   {% endif %}
	{% if tl.restore.factor.extrude != factor.extrude %} M221 S{(factor.extrude*100)|round(0)} {% endif %}
	{% if not tl.restore.absolute.coordinates %} G91 {% endif %}
	{% endif %}

[gcode_macro HYPERLAPSE]
description = Start/Stop a hyperlapse recording
variable_cycle = 0
variable_run = False
gcode = 
	{% set cycle = params.CYCLE|default(30)|int %}
	{% if params.ACTION and params.ACTION|lower == 'start' %}
	{action_respond_info("Hyperlapse: frames started (Cycle %d sec)" % cycle)}
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=run VALUE=True
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=cycle VALUE={cycle}
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION={cycle}
	TIMELAPSE_TAKE_FRAME HYPERLAPSE=True
	{% elif params.ACTION and params.ACTION|lower == 'stop' %}
	{% if run %}{action_respond_info("Hyperlapse: frames stopped")}{% endif %}
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=run VALUE=False
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION=0
	{% else %}
	{action_raise_error("Hyperlapse: No valid input parameter
	Use:
	- HYPERLAPSE ACTION=START [CYCLE=time]
	- HYPERLAPSE ACTION=STOP")}
	{% endif %}

[delayed_gcode _HYPERLAPSE_LOOP]
gcode = 
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION={printer["gcode_macro HYPERLAPSE"].cycle}
	TIMELAPSE_TAKE_FRAME HYPERLAPSE=True

[gcode_macro TIMELAPSE_RENDER]
description = Render Timelapse video and wait for the result
variable_render = False
variable_run_identifier = 0
gcode = 
	{action_respond_info("Timelapse: Rendering started")}
	{action_call_remote_method("timelapse_render", byrendermacro="True")}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_RENDER VARIABLE=render VALUE=True
	{printer.configfile.settings['gcode_macro pause'].rename_existing}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_RENDER DURATION=0.5

[delayed_gcode _WAIT_TIMELAPSE_RENDER]
gcode = 
	{% set ri = printer['gcode_macro TIMELAPSE_RENDER'].run_identifier % 4 %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_RENDER VARIABLE=run_identifier VALUE={ri + 1}
	{% if printer['gcode_macro TIMELAPSE_RENDER'].render %}
	M117 Rendering {['-','\\','|','/'][ri]}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_RENDER DURATION=0.5
	{% else %}
	{action_respond_info("Timelapse: Rendering finished")}
	M117
	{printer.configfile.settings['gcode_macro resume'].rename_existing}
	{% endif %}

[gcode_macro TEST_STREAM_DELAY]
description = Helper macro to find stream and park delay
gcode = 
	{% set min = printer.toolhead.axis_minimum %}
	{% set max = printer.toolhead.axis_maximum %}
	{% set act = printer.toolhead.position %}
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% if act.z > 5.0 %}
	G0 X{min.x + 5.0} F{tl.speed.travel|int * 60}
	G0 X{(max.x-min.x)/2}
	G4 P{tl.park.time|float * 1000}
	_TIMELAPSE_NEW_FRAME HYPERLAPSE=FALSE
	G0 X{max.x - 5.0}
	{% else %}
	{action_raise_error("Toolhead z %.3f to low. Please place head above z = 5.0" % act.z)}
	{% endif %}

[gcode_macro _OBICO_LAYER_CHANGE]
description = Run a scan across the current print area
variable_first_layer_scan_retract_length = 6
variable_first_layer_scan_retract_speed = 15
variable_first_layer_scan_cooldown_temp = 170
variable_first_layer_scan_resume_speed = 50
variable_first_layer_scan_enabled = True
variable_first_layer_scan_stepover = 10
variable_first_layer_scan_speed = 10
variable_first_layer_scan_zhop = 4
variable_first_layer_scan_zhop_speed = 15
variable_verbose = False
variable_current_layer = -1
variable_first_layer_scanning = False
variable_wait = {'resume': "RESUME", 'absolute_coordinates': True, 'absolute_extrude': True, 'e': 0.0, 'previous_temp': 0}
gcode = 
	
	{% set pause_macro  = "PAUSE"  if printer.configfile.settings['gcode_macro pause']  is not defined
	else printer.configfile.settings['gcode_macro pause'].rename_existing %}
	{% set resume_macro = "RESUME" if printer.configfile.settings['gcode_macro resume'] is not defined
	else printer.configfile.settings['gcode_macro resume'].rename_existing %}
	
	{% set current_layer_default = printer.print_stats.info.current_layer if printer.print_stats.info.current_layer is not none else -1 %}
	{% set current_layer = params.CURRENT_LAYER|default(current_layer_default)|int %}
	
	{% set polygon_points = printer.exclude_object.objects|map(attribute='polygon')|sum(start=[]) if printer.exclude_object is defined else [] %}
	{% set min_x = params.MINX|default(polygon_points|map(attribute=0)|min|default(printer.toolhead.axis_minimum.x))|float %}
	{% set min_y = params.MINY|default(polygon_points|map(attribute=1)|min|default(printer.toolhead.axis_minimum.y))|float %}
	{% set max_x = params.MAXX|default(polygon_points|map(attribute=0)|max|default(printer.toolhead.axis_maximum.x))|float %}
	{% set max_y = params.MAXY|default(polygon_points|map(attribute=1)|max|default(printer.toolhead.axis_maximum.y))|float %}
	
	{% set stepoverCount = ((max_y - min_y) / first_layer_scan_stepover|float)|round(method='ceil')|int %}
	
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Layer %d" % (current_layer)}' {% endif %}
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=current_layer VALUE={current_layer}
	
	{% if first_layer_scan_enabled and current_layer == 2 %}
	
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=first_layer_scanning VALUE=True
	
	
	{% set wait_dic = {'resume'              : resume_macro,
	'absolute_coordinates': printer.gcode_move.absolute_coordinates,
	'absolute_extrude'    : printer.gcode_move.absolute_extrude,
	'e'                   : printer.gcode_move.gcode_position.e,
	'previous_temp'       : printer.extruder.target} %}
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=wait VALUE="{wait_dic}"
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Prepare scanning" {% endif %}
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Scan Coordinates: Min:[%.3f:%.3f] Max:[%.3f:%.3f]" % (min_x,min_y,max_x,max_y)}' {% endif %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Retract %.1fmm filament" % first_layer_scan_retract_length|abs}' {% endif %}
	M83
	G0 E-{first_layer_scan_retract_length|abs} F{first_layer_scan_retract_speed|float * 60}
	{% endif %}
	G91
	G0 Z{first_layer_scan_zhop|abs} F{first_layer_scan_zhop_speed|float * 60}
	
	
	M106 S255
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Fan on and lowering temperature to %.1f" % first_layer_scan_cooldown_temp}' {% endif %}
	M104 S{first_layer_scan_cooldown_temp}
	M109 S{first_layer_scan_cooldown_temp}
	
	{pause_macro}
	
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Start scanning" {% endif %}
	
	UPDATE_DELAYED_GCODE ID=_WAIT_OBICO_LAYER_CHANGE DURATION=1.0
	G90
	G0 X{min_x} Y{min_y} F{first_layer_scan_resume_speed|float * 60}
	{% for ystep in range(stepoverCount) %}
	G0 Y{min_y + first_layer_scan_stepover|float * ystep} F{first_layer_scan_speed|float * 60}
	G0 X{max_x if ystep % 2 == 0 else min_x}              F{first_layer_scan_speed|float * 60}
	{% endfor %}
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Finish scanning" {% endif %}
	
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=first_layer_scanning VALUE=False
	
	{% endif %}

[delayed_gcode _WAIT_OBICO_LAYER_CHANGE]
gcode = 
	{% set lc_macro = printer['gcode_macro _OBICO_LAYER_CHANGE'] %}
	{% if lc_macro.first_layer_scanning %}
	
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Waiting for first layer scan..." {% endif %}
	UPDATE_DELAYED_GCODE ID=_WAIT_OBICO_LAYER_CHANGE DURATION=1.0
	{% else %}
	
	M107
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Fan off and resume print" {% endif %}
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Call %s VELOCITY=%.1f" % (lc_macro.wait.resume, lc_macro.first_layer_scan_resume_speed)}' {% endif %}
	{lc_macro.wait.resume} VELOCITY={lc_macro.first_layer_scan_resume_speed}
	G91
	G0 Z-{lc_macro.first_layer_scan_zhop|abs} F{lc_macro.first_layer_scan_zhop_speed|float * 60}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% set first_layer_scan_unretract_length = lc_macro.first_layer_scan_retract_length + 0.5 %}
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Extrude %.1fmm filament" % first_layer_scan_unretract_length|abs}' {% endif %}
	M83
	G0 E{first_layer_scan_unretract_length|abs} F{lc_macro.first_layer_scan_retract_speed|float * 60}
	{% endif %}
	
	
	M104 S{lc_macro.wait.previous_temp}
	M109 S{lc_macro.wait.previous_temp}
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Heating back up to previous temperature"}' {% endif %}
	
	
	{% if lc_macro.wait.absolute_coordinates %} G90 {% endif %}
	{% if lc_macro.wait.absolute_extrude %}
	M82
	G92 E{lc_macro.wait.e}
	{% endif %}
	{% endif %}

[gcode_macro OBICO_LINK_STATUS]
description = Link to Obico server
variable_one_time_passcode = ''
variable_one_time_passlink = ''
variable_is_linked = False
gcode = 
	{action_respond_info('Obico one_time_passcode: {}'.format(one_time_passcode))}
	{action_respond_info('Obico one_time_passlink: {}'.format(one_time_passlink))}
	{action_respond_info('Obico is_linked: {}'.format(is_linked))}
	{% if not is_linked and one_time_passcode != '' %}
	M117 Code: {one_time_passcode}
	{% else %}
	M117 Obico linked
	{% endif %}

[gcode_macro _OBICO_RELINK]
description = Re-link to Obico server
gcode = 
	{action_respond_info('WARNING: Re-link to Obico server')}
	{action_call_remote_method("obico_remote_event", event_name='relink_obico', message='')}
	{action_respond_info('WARNING: relink_obico requested')}

[exclude_object]

[mcu]
serial = /dev/serial/by-id/usb-1a86_USB_Serial-if00-port0
restart_method = command

[temperature_sensor raspberry_pi]
sensor_type = temperature_host
min_temp = 10
max_temp = 100

[temperature_sensor mcu_temp]
sensor_type = temperature_mcu
min_temp = 0
max_temp = 100

[printer]
kinematics = cartesian
max_velocity = 200
max_accel = 4000
max_z_velocity = 10
max_z_accel = 100
minimum_cruise_ratio = 0.5
square_corner_velocity = 5

[stepper_x]
step_pin = PB9
dir_pin = PC2
enable_pin = !PC3
microsteps = 16
rotation_distance = 40
endstop_pin = ^PA5
position_endstop = 0
position_max = 230
homing_speed = 50

[stepper_y]
step_pin = PB7
dir_pin = PB8
enable_pin = !PC3
microsteps = 16
rotation_distance = 40
endstop_pin = ^PA6
position_endstop = 0
position_max = 231
homing_speed = 50

[stepper_z]
step_pin = PB5
dir_pin = !PB6
enable_pin = !PC3
microsteps = 16
rotation_distance = 8
endstop_pin = probe:z_virtual_endstop
position_max = 250
position_min = -4
homing_speed = 4
second_homing_speed = 1
homing_retract_dist = 2.0

[fan]
pin = PA0

[extruder]
max_extrude_only_distance = 100.0
step_pin = PB3
dir_pin = PB4
enable_pin = !PC3
microsteps = 16
gear_ratio = 42:12
rotation_distance = 26.359
nozzle_diameter = 0.400
filament_diameter = 1.750
heater_pin = PA1
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PC5
min_temp = 0
max_temp = 300
min_extrude_temp = 170
pressure_advance = .0369
pressure_advance_smooth_time = 0.04
control = pid
pid_kp = 19.195
pid_ki = 1.000
pid_kd = 92.135

[firmware_retraction]
retract_length = 0.3
retract_speed = 20

[idle_timeout]
gcode = 
	{% if printer.pause_resume.is_paused %}
	M118 Idle timeout while paused, turning off hotend
	SET_HEATER_TEMPERATURE HEATER=extruder TARGET=0
	{% else %}
	M118 Idle timeout
	TURN_OFF_HEATERS
	M84
	{% endif %}
timeout = 1800

[heater_bed]
heater_pin = PA2
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PC4
min_temp = 0
max_temp = 130
control = pid
pid_kp = 68.601
pid_ki = 1.185
pid_kd = 993.000

[bltouch]
sensor_pin = ^PB1
control_pin = PB0
x_offset = -31.8
y_offset = -40.5
speed = 35
samples = 2
samples_result = median
samples_tolerance = 0.05
samples_tolerance_retries = 2
sample_retract_dist = 5.0
probe_with_touch_mode = true
stow_on_each_sample = false
z_offset = 2.049

[safe_z_home]
home_xy_position = 147, 154
speed = 75
z_hop = 10
z_hop_speed = 5
move_to_previous = false

[bed_screws]
screw1 = 30,51
screw1_name = "FL"
screw2 = 200,51
screw2_name = "FR"
screw3 = 200,195
screw3_name = "RR"
screw4 = 30,195
screw4_name = "RL"

[screws_tilt_adjust]
screw1 = 67, 67
screw1_name = front left screw
screw2 = 230, 67
screw2_name = front right screw
screw3 = 230, 230
screw3_name = rear right screw
screw4 = 67.60, 230
screw4_name = rear left screw
horizontal_move_z = 10
speed = 200
screw_thread = CW-M4

[bed_mesh]
speed = 120
mesh_min = 10,11
mesh_max = 195,182
probe_count = 3,3
algorithm = bicubic
fade_start = 1
fade_end = 10
fade_target = 0

[filament_motion_sensor SFS_T0]
detection_length = 150.00
extruder = extruder
switch_pin = PA4
pause_on_runout = True
event_delay = 3.0
pause_delay = 0.5
runout_gcode = 
	M117 Runout Detected!

[delayed_gcode DISABLEFILAMENTSENSOR]
initial_duration = 1
gcode = 
	SET_FILAMENT_SENSOR SENSOR=SFS_T0 ENABLE=0

[gcode_macro SFS_ENABLE]
description = Enable smart filament sensor
gcode = 
	M117 ENABLING the Smart Filament Sensor
	G92 E0
	SET_FILAMENT_SENSOR SENSOR=SFS_T0 ENABLE=1

[gcode_macro SFS_DISABLE]
description = Disable smart filament sensor
gcode = 
	M117 DISABLING the Smart Filament Sensor
	G92 E0
	SET_FILAMENT_SENSOR SENSOR=SFS_T0 ENABLE=0

[gcode_macro FILAMENT_RUNOUT]
gcode = 
	M117 Runout Detected!
	M300 S1 P10
	M600
	M300 S1 P10

[gcode_macro M300]
gcode = 
	{% set S = params.S|default(1000)|int %}
	{% set P = params.P|default(100)|int %}
	SET_PIN PIN=BEEPER VALUE=0.5 CYCLE_TIME={ 1.0/S if S > 0 else 1 }
	G4 P{P}
	SET_PIN PIN=BEEPER VALUE=0
	[gcode_macro M600]
	gcode:
	{% set X = params.X|default(25)|float %}
	{% set Y = params.Y|default(25)|float %}
	{% set Z = params.Z|default(10)|float %}
	SAVE_GCODE_STATE NAME=M600_state
	PAUSE
	G91
	G1 E-.8 F2700
	G1 Z{Z}
	G90
	G1 X{X} Y{Y} F3000
	G91
	G1 E-15 F1000
	RESTORE_GCODE_STATE NAME=M600_state

[gcode_arcs]
resolution = 1.0

[input_shaper]
shaper_freq_x = 73.5
shaper_type_x = ei
shaper_freq_y = 76.9
shaper_type_y = mzv
=======================
bed_mesh: bicubic interpolation with a probe_count of less than 4 points detected.  Forcing lagrange interpolation. Configured Probe Count: 3, 3
Extruder max_extrude_ratio=0.266081
mcu 'mcu': Starting serial connect
webhooks client 548292038320: New connection
webhooks client 548292038320: Client info {'program': 'Moonraker', 'version': 'v0.9.3-3-gccfe32f'}
mcu 'mcu': got {'oid': 10, 'next_clock': 2149135104, 'value': 14014, '#name': 'analog_in_state', '#sent_time': 2587.8220014569997, '#receive_time': 2587.8664250310003}
mcu 'mcu': got {'oid': 12, 'next_clock': 2150575104, 'value': 31563, '#name': 'analog_in_state', '#sent_time': 2587.875853253, '#receive_time': 2587.886599031}
mcu 'mcu': got {'oid': 17, 'next_clock': 2154175104, 'value': 31508, '#name': 'analog_in_state', '#sent_time': 2587.930397957, '#receive_time': 2587.9365496980004}
mcu 'mcu': got {'oid': 10, 'next_clock': 2170735104, 'value': 14012, '#name': 'analog_in_state', '#sent_time': 2588.145768253, '#receive_time': 2588.166438235}
mcu 'mcu': got {'oid': 12, 'next_clock': 2172175104, 'value': 31557, '#name': 'analog_in_state', '#sent_time': 2588.145768253, '#receive_time': 2588.186436901}
mcu 'mcu': got {'oid': 17, 'next_clock': 2175775104, 'value': 31502, '#name': 'analog_in_state', '#sent_time': 2588.199432309, '#receive_time': 2588.23640079}
Loaded MCU 'mcu' 119 commands (v0.12.0-286-g81de9a861 / gcc: (15:8-2019-q3-1+b1) 8.3.1 20190703 (release) [gcc-8-branch revision 273027] binutils: (2.35.2-2+14+b2) 2.35.2)
MCU 'mcu' config: ADC_MAX=4095 BUS_PINS_i2c1=PB6,PB7 BUS_PINS_i2c1a=PB8,PB9 BUS_PINS_i2c2=PB10,PB11 BUS_PINS_spi1=PA6,PA7,PA5 BUS_PINS_spi1a=PB4,PB5,PB3 BUS_PINS_spi2=PB14,PB15,PB13 BUS_PINS_spi3=PB4,PB5,PB3 CLOCK_FREQ=72000000 MCU=stm32f103xe PWM_MAX=255 RECEIVE_WINDOW=192 RESERVE_PINS_serial=PA10,PA9 SERIAL_BAUD=250000 STATS_SUMSQ_BASE=256 STEPPER_BOTH_EDGE=1
mcu_temperature 'mcu' nominal base=357.558140 slope=-767.441860
Configured MCU 'mcu' (1024 moves)
Starting heater checks for heater_bed
bed_mesh: generated points
Index |  Tool Adjusted  |   Probe
  0   | (41.8, 51.5)    | (10.0, 11.0)
  1   | (134.3, 51.5)   | (102.5, 11.0)
  2   | (226.8, 51.5)   | (195.0, 11.0)
  3   | (226.8, 137.0)  | (195.0, 96.5)
  4   | (134.3, 137.0)  | (102.5, 96.5)
  5   | (41.8, 137.0)   | (10.0, 96.5)
  6   | (41.8, 222.5)   | (10.0, 182.0)
  7   | (134.3, 222.5)  | (102.5, 182.0)
  8   | (226.8, 222.5)  | (195.0, 182.0)
Starting heater checks for extruder
Stats 2589.3: gcodein=0  mcu: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=1138 bytes_read=4685 bytes_retransmit=9 bytes_invalid=0 send_seq=115 receive_seq=115 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000655  raspberry_pi: temp=52.1 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.22 cputime=1.363 memavail=1514480 print_time=110447.673 buffer_time=0.249 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
webhooks: registering remote method 'shutdown_machine' for connection id: 548292038320
webhooks: registering remote method 'reboot_machine' for connection id: 548292038320
webhooks: registering remote method 'pause_job_queue' for connection id: 548292038320
webhooks: registering remote method 'start_job_queue' for connection id: 548292038320
webhooks: registering remote method 'spoolman_set_active_spool' for connection id: 548292038320
webhooks: registering remote method 'obico_remote_event' for connection id: 548292038320
Stats 2590.3: gcodein=0  mcu: mcu_awake=0.006 mcu_task_avg=0.000028 mcu_task_stddev=0.000013 bytes_write=1144 bytes_read=4881 bytes_retransmit=9 bytes_invalid=0 send_seq=116 receive_seq=116 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000287  raspberry_pi: temp=53.1 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.22 cputime=1.401 memavail=1511824 print_time=110447.673 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 2591.3: gcodein=0  mcu: mcu_awake=0.006 mcu_task_avg=0.000028 mcu_task_stddev=0.000013 bytes_write=1150 bytes_read=5032 bytes_retransmit=9 bytes_invalid=0 send_seq=117 receive_seq=117 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000720  raspberry_pi: temp=52.1 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=2.22 cputime=1.423 memavail=1505588 print_time=110447.673 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 2592.3: gcodein=0  mcu: mcu_awake=0.006 mcu_task_avg=0.000028 mcu_task_stddev=0.000013 bytes_write=1156 bytes_read=5198 bytes_retransmit=9 bytes_invalid=0 send_seq=118 receive_seq=118 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000409  raspberry_pi: temp=52.1 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.12 cputime=1.432 memavail=1523980 print_time=110447.673 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 2593.3: gcodein=0  mcu: mcu_awake=0.006 mcu_task_avg=0.000028 mcu_task_stddev=0.000013 bytes_write=1162 bytes_read=5379 bytes_retransmit=9 bytes_invalid=0 send_seq=119 receive_seq=119 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000306  raspberry_pi: temp=52.1 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.12 cputime=1.442 memavail=1523980 print_time=110447.673 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 2594.3: gcodein=0  mcu: mcu_awake=0.006 mcu_task_avg=0.000028 mcu_task_stddev=0.000013 bytes_write=1168 bytes_read=5530 bytes_retransmit=9 bytes_invalid=0 send_seq=120 receive_seq=120 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000368  raspberry_pi: temp=53.1 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=2.12 cputime=1.451 memavail=1524968 print_time=110447.673 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 2595.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1174 bytes_read=5710 bytes_retransmit=9 bytes_invalid=0 send_seq=121 receive_seq=121 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000293  raspberry_pi: temp=51.1 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.12 cputime=1.462 memavail=1525972 print_time=110447.673 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 2596.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1180 bytes_read=5891 bytes_retransmit=9 bytes_invalid=0 send_seq=122 receive_seq=122 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000251  raspberry_pi: temp=51.6 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=2.12 cputime=1.471 memavail=1525472 print_time=110447.673 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 2597.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1186 bytes_read=6042 bytes_retransmit=9 bytes_invalid=0 send_seq=123 receive_seq=123 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000217  raspberry_pi: temp=51.6 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.95 cputime=1.480 memavail=1545480 print_time=110447.673 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 2598.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1192 bytes_read=6208 bytes_retransmit=9 bytes_invalid=0 send_seq=124 receive_seq=124 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000195  raspberry_pi: temp=52.1 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.95 cputime=1.489 memavail=1545256 print_time=110447.673 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 2599.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1198 bytes_read=6389 bytes_retransmit=9 bytes_invalid=0 send_seq=125 receive_seq=125 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000186  raspberry_pi: temp=51.1 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.95 cputime=1.498 memavail=1545008 print_time=110447.673 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 2600.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1204 bytes_read=6554 bytes_retransmit=9 bytes_invalid=0 send_seq=126 receive_seq=126 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000292  raspberry_pi: temp=51.1 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.95 cputime=1.512 memavail=1544320 print_time=110447.673 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 2601.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1210 bytes_read=6735 bytes_retransmit=9 bytes_invalid=0 send_seq=127 receive_seq=127 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000287  raspberry_pi: temp=51.1 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.95 cputime=1.527 memavail=1544320 print_time=110447.673 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 2602.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1216 bytes_read=6901 bytes_retransmit=9 bytes_invalid=0 send_seq=128 receive_seq=128 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000296  raspberry_pi: temp=51.1 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.96 cputime=1.542 memavail=1544320 print_time=110447.673 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 2603.3: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1222 bytes_read=7052 bytes_retransmit=9 bytes_invalid=0 send_seq=129 receive_seq=129 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000295  raspberry_pi: temp=52.1 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.96 cputime=1.556 memavail=1541816 print_time=110447.673 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
webhooks client 548292038320: Disconnected
Starting Klippy...
Args: ['/home/coon/klipper/klippy/klippy.py', '/home/coon/printer_data/config/printer.cfg', '-l', '/home/coon/printer_data/logs/klippy.log', '-I', '/home/coon/printer_data/comms/klippy.serial', '-a', '/home/coon/printer_data/comms/klippy.sock']
Git version: 'v0.12.0-404-g80d185c94'
Branch: master
Remote: origin
Tracked URL: https://github.com/Klipper3d/klipper.git
CPU: 4 core ?
Python: '3.9.2 (default, Dec  1 2024, 12:12:57) \n[GCC 10.2.1 20210110]'
Start printer at Sun Dec 22 18:42:51 2024 (1734910971.2 20.6)
===== Config file =====
[virtual_sdcard]
path = ~/printer_data/gcodes
on_error_gcode = CANCEL_PRINT

[pause_resume]
recover_velocity = 25

[display_status]

[respond]
default_prefix = 

[gcode_macro CANCEL_PRINT]
description = Cancel the actual running print
rename_existing = BASE_CANCEL_PRINT
gcode = 
	G91
	G0 Z10 F600
	G90
	TURN_OFF_HEATERS
	G0 X5 Y220
	CLEAR_PAUSE
	
	BASE_CANCEL_PRINT

[gcode_macro PAUSE]
description = Pause the actual running print
rename_existing = PAUSE_BASE
gcode = 
	
	{% set x = params.X|default(5) %}
	{% set y = params.Y|default(225) %}
	{% set z = params.Z|default(10)|float %}
	{% set e = params.E|default(1) %}
	
	{% set max_z = printer.toolhead.axis_maximum.z|float %}
	{% set act_z = printer.toolhead.position.z|float %}
	{% set lift_z = z|abs %}
	{% if act_z < (max_z - lift_z) %}
	{% set z_safe = lift_z %}
	{% else %}
	{% set z_safe = max_z - act_z %}
	{% endif %}
	
	PAUSE_BASE
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E-{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	{% if "xyz" in printer.toolhead.homed_axes %}
	G1 Z{z_safe}
	G90
	G1 X{x} Y{y} F6000
	{% else %}
	{action_respond_info("Printer not homed")}
	{% endif %}

[gcode_macro RESUME]
description = Resume the actual running print
rename_existing = RESUME_BASE
variable_last_extruder_temp = {'restore': False, 'temp': 0}
variable_restore_idle_timeout = 0
variable_idle_state = False
gcode = 
	
	{% set e = params.E|default(1) %}
	
	{% if 'VELOCITY' in params|upper %}
	{% set get_params = ('VELOCITY=' + params.VELOCITY)  %}
	{%else %}
	{% set get_params = "" %}
	{% endif %}
	
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	RESUME_BASE {get_params}

[gcode_macro SET_PAUSE_NEXT_LAYER]
description = Enable a pause if the next layer is reached
gcode = 
	{% set pause_next_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_next_layer %}
	{% set ENABLE = params.ENABLE|default(1)|int != 0 %}
	{% set MACRO = params.MACRO|default(pause_next_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_next_layer VALUE="{{ 'enable': ENABLE, 'call': MACRO }}"

[gcode_macro SET_PAUSE_AT_LAYER]
description = Enable/disable a pause if a given layer number is reached
gcode = 
	{% set pause_at_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_at_layer %}
	{% set ENABLE = params.ENABLE|int != 0 if params.ENABLE is defined
	else params.LAYER is defined %}
	{% set LAYER = params.LAYER|default(pause_at_layer.layer)|int %}
	{% set MACRO = params.MACRO|default(pause_at_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_at_layer VALUE="{{ 'enable': ENABLE, 'layer': LAYER, 'call': MACRO }}"

[gcode_macro SET_PRINT_STATS_INFO]
rename_existing = SET_PRINT_STATS_INFO_BASE
description = Overwrite, to get pause_next_layer and pause_at_layer feature
variable_pause_next_layer = { 'enable': False, 'call': "PAUSE" }
variable_pause_at_layer = { 'enable': False, 'layer': 0, 'call': "PAUSE" }
gcode = 
	{% if pause_next_layer.enable %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_next_layer" % pause_next_layer.call}'
	{pause_next_layer.call}
	SET_PAUSE_NEXT_LAYER ENABLE=0
	{% elif pause_at_layer.enable and params.CURRENT_LAYER is defined and params.CURRENT_LAYER|int == pause_at_layer.layer %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_at_layer [%d]" % (pause_at_layer.call, pause_at_layer.layer)}'
	{pause_at_layer.call}
	SET_PAUSE_AT_LAYER ENABLE=0
	{% endif %}
	SET_PRINT_STATS_INFO_BASE {rawparams}

[gcode_macro _TOOLHEAD_PARK_PAUSE_CANCEL]
description = Helper: park toolhead used in PAUSE and CANCEL_PRINT
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set velocity = printer.configfile.settings.pause_resume.recover_velocity %}
	{% set use_custom     = client.use_custom_pos|default(false)|lower == 'true' %}
	{% set custom_park_x  = client.custom_park_x|default(0.0) %}
	{% set custom_park_y  = client.custom_park_y|default(0.0) %}
	{% set park_dz        = client.custom_park_dz|default(2.0)|abs %}
	{% set sp_hop         = client.speed_hop|default(15) * 60 %}
	{% set sp_move        = client.speed_move|default(velocity) * 60 %}
	
	{% set origin    = printer.gcode_move.homing_origin %}
	{% set act       = printer.gcode_move.gcode_position %}
	{% set max       = printer.toolhead.axis_maximum %}
	{% set cone      = printer.toolhead.cone_start_z|default(max.z) %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	
	{% set z_min = params.Z_MIN|default(0)|float %}
	{% set z_park = [[(act.z + park_dz), z_min]|max, (max.z - origin.z)]|min %}
	{% set x_park = params.X       if params.X is defined
	else custom_park_x  if use_custom
	else 0.0            if round_bed
	else (max.x - 5.0) %}
	{% set y_park = params.Y       if params.Y is defined
	else custom_park_y  if use_custom
	else (max.y - 5.0)  if round_bed and z_park < cone
	else 0.0            if round_bed
	else (max.y - 5.0) %}
	
	_CLIENT_RETRACT
	{% if "xyz" in printer.toolhead.homed_axes %}
	G90
	G1 Z{z_park} F{sp_hop}
	G1 X{x_park} Y{y_park} F{sp_move}
	{% if not printer.gcode_move.absolute_coordinates %} G91 {% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='Printer not homed'
	{% endif %}

[gcode_macro _CLIENT_EXTRUDE]
description = Extrudes, if the extruder is hot enough
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set use_fw_retract = (client.use_fw_retract|default(false)|lower == 'true') and (printer.firmware_retraction is defined) %}
	{% set length = params.LENGTH|default(client.unretract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_unretract)|default(35) %}
	{% set absolute_extrude = printer.gcode_move.absolute_extrude %}
	
	{% if printer.toolhead.extruder != '' %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if use_fw_retract %}
	{% if length < 0 %}
	G10
	{% else %}
	G11
	{% endif %}
	{% else %}
	M83
	G1 E{length} F{(speed|float|abs) * 60}
	{% if absolute_extrude %}
	M82
	{% endif %}
	{% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='{"\"%s\" not hot enough" % printer.toolhead.extruder}'
	{% endif %}
	{% endif %}

[gcode_macro _CLIENT_RETRACT]
description = Retracts, if the extruder is hot enough
gcode = 
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set length = params.LENGTH|default(client.retract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_retract)|default(35) %}
	
	_CLIENT_EXTRUDE LENGTH=-{length|float|abs} SPEED={speed|float|abs}

[gcode_macro _CLIENT_LINEAR_MOVE]
description = Linear move with save and restore of the gcode state
gcode = 
	{% set x_move = "X" ~ params.X if params.X is defined else "" %}
	{% set y_move = "Y" ~ params.Y if params.Y is defined else "" %}
	{% set z_move = "Z" ~ params.Z if params.Z is defined else "" %}
	{% set e_move = "E" ~ params.E if params.E is defined else "" %}
	{% set rate = "F" ~ params.F if params.F is defined else "" %}
	{% set ABSOLUTE = params.ABSOLUTE | default(0) | int != 0 %}
	{% set ABSOLUTE_E = params.ABSOLUTE_E | default(0) | int != 0 %}
	SAVE_GCODE_STATE NAME=_client_movement
	{% if x_move or y_move or z_move %}
	G9{ 0 if ABSOLUTE else 1 }
	{% endif %}
	{% if e_move %}
	M8{ 2 if ABSOLUTE_E else 3 }
	{% endif %}
	G1 { x_move } { y_move } { z_move } { e_move } { rate }
	RESTORE_GCODE_STATE NAME=_client_movement

[gcode_macro play_test]
gcode = 
	RESPOND TYPE=command MSG="action:prompt_begin Question"
	RESPOND TYPE=command MSG="action:prompt_text Do you wont to cancel the print?"
	RESPOND TYPE=command MSG="action:prompt_footer_button continue|RESPOND TYPE=command MSG=action:prompt_end"
	RESPOND TYPE=command MSG="action:prompt_footer_button CANCEL|CANCEL_PRINT|error"
	RESPOND TYPE=command MSG="action:prompt_show"

[gcode_macro PRINT_START]
gcode = 
	START_PRINT {rawparams}

[gcode_macro START_PRINT]
gcode = 
	{% set BED_TEMP = params.BED_TEMP|default(60)|float %}
	{% set EXTRUDER_TEMP = params.EXTRUDER_TEMP|default(190)|float %}
	
	M190 S{BED_TEMP}
	
	G90
	
	G28
	
	RESPOND MSG="Bed Meshing"
	
	
	
	
	
	
	
	
	BED_MESH_CLEAR
	BED_MESH_CALIBRATE ADAPTIVE=1
	
	
	
	
	
	
	
	RESPOND MSG="Heating to print temp"
	M104 S{EXTRUDER_TEMP}
	G0 Z40 F240
	M109 S{EXTRUDER_TEMP}
	RESPOND MSG="Enable Runout Sensor"
	SFS_ENABLE
	RESPOND MSG="Line Purge"
	LINE_PURGE
	RESPOND MSG="Print Started"

[gcode_macro LINE_PURGE]
gcode = 
	G92 E0
	G1 Z2.0 F3000
	G1 X0.1 Y20 Z0.3 F5000.0
	G1 X0.1 Y200.0 Z0.3 F1500.0 E15
	G1 X0.4 Y200.0 Z0.3 F5000.0
	G1 X0.4 Y20 Z0.3 F1500.0 E30
	G92 E0
	G1 Z2.0 F3000
	G1 X5 Y20 Z0.3 F5000.0

[gcode_macro PRINT_END]
gcode = 
	END_PRINT

[gcode_macro END_PRINT]
gcode = 
	
	
	RESPOND MSG="Print Finished"
	G91
	G1 E-.5 Z0.2 F2400
	G1 X5 Y5 F6000
	G1 Z10
	G90
	SFS_DISABLE
	
	G1 X0 Y220 F6000
	M106 S0
	M104 S0
	M140 S0
	
	M84 X Y E

[gcode_macro SET_ACTIVE_SPOOL]
gcode = 
	{% if params.ID %}
	{% set id = params.ID|int %}
	{action_call_remote_method(
	"spoolman_set_active_spool",
	spool_id=id
	)}
	{% else %}
	{action_respond_info("Parameter 'ID' is required")}
	{% endif %}

[gcode_macro CLEAR_ACTIVE_SPOOL]
gcode = 
	{action_call_remote_method(
	"spoolman_set_active_spool",
	spool_id=None
	)}

[gcode_macro G29]
gcode = 
	G28
	BED_MESH_CALIBRATE
	G0 X0 Y0 Z10 F6000
	BED_MESH_PROFILE save=default

[gcode_macro M125]
gcode = 
	SAVE_GCODE_STATE NAME=parking
	M117 Parking toolhead
	G91
	G1 Z10 F600
	G90
	G1 X5 Y225 F4000
	RESTORE_GCODE_STATE NAME=parking

[gcode_macro Load_Filament]
gcode = 
	SAVE_GCODE_STATE NAME=loading_filament
	M117 Loading Filament
	M83
	G92 E0.0
	G91
	G1 E50 F200
	G92 E50
	RESTORE_GCODE_STATE NAME=loading_filament

[gcode_macro Unload_Filament]
gcode = 
	SAVE_GCODE_STATE NAME=unloading_filament
	M117 Unloading Filament
	G91
	G1 E5 F100
	G92 E0.0
	G1 E-50 F5000
	G92 E-50
	RESTORE_GCODE_STATE NAME=unloading_filament

[gcode_macro Filament_Change]
gcode = 
	
	SAVE_GCODE_STATE NAME=filament_change
	
	Unload_Filament
	
	RESPOND TYPE=command MSG="action:prompt_begin Question"
	RESPOND TYPE=command MSG="action:prompt_text Please insert new filament and confirm"
	RESPOND TYPE=command MSG="action:prompt_footer_button CONFIRM|Load_Filament|RESPOND TYPE=command MSG=action:prompt_end"
	RESPOND TYPE=command MSG="action:prompt_footer_button CANCEL|RESPOND TYPE=command MSG=action:prompt_end"
	RESPOND TYPE=command MSG="action:prompt_show"
	
	RESTORE_GCODE_STATE NAME=filament_change

[gcode_macro Calibrate_Hotend_PID]
gcode = 
	PID_CALIBRATE HEATER=extruder TARGET=200

[gcode_macro Calibrate_Bed_PID]
gcode = 
	PID_CALIBRATE HEATER=heater_bed TARGET=60

[gcode_macro Calibrate_Zoffset]
gcode = 
	PROBE_CALIBRATE

[gcode_macro Tram_bed]
gcode = 
	SCREWS_TILT_CALCULATE

[gcode_macro TEST_SPEED]
description = Test for max speed and acceleration parameters for the printer. Procedure: Home -> ReadPositionFromMCU -> MovesToolhead@Vel&Accel -> Home -> ReadPositionfromMCU
gcode = 
	
	{% set speed  = params.SPEED|default(printer.configfile.settings.printer.max_velocity)|int %}
	
	{% set iterations = params.ITERATIONS|default(5)|int %}
	
	{% set accel  = params.ACCEL|default(printer.configfile.settings.printer.max_accel)|int %}
	
	{% set min_cruise_ratio = params.MIN_CRUISE_RATIO|default(0.5)|float %}
	
	{% set bound = params.BOUND|default(20)|int %}
	
	{% set smallpatternsize = SMALLPATTERNSIZE|default(20)|int %}
	
	
	
	{% set x_min = printer.toolhead.axis_minimum.x + bound %}
	{% set x_max = printer.toolhead.axis_maximum.x - bound %}
	{% set y_min = printer.toolhead.axis_minimum.y + bound %}
	{% set y_max = printer.toolhead.axis_maximum.y - bound %}
	
	
	
	{% set x_center = (printer.toolhead.axis_minimum.x|float + printer.toolhead.axis_maximum.x|float ) / 2 %}
	{% set y_center = (printer.toolhead.axis_minimum.y|float + printer.toolhead.axis_maximum.y|float ) / 2 %}
	
	
	{% set x_center_min = x_center - (smallpatternsize/2) %}
	{% set x_center_max = x_center + (smallpatternsize/2) %}
	{% set y_center_min = y_center - (smallpatternsize/2) %}
	{% set y_center_max = y_center + (smallpatternsize/2) %}
	
	
	SAVE_GCODE_STATE NAME=TEST_SPEED
	
	
	{ action_respond_info("TEST_SPEED: starting %d iterations at speed %d, accel %d" % (iterations, speed, accel)) }
	
	
	M400
	G28
	
	{% if printer.configfile.settings.quad_gantry_level %}
	{% if printer.quad_gantry_level.applied == False %}
	QUAD_GANTRY_LEVEL
	G28 Z
	{% endif %}
	{% endif %}
	
	G90
	G1 X{printer.toolhead.axis_maximum.x-50} Y{printer.toolhead.axis_maximum.y-50} F{30*60}
	M400
	G28 X Y
	G0 X{printer.toolhead.axis_maximum.x-1} Y{printer.toolhead.axis_maximum.y-1} F{30*60}
	G4 P1000
	GET_POSITION
	
	
	G0 X{x_min} Y{y_min} Z{bound + 10} F{speed*60}
	
	
	{% if printer.configfile.settings.printer.minimum_cruise_ratio is defined %}
	SET_VELOCITY_LIMIT VELOCITY={speed} ACCEL={accel} MINIMUM_CRUISE_RATIO={min_cruise_ratio}
	{% else %}
	SET_VELOCITY_LIMIT VELOCITY={speed} ACCEL={accel} ACCEL_TO_DECEL={accel / 2}
	{% endif %}
	
	{% for i in range(iterations) %}
	
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_max} Y{y_max} F{speed*60}
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	G0 X{x_min} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	
	
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_min} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	
	
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_max} Y{y_center_max} F{speed*60}
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	G0 X{x_center_min} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	
	
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_min} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	{% endfor %}
	
	
	{% if printer.configfile.settings.printer.minimum_cruise_ratio is defined %}
	SET_VELOCITY_LIMIT VELOCITY={printer.configfile.settings.printer.max_velocity} ACCEL={printer.configfile.settings.printer.max_accel} MINIMUM_CRUISE_RATIO={printer.configfile.settings.printer.minimum_cruise_ratio}
	{% else %}
	SET_VELOCITY_LIMIT VELOCITY={printer.configfile.settings.printer.max_velocity} ACCEL={printer.configfile.settings.printer.max_accel} ACCEL_TO_DECEL={printer.configfile.settings.printer.max_accel_to_decel}
	{% endif %}
	
	
	M400
	G28
	
	G90
	G0 X{printer.toolhead.axis_maximum.x-1} Y{printer.toolhead.axis_maximum.y-1} F{30*60}
	G4 P1000
	GET_POSITION
	
	
	RESTORE_GCODE_STATE NAME=TEST_SPEED

[gcode_macro GET_TIMELAPSE_SETUP]
description = Print the Timelapse setup
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% set output_txt = ["Timelapse Setup:"] %}
	{% set _dummy = output_txt.append("enable: %s" % tl.enable) %}
	{% set _dummy = output_txt.append("park: %s" % tl.park.enable) %}
	{% if tl.park.enable %}
	{% set _dummy = output_txt.append("park position: %s time: %s s" % (tl.park.pos, tl.park.time)) %}
	{% set _dummy = output_txt.append("park cord x:%s y:%s dz:%s" % (tl.park.coord.x, tl.park.coord.y, tl.park.coord.dz)) %}
	{% set _dummy = output_txt.append("travel speed: %s mm/s" % tl.speed.travel) %}
	{% endif %}
	{% set _dummy = output_txt.append("fw_retract: %s" % tl.extruder.fw_retract) %}
	{% if not tl.extruder.fw_retract %}
	{% set _dummy = output_txt.append("retract: %s mm speed: %s mm/s" % (tl.extruder.retract, tl.speed.retract)) %}
	{% set _dummy = output_txt.append("extrude: %s mm speed: %s mm/s" % (tl.extruder.extrude, tl.speed.extrude)) %}
	{% endif %}
	{% set _dummy = output_txt.append("verbose: %s" % tl.verbose) %}
	{action_respond_info(output_txt|join("\n"))}

[gcode_macro _SET_TIMELAPSE_SETUP]
description = Set user parameters for timelapse
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	
	{% set min = printer.toolhead.axis_minimum %}
	{% set max = printer.toolhead.axis_maximum %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	{% set park = {'min'   : {'x': (min.x / 1.42)|round(3) if round_bed else min.x|round(3),
	'y': (min.y / 1.42)|round(3) if round_bed else min.y|round(3)},
	'max'   : {'x': (max.x / 1.42)|round(3) if round_bed else max.x|round(3),
	'y': (max.y / 1.42)|round(3) if round_bed else max.y|round(3)},
	'center': {'x': (max.x-(max.x-min.x)/2)|round(3),
	'y': (max.y-(max.y-min.y)/2)|round(3)}} %}
	
	{% if params.ENABLE %}
	{% if params.ENABLE|lower is in ['true', 'false'] %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=enable VALUE={True if params.ENABLE|lower == 'true' else False}
	{% else %}
	{action_raise_error("ENABLE=%s not supported. Allowed values are [True, False]" % params.ENABLE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.VERBOSE %}
	{% if params.VERBOSE|lower is in ['true', 'false'] %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=verbose VALUE={True if params.VERBOSE|lower == 'true' else False}
	{% else %}
	{action_raise_error("VERBOSE=%s not supported. Allowed values are [True, False]" % params.VERBOSE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_X %}
	{% if params.CUSTOM_POS_X|float >= min.x and params.CUSTOM_POS_X|float <= max.x %}
	{% set _dummy = tl.park.custom.update({'x':params.CUSTOM_POS_X|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_X=%s must be within [%s - %s]" % (params.CUSTOM_POS_X, min.x, max.x))}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_Y %}
	{% if params.CUSTOM_POS_Y|float >= min.y and params.CUSTOM_POS_Y|float <= max.y %}
	{% set _dummy = tl.park.custom.update({'y':params.CUSTOM_POS_Y|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_Y=%s must be within [%s - %s]" % (params.CUSTOM_POS_Y, min.y, max.y))}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_DZ %}
	{% if params.CUSTOM_POS_DZ|float >= min.z and params.CUSTOM_POS_DZ|float <= max.z %}
	{% set _dummy = tl.park.custom.update({'dz':params.CUSTOM_POS_DZ|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_DZ=%s must be within [%s - %s]" % (params.CUSTOM_POS_DZ, min.z, max.z))}
	{% endif %}
	{% endif %}
	{% if params.PARK_ENABLE %}
	{% if params.PARK_ENABLE|lower is in ['true', 'false'] %}
	{% set _dummy = tl.park.update({'enable':True if params.PARK_ENABLE|lower == 'true' else False}) %}
	{% else %}
	{action_raise_error("PARK_ENABLE=%s not supported. Allowed values are [True, False]" % params.PARK_ENABLE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.PARK_POS %}
	{% if params.PARK_POS|lower is in ['center','front_left','front_right','back_left','back_right','custom','x_only','y_only'] %}
	{% set dic = {'center'      : {'x': park.center.x   , 'y': park.center.y   , 'dz': 1                },
	'front_left'  : {'x': park.min.x      , 'y': park.min.y      , 'dz': 0                },
	'front_right' : {'x': park.max.x      , 'y': park.min.y      , 'dz': 0                },
	'back_left'   : {'x': park.min.x      , 'y': park.max.y      , 'dz': 0                },
	'back_right'  : {'x': park.max.x      , 'y': park.max.y      , 'dz': 0                },
	'custom'      : {'x': tl.park.custom.x, 'y': tl.park.custom.y, 'dz': tl.park.custom.dz},
	'x_only'      : {'x': tl.park.custom.x, 'y': 'none'          , 'dz': tl.park.custom.dz},
	'y_only'      : {'x': 'none'          , 'y': tl.park.custom.y, 'dz': tl.park.custom.dz}} %}
	{% set _dummy = tl.park.update({'pos':params.PARK_POS|lower}) %}
	{% set _dummy = tl.park.update({'coord':dic[tl.park.pos]}) %}
	{% else %}
	{action_raise_error("PARK_POS=%s not supported. Allowed values are [CENTER, FRONT_LEFT, FRONT_RIGHT, BACK_LEFT, BACK_RIGHT, CUSTOM, X_ONLY, Y_ONLY]"
	% params.PARK_POS|upper)}
	{% endif %}
	{% endif %}
	{% if params.PARK_TIME %}
	{% if params.PARK_TIME|float >= 0.0 %}
	{% set _dummy = tl.park.update({'time':params.PARK_TIME|float|round(3)}) %}
	{% else %}
	{action_raise_error("PARK_TIME=%s must be a positive number" % params.PARK_TIME)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=park VALUE="{tl.park}"
	{% if params.TRAVEL_SPEED %}
	{% if params.TRAVEL_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'travel':params.TRAVEL_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("TRAVEL_SPEED=%s must be larger than 0" % params.TRAVEL_SPEED)}
	{% endif %}
	{% endif %}
	{% if params.RETRACT_SPEED %}
	{% if params.RETRACT_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'retract':params.RETRACT_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("RETRACT_SPEED=%s must be larger than 0" % params.RETRACT_SPEED)}
	{% endif %}
	{% endif %}
	{% if params.EXTRUDE_SPEED %}
	{% if params.EXTRUDE_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'extrude':params.EXTRUDE_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("EXTRUDE_SPEED=%s must be larger than 0" % params.EXTRUDE_SPEED)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=speed VALUE="{tl.speed}"
	{% if params.EXTRUDE_DISTANCE %}
	{% if params.EXTRUDE_DISTANCE|float >= 0.0 %}
	{% set _dummy = tl.extruder.update({'extrude':params.EXTRUDE_DISTANCE|float|round(3)}) %}
	{% else %}
	{action_raise_error("EXTRUDE_DISTANCE=%s must be specified as positiv number" % params.EXTRUDE_DISTANCE)}
	{% endif %}
	{% endif %}
	{% if params.RETRACT_DISTANCE %}
	{% if params.RETRACT_DISTANCE|float >= 0.0 %}
	{% set _dummy = tl.extruder.update({'retract':params.RETRACT_DISTANCE|float|round(3)}) %}
	{% else %}
	{action_raise_error("RETRACT_DISTANCE=%s must be specified as positiv number" % params.RETRACT_DISTANCE)}
	{% endif %}
	{% endif %}
	{% if params.FW_RETRACT %}
	{% if params.FW_RETRACT|lower is in ['true', 'false'] %}
	{% if 'firmware_retraction' in printer.configfile.settings %}
	{% set _dummy = tl.extruder.update({'fw_retract': True if params.FW_RETRACT|lower == 'true' else False}) %}
	{% else %}
	{% set _dummy = tl.extruder.update({'fw_retract':False}) %}
	{% if params.FW_RETRACT|capitalize == 'True' %}
	{action_raise_error("[firmware_retraction] not defined in printer.cfg. Can not enable fw_retract")}
	{% endif %}
	{% endif %}
	{% else %}
	{action_raise_error("FW_RETRACT=%s not supported. Allowed values are [True, False]" % params.FW_RETRACT|capitalize)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=extruder VALUE="{tl.extruder}"
	{% if printer.configfile.settings['gcode_macro pause'] is defined %}
	{% set _dummy = tl.macro.update({'pause': printer.configfile.settings['gcode_macro pause'].rename_existing}) %}
	{% endif %}
	{% if printer.configfile.settings['gcode_macro resume'] is defined %}
	{% set _dummy = tl.macro.update({'resume': printer.configfile.settings['gcode_macro resume'].rename_existing}) %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=macro VALUE="{tl.macro}"

[gcode_macro TIMELAPSE_TAKE_FRAME]
description = Take Timelapse shoot
variable_enable = False
variable_takingframe = False
variable_park = {'enable': False,
	'pos'   : 'center',
	'time'  : 0.1,
	'custom': {'x': 0, 'y': 0, 'dz': 0},
	'coord' : {'x': 0, 'y': 0, 'dz': 0}}
variable_extruder = {'fw_retract': False,
	'retract': 1.0,
	'extrude': 1.0}
variable_speed = {'travel': 100,
	'retract': 15,
	'extrude': 15}
variable_verbose = True
variable_check_time = 0.5
variable_restore = {'absolute': {'coordinates': True, 'extrude': True}, 'speed': 1500, 'e':0, 'factor': {'speed': 1.0, 'extrude': 1.0}}
variable_macro = {'pause': 'PAUSE', 'resume': 'RESUME'}
variable_is_paused = False
gcode = 
	{% set hyperlapse = True if params.HYPERLAPSE and params.HYPERLAPSE|lower =='true' else False %}
	{% if enable %}
	{% if (hyperlapse and printer['gcode_macro HYPERLAPSE'].run) or
	(not hyperlapse and not printer['gcode_macro HYPERLAPSE'].run) %}
	{% if park.enable %}
	{% set pos = {'x': 'X' + park.coord.x|string if park.pos != 'y_only' else '',
	'y': 'Y' + park.coord.y|string if park.pos != 'x_only' else '',
	'z': 'Z'+ [printer.gcode_move.gcode_position.z + park.coord.dz, printer.toolhead.axis_maximum.z]|min|string} %}
	{% set restore = {'absolute': {'coordinates': printer.gcode_move.absolute_coordinates,
	'extrude'    : printer.gcode_move.absolute_extrude},
	'speed'   : printer.gcode_move.speed,
	'e'       : printer.gcode_move.gcode_position.e,
	'factor'  : {'speed'  : printer.gcode_move.speed_factor,
	'extrude': printer.gcode_move.extrude_factor}} %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=restore VALUE="{restore}"
	{% if not printer[printer.toolhead.extruder].can_extrude %}
	{% if verbose %}{action_respond_info("Timelapse: Warning, minimum extruder temperature not reached!")}{% endif %}
	{% else %}
	{% if extruder.fw_retract %}
	G10
	{% else %}
	M83
	G0 E-{extruder.retract} F{speed.retract * 60}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=is_paused VALUE=True
	{macro.pause}
	SET_GCODE_OFFSET X=0 Y=0
	G90
	{% if "xyz" not in printer.toolhead.homed_axes %}
	{% if verbose %}{action_respond_info("Timelapse: Warning, axis not homed yet!")}{% endif %}
	{% else %}
	G0 {pos.x} {pos.y} {pos.z} F{speed.travel * 60}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=takingframe VALUE=True
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_TAKE_FRAME DURATION={check_time}
	M400
	{% endif %}
	_TIMELAPSE_NEW_FRAME HYPERLAPSE={hyperlapse}
	{% endif %}
	{% else %}
	{% if verbose %}{action_respond_info("Timelapse: disabled, take frame ignored")}{% endif %}
	{% endif %}

[gcode_macro _TIMELAPSE_NEW_FRAME]
description = action call for timelapse shoot. must be a seperate macro
gcode = 
	{action_call_remote_method("timelapse_newframe",
	macropark=printer['gcode_macro TIMELAPSE_TAKE_FRAME'].park,
	hyperlapse=params.HYPERLAPSE)}

[delayed_gcode _WAIT_TIMELAPSE_TAKE_FRAME]
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% set factor = {'speed': printer.gcode_move.speed_factor, 'extrude': printer.gcode_move.extrude_factor} %}
	{% if tl.takingframe %}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_TAKE_FRAME DURATION={tl.check_time}
	{% else %}
	{tl.macro.resume} VELOCITY={tl.speed.travel}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=is_paused VALUE=False
	{% if not printer[printer.toolhead.extruder].can_extrude %}
	{action_respond_info("Timelapse: Warning minimum extruder temperature not reached!")}
	{% else %}
	{% if tl.extruder.fw_retract %}
	G11
	{% else %}
	G0 E{tl.extruder.extrude} F{tl.speed.extrude * 60}
	G0 F{tl.restore.speed}
	{% if tl.restore.absolute.extrude %}
	M82
	G92 E{tl.restore.e}
	{% endif %}
	{% endif %}
	{% endif %}
	{% if tl.restore.factor.speed   != factor.speed   %} M220 S{(factor.speed*100)|round(0)}   {% endif %}
	{% if tl.restore.factor.extrude != factor.extrude %} M221 S{(factor.extrude*100)|round(0)} {% endif %}
	{% if not tl.restore.absolute.coordinates %} G91 {% endif %}
	{% endif %}

[gcode_macro HYPERLAPSE]
description = Start/Stop a hyperlapse recording
variable_cycle = 0
variable_run = False
gcode = 
	{% set cycle = params.CYCLE|default(30)|int %}
	{% if params.ACTION and params.ACTION|lower == 'start' %}
	{action_respond_info("Hyperlapse: frames started (Cycle %d sec)" % cycle)}
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=run VALUE=True
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=cycle VALUE={cycle}
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION={cycle}
	TIMELAPSE_TAKE_FRAME HYPERLAPSE=True
	{% elif params.ACTION and params.ACTION|lower == 'stop' %}
	{% if run %}{action_respond_info("Hyperlapse: frames stopped")}{% endif %}
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=run VALUE=False
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION=0
	{% else %}
	{action_raise_error("Hyperlapse: No valid input parameter
	Use:
	- HYPERLAPSE ACTION=START [CYCLE=time]
	- HYPERLAPSE ACTION=STOP")}
	{% endif %}

[delayed_gcode _HYPERLAPSE_LOOP]
gcode = 
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION={printer["gcode_macro HYPERLAPSE"].cycle}
	TIMELAPSE_TAKE_FRAME HYPERLAPSE=True

[gcode_macro TIMELAPSE_RENDER]
description = Render Timelapse video and wait for the result
variable_render = False
variable_run_identifier = 0
gcode = 
	{action_respond_info("Timelapse: Rendering started")}
	{action_call_remote_method("timelapse_render", byrendermacro="True")}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_RENDER VARIABLE=render VALUE=True
	{printer.configfile.settings['gcode_macro pause'].rename_existing}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_RENDER DURATION=0.5

[delayed_gcode _WAIT_TIMELAPSE_RENDER]
gcode = 
	{% set ri = printer['gcode_macro TIMELAPSE_RENDER'].run_identifier % 4 %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_RENDER VARIABLE=run_identifier VALUE={ri + 1}
	{% if printer['gcode_macro TIMELAPSE_RENDER'].render %}
	M117 Rendering {['-','\\','|','/'][ri]}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_RENDER DURATION=0.5
	{% else %}
	{action_respond_info("Timelapse: Rendering finished")}
	M117
	{printer.configfile.settings['gcode_macro resume'].rename_existing}
	{% endif %}

[gcode_macro TEST_STREAM_DELAY]
description = Helper macro to find stream and park delay
gcode = 
	{% set min = printer.toolhead.axis_minimum %}
	{% set max = printer.toolhead.axis_maximum %}
	{% set act = printer.toolhead.position %}
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% if act.z > 5.0 %}
	G0 X{min.x + 5.0} F{tl.speed.travel|int * 60}
	G0 X{(max.x-min.x)/2}
	G4 P{tl.park.time|float * 1000}
	_TIMELAPSE_NEW_FRAME HYPERLAPSE=FALSE
	G0 X{max.x - 5.0}
	{% else %}
	{action_raise_error("Toolhead z %.3f to low. Please place head above z = 5.0" % act.z)}
	{% endif %}

[gcode_macro _OBICO_LAYER_CHANGE]
description = Run a scan across the current print area
variable_first_layer_scan_retract_length = 6
variable_first_layer_scan_retract_speed = 15
variable_first_layer_scan_cooldown_temp = 170
variable_first_layer_scan_resume_speed = 50
variable_first_layer_scan_enabled = True
variable_first_layer_scan_stepover = 10
variable_first_layer_scan_speed = 10
variable_first_layer_scan_zhop = 4
variable_first_layer_scan_zhop_speed = 15
variable_verbose = False
variable_current_layer = -1
variable_first_layer_scanning = False
variable_wait = {'resume': "RESUME", 'absolute_coordinates': True, 'absolute_extrude': True, 'e': 0.0, 'previous_temp': 0}
gcode = 
	
	{% set pause_macro  = "PAUSE"  if printer.configfile.settings['gcode_macro pause']  is not defined
	else printer.configfile.settings['gcode_macro pause'].rename_existing %}
	{% set resume_macro = "RESUME" if printer.configfile.settings['gcode_macro resume'] is not defined
	else printer.configfile.settings['gcode_macro resume'].rename_existing %}
	
	{% set current_layer_default = printer.print_stats.info.current_layer if printer.print_stats.info.current_layer is not none else -1 %}
	{% set current_layer = params.CURRENT_LAYER|default(current_layer_default)|int %}
	
	{% set polygon_points = printer.exclude_object.objects|map(attribute='polygon')|sum(start=[]) if printer.exclude_object is defined else [] %}
	{% set min_x = params.MINX|default(polygon_points|map(attribute=0)|min|default(printer.toolhead.axis_minimum.x))|float %}
	{% set min_y = params.MINY|default(polygon_points|map(attribute=1)|min|default(printer.toolhead.axis_minimum.y))|float %}
	{% set max_x = params.MAXX|default(polygon_points|map(attribute=0)|max|default(printer.toolhead.axis_maximum.x))|float %}
	{% set max_y = params.MAXY|default(polygon_points|map(attribute=1)|max|default(printer.toolhead.axis_maximum.y))|float %}
	
	{% set stepoverCount = ((max_y - min_y) / first_layer_scan_stepover|float)|round(method='ceil')|int %}
	
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Layer %d" % (current_layer)}' {% endif %}
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=current_layer VALUE={current_layer}
	
	{% if first_layer_scan_enabled and current_layer == 2 %}
	
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=first_layer_scanning VALUE=True
	
	
	{% set wait_dic = {'resume'              : resume_macro,
	'absolute_coordinates': printer.gcode_move.absolute_coordinates,
	'absolute_extrude'    : printer.gcode_move.absolute_extrude,
	'e'                   : printer.gcode_move.gcode_position.e,
	'previous_temp'       : printer.extruder.target} %}
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=wait VALUE="{wait_dic}"
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Prepare scanning" {% endif %}
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Scan Coordinates: Min:[%.3f:%.3f] Max:[%.3f:%.3f]" % (min_x,min_y,max_x,max_y)}' {% endif %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Retract %.1fmm filament" % first_layer_scan_retract_length|abs}' {% endif %}
	M83
	G0 E-{first_layer_scan_retract_length|abs} F{first_layer_scan_retract_speed|float * 60}
	{% endif %}
	G91
	G0 Z{first_layer_scan_zhop|abs} F{first_layer_scan_zhop_speed|float * 60}
	
	
	M106 S255
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Fan on and lowering temperature to %.1f" % first_layer_scan_cooldown_temp}' {% endif %}
	M104 S{first_layer_scan_cooldown_temp}
	M109 S{first_layer_scan_cooldown_temp}
	
	{pause_macro}
	
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Start scanning" {% endif %}
	
	UPDATE_DELAYED_GCODE ID=_WAIT_OBICO_LAYER_CHANGE DURATION=1.0
	G90
	G0 X{min_x} Y{min_y} F{first_layer_scan_resume_speed|float * 60}
	{% for ystep in range(stepoverCount) %}
	G0 Y{min_y + first_layer_scan_stepover|float * ystep} F{first_layer_scan_speed|float * 60}
	G0 X{max_x if ystep % 2 == 0 else min_x}              F{first_layer_scan_speed|float * 60}
	{% endfor %}
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Finish scanning" {% endif %}
	
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=first_layer_scanning VALUE=False
	
	{% endif %}

[delayed_gcode _WAIT_OBICO_LAYER_CHANGE]
gcode = 
	{% set lc_macro = printer['gcode_macro _OBICO_LAYER_CHANGE'] %}
	{% if lc_macro.first_layer_scanning %}
	
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Waiting for first layer scan..." {% endif %}
	UPDATE_DELAYED_GCODE ID=_WAIT_OBICO_LAYER_CHANGE DURATION=1.0
	{% else %}
	
	M107
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Fan off and resume print" {% endif %}
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Call %s VELOCITY=%.1f" % (lc_macro.wait.resume, lc_macro.first_layer_scan_resume_speed)}' {% endif %}
	{lc_macro.wait.resume} VELOCITY={lc_macro.first_layer_scan_resume_speed}
	G91
	G0 Z-{lc_macro.first_layer_scan_zhop|abs} F{lc_macro.first_layer_scan_zhop_speed|float * 60}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% set first_layer_scan_unretract_length = lc_macro.first_layer_scan_retract_length + 0.5 %}
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Extrude %.1fmm filament" % first_layer_scan_unretract_length|abs}' {% endif %}
	M83
	G0 E{first_layer_scan_unretract_length|abs} F{lc_macro.first_layer_scan_retract_speed|float * 60}
	{% endif %}
	
	
	M104 S{lc_macro.wait.previous_temp}
	M109 S{lc_macro.wait.previous_temp}
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Heating back up to previous temperature"}' {% endif %}
	
	
	{% if lc_macro.wait.absolute_coordinates %} G90 {% endif %}
	{% if lc_macro.wait.absolute_extrude %}
	M82
	G92 E{lc_macro.wait.e}
	{% endif %}
	{% endif %}

[gcode_macro OBICO_LINK_STATUS]
description = Link to Obico server
variable_one_time_passcode = ''
variable_one_time_passlink = ''
variable_is_linked = False
gcode = 
	{action_respond_info('Obico one_time_passcode: {}'.format(one_time_passcode))}
	{action_respond_info('Obico one_time_passlink: {}'.format(one_time_passlink))}
	{action_respond_info('Obico is_linked: {}'.format(is_linked))}
	{% if not is_linked and one_time_passcode != '' %}
	M117 Code: {one_time_passcode}
	{% else %}
	M117 Obico linked
	{% endif %}

[gcode_macro _OBICO_RELINK]
description = Re-link to Obico server
gcode = 
	{action_respond_info('WARNING: Re-link to Obico server')}
	{action_call_remote_method("obico_remote_event", event_name='relink_obico', message='')}
	{action_respond_info('WARNING: relink_obico requested')}

[exclude_object]

[mcu]
serial = /dev/serial/by-id/usb-1a86_USB_Serial-if00-port0
restart_method = command

[temperature_sensor raspberry_pi]
sensor_type = temperature_host
min_temp = 10
max_temp = 100

[temperature_sensor mcu_temp]
sensor_type = temperature_mcu
min_temp = 0
max_temp = 100

[printer]
kinematics = cartesian
max_velocity = 200
max_accel = 4000
max_z_velocity = 10
max_z_accel = 100
minimum_cruise_ratio = 0.5
square_corner_velocity = 5

[stepper_x]
step_pin = PB9
dir_pin = PC2
enable_pin = !PC3
microsteps = 16
rotation_distance = 40
endstop_pin = ^PA5
position_endstop = 0
position_max = 230
homing_speed = 50

[stepper_y]
step_pin = PB7
dir_pin = PB8
enable_pin = !PC3
microsteps = 16
rotation_distance = 40
endstop_pin = ^PA6
position_endstop = 0
position_max = 231
homing_speed = 50

[stepper_z]
step_pin = PB5
dir_pin = !PB6
enable_pin = !PC3
microsteps = 16
rotation_distance = 8
endstop_pin = probe:z_virtual_endstop
position_max = 250
position_min = -4
homing_speed = 4
second_homing_speed = 1
homing_retract_dist = 2.0

[fan]
pin = PA0

[extruder]
max_extrude_only_distance = 100.0
step_pin = PB3
dir_pin = PB4
enable_pin = !PC3
microsteps = 16
gear_ratio = 42:12
rotation_distance = 26.359
nozzle_diameter = 0.400
filament_diameter = 1.750
heater_pin = PA1
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PC5
min_temp = 0
max_temp = 300
min_extrude_temp = 170
pressure_advance = .0369
pressure_advance_smooth_time = 0.04
control = pid
pid_kp = 19.195
pid_ki = 1.000
pid_kd = 92.135

[firmware_retraction]
retract_length = 0.3
retract_speed = 20

[idle_timeout]
gcode = 
	{% if printer.pause_resume.is_paused %}
	M118 Idle timeout while paused, turning off hotend
	SET_HEATER_TEMPERATURE HEATER=extruder TARGET=0
	{% else %}
	M118 Idle timeout
	TURN_OFF_HEATERS
	M84
	{% endif %}
timeout = 1800

[heater_bed]
heater_pin = PA2
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PC4
min_temp = 0
max_temp = 130
control = pid
pid_kp = 68.601
pid_ki = 1.185
pid_kd = 993.000

[bltouch]
sensor_pin = ^PB1
control_pin = PB0
x_offset = -31.8
y_offset = -40.5
speed = 35
samples = 2
samples_result = median
samples_tolerance = 0.05
samples_tolerance_retries = 2
sample_retract_dist = 5.0
probe_with_touch_mode = true
stow_on_each_sample = false
z_offset = 2.049

[safe_z_home]
home_xy_position = 147, 154
speed = 75
z_hop = 10
z_hop_speed = 5
move_to_previous = false

[bed_screws]
screw1 = 30,51
screw1_name = "FL"
screw2 = 200,51
screw2_name = "FR"
screw3 = 200,195
screw3_name = "RR"
screw4 = 30,195
screw4_name = "RL"

[screws_tilt_adjust]
screw1 = 67, 67
screw1_name = front left screw
screw2 = 230, 67
screw2_name = front right screw
screw3 = 230, 230
screw3_name = rear right screw
screw4 = 67.60, 230
screw4_name = rear left screw
horizontal_move_z = 10
speed = 200
screw_thread = CW-M4

[bed_mesh]
speed = 120
mesh_min = 10,11
mesh_max = 195,182
probe_count = 3,3
algorithm = bicubic
fade_start = 1
fade_end = 10
fade_target = 0

[filament_motion_sensor SFS_T0]
detection_length = 150.00
extruder = extruder
switch_pin = PA4
pause_on_runout = True
event_delay = 3.0
pause_delay = 0.5
runout_gcode = 
	M117 Runout Detected!

[delayed_gcode DISABLEFILAMENTSENSOR]
initial_duration = 1
gcode = 
	SET_FILAMENT_SENSOR SENSOR=SFS_T0 ENABLE=0

[gcode_macro SFS_ENABLE]
description = Enable smart filament sensor
gcode = 
	M117 ENABLING the Smart Filament Sensor
	G92 E0
	SET_FILAMENT_SENSOR SENSOR=SFS_T0 ENABLE=1

[gcode_macro SFS_DISABLE]
description = Disable smart filament sensor
gcode = 
	M117 DISABLING the Smart Filament Sensor
	G92 E0
	SET_FILAMENT_SENSOR SENSOR=SFS_T0 ENABLE=0

[gcode_macro FILAMENT_RUNOUT]
gcode = 
	M117 Runout Detected!
	M300 S1 P10
	M600
	M300 S1 P10

[gcode_macro M300]
gcode = 
	{% set S = params.S|default(1000)|int %}
	{% set P = params.P|default(100)|int %}
	SET_PIN PIN=BEEPER VALUE=0.5 CYCLE_TIME={ 1.0/S if S > 0 else 1 }
	G4 P{P}
	SET_PIN PIN=BEEPER VALUE=0
	[gcode_macro M600]
	gcode:
	{% set X = params.X|default(25)|float %}
	{% set Y = params.Y|default(25)|float %}
	{% set Z = params.Z|default(10)|float %}
	SAVE_GCODE_STATE NAME=M600_state
	PAUSE
	G91
	G1 E-.8 F2700
	G1 Z{Z}
	G90
	G1 X{X} Y{Y} F3000
	G91
	G1 E-15 F1000
	RESTORE_GCODE_STATE NAME=M600_state

[gcode_arcs]
resolution = 1.0

[input_shaper]
shaper_freq_x = 73.5
shaper_type_x = ei
shaper_freq_y = 76.9
shaper_type_y = mzv
=======================
bed_mesh: bicubic interpolation with a probe_count of less than 4 points detected.  Forcing lagrange interpolation. Configured Probe Count: 3, 3
Extruder max_extrude_ratio=0.266081
mcu 'mcu': Starting serial connect
mcu 'mcu': got {'oid': 12, 'next_clock': 1304407808, 'value': 31556, '#name': 'analog_in_state', '#sent_time': 22.618114671, '#receive_time': 22.622889875000002}
mcu 'mcu': got {'oid': 17, 'next_clock': 1308007808, 'value': 31506, '#name': 'analog_in_state', '#sent_time': 22.618114671, '#receive_time': 22.675583208000003}
mcu 'mcu': got {'oid': 10, 'next_clock': 1324567808, 'value': 14014, '#name': 'analog_in_state', '#sent_time': 22.893795356000002, '#receive_time': 22.903085653}
mcu 'mcu': got {'oid': 12, 'next_clock': 1326007808, 'value': 31557, '#name': 'analog_in_state', '#sent_time': 22.893795356000002, '#receive_time': 22.922981245000003}
mcu 'mcu': got {'oid': 17, 'next_clock': 1329607808, 'value': 31505, '#name': 'analog_in_state', '#sent_time': 22.948440486000003, '#receive_time': 22.972971078}
Loaded MCU 'mcu' 119 commands (v0.12.0-286-g81de9a861 / gcc: (15:8-2019-q3-1+b1) 8.3.1 20190703 (release) [gcc-8-branch revision 273027] binutils: (2.35.2-2+14+b2) 2.35.2)
MCU 'mcu' config: ADC_MAX=4095 BUS_PINS_i2c1=PB6,PB7 BUS_PINS_i2c1a=PB8,PB9 BUS_PINS_i2c2=PB10,PB11 BUS_PINS_spi1=PA6,PA7,PA5 BUS_PINS_spi1a=PB4,PB5,PB3 BUS_PINS_spi2=PB14,PB15,PB13 BUS_PINS_spi3=PB4,PB5,PB3 CLOCK_FREQ=72000000 MCU=stm32f103xe PWM_MAX=255 RECEIVE_WINDOW=192 RESERVE_PINS_serial=PA10,PA9 SERIAL_BAUD=250000 STATS_SUMSQ_BASE=256 STEPPER_BOTH_EDGE=1
mcu_temperature 'mcu' nominal base=357.558140 slope=-767.441860
Configured MCU 'mcu' (1024 moves)
Starting heater checks for heater_bed
webhooks client 548011324848: New connection
bed_mesh: generated points
Index |  Tool Adjusted  |   Probe
  0   | (41.8, 51.5)    | (10.0, 11.0)
  1   | (134.3, 51.5)   | (102.5, 11.0)
  2   | (226.8, 51.5)   | (195.0, 11.0)
  3   | (226.8, 137.0)  | (195.0, 96.5)
  4   | (134.3, 137.0)  | (102.5, 96.5)
  5   | (41.8, 137.0)   | (10.0, 96.5)
  6   | (41.8, 222.5)   | (10.0, 182.0)
  7   | (134.3, 222.5)  | (102.5, 182.0)
  8   | (226.8, 222.5)  | (195.0, 182.0)
Starting heater checks for extruder
Stats 24.1: gcodein=0  mcu: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=1146 bytes_read=4690 bytes_retransmit=9 bytes_invalid=0 send_seq=116 receive_seq=116 retransmit_seq=2 srtt=0.003 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71999225  raspberry_pi: temp=54.0 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.51 cputime=1.854 memavail=1586384 print_time=110495.647 buffer_time=0.249 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
webhooks client 548011324848: Client info {'program': 'Moonraker', 'version': 'v0.9.3-3-gccfe32f'}
webhooks: registering remote method 'shutdown_machine' for connection id: 548011324848
webhooks: registering remote method 'reboot_machine' for connection id: 548011324848
webhooks: registering remote method 'pause_job_queue' for connection id: 548011324848
webhooks: registering remote method 'start_job_queue' for connection id: 548011324848
webhooks: registering remote method 'spoolman_set_active_spool' for connection id: 548011324848
Stats 25.1: gcodein=0  mcu: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=1152 bytes_read=4886 bytes_retransmit=9 bytes_invalid=0 send_seq=117 receive_seq=117 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71999637  raspberry_pi: temp=53.1 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.71 cputime=1.880 memavail=1583008 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 26.1: gcodein=0  mcu: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=1158 bytes_read=5037 bytes_retransmit=9 bytes_invalid=0 send_seq=118 receive_seq=118 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71999962  raspberry_pi: temp=53.6 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.71 cputime=1.910 memavail=1588000 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 27.1: gcodein=0  mcu: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=1164 bytes_read=5188 bytes_retransmit=9 bytes_invalid=0 send_seq=119 receive_seq=119 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71999847  raspberry_pi: temp=52.1 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.71 cputime=1.919 memavail=1584028 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 28.1: gcodein=0  mcu: mcu_awake=0.004 mcu_task_avg=0.000024 mcu_task_stddev=0.000012 bytes_write=1170 bytes_read=5399 bytes_retransmit=9 bytes_invalid=0 send_seq=120 receive_seq=120 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71999831  raspberry_pi: temp=52.6 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.71 cputime=1.929 memavail=1581724 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 29.1: gcodein=0  mcu: mcu_awake=0.004 mcu_task_avg=0.000024 mcu_task_stddev=0.000012 bytes_write=1176 bytes_read=5550 bytes_retransmit=9 bytes_invalid=0 send_seq=121 receive_seq=121 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000119  raspberry_pi: temp=51.6 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.71 cputime=1.938 memavail=1582572 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
webhooks: registering remote method 'obico_remote_event' for connection id: 548011324848
Stats 30.1: gcodein=0  mcu: mcu_awake=0.004 mcu_task_avg=0.000024 mcu_task_stddev=0.000012 bytes_write=1182 bytes_read=5701 bytes_retransmit=9 bytes_invalid=0 send_seq=122 receive_seq=122 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000259  raspberry_pi: temp=52.6 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.81 cputime=1.959 memavail=1581160 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 31.1: gcodein=0  mcu: mcu_awake=0.004 mcu_task_avg=0.000024 mcu_task_stddev=0.000012 bytes_write=1188 bytes_read=5897 bytes_retransmit=9 bytes_invalid=0 send_seq=123 receive_seq=123 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000204  raspberry_pi: temp=52.1 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.81 cputime=1.972 memavail=1578560 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 32.1: gcodein=0  mcu: mcu_awake=0.004 mcu_task_avg=0.000024 mcu_task_stddev=0.000012 bytes_write=1194 bytes_read=6048 bytes_retransmit=9 bytes_invalid=0 send_seq=124 receive_seq=124 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000111  raspberry_pi: temp=51.6 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.81 cputime=1.981 memavail=1580480 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 33.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1200 bytes_read=6213 bytes_retransmit=9 bytes_invalid=0 send_seq=125 receive_seq=125 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000095  raspberry_pi: temp=51.6 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.81 cputime=1.990 memavail=1568640 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 34.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1206 bytes_read=6409 bytes_retransmit=9 bytes_invalid=0 send_seq=126 receive_seq=126 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000071  raspberry_pi: temp=52.6 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.81 cputime=2.001 memavail=1561244 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 35.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1212 bytes_read=6560 bytes_retransmit=9 bytes_invalid=0 send_seq=127 receive_seq=127 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000062  raspberry_pi: temp=51.1 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.99 cputime=2.010 memavail=1560548 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 36.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1218 bytes_read=6711 bytes_retransmit=9 bytes_invalid=0 send_seq=128 receive_seq=128 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000077  raspberry_pi: temp=51.1 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.99 cputime=2.024 memavail=1560548 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 37.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1224 bytes_read=6907 bytes_retransmit=9 bytes_invalid=0 send_seq=129 receive_seq=129 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000067  raspberry_pi: temp=52.1 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.99 cputime=2.036 memavail=1556056 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 38.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1230 bytes_read=7072 bytes_retransmit=9 bytes_invalid=0 send_seq=130 receive_seq=130 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000058  raspberry_pi: temp=51.1 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.99 cputime=2.045 memavail=1556060 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 39.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1236 bytes_read=7223 bytes_retransmit=9 bytes_invalid=0 send_seq=131 receive_seq=131 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000057  raspberry_pi: temp=51.6 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.99 cputime=2.053 memavail=1556072 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 40.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1242 bytes_read=7419 bytes_retransmit=9 bytes_invalid=0 send_seq=132 receive_seq=132 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000059  raspberry_pi: temp=51.6 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=2.15 cputime=2.063 memavail=1555636 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 41.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1248 bytes_read=7570 bytes_retransmit=9 bytes_invalid=0 send_seq=133 receive_seq=133 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000065  raspberry_pi: temp=51.1 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.15 cputime=2.072 memavail=1555636 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 42.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1254 bytes_read=7721 bytes_retransmit=9 bytes_invalid=0 send_seq=134 receive_seq=134 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000083  raspberry_pi: temp=50.6 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.15 cputime=2.085 memavail=1555636 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 43.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1260 bytes_read=7931 bytes_retransmit=9 bytes_invalid=0 send_seq=135 receive_seq=135 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000097  raspberry_pi: temp=51.1 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=2.15 cputime=2.101 memavail=1555648 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 44.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1266 bytes_read=8082 bytes_retransmit=9 bytes_invalid=0 send_seq=136 receive_seq=136 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000122  raspberry_pi: temp=50.1 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.15 cputime=2.116 memavail=1555648 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 45.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1272 bytes_read=8248 bytes_retransmit=9 bytes_invalid=0 send_seq=137 receive_seq=137 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000134  raspberry_pi: temp=50.6 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.14 cputime=2.130 memavail=1555648 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 46.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1278 bytes_read=8429 bytes_retransmit=9 bytes_invalid=0 send_seq=138 receive_seq=138 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000140  raspberry_pi: temp=49.7 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=2.14 cputime=2.145 memavail=1555648 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 47.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1284 bytes_read=8580 bytes_retransmit=9 bytes_invalid=0 send_seq=139 receive_seq=139 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000146  raspberry_pi: temp=50.6 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.14 cputime=2.159 memavail=1555648 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 48.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1290 bytes_read=8760 bytes_retransmit=9 bytes_invalid=0 send_seq=140 receive_seq=140 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000156  raspberry_pi: temp=50.6 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=2.14 cputime=2.174 memavail=1555648 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 49.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1296 bytes_read=8941 bytes_retransmit=9 bytes_invalid=0 send_seq=141 receive_seq=141 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000156  raspberry_pi: temp=51.1 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=2.14 cputime=2.188 memavail=1555648 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 50.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1302 bytes_read=9092 bytes_retransmit=9 bytes_invalid=0 send_seq=142 receive_seq=142 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000158  raspberry_pi: temp=49.7 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=2.20 cputime=2.202 memavail=1555648 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 51.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1308 bytes_read=9258 bytes_retransmit=9 bytes_invalid=0 send_seq=143 receive_seq=143 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000160  raspberry_pi: temp=50.6 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=2.20 cputime=2.216 memavail=1555652 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 52.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1314 bytes_read=9439 bytes_retransmit=9 bytes_invalid=0 send_seq=144 receive_seq=144 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000161  raspberry_pi: temp=49.2 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=2.20 cputime=2.230 memavail=1555652 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 53.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1320 bytes_read=9604 bytes_retransmit=9 bytes_invalid=0 send_seq=145 receive_seq=145 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000162  raspberry_pi: temp=50.6 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.20 cputime=2.244 memavail=1555652 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 54.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1326 bytes_read=9770 bytes_retransmit=9 bytes_invalid=0 send_seq=146 receive_seq=146 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000162  raspberry_pi: temp=50.6 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=2.20 cputime=2.258 memavail=1556176 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 55.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1332 bytes_read=9951 bytes_retransmit=9 bytes_invalid=0 send_seq=147 receive_seq=147 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000169  raspberry_pi: temp=50.6 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.27 cputime=2.273 memavail=1556180 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 56.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1338 bytes_read=10102 bytes_retransmit=9 bytes_invalid=0 send_seq=148 receive_seq=148 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000164  raspberry_pi: temp=50.1 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=2.27 cputime=2.284 memavail=1549272 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 57.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1344 bytes_read=10268 bytes_retransmit=9 bytes_invalid=0 send_seq=149 receive_seq=149 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000162  raspberry_pi: temp=51.6 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.27 cputime=2.295 memavail=1538368 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 58.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1350 bytes_read=10449 bytes_retransmit=9 bytes_invalid=0 send_seq=150 receive_seq=150 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000160  raspberry_pi: temp=51.1 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.27 cputime=2.304 memavail=1538368 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 59.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1356 bytes_read=10614 bytes_retransmit=9 bytes_invalid=0 send_seq=151 receive_seq=151 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000161  raspberry_pi: temp=50.6 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=2.27 cputime=2.313 memavail=1538368 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 60.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1362 bytes_read=10780 bytes_retransmit=9 bytes_invalid=0 send_seq=152 receive_seq=152 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000160  raspberry_pi: temp=51.6 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.25 cputime=2.321 memavail=1538368 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 61.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1368 bytes_read=10961 bytes_retransmit=9 bytes_invalid=0 send_seq=153 receive_seq=153 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000165  raspberry_pi: temp=50.1 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=2.25 cputime=2.335 memavail=1538368 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.2 pwm=0.000
Stats 62.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1374 bytes_read=11112 bytes_retransmit=9 bytes_invalid=0 send_seq=154 receive_seq=154 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000168  raspberry_pi: temp=50.1 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.25 cputime=2.349 memavail=1538368 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 63.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1380 bytes_read=11278 bytes_retransmit=9 bytes_invalid=0 send_seq=155 receive_seq=155 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000173  raspberry_pi: temp=50.1 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=2.25 cputime=2.364 memavail=1538456 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 64.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1386 bytes_read=11464 bytes_retransmit=9 bytes_invalid=0 send_seq=156 receive_seq=156 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000180  raspberry_pi: temp=50.1 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=2.25 cputime=2.380 memavail=1538208 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 65.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1392 bytes_read=11605 bytes_retransmit=9 bytes_invalid=0 send_seq=157 receive_seq=157 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000182  raspberry_pi: temp=50.1 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.23 cputime=2.394 memavail=1537972 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 66.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1398 bytes_read=11760 bytes_retransmit=9 bytes_invalid=0 send_seq=158 receive_seq=158 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000186  raspberry_pi: temp=51.1 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=2.23 cputime=2.407 memavail=1538204 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 67.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1404 bytes_read=11932 bytes_retransmit=9 bytes_invalid=0 send_seq=159 receive_seq=159 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000181  raspberry_pi: temp=51.1 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.23 cputime=2.417 memavail=1538808 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 68.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1410 bytes_read=12083 bytes_retransmit=9 bytes_invalid=0 send_seq=160 receive_seq=160 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000181  raspberry_pi: temp=50.1 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.23 cputime=2.427 memavail=1527120 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 69.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1416 bytes_read=12263 bytes_retransmit=9 bytes_invalid=0 send_seq=161 receive_seq=161 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000190  raspberry_pi: temp=51.6 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.23 cputime=2.437 memavail=1539180 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 70.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1422 bytes_read=12444 bytes_retransmit=9 bytes_invalid=0 send_seq=162 receive_seq=162 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000202  raspberry_pi: temp=50.6 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.21 cputime=2.447 memavail=1539232 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 71.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1428 bytes_read=12595 bytes_retransmit=9 bytes_invalid=0 send_seq=163 receive_seq=163 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000199  raspberry_pi: temp=50.6 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=2.21 cputime=2.458 memavail=1538572 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 72.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1434 bytes_read=12761 bytes_retransmit=9 bytes_invalid=0 send_seq=164 receive_seq=164 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000212  raspberry_pi: temp=50.1 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.21 cputime=2.472 memavail=1538600 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 73.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1440 bytes_read=12942 bytes_retransmit=9 bytes_invalid=0 send_seq=165 receive_seq=165 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000210  raspberry_pi: temp=50.1 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.21 cputime=2.484 memavail=1539696 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 74.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1446 bytes_read=13107 bytes_retransmit=9 bytes_invalid=0 send_seq=166 receive_seq=166 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000208  raspberry_pi: temp=50.6 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=2.21 cputime=2.494 memavail=1557888 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 75.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1452 bytes_read=13273 bytes_retransmit=9 bytes_invalid=0 send_seq=167 receive_seq=167 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000208  raspberry_pi: temp=49.7 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=2.19 cputime=2.504 memavail=1557888 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 76.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1458 bytes_read=13454 bytes_retransmit=9 bytes_invalid=0 send_seq=168 receive_seq=168 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000203  raspberry_pi: temp=49.7 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=2.19 cputime=2.513 memavail=1557432 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 77.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1464 bytes_read=13605 bytes_retransmit=9 bytes_invalid=0 send_seq=169 receive_seq=169 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000198  raspberry_pi: temp=50.1 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.19 cputime=2.522 memavail=1557180 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 78.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1470 bytes_read=13786 bytes_retransmit=9 bytes_invalid=0 send_seq=170 receive_seq=170 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000194  raspberry_pi: temp=50.1 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=2.19 cputime=2.535 memavail=1557180 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 79.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1476 bytes_read=13966 bytes_retransmit=9 bytes_invalid=0 send_seq=171 receive_seq=171 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000195  raspberry_pi: temp=50.6 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.19 cputime=2.551 memavail=1556928 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 80.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1482 bytes_read=14117 bytes_retransmit=9 bytes_invalid=0 send_seq=172 receive_seq=172 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000197  raspberry_pi: temp=50.1 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.18 cputime=2.565 memavail=1556928 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 81.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1488 bytes_read=14298 bytes_retransmit=9 bytes_invalid=0 send_seq=173 receive_seq=173 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000197  raspberry_pi: temp=50.6 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=2.18 cputime=2.579 memavail=1556928 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 82.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1494 bytes_read=14464 bytes_retransmit=9 bytes_invalid=0 send_seq=174 receive_seq=174 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000195  raspberry_pi: temp=50.1 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=2.18 cputime=2.593 memavail=1556928 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 83.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1506 bytes_read=14631 bytes_retransmit=9 bytes_invalid=0 send_seq=176 receive_seq=176 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000195  raspberry_pi: temp=50.1 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=2.18 cputime=2.609 memavail=1556704 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 84.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1512 bytes_read=14826 bytes_retransmit=9 bytes_invalid=0 send_seq=177 receive_seq=177 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000194  raspberry_pi: temp=49.7 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=2.18 cputime=2.623 memavail=1555736 print_time=110495.647 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
webhooks client 548011324848: Disconnected
Starting Klippy...
Args: ['/home/coon/klipper/klippy/klippy.py', '/home/coon/printer_data/config/printer.cfg', '-l', '/home/coon/printer_data/logs/klippy.log', '-I', '/home/coon/printer_data/comms/klippy.serial', '-a', '/home/coon/printer_data/comms/klippy.sock']
Git version: 'v0.12.0-404-g80d185c94'
Branch: master
Remote: origin
Tracked URL: https://github.com/Klipper3d/klipper.git
CPU: 4 core ?
Python: '3.9.2 (default, Dec  1 2024, 12:12:57) \n[GCC 10.2.1 20210110]'
Start printer at Sun Dec 22 18:58:25 2024 (1734911905.8 27.3)
===== Config file =====
[virtual_sdcard]
path = ~/printer_data/gcodes
on_error_gcode = CANCEL_PRINT

[pause_resume]
recover_velocity = 25

[display_status]

[respond]
default_prefix = 

[gcode_macro CANCEL_PRINT]
description = Cancel the actual running print
rename_existing = BASE_CANCEL_PRINT
gcode = 
	G91
	G0 Z10 F600
	G90
	TURN_OFF_HEATERS
	G0 X5 Y220
	CLEAR_PAUSE
	
	BASE_CANCEL_PRINT

[gcode_macro PAUSE]
description = Pause the actual running print
rename_existing = PAUSE_BASE
gcode = 
	
	{% set x = params.X|default(5) %}
	{% set y = params.Y|default(225) %}
	{% set z = params.Z|default(10)|float %}
	{% set e = params.E|default(1) %}
	
	{% set max_z = printer.toolhead.axis_maximum.z|float %}
	{% set act_z = printer.toolhead.position.z|float %}
	{% set lift_z = z|abs %}
	{% if act_z < (max_z - lift_z) %}
	{% set z_safe = lift_z %}
	{% else %}
	{% set z_safe = max_z - act_z %}
	{% endif %}
	
	PAUSE_BASE
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E-{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	{% if "xyz" in printer.toolhead.homed_axes %}
	G1 Z{z_safe}
	G90
	G1 X{x} Y{y} F6000
	{% else %}
	{action_respond_info("Printer not homed")}
	{% endif %}

[gcode_macro RESUME]
description = Resume the actual running print
rename_existing = RESUME_BASE
variable_last_extruder_temp = {'restore': False, 'temp': 0}
variable_restore_idle_timeout = 0
variable_idle_state = False
gcode = 
	
	{% set e = params.E|default(1) %}
	
	{% if 'VELOCITY' in params|upper %}
	{% set get_params = ('VELOCITY=' + params.VELOCITY)  %}
	{%else %}
	{% set get_params = "" %}
	{% endif %}
	
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	RESUME_BASE {get_params}

[gcode_macro SET_PAUSE_NEXT_LAYER]
description = Enable a pause if the next layer is reached
gcode = 
	{% set pause_next_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_next_layer %}
	{% set ENABLE = params.ENABLE|default(1)|int != 0 %}
	{% set MACRO = params.MACRO|default(pause_next_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_next_layer VALUE="{{ 'enable': ENABLE, 'call': MACRO }}"

[gcode_macro SET_PAUSE_AT_LAYER]
description = Enable/disable a pause if a given layer number is reached
gcode = 
	{% set pause_at_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_at_layer %}
	{% set ENABLE = params.ENABLE|int != 0 if params.ENABLE is defined
	else params.LAYER is defined %}
	{% set LAYER = params.LAYER|default(pause_at_layer.layer)|int %}
	{% set MACRO = params.MACRO|default(pause_at_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_at_layer VALUE="{{ 'enable': ENABLE, 'layer': LAYER, 'call': MACRO }}"

[gcode_macro SET_PRINT_STATS_INFO]
rename_existing = SET_PRINT_STATS_INFO_BASE
description = Overwrite, to get pause_next_layer and pause_at_layer feature
variable_pause_next_layer = { 'enable': False, 'call': "PAUSE" }
variable_pause_at_layer = { 'enable': False, 'layer': 0, 'call': "PAUSE" }
gcode = 
	{% if pause_next_layer.enable %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_next_layer" % pause_next_layer.call}'
	{pause_next_layer.call}
	SET_PAUSE_NEXT_LAYER ENABLE=0
	{% elif pause_at_layer.enable and params.CURRENT_LAYER is defined and params.CURRENT_LAYER|int == pause_at_layer.layer %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_at_layer [%d]" % (pause_at_layer.call, pause_at_layer.layer)}'
	{pause_at_layer.call}
	SET_PAUSE_AT_LAYER ENABLE=0
	{% endif %}
	SET_PRINT_STATS_INFO_BASE {rawparams}

[gcode_macro _TOOLHEAD_PARK_PAUSE_CANCEL]
description = Helper: park toolhead used in PAUSE and CANCEL_PRINT
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set velocity = printer.configfile.settings.pause_resume.recover_velocity %}
	{% set use_custom     = client.use_custom_pos|default(false)|lower == 'true' %}
	{% set custom_park_x  = client.custom_park_x|default(0.0) %}
	{% set custom_park_y  = client.custom_park_y|default(0.0) %}
	{% set park_dz        = client.custom_park_dz|default(2.0)|abs %}
	{% set sp_hop         = client.speed_hop|default(15) * 60 %}
	{% set sp_move        = client.speed_move|default(velocity) * 60 %}
	
	{% set origin    = printer.gcode_move.homing_origin %}
	{% set act       = printer.gcode_move.gcode_position %}
	{% set max       = printer.toolhead.axis_maximum %}
	{% set cone      = printer.toolhead.cone_start_z|default(max.z) %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	
	{% set z_min = params.Z_MIN|default(0)|float %}
	{% set z_park = [[(act.z + park_dz), z_min]|max, (max.z - origin.z)]|min %}
	{% set x_park = params.X       if params.X is defined
	else custom_park_x  if use_custom
	else 0.0            if round_bed
	else (max.x - 5.0) %}
	{% set y_park = params.Y       if params.Y is defined
	else custom_park_y  if use_custom
	else (max.y - 5.0)  if round_bed and z_park < cone
	else 0.0            if round_bed
	else (max.y - 5.0) %}
	
	_CLIENT_RETRACT
	{% if "xyz" in printer.toolhead.homed_axes %}
	G90
	G1 Z{z_park} F{sp_hop}
	G1 X{x_park} Y{y_park} F{sp_move}
	{% if not printer.gcode_move.absolute_coordinates %} G91 {% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='Printer not homed'
	{% endif %}

[gcode_macro _CLIENT_EXTRUDE]
description = Extrudes, if the extruder is hot enough
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set use_fw_retract = (client.use_fw_retract|default(false)|lower == 'true') and (printer.firmware_retraction is defined) %}
	{% set length = params.LENGTH|default(client.unretract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_unretract)|default(35) %}
	{% set absolute_extrude = printer.gcode_move.absolute_extrude %}
	
	{% if printer.toolhead.extruder != '' %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if use_fw_retract %}
	{% if length < 0 %}
	G10
	{% else %}
	G11
	{% endif %}
	{% else %}
	M83
	G1 E{length} F{(speed|float|abs) * 60}
	{% if absolute_extrude %}
	M82
	{% endif %}
	{% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='{"\"%s\" not hot enough" % printer.toolhead.extruder}'
	{% endif %}
	{% endif %}

[gcode_macro _CLIENT_RETRACT]
description = Retracts, if the extruder is hot enough
gcode = 
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set length = params.LENGTH|default(client.retract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_retract)|default(35) %}
	
	_CLIENT_EXTRUDE LENGTH=-{length|float|abs} SPEED={speed|float|abs}

[gcode_macro _CLIENT_LINEAR_MOVE]
description = Linear move with save and restore of the gcode state
gcode = 
	{% set x_move = "X" ~ params.X if params.X is defined else "" %}
	{% set y_move = "Y" ~ params.Y if params.Y is defined else "" %}
	{% set z_move = "Z" ~ params.Z if params.Z is defined else "" %}
	{% set e_move = "E" ~ params.E if params.E is defined else "" %}
	{% set rate = "F" ~ params.F if params.F is defined else "" %}
	{% set ABSOLUTE = params.ABSOLUTE | default(0) | int != 0 %}
	{% set ABSOLUTE_E = params.ABSOLUTE_E | default(0) | int != 0 %}
	SAVE_GCODE_STATE NAME=_client_movement
	{% if x_move or y_move or z_move %}
	G9{ 0 if ABSOLUTE else 1 }
	{% endif %}
	{% if e_move %}
	M8{ 2 if ABSOLUTE_E else 3 }
	{% endif %}
	G1 { x_move } { y_move } { z_move } { e_move } { rate }
	RESTORE_GCODE_STATE NAME=_client_movement

[gcode_macro play_test]
gcode = 
	RESPOND TYPE=command MSG="action:prompt_begin Question"
	RESPOND TYPE=command MSG="action:prompt_text Do you wont to cancel the print?"
	RESPOND TYPE=command MSG="action:prompt_footer_button continue|RESPOND TYPE=command MSG=action:prompt_end"
	RESPOND TYPE=command MSG="action:prompt_footer_button CANCEL|CANCEL_PRINT|error"
	RESPOND TYPE=command MSG="action:prompt_show"

[gcode_macro PRINT_START]
gcode = 
	START_PRINT {rawparams}

[gcode_macro START_PRINT]
gcode = 
	{% set BED_TEMP = params.BED_TEMP|default(60)|float %}
	{% set EXTRUDER_TEMP = params.EXTRUDER_TEMP|default(190)|float %}
	
	M190 S{BED_TEMP}
	
	G90
	
	G28
	
	RESPOND MSG="Bed Meshing"
	
	
	
	
	
	
	
	
	BED_MESH_CLEAR
	BED_MESH_CALIBRATE ADAPTIVE=1
	
	
	
	
	
	
	
	RESPOND MSG="Heating to print temp"
	M104 S{EXTRUDER_TEMP}
	G0 Z40 F240
	M109 S{EXTRUDER_TEMP}
	RESPOND MSG="Enable Runout Sensor"
	SFS_ENABLE
	RESPOND MSG="Line Purge"
	LINE_PURGE
	RESPOND MSG="Print Started"

[gcode_macro LINE_PURGE]
gcode = 
	G92 E0
	G1 Z2.0 F3000
	G1 X0.1 Y20 Z0.3 F5000.0
	G1 X0.1 Y200.0 Z0.3 F1500.0 E15
	G1 X0.4 Y200.0 Z0.3 F5000.0
	G1 X0.4 Y20 Z0.3 F1500.0 E30
	G92 E0
	G1 Z2.0 F3000
	G1 X5 Y20 Z0.3 F5000.0

[gcode_macro PRINT_END]
gcode = 
	END_PRINT

[gcode_macro END_PRINT]
gcode = 
	
	
	RESPOND MSG="Print Finished"
	G91
	G1 E-.5 Z0.2 F2400
	G1 X5 Y5 F6000
	G1 Z10
	G90
	SFS_DISABLE
	
	G1 X0 Y220 F6000
	M106 S0
	M104 S0
	M140 S0
	
	M84 X Y E

[gcode_macro SET_ACTIVE_SPOOL]
gcode = 
	{% if params.ID %}
	{% set id = params.ID|int %}
	{action_call_remote_method(
	"spoolman_set_active_spool",
	spool_id=id
	)}
	{% else %}
	{action_respond_info("Parameter 'ID' is required")}
	{% endif %}

[gcode_macro CLEAR_ACTIVE_SPOOL]
gcode = 
	{action_call_remote_method(
	"spoolman_set_active_spool",
	spool_id=None
	)}

[gcode_macro G29]
gcode = 
	G28
	BED_MESH_CALIBRATE
	G0 X0 Y0 Z10 F6000
	BED_MESH_PROFILE save=default

[gcode_macro M125]
gcode = 
	SAVE_GCODE_STATE NAME=parking
	M117 Parking toolhead
	G91
	G1 Z10 F600
	G90
	G1 X5 Y225 F4000
	RESTORE_GCODE_STATE NAME=parking

[gcode_macro Load_Filament]
gcode = 
	SAVE_GCODE_STATE NAME=loading_filament
	M117 Loading Filament
	M83
	G92 E0.0
	G91
	G1 E50 F200
	G92 E50
	RESTORE_GCODE_STATE NAME=loading_filament

[gcode_macro Unload_Filament]
gcode = 
	SAVE_GCODE_STATE NAME=unloading_filament
	M117 Unloading Filament
	G91
	G1 E5 F100
	G92 E0.0
	G1 E-50 F5000
	G92 E-50
	RESTORE_GCODE_STATE NAME=unloading_filament

[gcode_macro Filament_Change]
gcode = 
	
	SAVE_GCODE_STATE NAME=filament_change
	
	Unload_Filament
	
	RESPOND TYPE=command MSG="action:prompt_begin Question"
	RESPOND TYPE=command MSG="action:prompt_text Please insert new filament and confirm"
	RESPOND TYPE=command MSG="action:prompt_footer_button CONFIRM|Load_Filament|RESPOND TYPE=command MSG=action:prompt_end"
	RESPOND TYPE=command MSG="action:prompt_footer_button CANCEL|RESPOND TYPE=command MSG=action:prompt_end"
	RESPOND TYPE=command MSG="action:prompt_show"
	
	RESTORE_GCODE_STATE NAME=filament_change

[gcode_macro Calibrate_Hotend_PID]
gcode = 
	PID_CALIBRATE HEATER=extruder TARGET=200

[gcode_macro Calibrate_Bed_PID]
gcode = 
	PID_CALIBRATE HEATER=heater_bed TARGET=60

[gcode_macro Calibrate_Zoffset]
gcode = 
	PROBE_CALIBRATE

[gcode_macro Tram_bed]
gcode = 
	SCREWS_TILT_CALCULATE

[gcode_macro TEST_SPEED]
description = Test for max speed and acceleration parameters for the printer. Procedure: Home -> ReadPositionFromMCU -> MovesToolhead@Vel&Accel -> Home -> ReadPositionfromMCU
gcode = 
	
	{% set speed  = params.SPEED|default(printer.configfile.settings.printer.max_velocity)|int %}
	
	{% set iterations = params.ITERATIONS|default(5)|int %}
	
	{% set accel  = params.ACCEL|default(printer.configfile.settings.printer.max_accel)|int %}
	
	{% set min_cruise_ratio = params.MIN_CRUISE_RATIO|default(0.5)|float %}
	
	{% set bound = params.BOUND|default(20)|int %}
	
	{% set smallpatternsize = SMALLPATTERNSIZE|default(20)|int %}
	
	
	
	{% set x_min = printer.toolhead.axis_minimum.x + bound %}
	{% set x_max = printer.toolhead.axis_maximum.x - bound %}
	{% set y_min = printer.toolhead.axis_minimum.y + bound %}
	{% set y_max = printer.toolhead.axis_maximum.y - bound %}
	
	
	
	{% set x_center = (printer.toolhead.axis_minimum.x|float + printer.toolhead.axis_maximum.x|float ) / 2 %}
	{% set y_center = (printer.toolhead.axis_minimum.y|float + printer.toolhead.axis_maximum.y|float ) / 2 %}
	
	
	{% set x_center_min = x_center - (smallpatternsize/2) %}
	{% set x_center_max = x_center + (smallpatternsize/2) %}
	{% set y_center_min = y_center - (smallpatternsize/2) %}
	{% set y_center_max = y_center + (smallpatternsize/2) %}
	
	
	SAVE_GCODE_STATE NAME=TEST_SPEED
	
	
	{ action_respond_info("TEST_SPEED: starting %d iterations at speed %d, accel %d" % (iterations, speed, accel)) }
	
	
	M400
	G28
	
	{% if printer.configfile.settings.quad_gantry_level %}
	{% if printer.quad_gantry_level.applied == False %}
	QUAD_GANTRY_LEVEL
	G28 Z
	{% endif %}
	{% endif %}
	
	G90
	G1 X{printer.toolhead.axis_maximum.x-50} Y{printer.toolhead.axis_maximum.y-50} F{30*60}
	M400
	G28 X Y
	G0 X{printer.toolhead.axis_maximum.x-1} Y{printer.toolhead.axis_maximum.y-1} F{30*60}
	G4 P1000
	GET_POSITION
	
	
	G0 X{x_min} Y{y_min} Z{bound + 10} F{speed*60}
	
	
	{% if printer.configfile.settings.printer.minimum_cruise_ratio is defined %}
	SET_VELOCITY_LIMIT VELOCITY={speed} ACCEL={accel} MINIMUM_CRUISE_RATIO={min_cruise_ratio}
	{% else %}
	SET_VELOCITY_LIMIT VELOCITY={speed} ACCEL={accel} ACCEL_TO_DECEL={accel / 2}
	{% endif %}
	
	{% for i in range(iterations) %}
	
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_max} Y{y_max} F{speed*60}
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	G0 X{x_min} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	
	
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_min} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	
	
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_max} Y{y_center_max} F{speed*60}
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	G0 X{x_center_min} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	
	
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_min} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	{% endfor %}
	
	
	{% if printer.configfile.settings.printer.minimum_cruise_ratio is defined %}
	SET_VELOCITY_LIMIT VELOCITY={printer.configfile.settings.printer.max_velocity} ACCEL={printer.configfile.settings.printer.max_accel} MINIMUM_CRUISE_RATIO={printer.configfile.settings.printer.minimum_cruise_ratio}
	{% else %}
	SET_VELOCITY_LIMIT VELOCITY={printer.configfile.settings.printer.max_velocity} ACCEL={printer.configfile.settings.printer.max_accel} ACCEL_TO_DECEL={printer.configfile.settings.printer.max_accel_to_decel}
	{% endif %}
	
	
	M400
	G28
	
	G90
	G0 X{printer.toolhead.axis_maximum.x-1} Y{printer.toolhead.axis_maximum.y-1} F{30*60}
	G4 P1000
	GET_POSITION
	
	
	RESTORE_GCODE_STATE NAME=TEST_SPEED

[gcode_macro GET_TIMELAPSE_SETUP]
description = Print the Timelapse setup
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% set output_txt = ["Timelapse Setup:"] %}
	{% set _dummy = output_txt.append("enable: %s" % tl.enable) %}
	{% set _dummy = output_txt.append("park: %s" % tl.park.enable) %}
	{% if tl.park.enable %}
	{% set _dummy = output_txt.append("park position: %s time: %s s" % (tl.park.pos, tl.park.time)) %}
	{% set _dummy = output_txt.append("park cord x:%s y:%s dz:%s" % (tl.park.coord.x, tl.park.coord.y, tl.park.coord.dz)) %}
	{% set _dummy = output_txt.append("travel speed: %s mm/s" % tl.speed.travel) %}
	{% endif %}
	{% set _dummy = output_txt.append("fw_retract: %s" % tl.extruder.fw_retract) %}
	{% if not tl.extruder.fw_retract %}
	{% set _dummy = output_txt.append("retract: %s mm speed: %s mm/s" % (tl.extruder.retract, tl.speed.retract)) %}
	{% set _dummy = output_txt.append("extrude: %s mm speed: %s mm/s" % (tl.extruder.extrude, tl.speed.extrude)) %}
	{% endif %}
	{% set _dummy = output_txt.append("verbose: %s" % tl.verbose) %}
	{action_respond_info(output_txt|join("\n"))}

[gcode_macro _SET_TIMELAPSE_SETUP]
description = Set user parameters for timelapse
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	
	{% set min = printer.toolhead.axis_minimum %}
	{% set max = printer.toolhead.axis_maximum %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	{% set park = {'min'   : {'x': (min.x / 1.42)|round(3) if round_bed else min.x|round(3),
	'y': (min.y / 1.42)|round(3) if round_bed else min.y|round(3)},
	'max'   : {'x': (max.x / 1.42)|round(3) if round_bed else max.x|round(3),
	'y': (max.y / 1.42)|round(3) if round_bed else max.y|round(3)},
	'center': {'x': (max.x-(max.x-min.x)/2)|round(3),
	'y': (max.y-(max.y-min.y)/2)|round(3)}} %}
	
	{% if params.ENABLE %}
	{% if params.ENABLE|lower is in ['true', 'false'] %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=enable VALUE={True if params.ENABLE|lower == 'true' else False}
	{% else %}
	{action_raise_error("ENABLE=%s not supported. Allowed values are [True, False]" % params.ENABLE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.VERBOSE %}
	{% if params.VERBOSE|lower is in ['true', 'false'] %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=verbose VALUE={True if params.VERBOSE|lower == 'true' else False}
	{% else %}
	{action_raise_error("VERBOSE=%s not supported. Allowed values are [True, False]" % params.VERBOSE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_X %}
	{% if params.CUSTOM_POS_X|float >= min.x and params.CUSTOM_POS_X|float <= max.x %}
	{% set _dummy = tl.park.custom.update({'x':params.CUSTOM_POS_X|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_X=%s must be within [%s - %s]" % (params.CUSTOM_POS_X, min.x, max.x))}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_Y %}
	{% if params.CUSTOM_POS_Y|float >= min.y and params.CUSTOM_POS_Y|float <= max.y %}
	{% set _dummy = tl.park.custom.update({'y':params.CUSTOM_POS_Y|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_Y=%s must be within [%s - %s]" % (params.CUSTOM_POS_Y, min.y, max.y))}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_DZ %}
	{% if params.CUSTOM_POS_DZ|float >= min.z and params.CUSTOM_POS_DZ|float <= max.z %}
	{% set _dummy = tl.park.custom.update({'dz':params.CUSTOM_POS_DZ|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_DZ=%s must be within [%s - %s]" % (params.CUSTOM_POS_DZ, min.z, max.z))}
	{% endif %}
	{% endif %}
	{% if params.PARK_ENABLE %}
	{% if params.PARK_ENABLE|lower is in ['true', 'false'] %}
	{% set _dummy = tl.park.update({'enable':True if params.PARK_ENABLE|lower == 'true' else False}) %}
	{% else %}
	{action_raise_error("PARK_ENABLE=%s not supported. Allowed values are [True, False]" % params.PARK_ENABLE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.PARK_POS %}
	{% if params.PARK_POS|lower is in ['center','front_left','front_right','back_left','back_right','custom','x_only','y_only'] %}
	{% set dic = {'center'      : {'x': park.center.x   , 'y': park.center.y   , 'dz': 1                },
	'front_left'  : {'x': park.min.x      , 'y': park.min.y      , 'dz': 0                },
	'front_right' : {'x': park.max.x      , 'y': park.min.y      , 'dz': 0                },
	'back_left'   : {'x': park.min.x      , 'y': park.max.y      , 'dz': 0                },
	'back_right'  : {'x': park.max.x      , 'y': park.max.y      , 'dz': 0                },
	'custom'      : {'x': tl.park.custom.x, 'y': tl.park.custom.y, 'dz': tl.park.custom.dz},
	'x_only'      : {'x': tl.park.custom.x, 'y': 'none'          , 'dz': tl.park.custom.dz},
	'y_only'      : {'x': 'none'          , 'y': tl.park.custom.y, 'dz': tl.park.custom.dz}} %}
	{% set _dummy = tl.park.update({'pos':params.PARK_POS|lower}) %}
	{% set _dummy = tl.park.update({'coord':dic[tl.park.pos]}) %}
	{% else %}
	{action_raise_error("PARK_POS=%s not supported. Allowed values are [CENTER, FRONT_LEFT, FRONT_RIGHT, BACK_LEFT, BACK_RIGHT, CUSTOM, X_ONLY, Y_ONLY]"
	% params.PARK_POS|upper)}
	{% endif %}
	{% endif %}
	{% if params.PARK_TIME %}
	{% if params.PARK_TIME|float >= 0.0 %}
	{% set _dummy = tl.park.update({'time':params.PARK_TIME|float|round(3)}) %}
	{% else %}
	{action_raise_error("PARK_TIME=%s must be a positive number" % params.PARK_TIME)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=park VALUE="{tl.park}"
	{% if params.TRAVEL_SPEED %}
	{% if params.TRAVEL_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'travel':params.TRAVEL_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("TRAVEL_SPEED=%s must be larger than 0" % params.TRAVEL_SPEED)}
	{% endif %}
	{% endif %}
	{% if params.RETRACT_SPEED %}
	{% if params.RETRACT_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'retract':params.RETRACT_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("RETRACT_SPEED=%s must be larger than 0" % params.RETRACT_SPEED)}
	{% endif %}
	{% endif %}
	{% if params.EXTRUDE_SPEED %}
	{% if params.EXTRUDE_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'extrude':params.EXTRUDE_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("EXTRUDE_SPEED=%s must be larger than 0" % params.EXTRUDE_SPEED)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=speed VALUE="{tl.speed}"
	{% if params.EXTRUDE_DISTANCE %}
	{% if params.EXTRUDE_DISTANCE|float >= 0.0 %}
	{% set _dummy = tl.extruder.update({'extrude':params.EXTRUDE_DISTANCE|float|round(3)}) %}
	{% else %}
	{action_raise_error("EXTRUDE_DISTANCE=%s must be specified as positiv number" % params.EXTRUDE_DISTANCE)}
	{% endif %}
	{% endif %}
	{% if params.RETRACT_DISTANCE %}
	{% if params.RETRACT_DISTANCE|float >= 0.0 %}
	{% set _dummy = tl.extruder.update({'retract':params.RETRACT_DISTANCE|float|round(3)}) %}
	{% else %}
	{action_raise_error("RETRACT_DISTANCE=%s must be specified as positiv number" % params.RETRACT_DISTANCE)}
	{% endif %}
	{% endif %}
	{% if params.FW_RETRACT %}
	{% if params.FW_RETRACT|lower is in ['true', 'false'] %}
	{% if 'firmware_retraction' in printer.configfile.settings %}
	{% set _dummy = tl.extruder.update({'fw_retract': True if params.FW_RETRACT|lower == 'true' else False}) %}
	{% else %}
	{% set _dummy = tl.extruder.update({'fw_retract':False}) %}
	{% if params.FW_RETRACT|capitalize == 'True' %}
	{action_raise_error("[firmware_retraction] not defined in printer.cfg. Can not enable fw_retract")}
	{% endif %}
	{% endif %}
	{% else %}
	{action_raise_error("FW_RETRACT=%s not supported. Allowed values are [True, False]" % params.FW_RETRACT|capitalize)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=extruder VALUE="{tl.extruder}"
	{% if printer.configfile.settings['gcode_macro pause'] is defined %}
	{% set _dummy = tl.macro.update({'pause': printer.configfile.settings['gcode_macro pause'].rename_existing}) %}
	{% endif %}
	{% if printer.configfile.settings['gcode_macro resume'] is defined %}
	{% set _dummy = tl.macro.update({'resume': printer.configfile.settings['gcode_macro resume'].rename_existing}) %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=macro VALUE="{tl.macro}"

[gcode_macro TIMELAPSE_TAKE_FRAME]
description = Take Timelapse shoot
variable_enable = False
variable_takingframe = False
variable_park = {'enable': False,
	'pos'   : 'center',
	'time'  : 0.1,
	'custom': {'x': 0, 'y': 0, 'dz': 0},
	'coord' : {'x': 0, 'y': 0, 'dz': 0}}
variable_extruder = {'fw_retract': False,
	'retract': 1.0,
	'extrude': 1.0}
variable_speed = {'travel': 100,
	'retract': 15,
	'extrude': 15}
variable_verbose = True
variable_check_time = 0.5
variable_restore = {'absolute': {'coordinates': True, 'extrude': True}, 'speed': 1500, 'e':0, 'factor': {'speed': 1.0, 'extrude': 1.0}}
variable_macro = {'pause': 'PAUSE', 'resume': 'RESUME'}
variable_is_paused = False
gcode = 
	{% set hyperlapse = True if params.HYPERLAPSE and params.HYPERLAPSE|lower =='true' else False %}
	{% if enable %}
	{% if (hyperlapse and printer['gcode_macro HYPERLAPSE'].run) or
	(not hyperlapse and not printer['gcode_macro HYPERLAPSE'].run) %}
	{% if park.enable %}
	{% set pos = {'x': 'X' + park.coord.x|string if park.pos != 'y_only' else '',
	'y': 'Y' + park.coord.y|string if park.pos != 'x_only' else '',
	'z': 'Z'+ [printer.gcode_move.gcode_position.z + park.coord.dz, printer.toolhead.axis_maximum.z]|min|string} %}
	{% set restore = {'absolute': {'coordinates': printer.gcode_move.absolute_coordinates,
	'extrude'    : printer.gcode_move.absolute_extrude},
	'speed'   : printer.gcode_move.speed,
	'e'       : printer.gcode_move.gcode_position.e,
	'factor'  : {'speed'  : printer.gcode_move.speed_factor,
	'extrude': printer.gcode_move.extrude_factor}} %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=restore VALUE="{restore}"
	{% if not printer[printer.toolhead.extruder].can_extrude %}
	{% if verbose %}{action_respond_info("Timelapse: Warning, minimum extruder temperature not reached!")}{% endif %}
	{% else %}
	{% if extruder.fw_retract %}
	G10
	{% else %}
	M83
	G0 E-{extruder.retract} F{speed.retract * 60}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=is_paused VALUE=True
	{macro.pause}
	SET_GCODE_OFFSET X=0 Y=0
	G90
	{% if "xyz" not in printer.toolhead.homed_axes %}
	{% if verbose %}{action_respond_info("Timelapse: Warning, axis not homed yet!")}{% endif %}
	{% else %}
	G0 {pos.x} {pos.y} {pos.z} F{speed.travel * 60}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=takingframe VALUE=True
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_TAKE_FRAME DURATION={check_time}
	M400
	{% endif %}
	_TIMELAPSE_NEW_FRAME HYPERLAPSE={hyperlapse}
	{% endif %}
	{% else %}
	{% if verbose %}{action_respond_info("Timelapse: disabled, take frame ignored")}{% endif %}
	{% endif %}

[gcode_macro _TIMELAPSE_NEW_FRAME]
description = action call for timelapse shoot. must be a seperate macro
gcode = 
	{action_call_remote_method("timelapse_newframe",
	macropark=printer['gcode_macro TIMELAPSE_TAKE_FRAME'].park,
	hyperlapse=params.HYPERLAPSE)}

[delayed_gcode _WAIT_TIMELAPSE_TAKE_FRAME]
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% set factor = {'speed': printer.gcode_move.speed_factor, 'extrude': printer.gcode_move.extrude_factor} %}
	{% if tl.takingframe %}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_TAKE_FRAME DURATION={tl.check_time}
	{% else %}
	{tl.macro.resume} VELOCITY={tl.speed.travel}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=is_paused VALUE=False
	{% if not printer[printer.toolhead.extruder].can_extrude %}
	{action_respond_info("Timelapse: Warning minimum extruder temperature not reached!")}
	{% else %}
	{% if tl.extruder.fw_retract %}
	G11
	{% else %}
	G0 E{tl.extruder.extrude} F{tl.speed.extrude * 60}
	G0 F{tl.restore.speed}
	{% if tl.restore.absolute.extrude %}
	M82
	G92 E{tl.restore.e}
	{% endif %}
	{% endif %}
	{% endif %}
	{% if tl.restore.factor.speed   != factor.speed   %} M220 S{(factor.speed*100)|round(0)}   {% endif %}
	{% if tl.restore.factor.extrude != factor.extrude %} M221 S{(factor.extrude*100)|round(0)} {% endif %}
	{% if not tl.restore.absolute.coordinates %} G91 {% endif %}
	{% endif %}

[gcode_macro HYPERLAPSE]
description = Start/Stop a hyperlapse recording
variable_cycle = 0
variable_run = False
gcode = 
	{% set cycle = params.CYCLE|default(30)|int %}
	{% if params.ACTION and params.ACTION|lower == 'start' %}
	{action_respond_info("Hyperlapse: frames started (Cycle %d sec)" % cycle)}
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=run VALUE=True
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=cycle VALUE={cycle}
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION={cycle}
	TIMELAPSE_TAKE_FRAME HYPERLAPSE=True
	{% elif params.ACTION and params.ACTION|lower == 'stop' %}
	{% if run %}{action_respond_info("Hyperlapse: frames stopped")}{% endif %}
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=run VALUE=False
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION=0
	{% else %}
	{action_raise_error("Hyperlapse: No valid input parameter
	Use:
	- HYPERLAPSE ACTION=START [CYCLE=time]
	- HYPERLAPSE ACTION=STOP")}
	{% endif %}

[delayed_gcode _HYPERLAPSE_LOOP]
gcode = 
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION={printer["gcode_macro HYPERLAPSE"].cycle}
	TIMELAPSE_TAKE_FRAME HYPERLAPSE=True

[gcode_macro TIMELAPSE_RENDER]
description = Render Timelapse video and wait for the result
variable_render = False
variable_run_identifier = 0
gcode = 
	{action_respond_info("Timelapse: Rendering started")}
	{action_call_remote_method("timelapse_render", byrendermacro="True")}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_RENDER VARIABLE=render VALUE=True
	{printer.configfile.settings['gcode_macro pause'].rename_existing}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_RENDER DURATION=0.5

[delayed_gcode _WAIT_TIMELAPSE_RENDER]
gcode = 
	{% set ri = printer['gcode_macro TIMELAPSE_RENDER'].run_identifier % 4 %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_RENDER VARIABLE=run_identifier VALUE={ri + 1}
	{% if printer['gcode_macro TIMELAPSE_RENDER'].render %}
	M117 Rendering {['-','\\','|','/'][ri]}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_RENDER DURATION=0.5
	{% else %}
	{action_respond_info("Timelapse: Rendering finished")}
	M117
	{printer.configfile.settings['gcode_macro resume'].rename_existing}
	{% endif %}

[gcode_macro TEST_STREAM_DELAY]
description = Helper macro to find stream and park delay
gcode = 
	{% set min = printer.toolhead.axis_minimum %}
	{% set max = printer.toolhead.axis_maximum %}
	{% set act = printer.toolhead.position %}
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% if act.z > 5.0 %}
	G0 X{min.x + 5.0} F{tl.speed.travel|int * 60}
	G0 X{(max.x-min.x)/2}
	G4 P{tl.park.time|float * 1000}
	_TIMELAPSE_NEW_FRAME HYPERLAPSE=FALSE
	G0 X{max.x - 5.0}
	{% else %}
	{action_raise_error("Toolhead z %.3f to low. Please place head above z = 5.0" % act.z)}
	{% endif %}

[gcode_macro _OBICO_LAYER_CHANGE]
description = Run a scan across the current print area
variable_first_layer_scan_retract_length = 6
variable_first_layer_scan_retract_speed = 15
variable_first_layer_scan_cooldown_temp = 170
variable_first_layer_scan_resume_speed = 50
variable_first_layer_scan_enabled = True
variable_first_layer_scan_stepover = 10
variable_first_layer_scan_speed = 10
variable_first_layer_scan_zhop = 4
variable_first_layer_scan_zhop_speed = 15
variable_verbose = False
variable_current_layer = -1
variable_first_layer_scanning = False
variable_wait = {'resume': "RESUME", 'absolute_coordinates': True, 'absolute_extrude': True, 'e': 0.0, 'previous_temp': 0}
gcode = 
	
	{% set pause_macro  = "PAUSE"  if printer.configfile.settings['gcode_macro pause']  is not defined
	else printer.configfile.settings['gcode_macro pause'].rename_existing %}
	{% set resume_macro = "RESUME" if printer.configfile.settings['gcode_macro resume'] is not defined
	else printer.configfile.settings['gcode_macro resume'].rename_existing %}
	
	{% set current_layer_default = printer.print_stats.info.current_layer if printer.print_stats.info.current_layer is not none else -1 %}
	{% set current_layer = params.CURRENT_LAYER|default(current_layer_default)|int %}
	
	{% set polygon_points = printer.exclude_object.objects|map(attribute='polygon')|sum(start=[]) if printer.exclude_object is defined else [] %}
	{% set min_x = params.MINX|default(polygon_points|map(attribute=0)|min|default(printer.toolhead.axis_minimum.x))|float %}
	{% set min_y = params.MINY|default(polygon_points|map(attribute=1)|min|default(printer.toolhead.axis_minimum.y))|float %}
	{% set max_x = params.MAXX|default(polygon_points|map(attribute=0)|max|default(printer.toolhead.axis_maximum.x))|float %}
	{% set max_y = params.MAXY|default(polygon_points|map(attribute=1)|max|default(printer.toolhead.axis_maximum.y))|float %}
	
	{% set stepoverCount = ((max_y - min_y) / first_layer_scan_stepover|float)|round(method='ceil')|int %}
	
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Layer %d" % (current_layer)}' {% endif %}
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=current_layer VALUE={current_layer}
	
	{% if first_layer_scan_enabled and current_layer == 2 %}
	
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=first_layer_scanning VALUE=True
	
	
	{% set wait_dic = {'resume'              : resume_macro,
	'absolute_coordinates': printer.gcode_move.absolute_coordinates,
	'absolute_extrude'    : printer.gcode_move.absolute_extrude,
	'e'                   : printer.gcode_move.gcode_position.e,
	'previous_temp'       : printer.extruder.target} %}
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=wait VALUE="{wait_dic}"
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Prepare scanning" {% endif %}
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Scan Coordinates: Min:[%.3f:%.3f] Max:[%.3f:%.3f]" % (min_x,min_y,max_x,max_y)}' {% endif %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Retract %.1fmm filament" % first_layer_scan_retract_length|abs}' {% endif %}
	M83
	G0 E-{first_layer_scan_retract_length|abs} F{first_layer_scan_retract_speed|float * 60}
	{% endif %}
	G91
	G0 Z{first_layer_scan_zhop|abs} F{first_layer_scan_zhop_speed|float * 60}
	
	
	M106 S255
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Fan on and lowering temperature to %.1f" % first_layer_scan_cooldown_temp}' {% endif %}
	M104 S{first_layer_scan_cooldown_temp}
	M109 S{first_layer_scan_cooldown_temp}
	
	{pause_macro}
	
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Start scanning" {% endif %}
	
	UPDATE_DELAYED_GCODE ID=_WAIT_OBICO_LAYER_CHANGE DURATION=1.0
	G90
	G0 X{min_x} Y{min_y} F{first_layer_scan_resume_speed|float * 60}
	{% for ystep in range(stepoverCount) %}
	G0 Y{min_y + first_layer_scan_stepover|float * ystep} F{first_layer_scan_speed|float * 60}
	G0 X{max_x if ystep % 2 == 0 else min_x}              F{first_layer_scan_speed|float * 60}
	{% endfor %}
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Finish scanning" {% endif %}
	
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=first_layer_scanning VALUE=False
	
	{% endif %}

[delayed_gcode _WAIT_OBICO_LAYER_CHANGE]
gcode = 
	{% set lc_macro = printer['gcode_macro _OBICO_LAYER_CHANGE'] %}
	{% if lc_macro.first_layer_scanning %}
	
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Waiting for first layer scan..." {% endif %}
	UPDATE_DELAYED_GCODE ID=_WAIT_OBICO_LAYER_CHANGE DURATION=1.0
	{% else %}
	
	M107
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Fan off and resume print" {% endif %}
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Call %s VELOCITY=%.1f" % (lc_macro.wait.resume, lc_macro.first_layer_scan_resume_speed)}' {% endif %}
	{lc_macro.wait.resume} VELOCITY={lc_macro.first_layer_scan_resume_speed}
	G91
	G0 Z-{lc_macro.first_layer_scan_zhop|abs} F{lc_macro.first_layer_scan_zhop_speed|float * 60}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% set first_layer_scan_unretract_length = lc_macro.first_layer_scan_retract_length + 0.5 %}
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Extrude %.1fmm filament" % first_layer_scan_unretract_length|abs}' {% endif %}
	M83
	G0 E{first_layer_scan_unretract_length|abs} F{lc_macro.first_layer_scan_retract_speed|float * 60}
	{% endif %}
	
	
	M104 S{lc_macro.wait.previous_temp}
	M109 S{lc_macro.wait.previous_temp}
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Heating back up to previous temperature"}' {% endif %}
	
	
	{% if lc_macro.wait.absolute_coordinates %} G90 {% endif %}
	{% if lc_macro.wait.absolute_extrude %}
	M82
	G92 E{lc_macro.wait.e}
	{% endif %}
	{% endif %}

[gcode_macro OBICO_LINK_STATUS]
description = Link to Obico server
variable_one_time_passcode = ''
variable_one_time_passlink = ''
variable_is_linked = False
gcode = 
	{action_respond_info('Obico one_time_passcode: {}'.format(one_time_passcode))}
	{action_respond_info('Obico one_time_passlink: {}'.format(one_time_passlink))}
	{action_respond_info('Obico is_linked: {}'.format(is_linked))}
	{% if not is_linked and one_time_passcode != '' %}
	M117 Code: {one_time_passcode}
	{% else %}
	M117 Obico linked
	{% endif %}

[gcode_macro _OBICO_RELINK]
description = Re-link to Obico server
gcode = 
	{action_respond_info('WARNING: Re-link to Obico server')}
	{action_call_remote_method("obico_remote_event", event_name='relink_obico', message='')}
	{action_respond_info('WARNING: relink_obico requested')}

[exclude_object]

[mcu]
serial = /dev/serial/by-id/usb-1a86_USB_Serial-if00-port0
restart_method = command

[temperature_sensor raspberry_pi]
sensor_type = temperature_host
min_temp = 10
max_temp = 100

[temperature_sensor mcu_temp]
sensor_type = temperature_mcu
min_temp = 0
max_temp = 100

[printer]
kinematics = cartesian
max_velocity = 200
max_accel = 4000
max_z_velocity = 10
max_z_accel = 100
minimum_cruise_ratio = 0.5
square_corner_velocity = 5

[stepper_x]
step_pin = PB9
dir_pin = PC2
enable_pin = !PC3
microsteps = 16
rotation_distance = 40
endstop_pin = ^PA5
position_endstop = 0
position_max = 230
homing_speed = 50

[stepper_y]
step_pin = PB7
dir_pin = PB8
enable_pin = !PC3
microsteps = 16
rotation_distance = 40
endstop_pin = ^PA6
position_endstop = 0
position_max = 231
homing_speed = 50

[stepper_z]
step_pin = PB5
dir_pin = !PB6
enable_pin = !PC3
microsteps = 16
rotation_distance = 8
endstop_pin = probe:z_virtual_endstop
position_max = 250
position_min = -4
homing_speed = 4
second_homing_speed = 1
homing_retract_dist = 2.0

[fan]
pin = PA0

[extruder]
max_extrude_only_distance = 100.0
step_pin = PB3
dir_pin = PB4
enable_pin = !PC3
microsteps = 16
gear_ratio = 42:12
rotation_distance = 26.359
nozzle_diameter = 0.400
filament_diameter = 1.750
heater_pin = PA1
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PC5
min_temp = 0
max_temp = 300
min_extrude_temp = 170
pressure_advance = .0369
pressure_advance_smooth_time = 0.04
control = pid
pid_kp = 19.195
pid_ki = 1.000
pid_kd = 92.135

[firmware_retraction]
retract_length = 0.3
retract_speed = 20

[idle_timeout]
gcode = 
	{% if printer.pause_resume.is_paused %}
	M118 Idle timeout while paused, turning off hotend
	SET_HEATER_TEMPERATURE HEATER=extruder TARGET=0
	{% else %}
	M118 Idle timeout
	TURN_OFF_HEATERS
	M84
	{% endif %}
timeout = 1800

[heater_bed]
heater_pin = PA2
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PC4
min_temp = 0
max_temp = 130
control = pid
pid_kp = 68.601
pid_ki = 1.185
pid_kd = 993.000

[bltouch]
sensor_pin = ^PB1
control_pin = PB0
x_offset = -31.8
y_offset = -40.5
speed = 35
samples = 2
samples_result = median
samples_tolerance = 0.05
samples_tolerance_retries = 2
sample_retract_dist = 5.0
probe_with_touch_mode = true
stow_on_each_sample = false
z_offset = 2.049

[safe_z_home]
home_xy_position = 147, 154
speed = 75
z_hop = 10
z_hop_speed = 5
move_to_previous = false

[bed_screws]
screw1 = 30,51
screw1_name = "FL"
screw2 = 200,51
screw2_name = "FR"
screw3 = 200,195
screw3_name = "RR"
screw4 = 30,195
screw4_name = "RL"

[screws_tilt_adjust]
screw1 = 67, 67
screw1_name = front left screw
screw2 = 230, 67
screw2_name = front right screw
screw3 = 230, 230
screw3_name = rear right screw
screw4 = 67.60, 230
screw4_name = rear left screw
horizontal_move_z = 10
speed = 200
screw_thread = CW-M4

[bed_mesh]
speed = 120
mesh_min = 10,11
mesh_max = 195,182
probe_count = 3,3
algorithm = bicubic
fade_start = 1
fade_end = 10
fade_target = 0

[filament_motion_sensor SFS_T0]
detection_length = 150.00
extruder = extruder
switch_pin = PA4
pause_on_runout = True
event_delay = 3.0
pause_delay = 0.5
runout_gcode = 
	M117 Runout Detected!

[delayed_gcode DISABLEFILAMENTSENSOR]
initial_duration = 1
gcode = 
	SET_FILAMENT_SENSOR SENSOR=SFS_T0 ENABLE=0

[gcode_macro SFS_ENABLE]
description = Enable smart filament sensor
gcode = 
	M117 ENABLING the Smart Filament Sensor
	G92 E0
	SET_FILAMENT_SENSOR SENSOR=SFS_T0 ENABLE=1

[gcode_macro SFS_DISABLE]
description = Disable smart filament sensor
gcode = 
	M117 DISABLING the Smart Filament Sensor
	G92 E0
	SET_FILAMENT_SENSOR SENSOR=SFS_T0 ENABLE=0

[gcode_macro FILAMENT_RUNOUT]
gcode = 
	M117 Runout Detected!
	M300 S1 P10
	M600
	M300 S1 P10

[gcode_macro M300]
gcode = 
	{% set S = params.S|default(1000)|int %}
	{% set P = params.P|default(100)|int %}
	SET_PIN PIN=BEEPER VALUE=0.5 CYCLE_TIME={ 1.0/S if S > 0 else 1 }
	G4 P{P}
	SET_PIN PIN=BEEPER VALUE=0
	[gcode_macro M600]
	gcode:
	{% set X = params.X|default(25)|float %}
	{% set Y = params.Y|default(25)|float %}
	{% set Z = params.Z|default(10)|float %}
	SAVE_GCODE_STATE NAME=M600_state
	PAUSE
	G91
	G1 E-.8 F2700
	G1 Z{Z}
	G90
	G1 X{X} Y{Y} F3000
	G91
	G1 E-15 F1000
	RESTORE_GCODE_STATE NAME=M600_state

[gcode_arcs]
resolution = 1.0

[input_shaper]
shaper_freq_x = 73.5
shaper_type_x = ei
shaper_freq_y = 76.9
shaper_type_y = mzv
=======================
bed_mesh: bicubic interpolation with a probe_count of less than 4 points detected.  Forcing lagrange interpolation. Configured Probe Count: 3, 3
Extruder max_extrude_ratio=0.266081
mcu 'mcu': Starting serial connect
mcu 'mcu': got {'oid': 10, 'next_clock': 4184058368, 'value': 14011, '#name': 'analog_in_state', '#sent_time': 29.413606852, '#receive_time': 29.418645889}
mcu 'mcu': got {'oid': 12, 'next_clock': 4185498368, 'value': 31557, '#name': 'analog_in_state', '#sent_time': 29.413606852, '#receive_time': 29.439499982}
mcu 'mcu': got {'oid': 17, 'next_clock': 4189098368, 'value': 31501, '#name': 'analog_in_state', '#sent_time': 29.467754056, '#receive_time': 29.488743371}
Loaded MCU 'mcu' 119 commands (v0.12.0-286-g81de9a861 / gcc: (15:8-2019-q3-1+b1) 8.3.1 20190703 (release) [gcc-8-branch revision 273027] binutils: (2.35.2-2+14+b2) 2.35.2)
MCU 'mcu' config: ADC_MAX=4095 BUS_PINS_i2c1=PB6,PB7 BUS_PINS_i2c1a=PB8,PB9 BUS_PINS_i2c2=PB10,PB11 BUS_PINS_spi1=PA6,PA7,PA5 BUS_PINS_spi1a=PB4,PB5,PB3 BUS_PINS_spi2=PB14,PB15,PB13 BUS_PINS_spi3=PB4,PB5,PB3 CLOCK_FREQ=72000000 MCU=stm32f103xe PWM_MAX=255 RECEIVE_WINDOW=192 RESERVE_PINS_serial=PA10,PA9 SERIAL_BAUD=250000 STATS_SUMSQ_BASE=256 STEPPER_BOTH_EDGE=1
mcu_temperature 'mcu' nominal base=357.558140 slope=-767.441860
Configured MCU 'mcu' (1024 moves)
Starting heater checks for heater_bed
webhooks client 547728089776: New connection
bed_mesh: generated points
Index |  Tool Adjusted  |   Probe
  0   | (41.8, 51.5)    | (10.0, 11.0)
  1   | (134.3, 51.5)   | (102.5, 11.0)
  2   | (226.8, 51.5)   | (195.0, 11.0)
  3   | (226.8, 137.0)  | (195.0, 96.5)
  4   | (134.3, 137.0)  | (102.5, 96.5)
  5   | (41.8, 137.0)   | (10.0, 96.5)
  6   | (41.8, 222.5)   | (10.0, 182.0)
  7   | (134.3, 222.5)  | (102.5, 182.0)
  8   | (226.8, 222.5)  | (195.0, 182.0)
Starting heater checks for extruder
Stats 30.7: gcodein=0  mcu: mcu_awake=0.006 mcu_task_avg=0.000028 mcu_task_stddev=0.000013 bytes_write=1138 bytes_read=4636 bytes_retransmit=9 bytes_invalid=0 send_seq=115 receive_seq=115 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000384  raspberry_pi: temp=52.1 mcu_temp: temp=0.0 heater_bed: target=0 temp=0.0 pwm=0.000 sysload=1.48 cputime=1.865 memavail=1509848 print_time=111430.208 buffer_time=0.249 print_stall=0 extruder: target=0 temp=0.0 pwm=0.000
webhooks client 547728089776: Client info {'program': 'Moonraker', 'version': 'v0.9.3-3-gccfe32f'}
webhooks: registering remote method 'shutdown_machine' for connection id: 547728089776
webhooks: registering remote method 'reboot_machine' for connection id: 547728089776
webhooks: registering remote method 'pause_job_queue' for connection id: 547728089776
webhooks: registering remote method 'start_job_queue' for connection id: 547728089776
webhooks: registering remote method 'spoolman_set_active_spool' for connection id: 547728089776
webhooks: registering remote method 'obico_remote_event' for connection id: 547728089776
Stats 31.7: gcodein=0  mcu: mcu_awake=0.006 mcu_task_avg=0.000028 mcu_task_stddev=0.000013 bytes_write=1144 bytes_read=4777 bytes_retransmit=9 bytes_invalid=0 send_seq=116 receive_seq=116 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000387  raspberry_pi: temp=52.6 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.48 cputime=1.900 memavail=1499900 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 32.7: gcodein=0  mcu: mcu_awake=0.006 mcu_task_avg=0.000028 mcu_task_stddev=0.000013 bytes_write=1150 bytes_read=4946 bytes_retransmit=9 bytes_invalid=0 send_seq=117 receive_seq=117 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000720  raspberry_pi: temp=52.1 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.48 cputime=1.919 memavail=1484892 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 33.7: gcodein=0  mcu: mcu_awake=0.006 mcu_task_avg=0.000028 mcu_task_stddev=0.000013 bytes_write=1156 bytes_read=5101 bytes_retransmit=9 bytes_invalid=0 send_seq=118 receive_seq=118 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000387  raspberry_pi: temp=52.1 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.48 cputime=1.927 memavail=1487268 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 34.7: gcodein=0  mcu: mcu_awake=0.006 mcu_task_avg=0.000028 mcu_task_stddev=0.000013 bytes_write=1162 bytes_read=5252 bytes_retransmit=9 bytes_invalid=0 send_seq=119 receive_seq=119 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000567  raspberry_pi: temp=52.1 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.48 cputime=1.936 memavail=1481376 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 35.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000010 bytes_write=1168 bytes_read=5447 bytes_retransmit=9 bytes_invalid=0 send_seq=120 receive_seq=120 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000494  raspberry_pi: temp=51.6 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.60 cputime=1.947 memavail=1470840 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 36.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000010 bytes_write=1174 bytes_read=5613 bytes_retransmit=9 bytes_invalid=0 send_seq=121 receive_seq=121 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000404  raspberry_pi: temp=51.1 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.60 cputime=1.958 memavail=1485920 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 37.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000010 bytes_write=1180 bytes_read=5764 bytes_retransmit=9 bytes_invalid=0 send_seq=122 receive_seq=122 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000365  raspberry_pi: temp=51.6 mcu_temp: temp=29.4 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.60 cputime=1.970 memavail=1485000 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 38.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000010 bytes_write=1186 bytes_read=5945 bytes_retransmit=9 bytes_invalid=0 send_seq=123 receive_seq=123 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000353  raspberry_pi: temp=49.2 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.60 cputime=1.983 memavail=1485000 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 39.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000010 bytes_write=1192 bytes_read=6111 bytes_retransmit=9 bytes_invalid=0 send_seq=124 receive_seq=124 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000419  raspberry_pi: temp=51.1 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.60 cputime=1.993 memavail=1479776 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 40.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1198 bytes_read=6276 bytes_retransmit=9 bytes_invalid=0 send_seq=125 receive_seq=125 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000330  raspberry_pi: temp=51.1 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.80 cputime=2.002 memavail=1479680 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 41.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1204 bytes_read=6457 bytes_retransmit=9 bytes_invalid=0 send_seq=126 receive_seq=126 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000277  raspberry_pi: temp=50.1 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.80 cputime=2.010 memavail=1479680 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 42.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1210 bytes_read=6623 bytes_retransmit=9 bytes_invalid=0 send_seq=127 receive_seq=127 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000251  raspberry_pi: temp=50.1 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.80 cputime=2.019 memavail=1479680 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 43.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1216 bytes_read=6774 bytes_retransmit=9 bytes_invalid=0 send_seq=128 receive_seq=128 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000218  raspberry_pi: temp=51.1 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.80 cputime=2.027 memavail=1479440 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 44.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1222 bytes_read=6955 bytes_retransmit=9 bytes_invalid=0 send_seq=129 receive_seq=129 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000216  raspberry_pi: temp=50.6 mcu_temp: temp=29.4 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.80 cputime=2.039 memavail=1479440 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 45.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1228 bytes_read=7135 bytes_retransmit=9 bytes_invalid=0 send_seq=130 receive_seq=130 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000218  raspberry_pi: temp=51.1 mcu_temp: temp=29.4 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.65 cputime=2.054 memavail=1479452 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 46.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1234 bytes_read=7286 bytes_retransmit=9 bytes_invalid=0 send_seq=131 receive_seq=131 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000230  raspberry_pi: temp=50.6 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.65 cputime=2.067 memavail=1479456 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 47.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1240 bytes_read=7467 bytes_retransmit=9 bytes_invalid=0 send_seq=132 receive_seq=132 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000233  raspberry_pi: temp=50.6 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.65 cputime=2.080 memavail=1479456 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 48.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1246 bytes_read=7633 bytes_retransmit=9 bytes_invalid=0 send_seq=133 receive_seq=133 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000235  raspberry_pi: temp=50.1 mcu_temp: temp=29.4 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.65 cputime=2.094 memavail=1479456 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 49.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1252 bytes_read=7784 bytes_retransmit=9 bytes_invalid=0 send_seq=134 receive_seq=134 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000240  raspberry_pi: temp=50.6 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.65 cputime=2.107 memavail=1479208 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 50.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1258 bytes_read=7979 bytes_retransmit=9 bytes_invalid=0 send_seq=135 receive_seq=135 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000235  raspberry_pi: temp=49.7 mcu_temp: temp=29.4 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.60 cputime=2.121 memavail=1478200 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 51.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1264 bytes_read=8145 bytes_retransmit=9 bytes_invalid=0 send_seq=136 receive_seq=136 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000233  raspberry_pi: temp=50.6 mcu_temp: temp=29.4 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.60 cputime=2.134 memavail=1478212 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 52.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1270 bytes_read=8296 bytes_retransmit=9 bytes_invalid=0 send_seq=137 receive_seq=137 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000245  raspberry_pi: temp=50.1 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=1.60 cputime=2.148 memavail=1478212 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 53.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1276 bytes_read=8477 bytes_retransmit=9 bytes_invalid=0 send_seq=138 receive_seq=138 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000241  raspberry_pi: temp=49.2 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.60 cputime=2.161 memavail=1478212 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 54.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1282 bytes_read=8643 bytes_retransmit=9 bytes_invalid=0 send_seq=139 receive_seq=139 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000235  raspberry_pi: temp=49.2 mcu_temp: temp=29.4 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.60 cputime=2.174 memavail=1478212 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 55.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1288 bytes_read=8808 bytes_retransmit=9 bytes_invalid=0 send_seq=140 receive_seq=140 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000239  raspberry_pi: temp=49.2 mcu_temp: temp=29.4 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.47 cputime=2.187 memavail=1478212 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 56.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1294 bytes_read=8989 bytes_retransmit=9 bytes_invalid=0 send_seq=141 receive_seq=141 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000247  raspberry_pi: temp=49.7 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.47 cputime=2.201 memavail=1478212 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 57.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1300 bytes_read=9155 bytes_retransmit=9 bytes_invalid=0 send_seq=142 receive_seq=142 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000244  raspberry_pi: temp=49.2 mcu_temp: temp=29.4 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.47 cputime=2.214 memavail=1478212 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 58.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1306 bytes_read=9306 bytes_retransmit=9 bytes_invalid=0 send_seq=143 receive_seq=143 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000247  raspberry_pi: temp=49.2 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.47 cputime=2.227 memavail=1478212 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 59.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1312 bytes_read=9487 bytes_retransmit=9 bytes_invalid=0 send_seq=144 receive_seq=144 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000256  raspberry_pi: temp=49.2 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.47 cputime=2.240 memavail=1478212 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 60.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1318 bytes_read=9667 bytes_retransmit=9 bytes_invalid=0 send_seq=145 receive_seq=145 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000253  raspberry_pi: temp=49.2 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.59 cputime=2.254 memavail=1478172 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 61.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1324 bytes_read=9818 bytes_retransmit=9 bytes_invalid=0 send_seq=146 receive_seq=146 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000247  raspberry_pi: temp=50.1 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.59 cputime=2.267 memavail=1478236 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 62.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1330 bytes_read=9999 bytes_retransmit=9 bytes_invalid=0 send_seq=147 receive_seq=147 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000242  raspberry_pi: temp=49.7 mcu_temp: temp=29.4 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.59 cputime=2.280 memavail=1478236 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 63.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1336 bytes_read=10165 bytes_retransmit=9 bytes_invalid=0 send_seq=148 receive_seq=148 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000237  raspberry_pi: temp=48.2 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.59 cputime=2.293 memavail=1478236 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 64.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1342 bytes_read=10316 bytes_retransmit=9 bytes_invalid=0 send_seq=149 receive_seq=149 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000232  raspberry_pi: temp=50.1 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.59 cputime=2.306 memavail=1478236 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 65.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1348 bytes_read=10511 bytes_retransmit=9 bytes_invalid=0 send_seq=150 receive_seq=150 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000230  raspberry_pi: temp=48.7 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.63 cputime=2.320 memavail=1478236 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 66.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1354 bytes_read=10677 bytes_retransmit=9 bytes_invalid=0 send_seq=151 receive_seq=151 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000226  raspberry_pi: temp=49.2 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.63 cputime=2.334 memavail=1478244 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 67.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1360 bytes_read=10828 bytes_retransmit=9 bytes_invalid=0 send_seq=152 receive_seq=152 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000224  raspberry_pi: temp=49.7 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.63 cputime=2.346 memavail=1478244 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 68.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1366 bytes_read=11024 bytes_retransmit=9 bytes_invalid=0 send_seq=153 receive_seq=153 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000223  raspberry_pi: temp=48.7 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.63 cputime=2.360 memavail=1478244 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 69.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1372 bytes_read=11175 bytes_retransmit=9 bytes_invalid=0 send_seq=154 receive_seq=154 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000223  raspberry_pi: temp=48.7 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.63 cputime=2.372 memavail=1478244 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 70.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1378 bytes_read=11340 bytes_retransmit=9 bytes_invalid=0 send_seq=155 receive_seq=155 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000220  raspberry_pi: temp=49.7 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.50 cputime=2.385 memavail=1478192 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 71.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1384 bytes_read=11536 bytes_retransmit=9 bytes_invalid=0 send_seq=156 receive_seq=156 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000219  raspberry_pi: temp=48.2 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.50 cputime=2.400 memavail=1478260 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 72.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1390 bytes_read=11687 bytes_retransmit=9 bytes_invalid=0 send_seq=157 receive_seq=157 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000218  raspberry_pi: temp=49.7 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.50 cputime=2.413 memavail=1478260 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 73.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1396 bytes_read=11838 bytes_retransmit=9 bytes_invalid=0 send_seq=158 receive_seq=158 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000217  raspberry_pi: temp=49.7 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.50 cputime=2.426 memavail=1478264 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 74.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1402 bytes_read=12034 bytes_retransmit=9 bytes_invalid=0 send_seq=159 receive_seq=159 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000216  raspberry_pi: temp=49.2 mcu_temp: temp=29.4 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.50 cputime=2.440 memavail=1478264 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 75.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1408 bytes_read=12199 bytes_retransmit=9 bytes_invalid=0 send_seq=160 receive_seq=160 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000219  raspberry_pi: temp=49.2 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.38 cputime=2.453 memavail=1478264 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 76.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1414 bytes_read=12350 bytes_retransmit=9 bytes_invalid=0 send_seq=161 receive_seq=161 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000217  raspberry_pi: temp=48.2 mcu_temp: temp=29.4 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.38 cputime=2.466 memavail=1478264 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 77.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1420 bytes_read=12546 bytes_retransmit=9 bytes_invalid=0 send_seq=162 receive_seq=162 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000218  raspberry_pi: temp=48.7 mcu_temp: temp=29.4 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.38 cputime=2.479 memavail=1478264 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 78.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1426 bytes_read=12697 bytes_retransmit=9 bytes_invalid=0 send_seq=163 receive_seq=163 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000247  raspberry_pi: temp=49.7 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.38 cputime=2.492 memavail=1478264 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 79.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1432 bytes_read=12848 bytes_retransmit=9 bytes_invalid=0 send_seq=164 receive_seq=164 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000244  raspberry_pi: temp=48.2 mcu_temp: temp=29.4 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.38 cputime=2.505 memavail=1478264 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 80.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1438 bytes_read=13058 bytes_retransmit=9 bytes_invalid=0 send_seq=165 receive_seq=165 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000240  raspberry_pi: temp=49.2 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.27 cputime=2.519 memavail=1478764 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 81.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1444 bytes_read=13209 bytes_retransmit=9 bytes_invalid=0 send_seq=166 receive_seq=166 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000248  raspberry_pi: temp=48.7 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.27 cputime=2.532 memavail=1478784 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 82.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1450 bytes_read=13360 bytes_retransmit=9 bytes_invalid=0 send_seq=167 receive_seq=167 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000245  raspberry_pi: temp=48.2 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.27 cputime=2.545 memavail=1478784 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 83.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1456 bytes_read=13556 bytes_retransmit=9 bytes_invalid=0 send_seq=168 receive_seq=168 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000246  raspberry_pi: temp=49.2 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=1.27 cputime=2.559 memavail=1478784 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 84.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1462 bytes_read=13707 bytes_retransmit=9 bytes_invalid=0 send_seq=169 receive_seq=169 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000244  raspberry_pi: temp=48.7 mcu_temp: temp=29.4 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.27 cputime=2.572 memavail=1478784 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 85.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1468 bytes_read=13858 bytes_retransmit=9 bytes_invalid=0 send_seq=170 receive_seq=170 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000239  raspberry_pi: temp=48.7 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.16 cputime=2.585 memavail=1478784 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 86.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1474 bytes_read=14068 bytes_retransmit=9 bytes_invalid=0 send_seq=171 receive_seq=171 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000236  raspberry_pi: temp=48.2 mcu_temp: temp=29.4 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.16 cputime=2.599 memavail=1478784 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 87.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1480 bytes_read=14219 bytes_retransmit=9 bytes_invalid=0 send_seq=172 receive_seq=172 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000232  raspberry_pi: temp=49.2 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.16 cputime=2.612 memavail=1478784 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 88.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1486 bytes_read=14370 bytes_retransmit=9 bytes_invalid=0 send_seq=173 receive_seq=173 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000229  raspberry_pi: temp=49.7 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.16 cputime=2.624 memavail=1478784 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 89.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1498 bytes_read=14565 bytes_retransmit=9 bytes_invalid=0 send_seq=175 receive_seq=174 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000224  raspberry_pi: temp=49.7 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.16 cputime=2.638 memavail=1478788 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 90.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1504 bytes_read=14722 bytes_retransmit=9 bytes_invalid=0 send_seq=176 receive_seq=176 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000216  raspberry_pi: temp=48.2 mcu_temp: temp=29.4 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.07 cputime=2.650 memavail=1478296 print_time=111430.208 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
webhooks client 547728089776: Disconnected
webhooks client 547702755088: New connection
webhooks client 547702755088: Client info {'program': 'Moonraker', 'version': 'v0.9.3-3-gccfe32f'}
webhooks: registering remote method 'shutdown_machine' for connection id: 547702755088
webhooks: registering remote method 'reboot_machine' for connection id: 547702755088
webhooks: registering remote method 'pause_job_queue' for connection id: 547702755088
webhooks: registering remote method 'start_job_queue' for connection id: 547702755088
webhooks client 547702755088: Disconnected
Starting Klippy...
Args: ['/home/coon/klipper/klippy/klippy.py', '/home/coon/printer_data/config/printer.cfg', '-l', '/home/coon/printer_data/logs/klippy.log', '-I', '/home/coon/printer_data/comms/klippy.serial', '-a', '/home/coon/printer_data/comms/klippy.sock']
Git version: 'v0.12.0-404-g80d185c94'
Branch: master
Remote: origin
Tracked URL: https://github.com/Klipper3d/klipper.git
CPU: 4 core ?
Python: '3.9.2 (default, Dec  1 2024, 12:12:57) \n[GCC 10.2.1 20210110]'
Start printer at Sun Dec 22 19:20:53 2024 (1734913253.5 44.0)
===== Config file =====
[virtual_sdcard]
path = ~/printer_data/gcodes
on_error_gcode = CANCEL_PRINT

[pause_resume]
recover_velocity = 25

[display_status]

[respond]
default_prefix = 

[gcode_macro CANCEL_PRINT]
description = Cancel the actual running print
rename_existing = BASE_CANCEL_PRINT
gcode = 
	G91
	G0 Z10 F600
	G90
	TURN_OFF_HEATERS
	G0 X5 Y220
	CLEAR_PAUSE
	
	BASE_CANCEL_PRINT

[gcode_macro PAUSE]
description = Pause the actual running print
rename_existing = PAUSE_BASE
gcode = 
	
	{% set x = params.X|default(5) %}
	{% set y = params.Y|default(225) %}
	{% set z = params.Z|default(10)|float %}
	{% set e = params.E|default(1) %}
	
	{% set max_z = printer.toolhead.axis_maximum.z|float %}
	{% set act_z = printer.toolhead.position.z|float %}
	{% set lift_z = z|abs %}
	{% if act_z < (max_z - lift_z) %}
	{% set z_safe = lift_z %}
	{% else %}
	{% set z_safe = max_z - act_z %}
	{% endif %}
	
	PAUSE_BASE
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E-{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	{% if "xyz" in printer.toolhead.homed_axes %}
	G1 Z{z_safe}
	G90
	G1 X{x} Y{y} F6000
	{% else %}
	{action_respond_info("Printer not homed")}
	{% endif %}

[gcode_macro RESUME]
description = Resume the actual running print
rename_existing = RESUME_BASE
variable_last_extruder_temp = {'restore': False, 'temp': 0}
variable_restore_idle_timeout = 0
variable_idle_state = False
gcode = 
	
	{% set e = params.E|default(1) %}
	
	{% if 'VELOCITY' in params|upper %}
	{% set get_params = ('VELOCITY=' + params.VELOCITY)  %}
	{%else %}
	{% set get_params = "" %}
	{% endif %}
	
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	RESUME_BASE {get_params}

[gcode_macro SET_PAUSE_NEXT_LAYER]
description = Enable a pause if the next layer is reached
gcode = 
	{% set pause_next_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_next_layer %}
	{% set ENABLE = params.ENABLE|default(1)|int != 0 %}
	{% set MACRO = params.MACRO|default(pause_next_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_next_layer VALUE="{{ 'enable': ENABLE, 'call': MACRO }}"

[gcode_macro SET_PAUSE_AT_LAYER]
description = Enable/disable a pause if a given layer number is reached
gcode = 
	{% set pause_at_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_at_layer %}
	{% set ENABLE = params.ENABLE|int != 0 if params.ENABLE is defined
	else params.LAYER is defined %}
	{% set LAYER = params.LAYER|default(pause_at_layer.layer)|int %}
	{% set MACRO = params.MACRO|default(pause_at_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_at_layer VALUE="{{ 'enable': ENABLE, 'layer': LAYER, 'call': MACRO }}"

[gcode_macro SET_PRINT_STATS_INFO]
rename_existing = SET_PRINT_STATS_INFO_BASE
description = Overwrite, to get pause_next_layer and pause_at_layer feature
variable_pause_next_layer = { 'enable': False, 'call': "PAUSE" }
variable_pause_at_layer = { 'enable': False, 'layer': 0, 'call': "PAUSE" }
gcode = 
	{% if pause_next_layer.enable %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_next_layer" % pause_next_layer.call}'
	{pause_next_layer.call}
	SET_PAUSE_NEXT_LAYER ENABLE=0
	{% elif pause_at_layer.enable and params.CURRENT_LAYER is defined and params.CURRENT_LAYER|int == pause_at_layer.layer %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_at_layer [%d]" % (pause_at_layer.call, pause_at_layer.layer)}'
	{pause_at_layer.call}
	SET_PAUSE_AT_LAYER ENABLE=0
	{% endif %}
	SET_PRINT_STATS_INFO_BASE {rawparams}

[gcode_macro _TOOLHEAD_PARK_PAUSE_CANCEL]
description = Helper: park toolhead used in PAUSE and CANCEL_PRINT
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set velocity = printer.configfile.settings.pause_resume.recover_velocity %}
	{% set use_custom     = client.use_custom_pos|default(false)|lower == 'true' %}
	{% set custom_park_x  = client.custom_park_x|default(0.0) %}
	{% set custom_park_y  = client.custom_park_y|default(0.0) %}
	{% set park_dz        = client.custom_park_dz|default(2.0)|abs %}
	{% set sp_hop         = client.speed_hop|default(15) * 60 %}
	{% set sp_move        = client.speed_move|default(velocity) * 60 %}
	
	{% set origin    = printer.gcode_move.homing_origin %}
	{% set act       = printer.gcode_move.gcode_position %}
	{% set max       = printer.toolhead.axis_maximum %}
	{% set cone      = printer.toolhead.cone_start_z|default(max.z) %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	
	{% set z_min = params.Z_MIN|default(0)|float %}
	{% set z_park = [[(act.z + park_dz), z_min]|max, (max.z - origin.z)]|min %}
	{% set x_park = params.X       if params.X is defined
	else custom_park_x  if use_custom
	else 0.0            if round_bed
	else (max.x - 5.0) %}
	{% set y_park = params.Y       if params.Y is defined
	else custom_park_y  if use_custom
	else (max.y - 5.0)  if round_bed and z_park < cone
	else 0.0            if round_bed
	else (max.y - 5.0) %}
	
	_CLIENT_RETRACT
	{% if "xyz" in printer.toolhead.homed_axes %}
	G90
	G1 Z{z_park} F{sp_hop}
	G1 X{x_park} Y{y_park} F{sp_move}
	{% if not printer.gcode_move.absolute_coordinates %} G91 {% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='Printer not homed'
	{% endif %}

[gcode_macro _CLIENT_EXTRUDE]
description = Extrudes, if the extruder is hot enough
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set use_fw_retract = (client.use_fw_retract|default(false)|lower == 'true') and (printer.firmware_retraction is defined) %}
	{% set length = params.LENGTH|default(client.unretract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_unretract)|default(35) %}
	{% set absolute_extrude = printer.gcode_move.absolute_extrude %}
	
	{% if printer.toolhead.extruder != '' %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if use_fw_retract %}
	{% if length < 0 %}
	G10
	{% else %}
	G11
	{% endif %}
	{% else %}
	M83
	G1 E{length} F{(speed|float|abs) * 60}
	{% if absolute_extrude %}
	M82
	{% endif %}
	{% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='{"\"%s\" not hot enough" % printer.toolhead.extruder}'
	{% endif %}
	{% endif %}

[gcode_macro _CLIENT_RETRACT]
description = Retracts, if the extruder is hot enough
gcode = 
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set length = params.LENGTH|default(client.retract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_retract)|default(35) %}
	
	_CLIENT_EXTRUDE LENGTH=-{length|float|abs} SPEED={speed|float|abs}

[gcode_macro _CLIENT_LINEAR_MOVE]
description = Linear move with save and restore of the gcode state
gcode = 
	{% set x_move = "X" ~ params.X if params.X is defined else "" %}
	{% set y_move = "Y" ~ params.Y if params.Y is defined else "" %}
	{% set z_move = "Z" ~ params.Z if params.Z is defined else "" %}
	{% set e_move = "E" ~ params.E if params.E is defined else "" %}
	{% set rate = "F" ~ params.F if params.F is defined else "" %}
	{% set ABSOLUTE = params.ABSOLUTE | default(0) | int != 0 %}
	{% set ABSOLUTE_E = params.ABSOLUTE_E | default(0) | int != 0 %}
	SAVE_GCODE_STATE NAME=_client_movement
	{% if x_move or y_move or z_move %}
	G9{ 0 if ABSOLUTE else 1 }
	{% endif %}
	{% if e_move %}
	M8{ 2 if ABSOLUTE_E else 3 }
	{% endif %}
	G1 { x_move } { y_move } { z_move } { e_move } { rate }
	RESTORE_GCODE_STATE NAME=_client_movement

[gcode_macro play_test]
gcode = 
	RESPOND TYPE=command MSG="action:prompt_begin Question"
	RESPOND TYPE=command MSG="action:prompt_text Do you wont to cancel the print?"
	RESPOND TYPE=command MSG="action:prompt_footer_button continue|RESPOND TYPE=command MSG=action:prompt_end"
	RESPOND TYPE=command MSG="action:prompt_footer_button CANCEL|CANCEL_PRINT|error"
	RESPOND TYPE=command MSG="action:prompt_show"

[gcode_macro PRINT_START]
gcode = 
	START_PRINT {rawparams}

[gcode_macro START_PRINT]
gcode = 
	{% set BED_TEMP = params.BED_TEMP|default(60)|float %}
	{% set EXTRUDER_TEMP = params.EXTRUDER_TEMP|default(190)|float %}
	
	M190 S{BED_TEMP}
	
	G90
	
	G28
	
	RESPOND MSG="Bed Meshing"
	
	
	
	
	
	
	
	
	BED_MESH_CLEAR
	BED_MESH_CALIBRATE ADAPTIVE=1
	
	
	
	
	
	
	
	RESPOND MSG="Heating to print temp"
	M104 S{EXTRUDER_TEMP}
	G0 Z40 F240
	M109 S{EXTRUDER_TEMP}
	RESPOND MSG="Enable Runout Sensor"
	SFS_ENABLE
	RESPOND MSG="Line Purge"
	LINE_PURGE
	RESPOND MSG="Print Started"

[gcode_macro LINE_PURGE]
gcode = 
	G92 E0
	G1 Z2.0 F3000
	G1 X0.1 Y20 Z0.3 F5000.0
	G1 X0.1 Y200.0 Z0.3 F1500.0 E15
	G1 X0.4 Y200.0 Z0.3 F5000.0
	G1 X0.4 Y20 Z0.3 F1500.0 E30
	G92 E0
	G1 Z2.0 F3000
	G1 X5 Y20 Z0.3 F5000.0

[gcode_macro PRINT_END]
gcode = 
	END_PRINT

[gcode_macro END_PRINT]
gcode = 
	
	
	RESPOND MSG="Print Finished"
	G91
	G1 E-.5 Z0.2 F2400
	G1 X5 Y5 F6000
	G1 Z10
	G90
	SFS_DISABLE
	
	G1 X0 Y220 F6000
	M106 S0
	M104 S0
	M140 S0
	
	M84 X Y E

[gcode_macro G29]
gcode = 
	G28
	BED_MESH_CALIBRATE
	G0 X0 Y0 Z10 F6000
	BED_MESH_PROFILE save=default

[gcode_macro M125]
gcode = 
	SAVE_GCODE_STATE NAME=parking
	M117 Parking toolhead
	G91
	G1 Z10 F600
	G90
	G1 X5 Y225 F4000
	RESTORE_GCODE_STATE NAME=parking

[gcode_macro Load_Filament]
gcode = 
	SAVE_GCODE_STATE NAME=loading_filament
	M117 Loading Filament
	M83
	G92 E0.0
	G91
	G1 E50 F200
	G92 E50
	RESTORE_GCODE_STATE NAME=loading_filament

[gcode_macro Unload_Filament]
gcode = 
	SAVE_GCODE_STATE NAME=unloading_filament
	M117 Unloading Filament
	G91
	G1 E5 F100
	G92 E0.0
	G1 E-50 F5000
	G92 E-50
	RESTORE_GCODE_STATE NAME=unloading_filament

[gcode_macro Filament_Change]
gcode = 
	
	SAVE_GCODE_STATE NAME=filament_change
	
	Unload_Filament
	
	RESPOND TYPE=command MSG="action:prompt_begin Question"
	RESPOND TYPE=command MSG="action:prompt_text Please insert new filament and confirm"
	RESPOND TYPE=command MSG="action:prompt_footer_button CONFIRM|Load_Filament|RESPOND TYPE=command MSG=action:prompt_end"
	RESPOND TYPE=command MSG="action:prompt_footer_button CANCEL|RESPOND TYPE=command MSG=action:prompt_end"
	RESPOND TYPE=command MSG="action:prompt_show"
	
	RESTORE_GCODE_STATE NAME=filament_change

[gcode_macro Calibrate_Hotend_PID]
gcode = 
	PID_CALIBRATE HEATER=extruder TARGET=200

[gcode_macro Calibrate_Bed_PID]
gcode = 
	PID_CALIBRATE HEATER=heater_bed TARGET=60

[gcode_macro Calibrate_Zoffset]
gcode = 
	PROBE_CALIBRATE

[gcode_macro Tram_bed]
gcode = 
	SCREWS_TILT_CALCULATE

[gcode_macro TEST_SPEED]
description = Test for max speed and acceleration parameters for the printer. Procedure: Home -> ReadPositionFromMCU -> MovesToolhead@Vel&Accel -> Home -> ReadPositionfromMCU
gcode = 
	
	{% set speed  = params.SPEED|default(printer.configfile.settings.printer.max_velocity)|int %}
	
	{% set iterations = params.ITERATIONS|default(5)|int %}
	
	{% set accel  = params.ACCEL|default(printer.configfile.settings.printer.max_accel)|int %}
	
	{% set min_cruise_ratio = params.MIN_CRUISE_RATIO|default(0.5)|float %}
	
	{% set bound = params.BOUND|default(20)|int %}
	
	{% set smallpatternsize = SMALLPATTERNSIZE|default(20)|int %}
	
	
	
	{% set x_min = printer.toolhead.axis_minimum.x + bound %}
	{% set x_max = printer.toolhead.axis_maximum.x - bound %}
	{% set y_min = printer.toolhead.axis_minimum.y + bound %}
	{% set y_max = printer.toolhead.axis_maximum.y - bound %}
	
	
	
	{% set x_center = (printer.toolhead.axis_minimum.x|float + printer.toolhead.axis_maximum.x|float ) / 2 %}
	{% set y_center = (printer.toolhead.axis_minimum.y|float + printer.toolhead.axis_maximum.y|float ) / 2 %}
	
	
	{% set x_center_min = x_center - (smallpatternsize/2) %}
	{% set x_center_max = x_center + (smallpatternsize/2) %}
	{% set y_center_min = y_center - (smallpatternsize/2) %}
	{% set y_center_max = y_center + (smallpatternsize/2) %}
	
	
	SAVE_GCODE_STATE NAME=TEST_SPEED
	
	
	{ action_respond_info("TEST_SPEED: starting %d iterations at speed %d, accel %d" % (iterations, speed, accel)) }
	
	
	M400
	G28
	
	{% if printer.configfile.settings.quad_gantry_level %}
	{% if printer.quad_gantry_level.applied == False %}
	QUAD_GANTRY_LEVEL
	G28 Z
	{% endif %}
	{% endif %}
	
	G90
	G1 X{printer.toolhead.axis_maximum.x-50} Y{printer.toolhead.axis_maximum.y-50} F{30*60}
	M400
	G28 X Y
	G0 X{printer.toolhead.axis_maximum.x-1} Y{printer.toolhead.axis_maximum.y-1} F{30*60}
	G4 P1000
	GET_POSITION
	
	
	G0 X{x_min} Y{y_min} Z{bound + 10} F{speed*60}
	
	
	{% if printer.configfile.settings.printer.minimum_cruise_ratio is defined %}
	SET_VELOCITY_LIMIT VELOCITY={speed} ACCEL={accel} MINIMUM_CRUISE_RATIO={min_cruise_ratio}
	{% else %}
	SET_VELOCITY_LIMIT VELOCITY={speed} ACCEL={accel} ACCEL_TO_DECEL={accel / 2}
	{% endif %}
	
	{% for i in range(iterations) %}
	
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_max} Y{y_max} F{speed*60}
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	G0 X{x_min} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	
	
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_min} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	
	
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_max} Y{y_center_max} F{speed*60}
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	G0 X{x_center_min} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	
	
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_min} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	{% endfor %}
	
	
	{% if printer.configfile.settings.printer.minimum_cruise_ratio is defined %}
	SET_VELOCITY_LIMIT VELOCITY={printer.configfile.settings.printer.max_velocity} ACCEL={printer.configfile.settings.printer.max_accel} MINIMUM_CRUISE_RATIO={printer.configfile.settings.printer.minimum_cruise_ratio}
	{% else %}
	SET_VELOCITY_LIMIT VELOCITY={printer.configfile.settings.printer.max_velocity} ACCEL={printer.configfile.settings.printer.max_accel} ACCEL_TO_DECEL={printer.configfile.settings.printer.max_accel_to_decel}
	{% endif %}
	
	
	M400
	G28
	
	G90
	G0 X{printer.toolhead.axis_maximum.x-1} Y{printer.toolhead.axis_maximum.y-1} F{30*60}
	G4 P1000
	GET_POSITION
	
	
	RESTORE_GCODE_STATE NAME=TEST_SPEED

[gcode_macro GET_TIMELAPSE_SETUP]
description = Print the Timelapse setup
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% set output_txt = ["Timelapse Setup:"] %}
	{% set _dummy = output_txt.append("enable: %s" % tl.enable) %}
	{% set _dummy = output_txt.append("park: %s" % tl.park.enable) %}
	{% if tl.park.enable %}
	{% set _dummy = output_txt.append("park position: %s time: %s s" % (tl.park.pos, tl.park.time)) %}
	{% set _dummy = output_txt.append("park cord x:%s y:%s dz:%s" % (tl.park.coord.x, tl.park.coord.y, tl.park.coord.dz)) %}
	{% set _dummy = output_txt.append("travel speed: %s mm/s" % tl.speed.travel) %}
	{% endif %}
	{% set _dummy = output_txt.append("fw_retract: %s" % tl.extruder.fw_retract) %}
	{% if not tl.extruder.fw_retract %}
	{% set _dummy = output_txt.append("retract: %s mm speed: %s mm/s" % (tl.extruder.retract, tl.speed.retract)) %}
	{% set _dummy = output_txt.append("extrude: %s mm speed: %s mm/s" % (tl.extruder.extrude, tl.speed.extrude)) %}
	{% endif %}
	{% set _dummy = output_txt.append("verbose: %s" % tl.verbose) %}
	{action_respond_info(output_txt|join("\n"))}

[gcode_macro _SET_TIMELAPSE_SETUP]
description = Set user parameters for timelapse
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	
	{% set min = printer.toolhead.axis_minimum %}
	{% set max = printer.toolhead.axis_maximum %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	{% set park = {'min'   : {'x': (min.x / 1.42)|round(3) if round_bed else min.x|round(3),
	'y': (min.y / 1.42)|round(3) if round_bed else min.y|round(3)},
	'max'   : {'x': (max.x / 1.42)|round(3) if round_bed else max.x|round(3),
	'y': (max.y / 1.42)|round(3) if round_bed else max.y|round(3)},
	'center': {'x': (max.x-(max.x-min.x)/2)|round(3),
	'y': (max.y-(max.y-min.y)/2)|round(3)}} %}
	
	{% if params.ENABLE %}
	{% if params.ENABLE|lower is in ['true', 'false'] %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=enable VALUE={True if params.ENABLE|lower == 'true' else False}
	{% else %}
	{action_raise_error("ENABLE=%s not supported. Allowed values are [True, False]" % params.ENABLE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.VERBOSE %}
	{% if params.VERBOSE|lower is in ['true', 'false'] %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=verbose VALUE={True if params.VERBOSE|lower == 'true' else False}
	{% else %}
	{action_raise_error("VERBOSE=%s not supported. Allowed values are [True, False]" % params.VERBOSE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_X %}
	{% if params.CUSTOM_POS_X|float >= min.x and params.CUSTOM_POS_X|float <= max.x %}
	{% set _dummy = tl.park.custom.update({'x':params.CUSTOM_POS_X|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_X=%s must be within [%s - %s]" % (params.CUSTOM_POS_X, min.x, max.x))}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_Y %}
	{% if params.CUSTOM_POS_Y|float >= min.y and params.CUSTOM_POS_Y|float <= max.y %}
	{% set _dummy = tl.park.custom.update({'y':params.CUSTOM_POS_Y|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_Y=%s must be within [%s - %s]" % (params.CUSTOM_POS_Y, min.y, max.y))}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_DZ %}
	{% if params.CUSTOM_POS_DZ|float >= min.z and params.CUSTOM_POS_DZ|float <= max.z %}
	{% set _dummy = tl.park.custom.update({'dz':params.CUSTOM_POS_DZ|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_DZ=%s must be within [%s - %s]" % (params.CUSTOM_POS_DZ, min.z, max.z))}
	{% endif %}
	{% endif %}
	{% if params.PARK_ENABLE %}
	{% if params.PARK_ENABLE|lower is in ['true', 'false'] %}
	{% set _dummy = tl.park.update({'enable':True if params.PARK_ENABLE|lower == 'true' else False}) %}
	{% else %}
	{action_raise_error("PARK_ENABLE=%s not supported. Allowed values are [True, False]" % params.PARK_ENABLE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.PARK_POS %}
	{% if params.PARK_POS|lower is in ['center','front_left','front_right','back_left','back_right','custom','x_only','y_only'] %}
	{% set dic = {'center'      : {'x': park.center.x   , 'y': park.center.y   , 'dz': 1                },
	'front_left'  : {'x': park.min.x      , 'y': park.min.y      , 'dz': 0                },
	'front_right' : {'x': park.max.x      , 'y': park.min.y      , 'dz': 0                },
	'back_left'   : {'x': park.min.x      , 'y': park.max.y      , 'dz': 0                },
	'back_right'  : {'x': park.max.x      , 'y': park.max.y      , 'dz': 0                },
	'custom'      : {'x': tl.park.custom.x, 'y': tl.park.custom.y, 'dz': tl.park.custom.dz},
	'x_only'      : {'x': tl.park.custom.x, 'y': 'none'          , 'dz': tl.park.custom.dz},
	'y_only'      : {'x': 'none'          , 'y': tl.park.custom.y, 'dz': tl.park.custom.dz}} %}
	{% set _dummy = tl.park.update({'pos':params.PARK_POS|lower}) %}
	{% set _dummy = tl.park.update({'coord':dic[tl.park.pos]}) %}
	{% else %}
	{action_raise_error("PARK_POS=%s not supported. Allowed values are [CENTER, FRONT_LEFT, FRONT_RIGHT, BACK_LEFT, BACK_RIGHT, CUSTOM, X_ONLY, Y_ONLY]"
	% params.PARK_POS|upper)}
	{% endif %}
	{% endif %}
	{% if params.PARK_TIME %}
	{% if params.PARK_TIME|float >= 0.0 %}
	{% set _dummy = tl.park.update({'time':params.PARK_TIME|float|round(3)}) %}
	{% else %}
	{action_raise_error("PARK_TIME=%s must be a positive number" % params.PARK_TIME)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=park VALUE="{tl.park}"
	{% if params.TRAVEL_SPEED %}
	{% if params.TRAVEL_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'travel':params.TRAVEL_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("TRAVEL_SPEED=%s must be larger than 0" % params.TRAVEL_SPEED)}
	{% endif %}
	{% endif %}
	{% if params.RETRACT_SPEED %}
	{% if params.RETRACT_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'retract':params.RETRACT_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("RETRACT_SPEED=%s must be larger than 0" % params.RETRACT_SPEED)}
	{% endif %}
	{% endif %}
	{% if params.EXTRUDE_SPEED %}
	{% if params.EXTRUDE_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'extrude':params.EXTRUDE_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("EXTRUDE_SPEED=%s must be larger than 0" % params.EXTRUDE_SPEED)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=speed VALUE="{tl.speed}"
	{% if params.EXTRUDE_DISTANCE %}
	{% if params.EXTRUDE_DISTANCE|float >= 0.0 %}
	{% set _dummy = tl.extruder.update({'extrude':params.EXTRUDE_DISTANCE|float|round(3)}) %}
	{% else %}
	{action_raise_error("EXTRUDE_DISTANCE=%s must be specified as positiv number" % params.EXTRUDE_DISTANCE)}
	{% endif %}
	{% endif %}
	{% if params.RETRACT_DISTANCE %}
	{% if params.RETRACT_DISTANCE|float >= 0.0 %}
	{% set _dummy = tl.extruder.update({'retract':params.RETRACT_DISTANCE|float|round(3)}) %}
	{% else %}
	{action_raise_error("RETRACT_DISTANCE=%s must be specified as positiv number" % params.RETRACT_DISTANCE)}
	{% endif %}
	{% endif %}
	{% if params.FW_RETRACT %}
	{% if params.FW_RETRACT|lower is in ['true', 'false'] %}
	{% if 'firmware_retraction' in printer.configfile.settings %}
	{% set _dummy = tl.extruder.update({'fw_retract': True if params.FW_RETRACT|lower == 'true' else False}) %}
	{% else %}
	{% set _dummy = tl.extruder.update({'fw_retract':False}) %}
	{% if params.FW_RETRACT|capitalize == 'True' %}
	{action_raise_error("[firmware_retraction] not defined in printer.cfg. Can not enable fw_retract")}
	{% endif %}
	{% endif %}
	{% else %}
	{action_raise_error("FW_RETRACT=%s not supported. Allowed values are [True, False]" % params.FW_RETRACT|capitalize)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=extruder VALUE="{tl.extruder}"
	{% if printer.configfile.settings['gcode_macro pause'] is defined %}
	{% set _dummy = tl.macro.update({'pause': printer.configfile.settings['gcode_macro pause'].rename_existing}) %}
	{% endif %}
	{% if printer.configfile.settings['gcode_macro resume'] is defined %}
	{% set _dummy = tl.macro.update({'resume': printer.configfile.settings['gcode_macro resume'].rename_existing}) %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=macro VALUE="{tl.macro}"

[gcode_macro TIMELAPSE_TAKE_FRAME]
description = Take Timelapse shoot
variable_enable = False
variable_takingframe = False
variable_park = {'enable': False,
	'pos'   : 'center',
	'time'  : 0.1,
	'custom': {'x': 0, 'y': 0, 'dz': 0},
	'coord' : {'x': 0, 'y': 0, 'dz': 0}}
variable_extruder = {'fw_retract': False,
	'retract': 1.0,
	'extrude': 1.0}
variable_speed = {'travel': 100,
	'retract': 15,
	'extrude': 15}
variable_verbose = True
variable_check_time = 0.5
variable_restore = {'absolute': {'coordinates': True, 'extrude': True}, 'speed': 1500, 'e':0, 'factor': {'speed': 1.0, 'extrude': 1.0}}
variable_macro = {'pause': 'PAUSE', 'resume': 'RESUME'}
variable_is_paused = False
gcode = 
	{% set hyperlapse = True if params.HYPERLAPSE and params.HYPERLAPSE|lower =='true' else False %}
	{% if enable %}
	{% if (hyperlapse and printer['gcode_macro HYPERLAPSE'].run) or
	(not hyperlapse and not printer['gcode_macro HYPERLAPSE'].run) %}
	{% if park.enable %}
	{% set pos = {'x': 'X' + park.coord.x|string if park.pos != 'y_only' else '',
	'y': 'Y' + park.coord.y|string if park.pos != 'x_only' else '',
	'z': 'Z'+ [printer.gcode_move.gcode_position.z + park.coord.dz, printer.toolhead.axis_maximum.z]|min|string} %}
	{% set restore = {'absolute': {'coordinates': printer.gcode_move.absolute_coordinates,
	'extrude'    : printer.gcode_move.absolute_extrude},
	'speed'   : printer.gcode_move.speed,
	'e'       : printer.gcode_move.gcode_position.e,
	'factor'  : {'speed'  : printer.gcode_move.speed_factor,
	'extrude': printer.gcode_move.extrude_factor}} %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=restore VALUE="{restore}"
	{% if not printer[printer.toolhead.extruder].can_extrude %}
	{% if verbose %}{action_respond_info("Timelapse: Warning, minimum extruder temperature not reached!")}{% endif %}
	{% else %}
	{% if extruder.fw_retract %}
	G10
	{% else %}
	M83
	G0 E-{extruder.retract} F{speed.retract * 60}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=is_paused VALUE=True
	{macro.pause}
	SET_GCODE_OFFSET X=0 Y=0
	G90
	{% if "xyz" not in printer.toolhead.homed_axes %}
	{% if verbose %}{action_respond_info("Timelapse: Warning, axis not homed yet!")}{% endif %}
	{% else %}
	G0 {pos.x} {pos.y} {pos.z} F{speed.travel * 60}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=takingframe VALUE=True
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_TAKE_FRAME DURATION={check_time}
	M400
	{% endif %}
	_TIMELAPSE_NEW_FRAME HYPERLAPSE={hyperlapse}
	{% endif %}
	{% else %}
	{% if verbose %}{action_respond_info("Timelapse: disabled, take frame ignored")}{% endif %}
	{% endif %}

[gcode_macro _TIMELAPSE_NEW_FRAME]
description = action call for timelapse shoot. must be a seperate macro
gcode = 
	{action_call_remote_method("timelapse_newframe",
	macropark=printer['gcode_macro TIMELAPSE_TAKE_FRAME'].park,
	hyperlapse=params.HYPERLAPSE)}

[delayed_gcode _WAIT_TIMELAPSE_TAKE_FRAME]
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% set factor = {'speed': printer.gcode_move.speed_factor, 'extrude': printer.gcode_move.extrude_factor} %}
	{% if tl.takingframe %}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_TAKE_FRAME DURATION={tl.check_time}
	{% else %}
	{tl.macro.resume} VELOCITY={tl.speed.travel}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=is_paused VALUE=False
	{% if not printer[printer.toolhead.extruder].can_extrude %}
	{action_respond_info("Timelapse: Warning minimum extruder temperature not reached!")}
	{% else %}
	{% if tl.extruder.fw_retract %}
	G11
	{% else %}
	G0 E{tl.extruder.extrude} F{tl.speed.extrude * 60}
	G0 F{tl.restore.speed}
	{% if tl.restore.absolute.extrude %}
	M82
	G92 E{tl.restore.e}
	{% endif %}
	{% endif %}
	{% endif %}
	{% if tl.restore.factor.speed   != factor.speed   %} M220 S{(factor.speed*100)|round(0)}   {% endif %}
	{% if tl.restore.factor.extrude != factor.extrude %} M221 S{(factor.extrude*100)|round(0)} {% endif %}
	{% if not tl.restore.absolute.coordinates %} G91 {% endif %}
	{% endif %}

[gcode_macro HYPERLAPSE]
description = Start/Stop a hyperlapse recording
variable_cycle = 0
variable_run = False
gcode = 
	{% set cycle = params.CYCLE|default(30)|int %}
	{% if params.ACTION and params.ACTION|lower == 'start' %}
	{action_respond_info("Hyperlapse: frames started (Cycle %d sec)" % cycle)}
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=run VALUE=True
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=cycle VALUE={cycle}
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION={cycle}
	TIMELAPSE_TAKE_FRAME HYPERLAPSE=True
	{% elif params.ACTION and params.ACTION|lower == 'stop' %}
	{% if run %}{action_respond_info("Hyperlapse: frames stopped")}{% endif %}
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=run VALUE=False
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION=0
	{% else %}
	{action_raise_error("Hyperlapse: No valid input parameter
	Use:
	- HYPERLAPSE ACTION=START [CYCLE=time]
	- HYPERLAPSE ACTION=STOP")}
	{% endif %}

[delayed_gcode _HYPERLAPSE_LOOP]
gcode = 
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION={printer["gcode_macro HYPERLAPSE"].cycle}
	TIMELAPSE_TAKE_FRAME HYPERLAPSE=True

[gcode_macro TIMELAPSE_RENDER]
description = Render Timelapse video and wait for the result
variable_render = False
variable_run_identifier = 0
gcode = 
	{action_respond_info("Timelapse: Rendering started")}
	{action_call_remote_method("timelapse_render", byrendermacro="True")}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_RENDER VARIABLE=render VALUE=True
	{printer.configfile.settings['gcode_macro pause'].rename_existing}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_RENDER DURATION=0.5

[delayed_gcode _WAIT_TIMELAPSE_RENDER]
gcode = 
	{% set ri = printer['gcode_macro TIMELAPSE_RENDER'].run_identifier % 4 %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_RENDER VARIABLE=run_identifier VALUE={ri + 1}
	{% if printer['gcode_macro TIMELAPSE_RENDER'].render %}
	M117 Rendering {['-','\\','|','/'][ri]}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_RENDER DURATION=0.5
	{% else %}
	{action_respond_info("Timelapse: Rendering finished")}
	M117
	{printer.configfile.settings['gcode_macro resume'].rename_existing}
	{% endif %}

[gcode_macro TEST_STREAM_DELAY]
description = Helper macro to find stream and park delay
gcode = 
	{% set min = printer.toolhead.axis_minimum %}
	{% set max = printer.toolhead.axis_maximum %}
	{% set act = printer.toolhead.position %}
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% if act.z > 5.0 %}
	G0 X{min.x + 5.0} F{tl.speed.travel|int * 60}
	G0 X{(max.x-min.x)/2}
	G4 P{tl.park.time|float * 1000}
	_TIMELAPSE_NEW_FRAME HYPERLAPSE=FALSE
	G0 X{max.x - 5.0}
	{% else %}
	{action_raise_error("Toolhead z %.3f to low. Please place head above z = 5.0" % act.z)}
	{% endif %}

[gcode_macro _OBICO_LAYER_CHANGE]
description = Run a scan across the current print area
variable_first_layer_scan_retract_length = 6
variable_first_layer_scan_retract_speed = 15
variable_first_layer_scan_cooldown_temp = 170
variable_first_layer_scan_resume_speed = 50
variable_first_layer_scan_enabled = True
variable_first_layer_scan_stepover = 10
variable_first_layer_scan_speed = 10
variable_first_layer_scan_zhop = 4
variable_first_layer_scan_zhop_speed = 15
variable_verbose = False
variable_current_layer = -1
variable_first_layer_scanning = False
variable_wait = {'resume': "RESUME", 'absolute_coordinates': True, 'absolute_extrude': True, 'e': 0.0, 'previous_temp': 0}
gcode = 
	
	{% set pause_macro  = "PAUSE"  if printer.configfile.settings['gcode_macro pause']  is not defined
	else printer.configfile.settings['gcode_macro pause'].rename_existing %}
	{% set resume_macro = "RESUME" if printer.configfile.settings['gcode_macro resume'] is not defined
	else printer.configfile.settings['gcode_macro resume'].rename_existing %}
	
	{% set current_layer_default = printer.print_stats.info.current_layer if printer.print_stats.info.current_layer is not none else -1 %}
	{% set current_layer = params.CURRENT_LAYER|default(current_layer_default)|int %}
	
	{% set polygon_points = printer.exclude_object.objects|map(attribute='polygon')|sum(start=[]) if printer.exclude_object is defined else [] %}
	{% set min_x = params.MINX|default(polygon_points|map(attribute=0)|min|default(printer.toolhead.axis_minimum.x))|float %}
	{% set min_y = params.MINY|default(polygon_points|map(attribute=1)|min|default(printer.toolhead.axis_minimum.y))|float %}
	{% set max_x = params.MAXX|default(polygon_points|map(attribute=0)|max|default(printer.toolhead.axis_maximum.x))|float %}
	{% set max_y = params.MAXY|default(polygon_points|map(attribute=1)|max|default(printer.toolhead.axis_maximum.y))|float %}
	
	{% set stepoverCount = ((max_y - min_y) / first_layer_scan_stepover|float)|round(method='ceil')|int %}
	
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Layer %d" % (current_layer)}' {% endif %}
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=current_layer VALUE={current_layer}
	
	{% if first_layer_scan_enabled and current_layer == 2 %}
	
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=first_layer_scanning VALUE=True
	
	
	{% set wait_dic = {'resume'              : resume_macro,
	'absolute_coordinates': printer.gcode_move.absolute_coordinates,
	'absolute_extrude'    : printer.gcode_move.absolute_extrude,
	'e'                   : printer.gcode_move.gcode_position.e,
	'previous_temp'       : printer.extruder.target} %}
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=wait VALUE="{wait_dic}"
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Prepare scanning" {% endif %}
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Scan Coordinates: Min:[%.3f:%.3f] Max:[%.3f:%.3f]" % (min_x,min_y,max_x,max_y)}' {% endif %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Retract %.1fmm filament" % first_layer_scan_retract_length|abs}' {% endif %}
	M83
	G0 E-{first_layer_scan_retract_length|abs} F{first_layer_scan_retract_speed|float * 60}
	{% endif %}
	G91
	G0 Z{first_layer_scan_zhop|abs} F{first_layer_scan_zhop_speed|float * 60}
	
	
	M106 S255
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Fan on and lowering temperature to %.1f" % first_layer_scan_cooldown_temp}' {% endif %}
	M104 S{first_layer_scan_cooldown_temp}
	M109 S{first_layer_scan_cooldown_temp}
	
	{pause_macro}
	
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Start scanning" {% endif %}
	
	UPDATE_DELAYED_GCODE ID=_WAIT_OBICO_LAYER_CHANGE DURATION=1.0
	G90
	G0 X{min_x} Y{min_y} F{first_layer_scan_resume_speed|float * 60}
	{% for ystep in range(stepoverCount) %}
	G0 Y{min_y + first_layer_scan_stepover|float * ystep} F{first_layer_scan_speed|float * 60}
	G0 X{max_x if ystep % 2 == 0 else min_x}              F{first_layer_scan_speed|float * 60}
	{% endfor %}
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Finish scanning" {% endif %}
	
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=first_layer_scanning VALUE=False
	
	{% endif %}

[delayed_gcode _WAIT_OBICO_LAYER_CHANGE]
gcode = 
	{% set lc_macro = printer['gcode_macro _OBICO_LAYER_CHANGE'] %}
	{% if lc_macro.first_layer_scanning %}
	
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Waiting for first layer scan..." {% endif %}
	UPDATE_DELAYED_GCODE ID=_WAIT_OBICO_LAYER_CHANGE DURATION=1.0
	{% else %}
	
	M107
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Fan off and resume print" {% endif %}
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Call %s VELOCITY=%.1f" % (lc_macro.wait.resume, lc_macro.first_layer_scan_resume_speed)}' {% endif %}
	{lc_macro.wait.resume} VELOCITY={lc_macro.first_layer_scan_resume_speed}
	G91
	G0 Z-{lc_macro.first_layer_scan_zhop|abs} F{lc_macro.first_layer_scan_zhop_speed|float * 60}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% set first_layer_scan_unretract_length = lc_macro.first_layer_scan_retract_length + 0.5 %}
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Extrude %.1fmm filament" % first_layer_scan_unretract_length|abs}' {% endif %}
	M83
	G0 E{first_layer_scan_unretract_length|abs} F{lc_macro.first_layer_scan_retract_speed|float * 60}
	{% endif %}
	
	
	M104 S{lc_macro.wait.previous_temp}
	M109 S{lc_macro.wait.previous_temp}
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Heating back up to previous temperature"}' {% endif %}
	
	
	{% if lc_macro.wait.absolute_coordinates %} G90 {% endif %}
	{% if lc_macro.wait.absolute_extrude %}
	M82
	G92 E{lc_macro.wait.e}
	{% endif %}
	{% endif %}

[gcode_macro OBICO_LINK_STATUS]
description = Link to Obico server
variable_one_time_passcode = ''
variable_one_time_passlink = ''
variable_is_linked = False
gcode = 
	{action_respond_info('Obico one_time_passcode: {}'.format(one_time_passcode))}
	{action_respond_info('Obico one_time_passlink: {}'.format(one_time_passlink))}
	{action_respond_info('Obico is_linked: {}'.format(is_linked))}
	{% if not is_linked and one_time_passcode != '' %}
	M117 Code: {one_time_passcode}
	{% else %}
	M117 Obico linked
	{% endif %}

[gcode_macro _OBICO_RELINK]
description = Re-link to Obico server
gcode = 
	{action_respond_info('WARNING: Re-link to Obico server')}
	{action_call_remote_method("obico_remote_event", event_name='relink_obico', message='')}
	{action_respond_info('WARNING: relink_obico requested')}

[exclude_object]

[mcu]
serial = /dev/serial/by-id/usb-1a86_USB_Serial-if00-port0
restart_method = command

[temperature_sensor raspberry_pi]
sensor_type = temperature_host
min_temp = 10
max_temp = 100

[temperature_sensor mcu_temp]
sensor_type = temperature_mcu
min_temp = 0
max_temp = 100

[printer]
kinematics = cartesian
max_velocity = 200
max_accel = 4000
max_z_velocity = 10
max_z_accel = 100
minimum_cruise_ratio = 0.5
square_corner_velocity = 5

[stepper_x]
step_pin = PB9
dir_pin = PC2
enable_pin = !PC3
microsteps = 16
rotation_distance = 40
endstop_pin = ^PA5
position_endstop = 0
position_max = 230
homing_speed = 50

[stepper_y]
step_pin = PB7
dir_pin = PB8
enable_pin = !PC3
microsteps = 16
rotation_distance = 40
endstop_pin = ^PA6
position_endstop = 0
position_max = 231
homing_speed = 50

[stepper_z]
step_pin = PB5
dir_pin = !PB6
enable_pin = !PC3
microsteps = 16
rotation_distance = 8
endstop_pin = probe:z_virtual_endstop
position_max = 250
position_min = -4
homing_speed = 4
second_homing_speed = 1
homing_retract_dist = 2.0

[fan]
pin = PA0

[extruder]
max_extrude_only_distance = 100.0
step_pin = PB3
dir_pin = PB4
enable_pin = !PC3
microsteps = 16
gear_ratio = 42:12
rotation_distance = 26.359
nozzle_diameter = 0.400
filament_diameter = 1.750
heater_pin = PA1
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PC5
min_temp = 0
max_temp = 300
min_extrude_temp = 170
pressure_advance = .0369
pressure_advance_smooth_time = 0.04
control = pid
pid_kp = 19.195
pid_ki = 1.000
pid_kd = 92.135

[firmware_retraction]
retract_length = 0.3
retract_speed = 20

[idle_timeout]
gcode = 
	{% if printer.pause_resume.is_paused %}
	M118 Idle timeout while paused, turning off hotend
	SET_HEATER_TEMPERATURE HEATER=extruder TARGET=0
	{% else %}
	M118 Idle timeout
	TURN_OFF_HEATERS
	M84
	{% endif %}
timeout = 1800

[heater_bed]
heater_pin = PA2
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PC4
min_temp = 0
max_temp = 130
control = pid
pid_kp = 68.601
pid_ki = 1.185
pid_kd = 993.000

[bltouch]
sensor_pin = ^PB1
control_pin = PB0
x_offset = -31.8
y_offset = -40.5
speed = 35
samples = 2
samples_result = median
samples_tolerance = 0.05
samples_tolerance_retries = 2
sample_retract_dist = 5.0
probe_with_touch_mode = true
stow_on_each_sample = false
z_offset = 2.049

[safe_z_home]
home_xy_position = 147, 154
speed = 75
z_hop = 10
z_hop_speed = 5
move_to_previous = false

[bed_screws]
screw1 = 30,51
screw1_name = "FL"
screw2 = 200,51
screw2_name = "FR"
screw3 = 200,195
screw3_name = "RR"
screw4 = 30,195
screw4_name = "RL"

[screws_tilt_adjust]
screw1 = 67, 67
screw1_name = front left screw
screw2 = 230, 67
screw2_name = front right screw
screw3 = 230, 230
screw3_name = rear right screw
screw4 = 67.60, 230
screw4_name = rear left screw
horizontal_move_z = 10
speed = 200
screw_thread = CW-M4

[bed_mesh]
speed = 120
mesh_min = 10,11
mesh_max = 195,182
probe_count = 3,3
algorithm = bicubic
fade_start = 1
fade_end = 10
fade_target = 0

[filament_motion_sensor SFS_T0]
detection_length = 150.00
extruder = extruder
switch_pin = PA4
pause_on_runout = True
event_delay = 3.0
pause_delay = 0.5
runout_gcode = 
	M117 Runout Detected!

[delayed_gcode DISABLEFILAMENTSENSOR]
initial_duration = 1
gcode = 
	SET_FILAMENT_SENSOR SENSOR=SFS_T0 ENABLE=0

[gcode_macro SFS_ENABLE]
description = Enable smart filament sensor
gcode = 
	M117 ENABLING the Smart Filament Sensor
	G92 E0
	SET_FILAMENT_SENSOR SENSOR=SFS_T0 ENABLE=1

[gcode_macro SFS_DISABLE]
description = Disable smart filament sensor
gcode = 
	M117 DISABLING the Smart Filament Sensor
	G92 E0
	SET_FILAMENT_SENSOR SENSOR=SFS_T0 ENABLE=0

[gcode_macro FILAMENT_RUNOUT]
gcode = 
	M117 Runout Detected!
	M300 S1 P10
	M600
	M300 S1 P10

[gcode_macro M300]
gcode = 
	{% set S = params.S|default(1000)|int %}
	{% set P = params.P|default(100)|int %}
	SET_PIN PIN=BEEPER VALUE=0.5 CYCLE_TIME={ 1.0/S if S > 0 else 1 }
	G4 P{P}
	SET_PIN PIN=BEEPER VALUE=0
	[gcode_macro M600]
	gcode:
	{% set X = params.X|default(25)|float %}
	{% set Y = params.Y|default(25)|float %}
	{% set Z = params.Z|default(10)|float %}
	SAVE_GCODE_STATE NAME=M600_state
	PAUSE
	G91
	G1 E-.8 F2700
	G1 Z{Z}
	G90
	G1 X{X} Y{Y} F3000
	G91
	G1 E-15 F1000
	RESTORE_GCODE_STATE NAME=M600_state

[gcode_arcs]
resolution = 1.0

[input_shaper]
shaper_freq_x = 73.5
shaper_type_x = ei
shaper_freq_y = 76.9
shaper_type_y = mzv
=======================
bed_mesh: bicubic interpolation with a probe_count of less than 4 points detected.  Forcing lagrange interpolation. Configured Probe Count: 3, 3
Extruder max_extrude_ratio=0.266081
mcu 'mcu': Starting serial connect
mcu 'mcu': got {'oid': 10, 'next_clock': 2441410560, 'value': 14012, '#name': 'analog_in_state', '#sent_time': 45.93217988, '#receive_time': 45.972683324}
mcu 'mcu': got {'oid': 12, 'next_clock': 2442850560, 'value': 31554, '#name': 'analog_in_state', '#sent_time': 45.986191954, '#receive_time': 45.992598546}
mcu 'mcu': got {'oid': 17, 'next_clock': 2446450560, 'value': 31504, '#name': 'analog_in_state', '#sent_time': 45.986191954, '#receive_time': 46.043352046}
mcu 'mcu': got {'count': 187, 'sum': 370582, 'sumsq': 3480336, '#name': 'stats', '#sent_time': 46.096014472, '#receive_time': 46.098951083}
mcu 'mcu': got {'oid': 10, 'next_clock': 2463010560, 'value': 14011, '#name': 'analog_in_state', '#sent_time': 46.259696509, '#receive_time': 46.272523509}
mcu 'mcu': got {'oid': 12, 'next_clock': 2464450560, 'value': 31559, '#name': 'analog_in_state', '#sent_time': 46.259696509, '#receive_time': 46.292664102}
mcu 'mcu': got {'oid': 17, 'next_clock': 2468050560, 'value': 31500, '#name': 'analog_in_state', '#sent_time': 46.313851213, '#receive_time': 46.342657694}
Loaded MCU 'mcu' 119 commands (v0.12.0-286-g81de9a861 / gcc: (15:8-2019-q3-1+b1) 8.3.1 20190703 (release) [gcc-8-branch revision 273027] binutils: (2.35.2-2+14+b2) 2.35.2)
MCU 'mcu' config: ADC_MAX=4095 BUS_PINS_i2c1=PB6,PB7 BUS_PINS_i2c1a=PB8,PB9 BUS_PINS_i2c2=PB10,PB11 BUS_PINS_spi1=PA6,PA7,PA5 BUS_PINS_spi1a=PB4,PB5,PB3 BUS_PINS_spi2=PB14,PB15,PB13 BUS_PINS_spi3=PB4,PB5,PB3 CLOCK_FREQ=72000000 MCU=stm32f103xe PWM_MAX=255 RECEIVE_WINDOW=192 RESERVE_PINS_serial=PA10,PA9 SERIAL_BAUD=250000 STATS_SUMSQ_BASE=256 STEPPER_BOTH_EDGE=1
mcu_temperature 'mcu' nominal base=357.558140 slope=-767.441860
Configured MCU 'mcu' (1024 moves)
Starting heater checks for heater_bed
webhooks client 547875842032: New connection
bed_mesh: generated points
Index |  Tool Adjusted  |   Probe
  0   | (41.8, 51.5)    | (10.0, 11.0)
  1   | (134.3, 51.5)   | (102.5, 11.0)
  2   | (226.8, 51.5)   | (195.0, 11.0)
  3   | (226.8, 137.0)  | (195.0, 96.5)
  4   | (134.3, 137.0)  | (102.5, 96.5)
  5   | (41.8, 137.0)   | (10.0, 96.5)
  6   | (41.8, 222.5)   | (10.0, 182.0)
  7   | (134.3, 222.5)  | (102.5, 182.0)
  8   | (226.8, 222.5)  | (195.0, 182.0)
Starting heater checks for extruder
Stats 47.4: gcodein=0  mcu: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=1091 bytes_read=4590 bytes_retransmit=9 bytes_invalid=0 send_seq=105 receive_seq=105 retransmit_seq=2 srtt=0.003 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72001498  raspberry_pi: temp=52.1 mcu_temp: temp=0.0 heater_bed: target=0 temp=0.0 pwm=0.000 sysload=1.52 cputime=1.866 memavail=1513092 print_time=112778.181 buffer_time=0.249 print_stall=0 extruder: target=0 temp=0.0 pwm=0.000
webhooks client 547875842032: Client info {'program': 'Moonraker', 'version': 'v0.9.3-3-gccfe32f'}
webhooks: registering remote method 'shutdown_machine' for connection id: 547875842032
webhooks: registering remote method 'reboot_machine' for connection id: 547875842032
webhooks: registering remote method 'pause_job_queue' for connection id: 547875842032
webhooks: registering remote method 'start_job_queue' for connection id: 547875842032
webhooks: registering remote method 'obico_remote_event' for connection id: 547875842032
Stats 48.4: gcodein=0  mcu: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=1097 bytes_read=4741 bytes_retransmit=9 bytes_invalid=0 send_seq=106 receive_seq=106 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72002240  raspberry_pi: temp=52.6 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.52 cputime=1.904 memavail=1511312 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 49.4: gcodein=0  mcu: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=1103 bytes_read=4922 bytes_retransmit=9 bytes_invalid=0 send_seq=107 receive_seq=107 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72001167  raspberry_pi: temp=52.6 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.52 cputime=1.920 memavail=1500488 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 50.4: gcodein=0  mcu: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=1109 bytes_read=5088 bytes_retransmit=9 bytes_invalid=0 send_seq=108 receive_seq=108 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000612  raspberry_pi: temp=51.6 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.72 cputime=1.931 memavail=1501400 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 51.4: gcodein=0  mcu: mcu_awake=0.003 mcu_task_avg=0.000021 mcu_task_stddev=0.000015 bytes_write=1115 bytes_read=5254 bytes_retransmit=9 bytes_invalid=0 send_seq=109 receive_seq=109 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000422  raspberry_pi: temp=51.1 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.72 cputime=1.940 memavail=1499516 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 52.4: gcodein=0  mcu: mcu_awake=0.003 mcu_task_avg=0.000021 mcu_task_stddev=0.000015 bytes_write=1121 bytes_read=5435 bytes_retransmit=9 bytes_invalid=0 send_seq=110 receive_seq=110 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000377  raspberry_pi: temp=50.6 mcu_temp: temp=29.4 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.72 cputime=1.951 memavail=1484856 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 53.4: gcodein=0  mcu: mcu_awake=0.003 mcu_task_avg=0.000021 mcu_task_stddev=0.000015 bytes_write=1127 bytes_read=5601 bytes_retransmit=9 bytes_invalid=0 send_seq=111 receive_seq=111 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000365  raspberry_pi: temp=50.6 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.72 cputime=1.964 memavail=1488608 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 54.4: gcodein=0  mcu: mcu_awake=0.003 mcu_task_avg=0.000021 mcu_task_stddev=0.000015 bytes_write=1133 bytes_read=5752 bytes_retransmit=9 bytes_invalid=0 send_seq=112 receive_seq=112 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000336  raspberry_pi: temp=50.1 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.72 cputime=1.976 memavail=1488112 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 55.4: gcodein=0  mcu: mcu_awake=0.003 mcu_task_avg=0.000021 mcu_task_stddev=0.000015 bytes_write=1139 bytes_read=5933 bytes_retransmit=9 bytes_invalid=0 send_seq=113 receive_seq=113 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000332  raspberry_pi: temp=50.1 mcu_temp: temp=29.4 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.58 cputime=1.990 memavail=1488112 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 56.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1145 bytes_read=6113 bytes_retransmit=9 bytes_invalid=0 send_seq=114 receive_seq=114 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000327  raspberry_pi: temp=50.1 mcu_temp: temp=29.4 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.58 cputime=2.003 memavail=1487636 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 57.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1151 bytes_read=6264 bytes_retransmit=9 bytes_invalid=0 send_seq=115 receive_seq=115 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000289  raspberry_pi: temp=50.6 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.58 cputime=2.015 memavail=1487144 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 58.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1157 bytes_read=6445 bytes_retransmit=9 bytes_invalid=0 send_seq=116 receive_seq=116 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000318  raspberry_pi: temp=50.6 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.58 cputime=2.029 memavail=1487144 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 59.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1163 bytes_read=6611 bytes_retransmit=9 bytes_invalid=0 send_seq=117 receive_seq=117 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000296  raspberry_pi: temp=49.7 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=1.58 cputime=2.043 memavail=1487144 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 60.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1169 bytes_read=6762 bytes_retransmit=9 bytes_invalid=0 send_seq=118 receive_seq=118 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000287  raspberry_pi: temp=49.7 mcu_temp: temp=29.4 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.62 cputime=2.056 memavail=1487144 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 61.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1175 bytes_read=6957 bytes_retransmit=9 bytes_invalid=0 send_seq=119 receive_seq=119 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000277  raspberry_pi: temp=51.6 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=1.62 cputime=2.070 memavail=1489744 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 62.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1181 bytes_read=7123 bytes_retransmit=9 bytes_invalid=0 send_seq=120 receive_seq=120 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000282  raspberry_pi: temp=49.2 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.62 cputime=2.083 memavail=1489744 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 63.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1187 bytes_read=7274 bytes_retransmit=9 bytes_invalid=0 send_seq=121 receive_seq=121 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000275  raspberry_pi: temp=49.2 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.62 cputime=2.095 memavail=1489744 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 64.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1193 bytes_read=7455 bytes_retransmit=9 bytes_invalid=0 send_seq=122 receive_seq=122 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000279  raspberry_pi: temp=49.2 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=1.62 cputime=2.111 memavail=1489744 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 65.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1199 bytes_read=7621 bytes_retransmit=9 bytes_invalid=0 send_seq=123 receive_seq=123 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000265  raspberry_pi: temp=49.7 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.73 cputime=2.123 memavail=1489744 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 66.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1205 bytes_read=7786 bytes_retransmit=9 bytes_invalid=0 send_seq=124 receive_seq=124 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000304  raspberry_pi: temp=49.7 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.73 cputime=2.136 memavail=1489744 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 67.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1211 bytes_read=7967 bytes_retransmit=9 bytes_invalid=0 send_seq=125 receive_seq=125 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000299  raspberry_pi: temp=49.2 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.73 cputime=2.150 memavail=1488756 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 68.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1217 bytes_read=8133 bytes_retransmit=9 bytes_invalid=0 send_seq=126 receive_seq=126 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000284  raspberry_pi: temp=49.2 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.73 cputime=2.163 memavail=1488756 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 69.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1223 bytes_read=8284 bytes_retransmit=9 bytes_invalid=0 send_seq=127 receive_seq=127 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000275  raspberry_pi: temp=49.7 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.73 cputime=2.175 memavail=1488756 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 70.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1229 bytes_read=8465 bytes_retransmit=9 bytes_invalid=0 send_seq=128 receive_seq=128 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000260  raspberry_pi: temp=50.1 mcu_temp: temp=29.4 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=1.75 cputime=2.186 memavail=1487428 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 71.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1235 bytes_read=8625 bytes_retransmit=9 bytes_invalid=0 send_seq=129 receive_seq=129 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000244  raspberry_pi: temp=49.7 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.75 cputime=2.194 memavail=1487436 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 72.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1241 bytes_read=8780 bytes_retransmit=9 bytes_invalid=0 send_seq=130 receive_seq=130 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000230  raspberry_pi: temp=50.1 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=1.75 cputime=2.202 memavail=1487436 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 73.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1247 bytes_read=8949 bytes_retransmit=9 bytes_invalid=0 send_seq=131 receive_seq=131 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000222  raspberry_pi: temp=51.1 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.75 cputime=2.210 memavail=1486936 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 74.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1253 bytes_read=9104 bytes_retransmit=9 bytes_invalid=0 send_seq=132 receive_seq=132 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000210  raspberry_pi: temp=50.6 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.75 cputime=2.219 memavail=1482948 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 75.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1259 bytes_read=9255 bytes_retransmit=9 bytes_invalid=0 send_seq=133 receive_seq=133 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000202  raspberry_pi: temp=49.7 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.77 cputime=2.230 memavail=1480280 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 76.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1265 bytes_read=9436 bytes_retransmit=9 bytes_invalid=0 send_seq=134 receive_seq=134 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000207  raspberry_pi: temp=49.7 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.77 cputime=2.243 memavail=1480280 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 77.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1271 bytes_read=9616 bytes_retransmit=9 bytes_invalid=0 send_seq=135 receive_seq=135 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000207  raspberry_pi: temp=50.6 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.77 cputime=2.256 memavail=1479056 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 78.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1277 bytes_read=9767 bytes_retransmit=9 bytes_invalid=0 send_seq=136 receive_seq=136 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000203  raspberry_pi: temp=49.7 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.77 cputime=2.268 memavail=1479056 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 79.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1283 bytes_read=9948 bytes_retransmit=9 bytes_invalid=0 send_seq=137 receive_seq=137 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000204  raspberry_pi: temp=49.2 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.77 cputime=2.283 memavail=1479056 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 80.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1289 bytes_read=10114 bytes_retransmit=9 bytes_invalid=0 send_seq=138 receive_seq=138 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000208  raspberry_pi: temp=49.2 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.79 cputime=2.298 memavail=1479056 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 81.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1295 bytes_read=10265 bytes_retransmit=9 bytes_invalid=0 send_seq=139 receive_seq=139 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000210  raspberry_pi: temp=48.7 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.79 cputime=2.311 memavail=1479056 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 82.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1301 bytes_read=10460 bytes_retransmit=9 bytes_invalid=0 send_seq=140 receive_seq=140 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000211  raspberry_pi: temp=49.7 mcu_temp: temp=29.2 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.79 cputime=2.325 memavail=1479056 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 83.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1307 bytes_read=10626 bytes_retransmit=9 bytes_invalid=0 send_seq=141 receive_seq=141 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000209  raspberry_pi: temp=49.7 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.79 cputime=2.339 memavail=1479056 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 84.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1313 bytes_read=10777 bytes_retransmit=9 bytes_invalid=0 send_seq=142 receive_seq=142 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000207  raspberry_pi: temp=48.7 mcu_temp: temp=29.4 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.79 cputime=2.351 memavail=1479056 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 85.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1319 bytes_read=10958 bytes_retransmit=9 bytes_invalid=0 send_seq=143 receive_seq=143 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000208  raspberry_pi: temp=49.2 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.81 cputime=2.365 memavail=1478832 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 86.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1325 bytes_read=11124 bytes_retransmit=9 bytes_invalid=0 send_seq=144 receive_seq=144 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000213  raspberry_pi: temp=49.2 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.81 cputime=2.378 memavail=1478832 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 87.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1331 bytes_read=11289 bytes_retransmit=9 bytes_invalid=0 send_seq=145 receive_seq=145 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000213  raspberry_pi: temp=49.7 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=1.81 cputime=2.391 memavail=1478852 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 88.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1337 bytes_read=11470 bytes_retransmit=9 bytes_invalid=0 send_seq=146 receive_seq=146 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000212  raspberry_pi: temp=49.2 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.81 cputime=2.404 memavail=1478852 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 89.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1343 bytes_read=11636 bytes_retransmit=9 bytes_invalid=0 send_seq=147 receive_seq=147 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000211  raspberry_pi: temp=49.7 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.81 cputime=2.416 memavail=1478852 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 90.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1349 bytes_read=11787 bytes_retransmit=9 bytes_invalid=0 send_seq=148 receive_seq=148 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000209  raspberry_pi: temp=49.2 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.66 cputime=2.430 memavail=1478852 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 91.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1355 bytes_read=11968 bytes_retransmit=9 bytes_invalid=0 send_seq=149 receive_seq=149 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000210  raspberry_pi: temp=49.7 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.66 cputime=2.443 memavail=1478852 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 92.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1361 bytes_read=12148 bytes_retransmit=9 bytes_invalid=0 send_seq=150 receive_seq=150 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000209  raspberry_pi: temp=47.7 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.66 cputime=2.457 memavail=1478852 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 93.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1367 bytes_read=12299 bytes_retransmit=9 bytes_invalid=0 send_seq=151 receive_seq=151 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000210  raspberry_pi: temp=49.2 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.66 cputime=2.471 memavail=1478852 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 94.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1373 bytes_read=12480 bytes_retransmit=9 bytes_invalid=0 send_seq=152 receive_seq=152 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000211  raspberry_pi: temp=49.7 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.66 cputime=2.484 memavail=1478852 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 95.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1379 bytes_read=12646 bytes_retransmit=9 bytes_invalid=0 send_seq=153 receive_seq=153 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000210  raspberry_pi: temp=48.7 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.53 cputime=2.497 memavail=1478852 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 96.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1385 bytes_read=12797 bytes_retransmit=9 bytes_invalid=0 send_seq=154 receive_seq=154 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000209  raspberry_pi: temp=49.2 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=1.53 cputime=2.510 memavail=1478852 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 97.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1391 bytes_read=12992 bytes_retransmit=9 bytes_invalid=0 send_seq=155 receive_seq=155 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000207  raspberry_pi: temp=49.2 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.53 cputime=2.524 memavail=1478640 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 98.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1397 bytes_read=13158 bytes_retransmit=9 bytes_invalid=0 send_seq=156 receive_seq=156 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000207  raspberry_pi: temp=49.2 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=1.53 cputime=2.538 memavail=1478640 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 99.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1403 bytes_read=13309 bytes_retransmit=9 bytes_invalid=0 send_seq=157 receive_seq=157 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000208  raspberry_pi: temp=48.7 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.53 cputime=2.552 memavail=1478640 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 100.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1409 bytes_read=13490 bytes_retransmit=9 bytes_invalid=0 send_seq=158 receive_seq=158 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000207  raspberry_pi: temp=49.2 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.57 cputime=2.565 memavail=1478640 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 101.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1415 bytes_read=13656 bytes_retransmit=9 bytes_invalid=0 send_seq=159 receive_seq=159 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000205  raspberry_pi: temp=49.7 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.57 cputime=2.579 memavail=1478416 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 102.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1421 bytes_read=13821 bytes_retransmit=9 bytes_invalid=0 send_seq=160 receive_seq=160 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000206  raspberry_pi: temp=49.2 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.57 cputime=2.592 memavail=1478416 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 103.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1427 bytes_read=14002 bytes_retransmit=9 bytes_invalid=0 send_seq=161 receive_seq=161 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000205  raspberry_pi: temp=49.7 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.57 cputime=2.605 memavail=1478416 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 104.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1433 bytes_read=14168 bytes_retransmit=9 bytes_invalid=0 send_seq=162 receive_seq=162 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000205  raspberry_pi: temp=49.2 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.57 cputime=2.619 memavail=1478416 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 105.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1439 bytes_read=14319 bytes_retransmit=9 bytes_invalid=0 send_seq=163 receive_seq=163 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000210  raspberry_pi: temp=48.7 mcu_temp: temp=29.4 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=1.52 cputime=2.631 memavail=1478192 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 106.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1445 bytes_read=14500 bytes_retransmit=9 bytes_invalid=0 send_seq=164 receive_seq=164 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000210  raspberry_pi: temp=49.2 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=1.52 cputime=2.643 memavail=1478192 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 107.4: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1457 bytes_read=14696 bytes_retransmit=9 bytes_invalid=0 send_seq=166 receive_seq=166 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000207  raspberry_pi: temp=49.2 mcu_temp: temp=29.4 heater_bed: target=0 temp=20.3 pwm=0.000 sysload=1.52 cputime=2.657 memavail=1480508 print_time=112778.181 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.3 pwm=0.000
Stats 486.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=3767 bytes_read=78521 bytes_retransmit=9 bytes_invalid=0 send_seq=551 receive_seq=551 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000181  raspberry_pi: temp=48.7 mcu_temp: temp=29.3 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=0.79 cputime=7.522 memavail=1474244 print_time=113218.055 buffer_time=0.803 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Attempting MCU 'mcu' reset command
webhooks client 547875842032: Disconnected
Restarting printer
Start printer at Sun Dec 22 19:28:30 2024 (1734913710.3 488.6)
===== Config file =====
[virtual_sdcard]
path = ~/printer_data/gcodes
on_error_gcode = CANCEL_PRINT

[pause_resume]
recover_velocity = 25

[display_status]

[respond]
default_prefix = 

[gcode_macro CANCEL_PRINT]
description = Cancel the actual running print
rename_existing = BASE_CANCEL_PRINT
gcode = 
	G91
	G0 Z10 F600
	G90
	TURN_OFF_HEATERS
	G0 X5 Y220
	CLEAR_PAUSE
	
	BASE_CANCEL_PRINT

[gcode_macro PAUSE]
description = Pause the actual running print
rename_existing = PAUSE_BASE
gcode = 
	
	{% set x = params.X|default(5) %}
	{% set y = params.Y|default(225) %}
	{% set z = params.Z|default(10)|float %}
	{% set e = params.E|default(1) %}
	
	{% set max_z = printer.toolhead.axis_maximum.z|float %}
	{% set act_z = printer.toolhead.position.z|float %}
	{% set lift_z = z|abs %}
	{% if act_z < (max_z - lift_z) %}
	{% set z_safe = lift_z %}
	{% else %}
	{% set z_safe = max_z - act_z %}
	{% endif %}
	
	PAUSE_BASE
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E-{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	{% if "xyz" in printer.toolhead.homed_axes %}
	G1 Z{z_safe}
	G90
	G1 X{x} Y{y} F6000
	{% else %}
	{action_respond_info("Printer not homed")}
	{% endif %}

[gcode_macro RESUME]
description = Resume the actual running print
rename_existing = RESUME_BASE
variable_last_extruder_temp = {'restore': False, 'temp': 0}
variable_restore_idle_timeout = 0
variable_idle_state = False
gcode = 
	
	{% set e = params.E|default(1) %}
	
	{% if 'VELOCITY' in params|upper %}
	{% set get_params = ('VELOCITY=' + params.VELOCITY)  %}
	{%else %}
	{% set get_params = "" %}
	{% endif %}
	
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	RESUME_BASE {get_params}

[gcode_macro SET_PAUSE_NEXT_LAYER]
description = Enable a pause if the next layer is reached
gcode = 
	{% set pause_next_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_next_layer %}
	{% set ENABLE = params.ENABLE|default(1)|int != 0 %}
	{% set MACRO = params.MACRO|default(pause_next_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_next_layer VALUE="{{ 'enable': ENABLE, 'call': MACRO }}"

[gcode_macro SET_PAUSE_AT_LAYER]
description = Enable/disable a pause if a given layer number is reached
gcode = 
	{% set pause_at_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_at_layer %}
	{% set ENABLE = params.ENABLE|int != 0 if params.ENABLE is defined
	else params.LAYER is defined %}
	{% set LAYER = params.LAYER|default(pause_at_layer.layer)|int %}
	{% set MACRO = params.MACRO|default(pause_at_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_at_layer VALUE="{{ 'enable': ENABLE, 'layer': LAYER, 'call': MACRO }}"

[gcode_macro SET_PRINT_STATS_INFO]
rename_existing = SET_PRINT_STATS_INFO_BASE
description = Overwrite, to get pause_next_layer and pause_at_layer feature
variable_pause_next_layer = { 'enable': False, 'call': "PAUSE" }
variable_pause_at_layer = { 'enable': False, 'layer': 0, 'call': "PAUSE" }
gcode = 
	{% if pause_next_layer.enable %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_next_layer" % pause_next_layer.call}'
	{pause_next_layer.call}
	SET_PAUSE_NEXT_LAYER ENABLE=0
	{% elif pause_at_layer.enable and params.CURRENT_LAYER is defined and params.CURRENT_LAYER|int == pause_at_layer.layer %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_at_layer [%d]" % (pause_at_layer.call, pause_at_layer.layer)}'
	{pause_at_layer.call}
	SET_PAUSE_AT_LAYER ENABLE=0
	{% endif %}
	SET_PRINT_STATS_INFO_BASE {rawparams}

[gcode_macro _TOOLHEAD_PARK_PAUSE_CANCEL]
description = Helper: park toolhead used in PAUSE and CANCEL_PRINT
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set velocity = printer.configfile.settings.pause_resume.recover_velocity %}
	{% set use_custom     = client.use_custom_pos|default(false)|lower == 'true' %}
	{% set custom_park_x  = client.custom_park_x|default(0.0) %}
	{% set custom_park_y  = client.custom_park_y|default(0.0) %}
	{% set park_dz        = client.custom_park_dz|default(2.0)|abs %}
	{% set sp_hop         = client.speed_hop|default(15) * 60 %}
	{% set sp_move        = client.speed_move|default(velocity) * 60 %}
	
	{% set origin    = printer.gcode_move.homing_origin %}
	{% set act       = printer.gcode_move.gcode_position %}
	{% set max       = printer.toolhead.axis_maximum %}
	{% set cone      = printer.toolhead.cone_start_z|default(max.z) %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	
	{% set z_min = params.Z_MIN|default(0)|float %}
	{% set z_park = [[(act.z + park_dz), z_min]|max, (max.z - origin.z)]|min %}
	{% set x_park = params.X       if params.X is defined
	else custom_park_x  if use_custom
	else 0.0            if round_bed
	else (max.x - 5.0) %}
	{% set y_park = params.Y       if params.Y is defined
	else custom_park_y  if use_custom
	else (max.y - 5.0)  if round_bed and z_park < cone
	else 0.0            if round_bed
	else (max.y - 5.0) %}
	
	_CLIENT_RETRACT
	{% if "xyz" in printer.toolhead.homed_axes %}
	G90
	G1 Z{z_park} F{sp_hop}
	G1 X{x_park} Y{y_park} F{sp_move}
	{% if not printer.gcode_move.absolute_coordinates %} G91 {% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='Printer not homed'
	{% endif %}

[gcode_macro _CLIENT_EXTRUDE]
description = Extrudes, if the extruder is hot enough
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set use_fw_retract = (client.use_fw_retract|default(false)|lower == 'true') and (printer.firmware_retraction is defined) %}
	{% set length = params.LENGTH|default(client.unretract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_unretract)|default(35) %}
	{% set absolute_extrude = printer.gcode_move.absolute_extrude %}
	
	{% if printer.toolhead.extruder != '' %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if use_fw_retract %}
	{% if length < 0 %}
	G10
	{% else %}
	G11
	{% endif %}
	{% else %}
	M83
	G1 E{length} F{(speed|float|abs) * 60}
	{% if absolute_extrude %}
	M82
	{% endif %}
	{% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='{"\"%s\" not hot enough" % printer.toolhead.extruder}'
	{% endif %}
	{% endif %}

[gcode_macro _CLIENT_RETRACT]
description = Retracts, if the extruder is hot enough
gcode = 
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set length = params.LENGTH|default(client.retract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_retract)|default(35) %}
	
	_CLIENT_EXTRUDE LENGTH=-{length|float|abs} SPEED={speed|float|abs}

[gcode_macro _CLIENT_LINEAR_MOVE]
description = Linear move with save and restore of the gcode state
gcode = 
	{% set x_move = "X" ~ params.X if params.X is defined else "" %}
	{% set y_move = "Y" ~ params.Y if params.Y is defined else "" %}
	{% set z_move = "Z" ~ params.Z if params.Z is defined else "" %}
	{% set e_move = "E" ~ params.E if params.E is defined else "" %}
	{% set rate = "F" ~ params.F if params.F is defined else "" %}
	{% set ABSOLUTE = params.ABSOLUTE | default(0) | int != 0 %}
	{% set ABSOLUTE_E = params.ABSOLUTE_E | default(0) | int != 0 %}
	SAVE_GCODE_STATE NAME=_client_movement
	{% if x_move or y_move or z_move %}
	G9{ 0 if ABSOLUTE else 1 }
	{% endif %}
	{% if e_move %}
	M8{ 2 if ABSOLUTE_E else 3 }
	{% endif %}
	G1 { x_move } { y_move } { z_move } { e_move } { rate }
	RESTORE_GCODE_STATE NAME=_client_movement

[gcode_macro play_test]
gcode = 
	RESPOND TYPE=command MSG="action:prompt_begin Question"
	RESPOND TYPE=command MSG="action:prompt_text Do you wont to cancel the print?"
	RESPOND TYPE=command MSG="action:prompt_footer_button continue|RESPOND TYPE=command MSG=action:prompt_end"
	RESPOND TYPE=command MSG="action:prompt_footer_button CANCEL|CANCEL_PRINT|error"
	RESPOND TYPE=command MSG="action:prompt_show"

[gcode_macro PRINT_START]
gcode = 
	START_PRINT {rawparams}

[gcode_macro START_PRINT]
gcode = 
	{% set BED_TEMP = params.BED_TEMP|default(60)|float %}
	{% set EXTRUDER_TEMP = params.EXTRUDER_TEMP|default(190)|float %}
	
	M190 S{BED_TEMP}
	
	G90
	
	G28
	
	RESPOND MSG="Bed Meshing"
	
	
	
	
	
	
	
	
	BED_MESH_CLEAR
	BED_MESH_CALIBRATE ADAPTIVE=1
	
	
	
	
	
	
	
	RESPOND MSG="Heating to print temp"
	M104 S{EXTRUDER_TEMP}
	G0 Z40 F240
	M109 S{EXTRUDER_TEMP}
	RESPOND MSG="Enable Runout Sensor"
	SFS_ENABLE
	RESPOND MSG="Line Purge"
	LINE_PURGE
	RESPOND MSG="Print Started"

[gcode_macro LINE_PURGE]
gcode = 
	G92 E0
	G1 Z2.0 F3000
	G1 X0.1 Y20 Z0.3 F5000.0
	G1 X0.1 Y200.0 Z0.3 F1500.0 E15
	G1 X0.4 Y200.0 Z0.3 F5000.0
	G1 X0.4 Y20 Z0.3 F1500.0 E30
	G92 E0
	G1 Z2.0 F3000
	G1 X5 Y20 Z0.3 F5000.0

[gcode_macro PRINT_END]
gcode = 
	END_PRINT

[gcode_macro END_PRINT]
gcode = 
	
	
	RESPOND MSG="Print Finished"
	G91
	G1 E-.5 Z0.2 F2400
	G1 X5 Y5 F6000
	G1 Z10
	G90
	SFS_DISABLE
	
	G1 X0 Y220 F6000
	M106 S0
	M104 S0
	M140 S0
	
	M84 X Y E

[gcode_macro SET_ACTIVE_SPOOL]
gcode = 
	{% if params.ID %}
	{% set id = params.ID|int %}
	{action_call_remote_method(
	"spoolman_set_active_spool",
	spool_id=id
	)}
	{% else %}
	{action_respond_info("Parameter 'ID' is required")}
	{% endif %}

[gcode_macro CLEAR_ACTIVE_SPOOL]
gcode = 
	{action_call_remote_method(
	"spoolman_set_active_spool",
	spool_id=None
	)}

[gcode_macro G29]
gcode = 
	G28
	BED_MESH_CALIBRATE
	G0 X0 Y0 Z10 F6000
	BED_MESH_PROFILE save=default

[gcode_macro M125]
gcode = 
	SAVE_GCODE_STATE NAME=parking
	M117 Parking toolhead
	G91
	G1 Z10 F600
	G90
	G1 X5 Y225 F4000
	RESTORE_GCODE_STATE NAME=parking

[gcode_macro Load_Filament]
gcode = 
	SAVE_GCODE_STATE NAME=loading_filament
	M117 Loading Filament
	M83
	G92 E0.0
	G91
	G1 E50 F200
	G92 E50
	RESTORE_GCODE_STATE NAME=loading_filament

[gcode_macro Unload_Filament]
gcode = 
	SAVE_GCODE_STATE NAME=unloading_filament
	M117 Unloading Filament
	G91
	G1 E5 F100
	G92 E0.0
	G1 E-50 F5000
	G92 E-50
	RESTORE_GCODE_STATE NAME=unloading_filament

[gcode_macro Filament_Change]
gcode = 
	
	SAVE_GCODE_STATE NAME=filament_change
	
	Unload_Filament
	
	RESPOND TYPE=command MSG="action:prompt_begin Question"
	RESPOND TYPE=command MSG="action:prompt_text Please insert new filament and confirm"
	RESPOND TYPE=command MSG="action:prompt_footer_button CONFIRM|Load_Filament|RESPOND TYPE=command MSG=action:prompt_end"
	RESPOND TYPE=command MSG="action:prompt_footer_button CANCEL|RESPOND TYPE=command MSG=action:prompt_end"
	RESPOND TYPE=command MSG="action:prompt_show"
	
	RESTORE_GCODE_STATE NAME=filament_change

[gcode_macro Calibrate_Hotend_PID]
gcode = 
	PID_CALIBRATE HEATER=extruder TARGET=200

[gcode_macro Calibrate_Bed_PID]
gcode = 
	PID_CALIBRATE HEATER=heater_bed TARGET=60

[gcode_macro Calibrate_Zoffset]
gcode = 
	PROBE_CALIBRATE

[gcode_macro Tram_bed]
gcode = 
	SCREWS_TILT_CALCULATE

[gcode_macro TEST_SPEED]
description = Test for max speed and acceleration parameters for the printer. Procedure: Home -> ReadPositionFromMCU -> MovesToolhead@Vel&Accel -> Home -> ReadPositionfromMCU
gcode = 
	
	{% set speed  = params.SPEED|default(printer.configfile.settings.printer.max_velocity)|int %}
	
	{% set iterations = params.ITERATIONS|default(5)|int %}
	
	{% set accel  = params.ACCEL|default(printer.configfile.settings.printer.max_accel)|int %}
	
	{% set min_cruise_ratio = params.MIN_CRUISE_RATIO|default(0.5)|float %}
	
	{% set bound = params.BOUND|default(20)|int %}
	
	{% set smallpatternsize = SMALLPATTERNSIZE|default(20)|int %}
	
	
	
	{% set x_min = printer.toolhead.axis_minimum.x + bound %}
	{% set x_max = printer.toolhead.axis_maximum.x - bound %}
	{% set y_min = printer.toolhead.axis_minimum.y + bound %}
	{% set y_max = printer.toolhead.axis_maximum.y - bound %}
	
	
	
	{% set x_center = (printer.toolhead.axis_minimum.x|float + printer.toolhead.axis_maximum.x|float ) / 2 %}
	{% set y_center = (printer.toolhead.axis_minimum.y|float + printer.toolhead.axis_maximum.y|float ) / 2 %}
	
	
	{% set x_center_min = x_center - (smallpatternsize/2) %}
	{% set x_center_max = x_center + (smallpatternsize/2) %}
	{% set y_center_min = y_center - (smallpatternsize/2) %}
	{% set y_center_max = y_center + (smallpatternsize/2) %}
	
	
	SAVE_GCODE_STATE NAME=TEST_SPEED
	
	
	{ action_respond_info("TEST_SPEED: starting %d iterations at speed %d, accel %d" % (iterations, speed, accel)) }
	
	
	M400
	G28
	
	{% if printer.configfile.settings.quad_gantry_level %}
	{% if printer.quad_gantry_level.applied == False %}
	QUAD_GANTRY_LEVEL
	G28 Z
	{% endif %}
	{% endif %}
	
	G90
	G1 X{printer.toolhead.axis_maximum.x-50} Y{printer.toolhead.axis_maximum.y-50} F{30*60}
	M400
	G28 X Y
	G0 X{printer.toolhead.axis_maximum.x-1} Y{printer.toolhead.axis_maximum.y-1} F{30*60}
	G4 P1000
	GET_POSITION
	
	
	G0 X{x_min} Y{y_min} Z{bound + 10} F{speed*60}
	
	
	{% if printer.configfile.settings.printer.minimum_cruise_ratio is defined %}
	SET_VELOCITY_LIMIT VELOCITY={speed} ACCEL={accel} MINIMUM_CRUISE_RATIO={min_cruise_ratio}
	{% else %}
	SET_VELOCITY_LIMIT VELOCITY={speed} ACCEL={accel} ACCEL_TO_DECEL={accel / 2}
	{% endif %}
	
	{% for i in range(iterations) %}
	
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_max} Y{y_max} F{speed*60}
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	G0 X{x_min} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	
	
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_min} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	
	
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_max} Y{y_center_max} F{speed*60}
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	G0 X{x_center_min} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	
	
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_min} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	{% endfor %}
	
	
	{% if printer.configfile.settings.printer.minimum_cruise_ratio is defined %}
	SET_VELOCITY_LIMIT VELOCITY={printer.configfile.settings.printer.max_velocity} ACCEL={printer.configfile.settings.printer.max_accel} MINIMUM_CRUISE_RATIO={printer.configfile.settings.printer.minimum_cruise_ratio}
	{% else %}
	SET_VELOCITY_LIMIT VELOCITY={printer.configfile.settings.printer.max_velocity} ACCEL={printer.configfile.settings.printer.max_accel} ACCEL_TO_DECEL={printer.configfile.settings.printer.max_accel_to_decel}
	{% endif %}
	
	
	M400
	G28
	
	G90
	G0 X{printer.toolhead.axis_maximum.x-1} Y{printer.toolhead.axis_maximum.y-1} F{30*60}
	G4 P1000
	GET_POSITION
	
	
	RESTORE_GCODE_STATE NAME=TEST_SPEED

[gcode_macro GET_TIMELAPSE_SETUP]
description = Print the Timelapse setup
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% set output_txt = ["Timelapse Setup:"] %}
	{% set _dummy = output_txt.append("enable: %s" % tl.enable) %}
	{% set _dummy = output_txt.append("park: %s" % tl.park.enable) %}
	{% if tl.park.enable %}
	{% set _dummy = output_txt.append("park position: %s time: %s s" % (tl.park.pos, tl.park.time)) %}
	{% set _dummy = output_txt.append("park cord x:%s y:%s dz:%s" % (tl.park.coord.x, tl.park.coord.y, tl.park.coord.dz)) %}
	{% set _dummy = output_txt.append("travel speed: %s mm/s" % tl.speed.travel) %}
	{% endif %}
	{% set _dummy = output_txt.append("fw_retract: %s" % tl.extruder.fw_retract) %}
	{% if not tl.extruder.fw_retract %}
	{% set _dummy = output_txt.append("retract: %s mm speed: %s mm/s" % (tl.extruder.retract, tl.speed.retract)) %}
	{% set _dummy = output_txt.append("extrude: %s mm speed: %s mm/s" % (tl.extruder.extrude, tl.speed.extrude)) %}
	{% endif %}
	{% set _dummy = output_txt.append("verbose: %s" % tl.verbose) %}
	{action_respond_info(output_txt|join("\n"))}

[gcode_macro _SET_TIMELAPSE_SETUP]
description = Set user parameters for timelapse
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	
	{% set min = printer.toolhead.axis_minimum %}
	{% set max = printer.toolhead.axis_maximum %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	{% set park = {'min'   : {'x': (min.x / 1.42)|round(3) if round_bed else min.x|round(3),
	'y': (min.y / 1.42)|round(3) if round_bed else min.y|round(3)},
	'max'   : {'x': (max.x / 1.42)|round(3) if round_bed else max.x|round(3),
	'y': (max.y / 1.42)|round(3) if round_bed else max.y|round(3)},
	'center': {'x': (max.x-(max.x-min.x)/2)|round(3),
	'y': (max.y-(max.y-min.y)/2)|round(3)}} %}
	
	{% if params.ENABLE %}
	{% if params.ENABLE|lower is in ['true', 'false'] %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=enable VALUE={True if params.ENABLE|lower == 'true' else False}
	{% else %}
	{action_raise_error("ENABLE=%s not supported. Allowed values are [True, False]" % params.ENABLE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.VERBOSE %}
	{% if params.VERBOSE|lower is in ['true', 'false'] %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=verbose VALUE={True if params.VERBOSE|lower == 'true' else False}
	{% else %}
	{action_raise_error("VERBOSE=%s not supported. Allowed values are [True, False]" % params.VERBOSE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_X %}
	{% if params.CUSTOM_POS_X|float >= min.x and params.CUSTOM_POS_X|float <= max.x %}
	{% set _dummy = tl.park.custom.update({'x':params.CUSTOM_POS_X|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_X=%s must be within [%s - %s]" % (params.CUSTOM_POS_X, min.x, max.x))}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_Y %}
	{% if params.CUSTOM_POS_Y|float >= min.y and params.CUSTOM_POS_Y|float <= max.y %}
	{% set _dummy = tl.park.custom.update({'y':params.CUSTOM_POS_Y|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_Y=%s must be within [%s - %s]" % (params.CUSTOM_POS_Y, min.y, max.y))}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_DZ %}
	{% if params.CUSTOM_POS_DZ|float >= min.z and params.CUSTOM_POS_DZ|float <= max.z %}
	{% set _dummy = tl.park.custom.update({'dz':params.CUSTOM_POS_DZ|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_DZ=%s must be within [%s - %s]" % (params.CUSTOM_POS_DZ, min.z, max.z))}
	{% endif %}
	{% endif %}
	{% if params.PARK_ENABLE %}
	{% if params.PARK_ENABLE|lower is in ['true', 'false'] %}
	{% set _dummy = tl.park.update({'enable':True if params.PARK_ENABLE|lower == 'true' else False}) %}
	{% else %}
	{action_raise_error("PARK_ENABLE=%s not supported. Allowed values are [True, False]" % params.PARK_ENABLE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.PARK_POS %}
	{% if params.PARK_POS|lower is in ['center','front_left','front_right','back_left','back_right','custom','x_only','y_only'] %}
	{% set dic = {'center'      : {'x': park.center.x   , 'y': park.center.y   , 'dz': 1                },
	'front_left'  : {'x': park.min.x      , 'y': park.min.y      , 'dz': 0                },
	'front_right' : {'x': park.max.x      , 'y': park.min.y      , 'dz': 0                },
	'back_left'   : {'x': park.min.x      , 'y': park.max.y      , 'dz': 0                },
	'back_right'  : {'x': park.max.x      , 'y': park.max.y      , 'dz': 0                },
	'custom'      : {'x': tl.park.custom.x, 'y': tl.park.custom.y, 'dz': tl.park.custom.dz},
	'x_only'      : {'x': tl.park.custom.x, 'y': 'none'          , 'dz': tl.park.custom.dz},
	'y_only'      : {'x': 'none'          , 'y': tl.park.custom.y, 'dz': tl.park.custom.dz}} %}
	{% set _dummy = tl.park.update({'pos':params.PARK_POS|lower}) %}
	{% set _dummy = tl.park.update({'coord':dic[tl.park.pos]}) %}
	{% else %}
	{action_raise_error("PARK_POS=%s not supported. Allowed values are [CENTER, FRONT_LEFT, FRONT_RIGHT, BACK_LEFT, BACK_RIGHT, CUSTOM, X_ONLY, Y_ONLY]"
	% params.PARK_POS|upper)}
	{% endif %}
	{% endif %}
	{% if params.PARK_TIME %}
	{% if params.PARK_TIME|float >= 0.0 %}
	{% set _dummy = tl.park.update({'time':params.PARK_TIME|float|round(3)}) %}
	{% else %}
	{action_raise_error("PARK_TIME=%s must be a positive number" % params.PARK_TIME)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=park VALUE="{tl.park}"
	{% if params.TRAVEL_SPEED %}
	{% if params.TRAVEL_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'travel':params.TRAVEL_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("TRAVEL_SPEED=%s must be larger than 0" % params.TRAVEL_SPEED)}
	{% endif %}
	{% endif %}
	{% if params.RETRACT_SPEED %}
	{% if params.RETRACT_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'retract':params.RETRACT_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("RETRACT_SPEED=%s must be larger than 0" % params.RETRACT_SPEED)}
	{% endif %}
	{% endif %}
	{% if params.EXTRUDE_SPEED %}
	{% if params.EXTRUDE_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'extrude':params.EXTRUDE_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("EXTRUDE_SPEED=%s must be larger than 0" % params.EXTRUDE_SPEED)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=speed VALUE="{tl.speed}"
	{% if params.EXTRUDE_DISTANCE %}
	{% if params.EXTRUDE_DISTANCE|float >= 0.0 %}
	{% set _dummy = tl.extruder.update({'extrude':params.EXTRUDE_DISTANCE|float|round(3)}) %}
	{% else %}
	{action_raise_error("EXTRUDE_DISTANCE=%s must be specified as positiv number" % params.EXTRUDE_DISTANCE)}
	{% endif %}
	{% endif %}
	{% if params.RETRACT_DISTANCE %}
	{% if params.RETRACT_DISTANCE|float >= 0.0 %}
	{% set _dummy = tl.extruder.update({'retract':params.RETRACT_DISTANCE|float|round(3)}) %}
	{% else %}
	{action_raise_error("RETRACT_DISTANCE=%s must be specified as positiv number" % params.RETRACT_DISTANCE)}
	{% endif %}
	{% endif %}
	{% if params.FW_RETRACT %}
	{% if params.FW_RETRACT|lower is in ['true', 'false'] %}
	{% if 'firmware_retraction' in printer.configfile.settings %}
	{% set _dummy = tl.extruder.update({'fw_retract': True if params.FW_RETRACT|lower == 'true' else False}) %}
	{% else %}
	{% set _dummy = tl.extruder.update({'fw_retract':False}) %}
	{% if params.FW_RETRACT|capitalize == 'True' %}
	{action_raise_error("[firmware_retraction] not defined in printer.cfg. Can not enable fw_retract")}
	{% endif %}
	{% endif %}
	{% else %}
	{action_raise_error("FW_RETRACT=%s not supported. Allowed values are [True, False]" % params.FW_RETRACT|capitalize)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=extruder VALUE="{tl.extruder}"
	{% if printer.configfile.settings['gcode_macro pause'] is defined %}
	{% set _dummy = tl.macro.update({'pause': printer.configfile.settings['gcode_macro pause'].rename_existing}) %}
	{% endif %}
	{% if printer.configfile.settings['gcode_macro resume'] is defined %}
	{% set _dummy = tl.macro.update({'resume': printer.configfile.settings['gcode_macro resume'].rename_existing}) %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=macro VALUE="{tl.macro}"

[gcode_macro TIMELAPSE_TAKE_FRAME]
description = Take Timelapse shoot
variable_enable = False
variable_takingframe = False
variable_park = {'enable': False,
	'pos'   : 'center',
	'time'  : 0.1,
	'custom': {'x': 0, 'y': 0, 'dz': 0},
	'coord' : {'x': 0, 'y': 0, 'dz': 0}}
variable_extruder = {'fw_retract': False,
	'retract': 1.0,
	'extrude': 1.0}
variable_speed = {'travel': 100,
	'retract': 15,
	'extrude': 15}
variable_verbose = True
variable_check_time = 0.5
variable_restore = {'absolute': {'coordinates': True, 'extrude': True}, 'speed': 1500, 'e':0, 'factor': {'speed': 1.0, 'extrude': 1.0}}
variable_macro = {'pause': 'PAUSE', 'resume': 'RESUME'}
variable_is_paused = False
gcode = 
	{% set hyperlapse = True if params.HYPERLAPSE and params.HYPERLAPSE|lower =='true' else False %}
	{% if enable %}
	{% if (hyperlapse and printer['gcode_macro HYPERLAPSE'].run) or
	(not hyperlapse and not printer['gcode_macro HYPERLAPSE'].run) %}
	{% if park.enable %}
	{% set pos = {'x': 'X' + park.coord.x|string if park.pos != 'y_only' else '',
	'y': 'Y' + park.coord.y|string if park.pos != 'x_only' else '',
	'z': 'Z'+ [printer.gcode_move.gcode_position.z + park.coord.dz, printer.toolhead.axis_maximum.z]|min|string} %}
	{% set restore = {'absolute': {'coordinates': printer.gcode_move.absolute_coordinates,
	'extrude'    : printer.gcode_move.absolute_extrude},
	'speed'   : printer.gcode_move.speed,
	'e'       : printer.gcode_move.gcode_position.e,
	'factor'  : {'speed'  : printer.gcode_move.speed_factor,
	'extrude': printer.gcode_move.extrude_factor}} %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=restore VALUE="{restore}"
	{% if not printer[printer.toolhead.extruder].can_extrude %}
	{% if verbose %}{action_respond_info("Timelapse: Warning, minimum extruder temperature not reached!")}{% endif %}
	{% else %}
	{% if extruder.fw_retract %}
	G10
	{% else %}
	M83
	G0 E-{extruder.retract} F{speed.retract * 60}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=is_paused VALUE=True
	{macro.pause}
	SET_GCODE_OFFSET X=0 Y=0
	G90
	{% if "xyz" not in printer.toolhead.homed_axes %}
	{% if verbose %}{action_respond_info("Timelapse: Warning, axis not homed yet!")}{% endif %}
	{% else %}
	G0 {pos.x} {pos.y} {pos.z} F{speed.travel * 60}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=takingframe VALUE=True
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_TAKE_FRAME DURATION={check_time}
	M400
	{% endif %}
	_TIMELAPSE_NEW_FRAME HYPERLAPSE={hyperlapse}
	{% endif %}
	{% else %}
	{% if verbose %}{action_respond_info("Timelapse: disabled, take frame ignored")}{% endif %}
	{% endif %}

[gcode_macro _TIMELAPSE_NEW_FRAME]
description = action call for timelapse shoot. must be a seperate macro
gcode = 
	{action_call_remote_method("timelapse_newframe",
	macropark=printer['gcode_macro TIMELAPSE_TAKE_FRAME'].park,
	hyperlapse=params.HYPERLAPSE)}

[delayed_gcode _WAIT_TIMELAPSE_TAKE_FRAME]
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% set factor = {'speed': printer.gcode_move.speed_factor, 'extrude': printer.gcode_move.extrude_factor} %}
	{% if tl.takingframe %}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_TAKE_FRAME DURATION={tl.check_time}
	{% else %}
	{tl.macro.resume} VELOCITY={tl.speed.travel}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=is_paused VALUE=False
	{% if not printer[printer.toolhead.extruder].can_extrude %}
	{action_respond_info("Timelapse: Warning minimum extruder temperature not reached!")}
	{% else %}
	{% if tl.extruder.fw_retract %}
	G11
	{% else %}
	G0 E{tl.extruder.extrude} F{tl.speed.extrude * 60}
	G0 F{tl.restore.speed}
	{% if tl.restore.absolute.extrude %}
	M82
	G92 E{tl.restore.e}
	{% endif %}
	{% endif %}
	{% endif %}
	{% if tl.restore.factor.speed   != factor.speed   %} M220 S{(factor.speed*100)|round(0)}   {% endif %}
	{% if tl.restore.factor.extrude != factor.extrude %} M221 S{(factor.extrude*100)|round(0)} {% endif %}
	{% if not tl.restore.absolute.coordinates %} G91 {% endif %}
	{% endif %}

[gcode_macro HYPERLAPSE]
description = Start/Stop a hyperlapse recording
variable_cycle = 0
variable_run = False
gcode = 
	{% set cycle = params.CYCLE|default(30)|int %}
	{% if params.ACTION and params.ACTION|lower == 'start' %}
	{action_respond_info("Hyperlapse: frames started (Cycle %d sec)" % cycle)}
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=run VALUE=True
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=cycle VALUE={cycle}
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION={cycle}
	TIMELAPSE_TAKE_FRAME HYPERLAPSE=True
	{% elif params.ACTION and params.ACTION|lower == 'stop' %}
	{% if run %}{action_respond_info("Hyperlapse: frames stopped")}{% endif %}
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=run VALUE=False
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION=0
	{% else %}
	{action_raise_error("Hyperlapse: No valid input parameter
	Use:
	- HYPERLAPSE ACTION=START [CYCLE=time]
	- HYPERLAPSE ACTION=STOP")}
	{% endif %}

[delayed_gcode _HYPERLAPSE_LOOP]
gcode = 
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION={printer["gcode_macro HYPERLAPSE"].cycle}
	TIMELAPSE_TAKE_FRAME HYPERLAPSE=True

[gcode_macro TIMELAPSE_RENDER]
description = Render Timelapse video and wait for the result
variable_render = False
variable_run_identifier = 0
gcode = 
	{action_respond_info("Timelapse: Rendering started")}
	{action_call_remote_method("timelapse_render", byrendermacro="True")}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_RENDER VARIABLE=render VALUE=True
	{printer.configfile.settings['gcode_macro pause'].rename_existing}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_RENDER DURATION=0.5

[delayed_gcode _WAIT_TIMELAPSE_RENDER]
gcode = 
	{% set ri = printer['gcode_macro TIMELAPSE_RENDER'].run_identifier % 4 %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_RENDER VARIABLE=run_identifier VALUE={ri + 1}
	{% if printer['gcode_macro TIMELAPSE_RENDER'].render %}
	M117 Rendering {['-','\\','|','/'][ri]}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_RENDER DURATION=0.5
	{% else %}
	{action_respond_info("Timelapse: Rendering finished")}
	M117
	{printer.configfile.settings['gcode_macro resume'].rename_existing}
	{% endif %}

[gcode_macro TEST_STREAM_DELAY]
description = Helper macro to find stream and park delay
gcode = 
	{% set min = printer.toolhead.axis_minimum %}
	{% set max = printer.toolhead.axis_maximum %}
	{% set act = printer.toolhead.position %}
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% if act.z > 5.0 %}
	G0 X{min.x + 5.0} F{tl.speed.travel|int * 60}
	G0 X{(max.x-min.x)/2}
	G4 P{tl.park.time|float * 1000}
	_TIMELAPSE_NEW_FRAME HYPERLAPSE=FALSE
	G0 X{max.x - 5.0}
	{% else %}
	{action_raise_error("Toolhead z %.3f to low. Please place head above z = 5.0" % act.z)}
	{% endif %}

[gcode_macro _OBICO_LAYER_CHANGE]
description = Run a scan across the current print area
variable_first_layer_scan_retract_length = 6
variable_first_layer_scan_retract_speed = 15
variable_first_layer_scan_cooldown_temp = 170
variable_first_layer_scan_resume_speed = 50
variable_first_layer_scan_enabled = True
variable_first_layer_scan_stepover = 10
variable_first_layer_scan_speed = 10
variable_first_layer_scan_zhop = 4
variable_first_layer_scan_zhop_speed = 15
variable_verbose = False
variable_current_layer = -1
variable_first_layer_scanning = False
variable_wait = {'resume': "RESUME", 'absolute_coordinates': True, 'absolute_extrude': True, 'e': 0.0, 'previous_temp': 0}
gcode = 
	
	{% set pause_macro  = "PAUSE"  if printer.configfile.settings['gcode_macro pause']  is not defined
	else printer.configfile.settings['gcode_macro pause'].rename_existing %}
	{% set resume_macro = "RESUME" if printer.configfile.settings['gcode_macro resume'] is not defined
	else printer.configfile.settings['gcode_macro resume'].rename_existing %}
	
	{% set current_layer_default = printer.print_stats.info.current_layer if printer.print_stats.info.current_layer is not none else -1 %}
	{% set current_layer = params.CURRENT_LAYER|default(current_layer_default)|int %}
	
	{% set polygon_points = printer.exclude_object.objects|map(attribute='polygon')|sum(start=[]) if printer.exclude_object is defined else [] %}
	{% set min_x = params.MINX|default(polygon_points|map(attribute=0)|min|default(printer.toolhead.axis_minimum.x))|float %}
	{% set min_y = params.MINY|default(polygon_points|map(attribute=1)|min|default(printer.toolhead.axis_minimum.y))|float %}
	{% set max_x = params.MAXX|default(polygon_points|map(attribute=0)|max|default(printer.toolhead.axis_maximum.x))|float %}
	{% set max_y = params.MAXY|default(polygon_points|map(attribute=1)|max|default(printer.toolhead.axis_maximum.y))|float %}
	
	{% set stepoverCount = ((max_y - min_y) / first_layer_scan_stepover|float)|round(method='ceil')|int %}
	
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Layer %d" % (current_layer)}' {% endif %}
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=current_layer VALUE={current_layer}
	
	{% if first_layer_scan_enabled and current_layer == 2 %}
	
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=first_layer_scanning VALUE=True
	
	
	{% set wait_dic = {'resume'              : resume_macro,
	'absolute_coordinates': printer.gcode_move.absolute_coordinates,
	'absolute_extrude'    : printer.gcode_move.absolute_extrude,
	'e'                   : printer.gcode_move.gcode_position.e,
	'previous_temp'       : printer.extruder.target} %}
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=wait VALUE="{wait_dic}"
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Prepare scanning" {% endif %}
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Scan Coordinates: Min:[%.3f:%.3f] Max:[%.3f:%.3f]" % (min_x,min_y,max_x,max_y)}' {% endif %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Retract %.1fmm filament" % first_layer_scan_retract_length|abs}' {% endif %}
	M83
	G0 E-{first_layer_scan_retract_length|abs} F{first_layer_scan_retract_speed|float * 60}
	{% endif %}
	G91
	G0 Z{first_layer_scan_zhop|abs} F{first_layer_scan_zhop_speed|float * 60}
	
	
	M106 S255
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Fan on and lowering temperature to %.1f" % first_layer_scan_cooldown_temp}' {% endif %}
	M104 S{first_layer_scan_cooldown_temp}
	M109 S{first_layer_scan_cooldown_temp}
	
	{pause_macro}
	
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Start scanning" {% endif %}
	
	UPDATE_DELAYED_GCODE ID=_WAIT_OBICO_LAYER_CHANGE DURATION=1.0
	G90
	G0 X{min_x} Y{min_y} F{first_layer_scan_resume_speed|float * 60}
	{% for ystep in range(stepoverCount) %}
	G0 Y{min_y + first_layer_scan_stepover|float * ystep} F{first_layer_scan_speed|float * 60}
	G0 X{max_x if ystep % 2 == 0 else min_x}              F{first_layer_scan_speed|float * 60}
	{% endfor %}
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Finish scanning" {% endif %}
	
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=first_layer_scanning VALUE=False
	
	{% endif %}

[delayed_gcode _WAIT_OBICO_LAYER_CHANGE]
gcode = 
	{% set lc_macro = printer['gcode_macro _OBICO_LAYER_CHANGE'] %}
	{% if lc_macro.first_layer_scanning %}
	
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Waiting for first layer scan..." {% endif %}
	UPDATE_DELAYED_GCODE ID=_WAIT_OBICO_LAYER_CHANGE DURATION=1.0
	{% else %}
	
	M107
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Fan off and resume print" {% endif %}
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Call %s VELOCITY=%.1f" % (lc_macro.wait.resume, lc_macro.first_layer_scan_resume_speed)}' {% endif %}
	{lc_macro.wait.resume} VELOCITY={lc_macro.first_layer_scan_resume_speed}
	G91
	G0 Z-{lc_macro.first_layer_scan_zhop|abs} F{lc_macro.first_layer_scan_zhop_speed|float * 60}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% set first_layer_scan_unretract_length = lc_macro.first_layer_scan_retract_length + 0.5 %}
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Extrude %.1fmm filament" % first_layer_scan_unretract_length|abs}' {% endif %}
	M83
	G0 E{first_layer_scan_unretract_length|abs} F{lc_macro.first_layer_scan_retract_speed|float * 60}
	{% endif %}
	
	
	M104 S{lc_macro.wait.previous_temp}
	M109 S{lc_macro.wait.previous_temp}
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Heating back up to previous temperature"}' {% endif %}
	
	
	{% if lc_macro.wait.absolute_coordinates %} G90 {% endif %}
	{% if lc_macro.wait.absolute_extrude %}
	M82
	G92 E{lc_macro.wait.e}
	{% endif %}
	{% endif %}

[gcode_macro OBICO_LINK_STATUS]
description = Link to Obico server
variable_one_time_passcode = ''
variable_one_time_passlink = ''
variable_is_linked = False
gcode = 
	{action_respond_info('Obico one_time_passcode: {}'.format(one_time_passcode))}
	{action_respond_info('Obico one_time_passlink: {}'.format(one_time_passlink))}
	{action_respond_info('Obico is_linked: {}'.format(is_linked))}
	{% if not is_linked and one_time_passcode != '' %}
	M117 Code: {one_time_passcode}
	{% else %}
	M117 Obico linked
	{% endif %}

[gcode_macro _OBICO_RELINK]
description = Re-link to Obico server
gcode = 
	{action_respond_info('WARNING: Re-link to Obico server')}
	{action_call_remote_method("obico_remote_event", event_name='relink_obico', message='')}
	{action_respond_info('WARNING: relink_obico requested')}

[exclude_object]

[mcu]
serial = /dev/serial/by-id/usb-1a86_USB_Serial-if00-port0
restart_method = command

[temperature_sensor raspberry_pi]
sensor_type = temperature_host
min_temp = 10
max_temp = 100

[temperature_sensor mcu_temp]
sensor_type = temperature_mcu
min_temp = 0
max_temp = 100

[printer]
kinematics = cartesian
max_velocity = 200
max_accel = 4000
max_z_velocity = 10
max_z_accel = 100
minimum_cruise_ratio = 0.5
square_corner_velocity = 5

[stepper_x]
step_pin = PB9
dir_pin = PC2
enable_pin = !PC3
microsteps = 16
rotation_distance = 40
endstop_pin = ^PA5
position_endstop = 0
position_max = 230
homing_speed = 50

[stepper_y]
step_pin = PB7
dir_pin = PB8
enable_pin = !PC3
microsteps = 16
rotation_distance = 40
endstop_pin = ^PA6
position_endstop = 0
position_max = 231
homing_speed = 50

[stepper_z]
step_pin = PB5
dir_pin = !PB6
enable_pin = !PC3
microsteps = 16
rotation_distance = 8
endstop_pin = probe:z_virtual_endstop
position_max = 250
position_min = -4
homing_speed = 4
second_homing_speed = 1
homing_retract_dist = 2.0

[fan]
pin = PA0

[extruder]
max_extrude_only_distance = 100.0
step_pin = PB3
dir_pin = PB4
enable_pin = !PC3
microsteps = 16
gear_ratio = 42:12
rotation_distance = 26.359
nozzle_diameter = 0.400
filament_diameter = 1.750
heater_pin = PA1
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PC5
min_temp = 0
max_temp = 300
min_extrude_temp = 170
pressure_advance = .0369
pressure_advance_smooth_time = 0.04
control = pid
pid_kp = 19.195
pid_ki = 1.000
pid_kd = 92.135

[firmware_retraction]
retract_length = 0.3
retract_speed = 20

[idle_timeout]
gcode = 
	{% if printer.pause_resume.is_paused %}
	M118 Idle timeout while paused, turning off hotend
	SET_HEATER_TEMPERATURE HEATER=extruder TARGET=0
	{% else %}
	M118 Idle timeout
	TURN_OFF_HEATERS
	M84
	{% endif %}
timeout = 1800

[heater_bed]
heater_pin = PA2
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PC4
min_temp = 0
max_temp = 130
control = pid
pid_kp = 68.601
pid_ki = 1.185
pid_kd = 993.000

[bltouch]
sensor_pin = ^PB1
control_pin = PB0
x_offset = -31.8
y_offset = -40.5
speed = 35
samples = 2
samples_result = median
samples_tolerance = 0.05
samples_tolerance_retries = 2
sample_retract_dist = 5.0
probe_with_touch_mode = true
stow_on_each_sample = false
z_offset = 2.049

[safe_z_home]
home_xy_position = 147, 154
speed = 75
z_hop = 10
z_hop_speed = 5
move_to_previous = false

[bed_screws]
screw1 = 30,51
screw1_name = "FL"
screw2 = 200,51
screw2_name = "FR"
screw3 = 200,195
screw3_name = "RR"
screw4 = 30,195
screw4_name = "RL"

[screws_tilt_adjust]
screw1 = 67, 67
screw1_name = front left screw
screw2 = 230, 67
screw2_name = front right screw
screw3 = 230, 230
screw3_name = rear right screw
screw4 = 67.60, 230
screw4_name = rear left screw
horizontal_move_z = 10
speed = 200
screw_thread = CW-M4

[bed_mesh]
speed = 120
mesh_min = 10,11
mesh_max = 195,182
probe_count = 3,3
algorithm = bicubic
fade_start = 1
fade_end = 10
fade_target = 0

[filament_motion_sensor SFS_T0]
detection_length = 150.00
extruder = extruder
switch_pin = PA4
pause_on_runout = True
event_delay = 3.0
pause_delay = 0.5
runout_gcode = 
	M117 Runout Detected!

[delayed_gcode DISABLEFILAMENTSENSOR]
initial_duration = 1
gcode = 
	SET_FILAMENT_SENSOR SENSOR=SFS_T0 ENABLE=0

[gcode_macro SFS_ENABLE]
description = Enable smart filament sensor
gcode = 
	M117 ENABLING the Smart Filament Sensor
	G92 E0
	SET_FILAMENT_SENSOR SENSOR=SFS_T0 ENABLE=1

[gcode_macro SFS_DISABLE]
description = Disable smart filament sensor
gcode = 
	M117 DISABLING the Smart Filament Sensor
	G92 E0
	SET_FILAMENT_SENSOR SENSOR=SFS_T0 ENABLE=0

[gcode_macro FILAMENT_RUNOUT]
gcode = 
	M117 Runout Detected!
	M300 S1 P10
	M600
	M300 S1 P10

[gcode_macro M300]
gcode = 
	{% set S = params.S|default(1000)|int %}
	{% set P = params.P|default(100)|int %}
	SET_PIN PIN=BEEPER VALUE=0.5 CYCLE_TIME={ 1.0/S if S > 0 else 1 }
	G4 P{P}
	SET_PIN PIN=BEEPER VALUE=0
	[gcode_macro M600]
	gcode:
	{% set X = params.X|default(25)|float %}
	{% set Y = params.Y|default(25)|float %}
	{% set Z = params.Z|default(10)|float %}
	SAVE_GCODE_STATE NAME=M600_state
	PAUSE
	G91
	G1 E-.8 F2700
	G1 Z{Z}
	G90
	G1 X{X} Y{Y} F3000
	G91
	G1 E-15 F1000
	RESTORE_GCODE_STATE NAME=M600_state

[gcode_arcs]
resolution = 1.0

[input_shaper]
shaper_freq_x = 73.5
shaper_type_x = ei
shaper_freq_y = 76.9
shaper_type_y = mzv
=======================
bed_mesh: bicubic interpolation with a probe_count of less than 4 points detected.  Forcing lagrange interpolation. Configured Probe Count: 3, 3
Extruder max_extrude_ratio=0.266081
mcu 'mcu': Starting serial connect
webhooks client 547944544960: New connection
webhooks client 547944544960: Client info {'program': 'Moonraker', 'version': 'v0.9.3-3-gccfe32f'}
Loaded MCU 'mcu' 119 commands (v0.12.0-286-g81de9a861 / gcc: (15:8-2019-q3-1+b1) 8.3.1 20190703 (release) [gcc-8-branch revision 273027] binutils: (2.35.2-2+14+b2) 2.35.2)
MCU 'mcu' config: ADC_MAX=4095 BUS_PINS_i2c1=PB6,PB7 BUS_PINS_i2c1a=PB8,PB9 BUS_PINS_i2c2=PB10,PB11 BUS_PINS_spi1=PA6,PA7,PA5 BUS_PINS_spi1a=PB4,PB5,PB3 BUS_PINS_spi2=PB14,PB15,PB13 BUS_PINS_spi3=PB4,PB5,PB3 CLOCK_FREQ=72000000 MCU=stm32f103xe PWM_MAX=255 RECEIVE_WINDOW=192 RESERVE_PINS_serial=PA10,PA9 SERIAL_BAUD=250000 STATS_SUMSQ_BASE=256 STEPPER_BOTH_EDGE=1
mcu_temperature 'mcu' nominal base=357.558140 slope=-767.441860
Sending MCU 'mcu' printer configuration...
Configured MCU 'mcu' (1024 moves)
Starting heater checks for heater_bed
bed_mesh: generated points
Index |  Tool Adjusted  |   Probe
  0   | (41.8, 51.5)    | (10.0, 11.0)
  1   | (134.3, 51.5)   | (102.5, 11.0)
  2   | (226.8, 51.5)   | (195.0, 11.0)
  3   | (226.8, 137.0)  | (195.0, 96.5)
  4   | (134.3, 137.0)  | (102.5, 96.5)
  5   | (41.8, 137.0)   | (10.0, 96.5)
  6   | (41.8, 222.5)   | (10.0, 182.0)
  7   | (134.3, 222.5)  | (102.5, 182.0)
  8   | (226.8, 222.5)  | (195.0, 182.0)
Starting heater checks for extruder
Stats 491.5: gcodein=0  mcu: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=1222 bytes_read=4498 bytes_retransmit=18 bytes_invalid=7 send_seq=131 receive_seq=131 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000286  raspberry_pi: temp=47.2 mcu_temp: temp=0.0 heater_bed: target=0 temp=0.0 pwm=0.000 sysload=0.81 cputime=8.449 memavail=1471920 print_time=4.198 buffer_time=0.249 print_stall=0 extruder: target=0 temp=0.0 pwm=0.000
webhooks: registering remote method 'shutdown_machine' for connection id: 547944544960
webhooks: registering remote method 'reboot_machine' for connection id: 547944544960
webhooks: registering remote method 'pause_job_queue' for connection id: 547944544960
webhooks: registering remote method 'start_job_queue' for connection id: 547944544960
Stats 492.5: gcodein=0  mcu: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=1228 bytes_read=4649 bytes_retransmit=18 bytes_invalid=7 send_seq=132 receive_seq=132 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000159  raspberry_pi: temp=49.2 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=0.81 cputime=8.480 memavail=1473016 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
webhooks: registering remote method 'obico_remote_event' for connection id: 547944544960
Stats 493.5: gcodein=0  mcu: mcu_awake=0.006 mcu_task_avg=0.000031 mcu_task_stddev=0.000045 bytes_write=1234 bytes_read=4845 bytes_retransmit=18 bytes_invalid=7 send_seq=133 receive_seq=133 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000097  raspberry_pi: temp=48.2 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=0.81 cputime=8.510 memavail=1470660 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 494.5: gcodein=0  mcu: mcu_awake=0.006 mcu_task_avg=0.000031 mcu_task_stddev=0.000045 bytes_write=1240 bytes_read=5011 bytes_retransmit=18 bytes_invalid=7 send_seq=134 receive_seq=134 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000315  raspberry_pi: temp=49.2 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=0.81 cputime=8.527 memavail=1470660 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 495.5: gcodein=0  mcu: mcu_awake=0.006 mcu_task_avg=0.000031 mcu_task_stddev=0.000045 bytes_write=1246 bytes_read=5162 bytes_retransmit=18 bytes_invalid=7 send_seq=135 receive_seq=135 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000422  raspberry_pi: temp=47.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=0.90 cputime=8.544 memavail=1470660 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 496.5: gcodein=0  mcu: mcu_awake=0.006 mcu_task_avg=0.000031 mcu_task_stddev=0.000045 bytes_write=1252 bytes_read=5343 bytes_retransmit=18 bytes_invalid=7 send_seq=136 receive_seq=136 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000437  raspberry_pi: temp=48.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=0.90 cputime=8.561 memavail=1470660 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 497.5: gcodein=0  mcu: mcu_awake=0.006 mcu_task_avg=0.000031 mcu_task_stddev=0.000045 bytes_write=1258 bytes_read=5509 bytes_retransmit=18 bytes_invalid=7 send_seq=137 receive_seq=137 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000501  raspberry_pi: temp=48.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=0.90 cputime=8.578 memavail=1469908 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 498.5: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1264 bytes_read=5674 bytes_retransmit=18 bytes_invalid=7 send_seq=138 receive_seq=138 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72001013  raspberry_pi: temp=48.2 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=0.90 cputime=8.593 memavail=1469684 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.6 pwm=0.000
Stats 499.5: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1270 bytes_read=5855 bytes_retransmit=18 bytes_invalid=7 send_seq=139 receive_seq=139 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000770  raspberry_pi: temp=47.2 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=0.90 cputime=8.609 memavail=1469684 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.6 pwm=0.000
Stats 500.5: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1276 bytes_read=6021 bytes_retransmit=18 bytes_invalid=7 send_seq=140 receive_seq=140 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000625  raspberry_pi: temp=48.2 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=0.91 cputime=8.628 memavail=1469468 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 501.5: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1282 bytes_read=6172 bytes_retransmit=18 bytes_invalid=7 send_seq=141 receive_seq=141 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000668  raspberry_pi: temp=48.7 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=0.91 cputime=8.644 memavail=1469468 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 502.5: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1288 bytes_read=6353 bytes_retransmit=18 bytes_invalid=7 send_seq=142 receive_seq=142 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000555  raspberry_pi: temp=48.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=0.91 cputime=8.660 memavail=1469468 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 503.5: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1294 bytes_read=6533 bytes_retransmit=18 bytes_invalid=7 send_seq=143 receive_seq=143 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000486  raspberry_pi: temp=48.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=0.91 cputime=8.677 memavail=1469244 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.6 pwm=0.000
Stats 504.5: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1300 bytes_read=6684 bytes_retransmit=18 bytes_invalid=7 send_seq=144 receive_seq=144 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000431  raspberry_pi: temp=47.7 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=0.91 cputime=8.693 memavail=1469244 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.6 pwm=0.000
Stats 505.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1306 bytes_read=6865 bytes_retransmit=18 bytes_invalid=7 send_seq=145 receive_seq=145 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000384  raspberry_pi: temp=48.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=1.00 cputime=8.709 memavail=1469244 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 506.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1312 bytes_read=7031 bytes_retransmit=18 bytes_invalid=7 send_seq=146 receive_seq=146 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000356  raspberry_pi: temp=47.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.00 cputime=8.726 memavail=1469244 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.6 pwm=0.000
Stats 507.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1318 bytes_read=7182 bytes_retransmit=18 bytes_invalid=7 send_seq=147 receive_seq=147 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000327  raspberry_pi: temp=48.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.00 cputime=8.742 memavail=1469512 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.6 pwm=0.000
Stats 508.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1324 bytes_read=7377 bytes_retransmit=18 bytes_invalid=7 send_seq=148 receive_seq=148 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000317  raspberry_pi: temp=47.7 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.00 cputime=8.758 memavail=1469516 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 509.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1330 bytes_read=7543 bytes_retransmit=18 bytes_invalid=7 send_seq=149 receive_seq=149 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000296  raspberry_pi: temp=47.7 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=1.00 cputime=8.774 memavail=1469516 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 510.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1336 bytes_read=7694 bytes_retransmit=18 bytes_invalid=7 send_seq=150 receive_seq=150 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000280  raspberry_pi: temp=47.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.08 cputime=8.791 memavail=1469516 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 511.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1342 bytes_read=7875 bytes_retransmit=18 bytes_invalid=7 send_seq=151 receive_seq=151 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000272  raspberry_pi: temp=48.2 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.08 cputime=8.807 memavail=1469516 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 512.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1348 bytes_read=8041 bytes_retransmit=18 bytes_invalid=7 send_seq=152 receive_seq=152 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000261  raspberry_pi: temp=48.7 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.08 cputime=8.823 memavail=1469516 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.6 pwm=0.000
Stats 513.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1354 bytes_read=8206 bytes_retransmit=18 bytes_invalid=7 send_seq=153 receive_seq=153 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000248  raspberry_pi: temp=47.7 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.08 cputime=8.839 memavail=1469516 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 514.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1360 bytes_read=8387 bytes_retransmit=18 bytes_invalid=7 send_seq=154 receive_seq=154 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000246  raspberry_pi: temp=48.2 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.08 cputime=8.856 memavail=1472128 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 515.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1366 bytes_read=8553 bytes_retransmit=18 bytes_invalid=7 send_seq=155 receive_seq=155 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000242  raspberry_pi: temp=48.2 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.15 cputime=8.872 memavail=1472128 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.6 pwm=0.000
Stats 516.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1372 bytes_read=8704 bytes_retransmit=18 bytes_invalid=7 send_seq=156 receive_seq=156 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000238  raspberry_pi: temp=47.7 mcu_temp: temp=29.7 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=1.15 cputime=8.890 memavail=1471944 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 517.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1378 bytes_read=8885 bytes_retransmit=18 bytes_invalid=7 send_seq=157 receive_seq=157 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000236  raspberry_pi: temp=47.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.15 cputime=8.908 memavail=1471508 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 518.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1384 bytes_read=9065 bytes_retransmit=18 bytes_invalid=7 send_seq=158 receive_seq=158 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000229  raspberry_pi: temp=48.2 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.15 cputime=8.925 memavail=1471520 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.6 pwm=0.000
Stats 519.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1390 bytes_read=9216 bytes_retransmit=18 bytes_invalid=7 send_seq=159 receive_seq=159 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000251  raspberry_pi: temp=48.2 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.15 cputime=8.941 memavail=1471296 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 520.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1396 bytes_read=9397 bytes_retransmit=18 bytes_invalid=7 send_seq=160 receive_seq=160 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000243  raspberry_pi: temp=48.2 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.30 cputime=8.958 memavail=1471296 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.6 pwm=0.000
Stats 521.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1402 bytes_read=9563 bytes_retransmit=18 bytes_invalid=7 send_seq=161 receive_seq=161 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000241  raspberry_pi: temp=48.7 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.30 cputime=8.975 memavail=1471072 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 522.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1408 bytes_read=9714 bytes_retransmit=18 bytes_invalid=7 send_seq=162 receive_seq=162 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000243  raspberry_pi: temp=48.2 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=1.30 cputime=8.991 memavail=1471072 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 523.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1414 bytes_read=9909 bytes_retransmit=18 bytes_invalid=7 send_seq=163 receive_seq=163 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000238  raspberry_pi: temp=48.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.30 cputime=9.009 memavail=1471072 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 524.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1420 bytes_read=10075 bytes_retransmit=18 bytes_invalid=7 send_seq=164 receive_seq=164 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000232  raspberry_pi: temp=48.2 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.30 cputime=9.026 memavail=1470824 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 525.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1426 bytes_read=10226 bytes_retransmit=18 bytes_invalid=7 send_seq=165 receive_seq=165 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000225  raspberry_pi: temp=48.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.36 cputime=9.042 memavail=1470824 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 526.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1432 bytes_read=10407 bytes_retransmit=18 bytes_invalid=7 send_seq=166 receive_seq=166 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000219  raspberry_pi: temp=49.2 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.36 cputime=9.059 memavail=1470824 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 527.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1438 bytes_read=10573 bytes_retransmit=18 bytes_invalid=7 send_seq=167 receive_seq=167 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000220  raspberry_pi: temp=48.2 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.36 cputime=9.075 memavail=1470068 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 528.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1444 bytes_read=10738 bytes_retransmit=18 bytes_invalid=7 send_seq=168 receive_seq=168 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000214  raspberry_pi: temp=48.2 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.36 cputime=9.092 memavail=1470092 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 529.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1450 bytes_read=10919 bytes_retransmit=18 bytes_invalid=7 send_seq=169 receive_seq=169 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000210  raspberry_pi: temp=47.7 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.36 cputime=9.108 memavail=1470092 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 530.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1456 bytes_read=11085 bytes_retransmit=18 bytes_invalid=7 send_seq=170 receive_seq=170 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000206  raspberry_pi: temp=48.2 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.41 cputime=9.125 memavail=1470096 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 531.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1462 bytes_read=11236 bytes_retransmit=18 bytes_invalid=7 send_seq=171 receive_seq=171 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000206  raspberry_pi: temp=49.2 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.41 cputime=9.141 memavail=1470096 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 532.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1468 bytes_read=11417 bytes_retransmit=18 bytes_invalid=7 send_seq=172 receive_seq=172 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000205  raspberry_pi: temp=48.2 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=1.41 cputime=9.161 memavail=1470096 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 533.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1474 bytes_read=11597 bytes_retransmit=18 bytes_invalid=7 send_seq=173 receive_seq=173 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000202  raspberry_pi: temp=48.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.41 cputime=9.175 memavail=1468236 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.6 pwm=0.000
Stats 534.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1480 bytes_read=11748 bytes_retransmit=18 bytes_invalid=7 send_seq=174 receive_seq=174 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000197  raspberry_pi: temp=47.7 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.41 cputime=9.186 memavail=1468236 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.6 pwm=0.000
Stats 535.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1486 bytes_read=11929 bytes_retransmit=18 bytes_invalid=7 send_seq=175 receive_seq=175 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000191  raspberry_pi: temp=47.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.46 cputime=9.197 memavail=1468236 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 536.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1492 bytes_read=12095 bytes_retransmit=18 bytes_invalid=7 send_seq=176 receive_seq=176 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000185  raspberry_pi: temp=48.2 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.46 cputime=9.207 memavail=1468236 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 537.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1498 bytes_read=12246 bytes_retransmit=18 bytes_invalid=7 send_seq=177 receive_seq=177 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000180  raspberry_pi: temp=48.2 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.46 cputime=9.218 memavail=1468236 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.6 pwm=0.000
Stats 538.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1504 bytes_read=12456 bytes_retransmit=18 bytes_invalid=7 send_seq=178 receive_seq=178 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000176  raspberry_pi: temp=48.2 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=1.46 cputime=9.233 memavail=1468020 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.6 pwm=0.000
Stats 539.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1510 bytes_read=12607 bytes_retransmit=18 bytes_invalid=7 send_seq=179 receive_seq=179 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000183  raspberry_pi: temp=48.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.46 cputime=9.249 memavail=1468020 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 540.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1516 bytes_read=12758 bytes_retransmit=18 bytes_invalid=7 send_seq=180 receive_seq=180 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000193  raspberry_pi: temp=48.2 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.50 cputime=9.266 memavail=1468020 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 541.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1522 bytes_read=12954 bytes_retransmit=18 bytes_invalid=7 send_seq=181 receive_seq=181 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000190  raspberry_pi: temp=49.2 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.50 cputime=9.283 memavail=1467796 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 542.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1528 bytes_read=13105 bytes_retransmit=18 bytes_invalid=7 send_seq=182 receive_seq=182 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000190  raspberry_pi: temp=48.7 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.50 cputime=9.299 memavail=1467548 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.6 pwm=0.000
Stats 543.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1534 bytes_read=13270 bytes_retransmit=18 bytes_invalid=7 send_seq=183 receive_seq=183 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000192  raspberry_pi: temp=47.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=1.50 cputime=9.316 memavail=1467324 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 544.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1540 bytes_read=13466 bytes_retransmit=18 bytes_invalid=7 send_seq=184 receive_seq=184 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000190  raspberry_pi: temp=48.7 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=1.50 cputime=9.333 memavail=1467324 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 545.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1546 bytes_read=13617 bytes_retransmit=18 bytes_invalid=7 send_seq=185 receive_seq=185 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000190  raspberry_pi: temp=48.7 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.54 cputime=9.350 memavail=1467324 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 546.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1552 bytes_read=13764 bytes_retransmit=18 bytes_invalid=7 send_seq=186 receive_seq=186 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000190  raspberry_pi: temp=48.2 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.54 cputime=9.367 memavail=1467356 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.6 pwm=0.000
Stats 547.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1558 bytes_read=13946 bytes_retransmit=18 bytes_invalid=7 send_seq=187 receive_seq=187 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000190  raspberry_pi: temp=48.2 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.54 cputime=9.384 memavail=1469152 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 548.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1564 bytes_read=14087 bytes_retransmit=18 bytes_invalid=7 send_seq=188 receive_seq=188 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000189  raspberry_pi: temp=48.7 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.54 cputime=9.401 memavail=1468908 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 549.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1570 bytes_read=14242 bytes_retransmit=18 bytes_invalid=7 send_seq=189 receive_seq=189 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000196  raspberry_pi: temp=49.2 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.54 cputime=9.417 memavail=1468908 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 550.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1582 bytes_read=14450 bytes_retransmit=18 bytes_invalid=7 send_seq=191 receive_seq=191 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000193  raspberry_pi: temp=48.7 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.58 cputime=9.435 memavail=1468908 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 551.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1588 bytes_read=14601 bytes_retransmit=18 bytes_invalid=7 send_seq=192 receive_seq=192 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000195  raspberry_pi: temp=48.7 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.58 cputime=9.451 memavail=1468908 print_time=4.198 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.6 pwm=0.000
webhooks client 547944544960: Disconnected
Starting Klippy...
Args: ['/home/coon/klipper/klippy/klippy.py', '/home/coon/printer_data/config/printer.cfg', '-l', '/home/coon/printer_data/logs/klippy.log', '-I', '/home/coon/printer_data/comms/klippy.serial', '-a', '/home/coon/printer_data/comms/klippy.sock']
Git version: 'v0.12.0-404-g80d185c94'
Branch: master
Remote: origin
Tracked URL: https://github.com/Klipper3d/klipper.git
CPU: 4 core ?
Python: '3.9.2 (default, Dec  1 2024, 12:12:57) \n[GCC 10.2.1 20210110]'
Start printer at Sun Dec 22 19:30:02 2024 (1734913802.9 21.4)
===== Config file =====
[virtual_sdcard]
path = ~/printer_data/gcodes
on_error_gcode = CANCEL_PRINT

[pause_resume]
recover_velocity = 25

[display_status]

[respond]
default_prefix = 

[gcode_macro CANCEL_PRINT]
description = Cancel the actual running print
rename_existing = BASE_CANCEL_PRINT
gcode = 
	G91
	G0 Z10 F600
	G90
	TURN_OFF_HEATERS
	G0 X5 Y220
	CLEAR_PAUSE
	
	BASE_CANCEL_PRINT

[gcode_macro PAUSE]
description = Pause the actual running print
rename_existing = PAUSE_BASE
gcode = 
	
	{% set x = params.X|default(5) %}
	{% set y = params.Y|default(225) %}
	{% set z = params.Z|default(10)|float %}
	{% set e = params.E|default(1) %}
	
	{% set max_z = printer.toolhead.axis_maximum.z|float %}
	{% set act_z = printer.toolhead.position.z|float %}
	{% set lift_z = z|abs %}
	{% if act_z < (max_z - lift_z) %}
	{% set z_safe = lift_z %}
	{% else %}
	{% set z_safe = max_z - act_z %}
	{% endif %}
	
	PAUSE_BASE
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E-{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	{% if "xyz" in printer.toolhead.homed_axes %}
	G1 Z{z_safe}
	G90
	G1 X{x} Y{y} F6000
	{% else %}
	{action_respond_info("Printer not homed")}
	{% endif %}

[gcode_macro RESUME]
description = Resume the actual running print
rename_existing = RESUME_BASE
variable_last_extruder_temp = {'restore': False, 'temp': 0}
variable_restore_idle_timeout = 0
variable_idle_state = False
gcode = 
	
	{% set e = params.E|default(1) %}
	
	{% if 'VELOCITY' in params|upper %}
	{% set get_params = ('VELOCITY=' + params.VELOCITY)  %}
	{%else %}
	{% set get_params = "" %}
	{% endif %}
	
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	RESUME_BASE {get_params}

[gcode_macro SET_PAUSE_NEXT_LAYER]
description = Enable a pause if the next layer is reached
gcode = 
	{% set pause_next_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_next_layer %}
	{% set ENABLE = params.ENABLE|default(1)|int != 0 %}
	{% set MACRO = params.MACRO|default(pause_next_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_next_layer VALUE="{{ 'enable': ENABLE, 'call': MACRO }}"

[gcode_macro SET_PAUSE_AT_LAYER]
description = Enable/disable a pause if a given layer number is reached
gcode = 
	{% set pause_at_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_at_layer %}
	{% set ENABLE = params.ENABLE|int != 0 if params.ENABLE is defined
	else params.LAYER is defined %}
	{% set LAYER = params.LAYER|default(pause_at_layer.layer)|int %}
	{% set MACRO = params.MACRO|default(pause_at_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_at_layer VALUE="{{ 'enable': ENABLE, 'layer': LAYER, 'call': MACRO }}"

[gcode_macro SET_PRINT_STATS_INFO]
rename_existing = SET_PRINT_STATS_INFO_BASE
description = Overwrite, to get pause_next_layer and pause_at_layer feature
variable_pause_next_layer = { 'enable': False, 'call': "PAUSE" }
variable_pause_at_layer = { 'enable': False, 'layer': 0, 'call': "PAUSE" }
gcode = 
	{% if pause_next_layer.enable %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_next_layer" % pause_next_layer.call}'
	{pause_next_layer.call}
	SET_PAUSE_NEXT_LAYER ENABLE=0
	{% elif pause_at_layer.enable and params.CURRENT_LAYER is defined and params.CURRENT_LAYER|int == pause_at_layer.layer %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_at_layer [%d]" % (pause_at_layer.call, pause_at_layer.layer)}'
	{pause_at_layer.call}
	SET_PAUSE_AT_LAYER ENABLE=0
	{% endif %}
	SET_PRINT_STATS_INFO_BASE {rawparams}

[gcode_macro _TOOLHEAD_PARK_PAUSE_CANCEL]
description = Helper: park toolhead used in PAUSE and CANCEL_PRINT
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set velocity = printer.configfile.settings.pause_resume.recover_velocity %}
	{% set use_custom     = client.use_custom_pos|default(false)|lower == 'true' %}
	{% set custom_park_x  = client.custom_park_x|default(0.0) %}
	{% set custom_park_y  = client.custom_park_y|default(0.0) %}
	{% set park_dz        = client.custom_park_dz|default(2.0)|abs %}
	{% set sp_hop         = client.speed_hop|default(15) * 60 %}
	{% set sp_move        = client.speed_move|default(velocity) * 60 %}
	
	{% set origin    = printer.gcode_move.homing_origin %}
	{% set act       = printer.gcode_move.gcode_position %}
	{% set max       = printer.toolhead.axis_maximum %}
	{% set cone      = printer.toolhead.cone_start_z|default(max.z) %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	
	{% set z_min = params.Z_MIN|default(0)|float %}
	{% set z_park = [[(act.z + park_dz), z_min]|max, (max.z - origin.z)]|min %}
	{% set x_park = params.X       if params.X is defined
	else custom_park_x  if use_custom
	else 0.0            if round_bed
	else (max.x - 5.0) %}
	{% set y_park = params.Y       if params.Y is defined
	else custom_park_y  if use_custom
	else (max.y - 5.0)  if round_bed and z_park < cone
	else 0.0            if round_bed
	else (max.y - 5.0) %}
	
	_CLIENT_RETRACT
	{% if "xyz" in printer.toolhead.homed_axes %}
	G90
	G1 Z{z_park} F{sp_hop}
	G1 X{x_park} Y{y_park} F{sp_move}
	{% if not printer.gcode_move.absolute_coordinates %} G91 {% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='Printer not homed'
	{% endif %}

[gcode_macro _CLIENT_EXTRUDE]
description = Extrudes, if the extruder is hot enough
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set use_fw_retract = (client.use_fw_retract|default(false)|lower == 'true') and (printer.firmware_retraction is defined) %}
	{% set length = params.LENGTH|default(client.unretract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_unretract)|default(35) %}
	{% set absolute_extrude = printer.gcode_move.absolute_extrude %}
	
	{% if printer.toolhead.extruder != '' %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if use_fw_retract %}
	{% if length < 0 %}
	G10
	{% else %}
	G11
	{% endif %}
	{% else %}
	M83
	G1 E{length} F{(speed|float|abs) * 60}
	{% if absolute_extrude %}
	M82
	{% endif %}
	{% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='{"\"%s\" not hot enough" % printer.toolhead.extruder}'
	{% endif %}
	{% endif %}

[gcode_macro _CLIENT_RETRACT]
description = Retracts, if the extruder is hot enough
gcode = 
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set length = params.LENGTH|default(client.retract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_retract)|default(35) %}
	
	_CLIENT_EXTRUDE LENGTH=-{length|float|abs} SPEED={speed|float|abs}

[gcode_macro _CLIENT_LINEAR_MOVE]
description = Linear move with save and restore of the gcode state
gcode = 
	{% set x_move = "X" ~ params.X if params.X is defined else "" %}
	{% set y_move = "Y" ~ params.Y if params.Y is defined else "" %}
	{% set z_move = "Z" ~ params.Z if params.Z is defined else "" %}
	{% set e_move = "E" ~ params.E if params.E is defined else "" %}
	{% set rate = "F" ~ params.F if params.F is defined else "" %}
	{% set ABSOLUTE = params.ABSOLUTE | default(0) | int != 0 %}
	{% set ABSOLUTE_E = params.ABSOLUTE_E | default(0) | int != 0 %}
	SAVE_GCODE_STATE NAME=_client_movement
	{% if x_move or y_move or z_move %}
	G9{ 0 if ABSOLUTE else 1 }
	{% endif %}
	{% if e_move %}
	M8{ 2 if ABSOLUTE_E else 3 }
	{% endif %}
	G1 { x_move } { y_move } { z_move } { e_move } { rate }
	RESTORE_GCODE_STATE NAME=_client_movement

[gcode_macro play_test]
gcode = 
	RESPOND TYPE=command MSG="action:prompt_begin Question"
	RESPOND TYPE=command MSG="action:prompt_text Do you wont to cancel the print?"
	RESPOND TYPE=command MSG="action:prompt_footer_button continue|RESPOND TYPE=command MSG=action:prompt_end"
	RESPOND TYPE=command MSG="action:prompt_footer_button CANCEL|CANCEL_PRINT|error"
	RESPOND TYPE=command MSG="action:prompt_show"

[gcode_macro PRINT_START]
gcode = 
	START_PRINT {rawparams}

[gcode_macro START_PRINT]
gcode = 
	{% set BED_TEMP = params.BED_TEMP|default(60)|float %}
	{% set EXTRUDER_TEMP = params.EXTRUDER_TEMP|default(190)|float %}
	
	M190 S{BED_TEMP}
	
	G90
	
	G28
	
	RESPOND MSG="Bed Meshing"
	
	
	
	
	
	
	
	
	BED_MESH_CLEAR
	BED_MESH_CALIBRATE ADAPTIVE=1
	
	
	
	
	
	
	
	RESPOND MSG="Heating to print temp"
	M104 S{EXTRUDER_TEMP}
	G0 Z40 F240
	M109 S{EXTRUDER_TEMP}
	RESPOND MSG="Enable Runout Sensor"
	SFS_ENABLE
	RESPOND MSG="Line Purge"
	LINE_PURGE
	RESPOND MSG="Print Started"

[gcode_macro LINE_PURGE]
gcode = 
	G92 E0
	G1 Z2.0 F3000
	G1 X0.1 Y20 Z0.3 F5000.0
	G1 X0.1 Y200.0 Z0.3 F1500.0 E15
	G1 X0.4 Y200.0 Z0.3 F5000.0
	G1 X0.4 Y20 Z0.3 F1500.0 E30
	G92 E0
	G1 Z2.0 F3000
	G1 X5 Y20 Z0.3 F5000.0

[gcode_macro PRINT_END]
gcode = 
	END_PRINT

[gcode_macro END_PRINT]
gcode = 
	
	
	RESPOND MSG="Print Finished"
	G91
	G1 E-.5 Z0.2 F2400
	G1 X5 Y5 F6000
	G1 Z10
	G90
	SFS_DISABLE
	
	G1 X0 Y220 F6000
	M106 S0
	M104 S0
	M140 S0
	
	M84 X Y E

[gcode_macro SET_ACTIVE_SPOOL]
gcode = 
	{% if params.ID %}
	{% set id = params.ID|int %}
	{action_call_remote_method(
	"spoolman_set_active_spool",
	spool_id=id
	)}
	{% else %}
	{action_respond_info("Parameter 'ID' is required")}
	{% endif %}

[gcode_macro CLEAR_ACTIVE_SPOOL]
gcode = 
	{action_call_remote_method(
	"spoolman_set_active_spool",
	spool_id=None
	)}

[gcode_macro G29]
gcode = 
	G28
	BED_MESH_CALIBRATE
	G0 X0 Y0 Z10 F6000
	BED_MESH_PROFILE save=default

[gcode_macro M125]
gcode = 
	SAVE_GCODE_STATE NAME=parking
	M117 Parking toolhead
	G91
	G1 Z10 F600
	G90
	G1 X5 Y225 F4000
	RESTORE_GCODE_STATE NAME=parking

[gcode_macro Load_Filament]
gcode = 
	SAVE_GCODE_STATE NAME=loading_filament
	M117 Loading Filament
	M83
	G92 E0.0
	G91
	G1 E50 F200
	G92 E50
	RESTORE_GCODE_STATE NAME=loading_filament

[gcode_macro Unload_Filament]
gcode = 
	SAVE_GCODE_STATE NAME=unloading_filament
	M117 Unloading Filament
	G91
	G1 E5 F100
	G92 E0.0
	G1 E-50 F5000
	G92 E-50
	RESTORE_GCODE_STATE NAME=unloading_filament

[gcode_macro Filament_Change]
gcode = 
	
	SAVE_GCODE_STATE NAME=filament_change
	
	Unload_Filament
	
	RESPOND TYPE=command MSG="action:prompt_begin Question"
	RESPOND TYPE=command MSG="action:prompt_text Please insert new filament and confirm"
	RESPOND TYPE=command MSG="action:prompt_footer_button CONFIRM|Load_Filament|RESPOND TYPE=command MSG=action:prompt_end"
	RESPOND TYPE=command MSG="action:prompt_footer_button CANCEL|RESPOND TYPE=command MSG=action:prompt_end"
	RESPOND TYPE=command MSG="action:prompt_show"
	
	RESTORE_GCODE_STATE NAME=filament_change

[gcode_macro Calibrate_Hotend_PID]
gcode = 
	PID_CALIBRATE HEATER=extruder TARGET=200

[gcode_macro Calibrate_Bed_PID]
gcode = 
	PID_CALIBRATE HEATER=heater_bed TARGET=60

[gcode_macro Calibrate_Zoffset]
gcode = 
	PROBE_CALIBRATE

[gcode_macro Tram_bed]
gcode = 
	SCREWS_TILT_CALCULATE

[gcode_macro TEST_SPEED]
description = Test for max speed and acceleration parameters for the printer. Procedure: Home -> ReadPositionFromMCU -> MovesToolhead@Vel&Accel -> Home -> ReadPositionfromMCU
gcode = 
	
	{% set speed  = params.SPEED|default(printer.configfile.settings.printer.max_velocity)|int %}
	
	{% set iterations = params.ITERATIONS|default(5)|int %}
	
	{% set accel  = params.ACCEL|default(printer.configfile.settings.printer.max_accel)|int %}
	
	{% set min_cruise_ratio = params.MIN_CRUISE_RATIO|default(0.5)|float %}
	
	{% set bound = params.BOUND|default(20)|int %}
	
	{% set smallpatternsize = SMALLPATTERNSIZE|default(20)|int %}
	
	
	
	{% set x_min = printer.toolhead.axis_minimum.x + bound %}
	{% set x_max = printer.toolhead.axis_maximum.x - bound %}
	{% set y_min = printer.toolhead.axis_minimum.y + bound %}
	{% set y_max = printer.toolhead.axis_maximum.y - bound %}
	
	
	
	{% set x_center = (printer.toolhead.axis_minimum.x|float + printer.toolhead.axis_maximum.x|float ) / 2 %}
	{% set y_center = (printer.toolhead.axis_minimum.y|float + printer.toolhead.axis_maximum.y|float ) / 2 %}
	
	
	{% set x_center_min = x_center - (smallpatternsize/2) %}
	{% set x_center_max = x_center + (smallpatternsize/2) %}
	{% set y_center_min = y_center - (smallpatternsize/2) %}
	{% set y_center_max = y_center + (smallpatternsize/2) %}
	
	
	SAVE_GCODE_STATE NAME=TEST_SPEED
	
	
	{ action_respond_info("TEST_SPEED: starting %d iterations at speed %d, accel %d" % (iterations, speed, accel)) }
	
	
	M400
	G28
	
	{% if printer.configfile.settings.quad_gantry_level %}
	{% if printer.quad_gantry_level.applied == False %}
	QUAD_GANTRY_LEVEL
	G28 Z
	{% endif %}
	{% endif %}
	
	G90
	G1 X{printer.toolhead.axis_maximum.x-50} Y{printer.toolhead.axis_maximum.y-50} F{30*60}
	M400
	G28 X Y
	G0 X{printer.toolhead.axis_maximum.x-1} Y{printer.toolhead.axis_maximum.y-1} F{30*60}
	G4 P1000
	GET_POSITION
	
	
	G0 X{x_min} Y{y_min} Z{bound + 10} F{speed*60}
	
	
	{% if printer.configfile.settings.printer.minimum_cruise_ratio is defined %}
	SET_VELOCITY_LIMIT VELOCITY={speed} ACCEL={accel} MINIMUM_CRUISE_RATIO={min_cruise_ratio}
	{% else %}
	SET_VELOCITY_LIMIT VELOCITY={speed} ACCEL={accel} ACCEL_TO_DECEL={accel / 2}
	{% endif %}
	
	{% for i in range(iterations) %}
	
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_max} Y{y_max} F{speed*60}
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	G0 X{x_min} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	
	
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_min} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	
	
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_max} Y{y_center_max} F{speed*60}
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	G0 X{x_center_min} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	
	
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_min} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	{% endfor %}
	
	
	{% if printer.configfile.settings.printer.minimum_cruise_ratio is defined %}
	SET_VELOCITY_LIMIT VELOCITY={printer.configfile.settings.printer.max_velocity} ACCEL={printer.configfile.settings.printer.max_accel} MINIMUM_CRUISE_RATIO={printer.configfile.settings.printer.minimum_cruise_ratio}
	{% else %}
	SET_VELOCITY_LIMIT VELOCITY={printer.configfile.settings.printer.max_velocity} ACCEL={printer.configfile.settings.printer.max_accel} ACCEL_TO_DECEL={printer.configfile.settings.printer.max_accel_to_decel}
	{% endif %}
	
	
	M400
	G28
	
	G90
	G0 X{printer.toolhead.axis_maximum.x-1} Y{printer.toolhead.axis_maximum.y-1} F{30*60}
	G4 P1000
	GET_POSITION
	
	
	RESTORE_GCODE_STATE NAME=TEST_SPEED

[gcode_macro GET_TIMELAPSE_SETUP]
description = Print the Timelapse setup
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% set output_txt = ["Timelapse Setup:"] %}
	{% set _dummy = output_txt.append("enable: %s" % tl.enable) %}
	{% set _dummy = output_txt.append("park: %s" % tl.park.enable) %}
	{% if tl.park.enable %}
	{% set _dummy = output_txt.append("park position: %s time: %s s" % (tl.park.pos, tl.park.time)) %}
	{% set _dummy = output_txt.append("park cord x:%s y:%s dz:%s" % (tl.park.coord.x, tl.park.coord.y, tl.park.coord.dz)) %}
	{% set _dummy = output_txt.append("travel speed: %s mm/s" % tl.speed.travel) %}
	{% endif %}
	{% set _dummy = output_txt.append("fw_retract: %s" % tl.extruder.fw_retract) %}
	{% if not tl.extruder.fw_retract %}
	{% set _dummy = output_txt.append("retract: %s mm speed: %s mm/s" % (tl.extruder.retract, tl.speed.retract)) %}
	{% set _dummy = output_txt.append("extrude: %s mm speed: %s mm/s" % (tl.extruder.extrude, tl.speed.extrude)) %}
	{% endif %}
	{% set _dummy = output_txt.append("verbose: %s" % tl.verbose) %}
	{action_respond_info(output_txt|join("\n"))}

[gcode_macro _SET_TIMELAPSE_SETUP]
description = Set user parameters for timelapse
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	
	{% set min = printer.toolhead.axis_minimum %}
	{% set max = printer.toolhead.axis_maximum %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	{% set park = {'min'   : {'x': (min.x / 1.42)|round(3) if round_bed else min.x|round(3),
	'y': (min.y / 1.42)|round(3) if round_bed else min.y|round(3)},
	'max'   : {'x': (max.x / 1.42)|round(3) if round_bed else max.x|round(3),
	'y': (max.y / 1.42)|round(3) if round_bed else max.y|round(3)},
	'center': {'x': (max.x-(max.x-min.x)/2)|round(3),
	'y': (max.y-(max.y-min.y)/2)|round(3)}} %}
	
	{% if params.ENABLE %}
	{% if params.ENABLE|lower is in ['true', 'false'] %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=enable VALUE={True if params.ENABLE|lower == 'true' else False}
	{% else %}
	{action_raise_error("ENABLE=%s not supported. Allowed values are [True, False]" % params.ENABLE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.VERBOSE %}
	{% if params.VERBOSE|lower is in ['true', 'false'] %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=verbose VALUE={True if params.VERBOSE|lower == 'true' else False}
	{% else %}
	{action_raise_error("VERBOSE=%s not supported. Allowed values are [True, False]" % params.VERBOSE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_X %}
	{% if params.CUSTOM_POS_X|float >= min.x and params.CUSTOM_POS_X|float <= max.x %}
	{% set _dummy = tl.park.custom.update({'x':params.CUSTOM_POS_X|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_X=%s must be within [%s - %s]" % (params.CUSTOM_POS_X, min.x, max.x))}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_Y %}
	{% if params.CUSTOM_POS_Y|float >= min.y and params.CUSTOM_POS_Y|float <= max.y %}
	{% set _dummy = tl.park.custom.update({'y':params.CUSTOM_POS_Y|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_Y=%s must be within [%s - %s]" % (params.CUSTOM_POS_Y, min.y, max.y))}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_DZ %}
	{% if params.CUSTOM_POS_DZ|float >= min.z and params.CUSTOM_POS_DZ|float <= max.z %}
	{% set _dummy = tl.park.custom.update({'dz':params.CUSTOM_POS_DZ|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_DZ=%s must be within [%s - %s]" % (params.CUSTOM_POS_DZ, min.z, max.z))}
	{% endif %}
	{% endif %}
	{% if params.PARK_ENABLE %}
	{% if params.PARK_ENABLE|lower is in ['true', 'false'] %}
	{% set _dummy = tl.park.update({'enable':True if params.PARK_ENABLE|lower == 'true' else False}) %}
	{% else %}
	{action_raise_error("PARK_ENABLE=%s not supported. Allowed values are [True, False]" % params.PARK_ENABLE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.PARK_POS %}
	{% if params.PARK_POS|lower is in ['center','front_left','front_right','back_left','back_right','custom','x_only','y_only'] %}
	{% set dic = {'center'      : {'x': park.center.x   , 'y': park.center.y   , 'dz': 1                },
	'front_left'  : {'x': park.min.x      , 'y': park.min.y      , 'dz': 0                },
	'front_right' : {'x': park.max.x      , 'y': park.min.y      , 'dz': 0                },
	'back_left'   : {'x': park.min.x      , 'y': park.max.y      , 'dz': 0                },
	'back_right'  : {'x': park.max.x      , 'y': park.max.y      , 'dz': 0                },
	'custom'      : {'x': tl.park.custom.x, 'y': tl.park.custom.y, 'dz': tl.park.custom.dz},
	'x_only'      : {'x': tl.park.custom.x, 'y': 'none'          , 'dz': tl.park.custom.dz},
	'y_only'      : {'x': 'none'          , 'y': tl.park.custom.y, 'dz': tl.park.custom.dz}} %}
	{% set _dummy = tl.park.update({'pos':params.PARK_POS|lower}) %}
	{% set _dummy = tl.park.update({'coord':dic[tl.park.pos]}) %}
	{% else %}
	{action_raise_error("PARK_POS=%s not supported. Allowed values are [CENTER, FRONT_LEFT, FRONT_RIGHT, BACK_LEFT, BACK_RIGHT, CUSTOM, X_ONLY, Y_ONLY]"
	% params.PARK_POS|upper)}
	{% endif %}
	{% endif %}
	{% if params.PARK_TIME %}
	{% if params.PARK_TIME|float >= 0.0 %}
	{% set _dummy = tl.park.update({'time':params.PARK_TIME|float|round(3)}) %}
	{% else %}
	{action_raise_error("PARK_TIME=%s must be a positive number" % params.PARK_TIME)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=park VALUE="{tl.park}"
	{% if params.TRAVEL_SPEED %}
	{% if params.TRAVEL_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'travel':params.TRAVEL_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("TRAVEL_SPEED=%s must be larger than 0" % params.TRAVEL_SPEED)}
	{% endif %}
	{% endif %}
	{% if params.RETRACT_SPEED %}
	{% if params.RETRACT_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'retract':params.RETRACT_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("RETRACT_SPEED=%s must be larger than 0" % params.RETRACT_SPEED)}
	{% endif %}
	{% endif %}
	{% if params.EXTRUDE_SPEED %}
	{% if params.EXTRUDE_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'extrude':params.EXTRUDE_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("EXTRUDE_SPEED=%s must be larger than 0" % params.EXTRUDE_SPEED)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=speed VALUE="{tl.speed}"
	{% if params.EXTRUDE_DISTANCE %}
	{% if params.EXTRUDE_DISTANCE|float >= 0.0 %}
	{% set _dummy = tl.extruder.update({'extrude':params.EXTRUDE_DISTANCE|float|round(3)}) %}
	{% else %}
	{action_raise_error("EXTRUDE_DISTANCE=%s must be specified as positiv number" % params.EXTRUDE_DISTANCE)}
	{% endif %}
	{% endif %}
	{% if params.RETRACT_DISTANCE %}
	{% if params.RETRACT_DISTANCE|float >= 0.0 %}
	{% set _dummy = tl.extruder.update({'retract':params.RETRACT_DISTANCE|float|round(3)}) %}
	{% else %}
	{action_raise_error("RETRACT_DISTANCE=%s must be specified as positiv number" % params.RETRACT_DISTANCE)}
	{% endif %}
	{% endif %}
	{% if params.FW_RETRACT %}
	{% if params.FW_RETRACT|lower is in ['true', 'false'] %}
	{% if 'firmware_retraction' in printer.configfile.settings %}
	{% set _dummy = tl.extruder.update({'fw_retract': True if params.FW_RETRACT|lower == 'true' else False}) %}
	{% else %}
	{% set _dummy = tl.extruder.update({'fw_retract':False}) %}
	{% if params.FW_RETRACT|capitalize == 'True' %}
	{action_raise_error("[firmware_retraction] not defined in printer.cfg. Can not enable fw_retract")}
	{% endif %}
	{% endif %}
	{% else %}
	{action_raise_error("FW_RETRACT=%s not supported. Allowed values are [True, False]" % params.FW_RETRACT|capitalize)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=extruder VALUE="{tl.extruder}"
	{% if printer.configfile.settings['gcode_macro pause'] is defined %}
	{% set _dummy = tl.macro.update({'pause': printer.configfile.settings['gcode_macro pause'].rename_existing}) %}
	{% endif %}
	{% if printer.configfile.settings['gcode_macro resume'] is defined %}
	{% set _dummy = tl.macro.update({'resume': printer.configfile.settings['gcode_macro resume'].rename_existing}) %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=macro VALUE="{tl.macro}"

[gcode_macro TIMELAPSE_TAKE_FRAME]
description = Take Timelapse shoot
variable_enable = False
variable_takingframe = False
variable_park = {'enable': False,
	'pos'   : 'center',
	'time'  : 0.1,
	'custom': {'x': 0, 'y': 0, 'dz': 0},
	'coord' : {'x': 0, 'y': 0, 'dz': 0}}
variable_extruder = {'fw_retract': False,
	'retract': 1.0,
	'extrude': 1.0}
variable_speed = {'travel': 100,
	'retract': 15,
	'extrude': 15}
variable_verbose = True
variable_check_time = 0.5
variable_restore = {'absolute': {'coordinates': True, 'extrude': True}, 'speed': 1500, 'e':0, 'factor': {'speed': 1.0, 'extrude': 1.0}}
variable_macro = {'pause': 'PAUSE', 'resume': 'RESUME'}
variable_is_paused = False
gcode = 
	{% set hyperlapse = True if params.HYPERLAPSE and params.HYPERLAPSE|lower =='true' else False %}
	{% if enable %}
	{% if (hyperlapse and printer['gcode_macro HYPERLAPSE'].run) or
	(not hyperlapse and not printer['gcode_macro HYPERLAPSE'].run) %}
	{% if park.enable %}
	{% set pos = {'x': 'X' + park.coord.x|string if park.pos != 'y_only' else '',
	'y': 'Y' + park.coord.y|string if park.pos != 'x_only' else '',
	'z': 'Z'+ [printer.gcode_move.gcode_position.z + park.coord.dz, printer.toolhead.axis_maximum.z]|min|string} %}
	{% set restore = {'absolute': {'coordinates': printer.gcode_move.absolute_coordinates,
	'extrude'    : printer.gcode_move.absolute_extrude},
	'speed'   : printer.gcode_move.speed,
	'e'       : printer.gcode_move.gcode_position.e,
	'factor'  : {'speed'  : printer.gcode_move.speed_factor,
	'extrude': printer.gcode_move.extrude_factor}} %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=restore VALUE="{restore}"
	{% if not printer[printer.toolhead.extruder].can_extrude %}
	{% if verbose %}{action_respond_info("Timelapse: Warning, minimum extruder temperature not reached!")}{% endif %}
	{% else %}
	{% if extruder.fw_retract %}
	G10
	{% else %}
	M83
	G0 E-{extruder.retract} F{speed.retract * 60}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=is_paused VALUE=True
	{macro.pause}
	SET_GCODE_OFFSET X=0 Y=0
	G90
	{% if "xyz" not in printer.toolhead.homed_axes %}
	{% if verbose %}{action_respond_info("Timelapse: Warning, axis not homed yet!")}{% endif %}
	{% else %}
	G0 {pos.x} {pos.y} {pos.z} F{speed.travel * 60}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=takingframe VALUE=True
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_TAKE_FRAME DURATION={check_time}
	M400
	{% endif %}
	_TIMELAPSE_NEW_FRAME HYPERLAPSE={hyperlapse}
	{% endif %}
	{% else %}
	{% if verbose %}{action_respond_info("Timelapse: disabled, take frame ignored")}{% endif %}
	{% endif %}

[gcode_macro _TIMELAPSE_NEW_FRAME]
description = action call for timelapse shoot. must be a seperate macro
gcode = 
	{action_call_remote_method("timelapse_newframe",
	macropark=printer['gcode_macro TIMELAPSE_TAKE_FRAME'].park,
	hyperlapse=params.HYPERLAPSE)}

[delayed_gcode _WAIT_TIMELAPSE_TAKE_FRAME]
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% set factor = {'speed': printer.gcode_move.speed_factor, 'extrude': printer.gcode_move.extrude_factor} %}
	{% if tl.takingframe %}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_TAKE_FRAME DURATION={tl.check_time}
	{% else %}
	{tl.macro.resume} VELOCITY={tl.speed.travel}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=is_paused VALUE=False
	{% if not printer[printer.toolhead.extruder].can_extrude %}
	{action_respond_info("Timelapse: Warning minimum extruder temperature not reached!")}
	{% else %}
	{% if tl.extruder.fw_retract %}
	G11
	{% else %}
	G0 E{tl.extruder.extrude} F{tl.speed.extrude * 60}
	G0 F{tl.restore.speed}
	{% if tl.restore.absolute.extrude %}
	M82
	G92 E{tl.restore.e}
	{% endif %}
	{% endif %}
	{% endif %}
	{% if tl.restore.factor.speed   != factor.speed   %} M220 S{(factor.speed*100)|round(0)}   {% endif %}
	{% if tl.restore.factor.extrude != factor.extrude %} M221 S{(factor.extrude*100)|round(0)} {% endif %}
	{% if not tl.restore.absolute.coordinates %} G91 {% endif %}
	{% endif %}

[gcode_macro HYPERLAPSE]
description = Start/Stop a hyperlapse recording
variable_cycle = 0
variable_run = False
gcode = 
	{% set cycle = params.CYCLE|default(30)|int %}
	{% if params.ACTION and params.ACTION|lower == 'start' %}
	{action_respond_info("Hyperlapse: frames started (Cycle %d sec)" % cycle)}
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=run VALUE=True
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=cycle VALUE={cycle}
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION={cycle}
	TIMELAPSE_TAKE_FRAME HYPERLAPSE=True
	{% elif params.ACTION and params.ACTION|lower == 'stop' %}
	{% if run %}{action_respond_info("Hyperlapse: frames stopped")}{% endif %}
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=run VALUE=False
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION=0
	{% else %}
	{action_raise_error("Hyperlapse: No valid input parameter
	Use:
	- HYPERLAPSE ACTION=START [CYCLE=time]
	- HYPERLAPSE ACTION=STOP")}
	{% endif %}

[delayed_gcode _HYPERLAPSE_LOOP]
gcode = 
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION={printer["gcode_macro HYPERLAPSE"].cycle}
	TIMELAPSE_TAKE_FRAME HYPERLAPSE=True

[gcode_macro TIMELAPSE_RENDER]
description = Render Timelapse video and wait for the result
variable_render = False
variable_run_identifier = 0
gcode = 
	{action_respond_info("Timelapse: Rendering started")}
	{action_call_remote_method("timelapse_render", byrendermacro="True")}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_RENDER VARIABLE=render VALUE=True
	{printer.configfile.settings['gcode_macro pause'].rename_existing}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_RENDER DURATION=0.5

[delayed_gcode _WAIT_TIMELAPSE_RENDER]
gcode = 
	{% set ri = printer['gcode_macro TIMELAPSE_RENDER'].run_identifier % 4 %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_RENDER VARIABLE=run_identifier VALUE={ri + 1}
	{% if printer['gcode_macro TIMELAPSE_RENDER'].render %}
	M117 Rendering {['-','\\','|','/'][ri]}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_RENDER DURATION=0.5
	{% else %}
	{action_respond_info("Timelapse: Rendering finished")}
	M117
	{printer.configfile.settings['gcode_macro resume'].rename_existing}
	{% endif %}

[gcode_macro TEST_STREAM_DELAY]
description = Helper macro to find stream and park delay
gcode = 
	{% set min = printer.toolhead.axis_minimum %}
	{% set max = printer.toolhead.axis_maximum %}
	{% set act = printer.toolhead.position %}
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% if act.z > 5.0 %}
	G0 X{min.x + 5.0} F{tl.speed.travel|int * 60}
	G0 X{(max.x-min.x)/2}
	G4 P{tl.park.time|float * 1000}
	_TIMELAPSE_NEW_FRAME HYPERLAPSE=FALSE
	G0 X{max.x - 5.0}
	{% else %}
	{action_raise_error("Toolhead z %.3f to low. Please place head above z = 5.0" % act.z)}
	{% endif %}

[gcode_macro _OBICO_LAYER_CHANGE]
description = Run a scan across the current print area
variable_first_layer_scan_retract_length = 6
variable_first_layer_scan_retract_speed = 15
variable_first_layer_scan_cooldown_temp = 170
variable_first_layer_scan_resume_speed = 50
variable_first_layer_scan_enabled = True
variable_first_layer_scan_stepover = 10
variable_first_layer_scan_speed = 10
variable_first_layer_scan_zhop = 4
variable_first_layer_scan_zhop_speed = 15
variable_verbose = False
variable_current_layer = -1
variable_first_layer_scanning = False
variable_wait = {'resume': "RESUME", 'absolute_coordinates': True, 'absolute_extrude': True, 'e': 0.0, 'previous_temp': 0}
gcode = 
	
	{% set pause_macro  = "PAUSE"  if printer.configfile.settings['gcode_macro pause']  is not defined
	else printer.configfile.settings['gcode_macro pause'].rename_existing %}
	{% set resume_macro = "RESUME" if printer.configfile.settings['gcode_macro resume'] is not defined
	else printer.configfile.settings['gcode_macro resume'].rename_existing %}
	
	{% set current_layer_default = printer.print_stats.info.current_layer if printer.print_stats.info.current_layer is not none else -1 %}
	{% set current_layer = params.CURRENT_LAYER|default(current_layer_default)|int %}
	
	{% set polygon_points = printer.exclude_object.objects|map(attribute='polygon')|sum(start=[]) if printer.exclude_object is defined else [] %}
	{% set min_x = params.MINX|default(polygon_points|map(attribute=0)|min|default(printer.toolhead.axis_minimum.x))|float %}
	{% set min_y = params.MINY|default(polygon_points|map(attribute=1)|min|default(printer.toolhead.axis_minimum.y))|float %}
	{% set max_x = params.MAXX|default(polygon_points|map(attribute=0)|max|default(printer.toolhead.axis_maximum.x))|float %}
	{% set max_y = params.MAXY|default(polygon_points|map(attribute=1)|max|default(printer.toolhead.axis_maximum.y))|float %}
	
	{% set stepoverCount = ((max_y - min_y) / first_layer_scan_stepover|float)|round(method='ceil')|int %}
	
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Layer %d" % (current_layer)}' {% endif %}
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=current_layer VALUE={current_layer}
	
	{% if first_layer_scan_enabled and current_layer == 2 %}
	
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=first_layer_scanning VALUE=True
	
	
	{% set wait_dic = {'resume'              : resume_macro,
	'absolute_coordinates': printer.gcode_move.absolute_coordinates,
	'absolute_extrude'    : printer.gcode_move.absolute_extrude,
	'e'                   : printer.gcode_move.gcode_position.e,
	'previous_temp'       : printer.extruder.target} %}
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=wait VALUE="{wait_dic}"
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Prepare scanning" {% endif %}
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Scan Coordinates: Min:[%.3f:%.3f] Max:[%.3f:%.3f]" % (min_x,min_y,max_x,max_y)}' {% endif %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Retract %.1fmm filament" % first_layer_scan_retract_length|abs}' {% endif %}
	M83
	G0 E-{first_layer_scan_retract_length|abs} F{first_layer_scan_retract_speed|float * 60}
	{% endif %}
	G91
	G0 Z{first_layer_scan_zhop|abs} F{first_layer_scan_zhop_speed|float * 60}
	
	
	M106 S255
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Fan on and lowering temperature to %.1f" % first_layer_scan_cooldown_temp}' {% endif %}
	M104 S{first_layer_scan_cooldown_temp}
	M109 S{first_layer_scan_cooldown_temp}
	
	{pause_macro}
	
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Start scanning" {% endif %}
	
	UPDATE_DELAYED_GCODE ID=_WAIT_OBICO_LAYER_CHANGE DURATION=1.0
	G90
	G0 X{min_x} Y{min_y} F{first_layer_scan_resume_speed|float * 60}
	{% for ystep in range(stepoverCount) %}
	G0 Y{min_y + first_layer_scan_stepover|float * ystep} F{first_layer_scan_speed|float * 60}
	G0 X{max_x if ystep % 2 == 0 else min_x}              F{first_layer_scan_speed|float * 60}
	{% endfor %}
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Finish scanning" {% endif %}
	
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=first_layer_scanning VALUE=False
	
	{% endif %}

[delayed_gcode _WAIT_OBICO_LAYER_CHANGE]
gcode = 
	{% set lc_macro = printer['gcode_macro _OBICO_LAYER_CHANGE'] %}
	{% if lc_macro.first_layer_scanning %}
	
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Waiting for first layer scan..." {% endif %}
	UPDATE_DELAYED_GCODE ID=_WAIT_OBICO_LAYER_CHANGE DURATION=1.0
	{% else %}
	
	M107
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Fan off and resume print" {% endif %}
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Call %s VELOCITY=%.1f" % (lc_macro.wait.resume, lc_macro.first_layer_scan_resume_speed)}' {% endif %}
	{lc_macro.wait.resume} VELOCITY={lc_macro.first_layer_scan_resume_speed}
	G91
	G0 Z-{lc_macro.first_layer_scan_zhop|abs} F{lc_macro.first_layer_scan_zhop_speed|float * 60}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% set first_layer_scan_unretract_length = lc_macro.first_layer_scan_retract_length + 0.5 %}
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Extrude %.1fmm filament" % first_layer_scan_unretract_length|abs}' {% endif %}
	M83
	G0 E{first_layer_scan_unretract_length|abs} F{lc_macro.first_layer_scan_retract_speed|float * 60}
	{% endif %}
	
	
	M104 S{lc_macro.wait.previous_temp}
	M109 S{lc_macro.wait.previous_temp}
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Heating back up to previous temperature"}' {% endif %}
	
	
	{% if lc_macro.wait.absolute_coordinates %} G90 {% endif %}
	{% if lc_macro.wait.absolute_extrude %}
	M82
	G92 E{lc_macro.wait.e}
	{% endif %}
	{% endif %}

[gcode_macro OBICO_LINK_STATUS]
description = Link to Obico server
variable_one_time_passcode = ''
variable_one_time_passlink = ''
variable_is_linked = False
gcode = 
	{action_respond_info('Obico one_time_passcode: {}'.format(one_time_passcode))}
	{action_respond_info('Obico one_time_passlink: {}'.format(one_time_passlink))}
	{action_respond_info('Obico is_linked: {}'.format(is_linked))}
	{% if not is_linked and one_time_passcode != '' %}
	M117 Code: {one_time_passcode}
	{% else %}
	M117 Obico linked
	{% endif %}

[gcode_macro _OBICO_RELINK]
description = Re-link to Obico server
gcode = 
	{action_respond_info('WARNING: Re-link to Obico server')}
	{action_call_remote_method("obico_remote_event", event_name='relink_obico', message='')}
	{action_respond_info('WARNING: relink_obico requested')}

[exclude_object]

[mcu]
serial = /dev/serial/by-id/usb-1a86_USB_Serial-if00-port0
restart_method = command

[temperature_sensor raspberry_pi]
sensor_type = temperature_host
min_temp = 10
max_temp = 100

[temperature_sensor mcu_temp]
sensor_type = temperature_mcu
min_temp = 0
max_temp = 100

[printer]
kinematics = cartesian
max_velocity = 200
max_accel = 4000
max_z_velocity = 10
max_z_accel = 100
minimum_cruise_ratio = 0.5
square_corner_velocity = 5

[stepper_x]
step_pin = PB9
dir_pin = PC2
enable_pin = !PC3
microsteps = 16
rotation_distance = 40
endstop_pin = ^PA5
position_endstop = 0
position_max = 230
homing_speed = 50

[stepper_y]
step_pin = PB7
dir_pin = PB8
enable_pin = !PC3
microsteps = 16
rotation_distance = 40
endstop_pin = ^PA6
position_endstop = 0
position_max = 231
homing_speed = 50

[stepper_z]
step_pin = PB5
dir_pin = !PB6
enable_pin = !PC3
microsteps = 16
rotation_distance = 8
endstop_pin = probe:z_virtual_endstop
position_max = 250
position_min = -4
homing_speed = 4
second_homing_speed = 1
homing_retract_dist = 2.0

[fan]
pin = PA0

[extruder]
max_extrude_only_distance = 100.0
step_pin = PB3
dir_pin = PB4
enable_pin = !PC3
microsteps = 16
gear_ratio = 42:12
rotation_distance = 26.359
nozzle_diameter = 0.400
filament_diameter = 1.750
heater_pin = PA1
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PC5
min_temp = 0
max_temp = 300
min_extrude_temp = 170
pressure_advance = .0369
pressure_advance_smooth_time = 0.04
control = pid
pid_kp = 19.195
pid_ki = 1.000
pid_kd = 92.135

[firmware_retraction]
retract_length = 0.3
retract_speed = 20

[idle_timeout]
gcode = 
	{% if printer.pause_resume.is_paused %}
	M118 Idle timeout while paused, turning off hotend
	SET_HEATER_TEMPERATURE HEATER=extruder TARGET=0
	{% else %}
	M118 Idle timeout
	TURN_OFF_HEATERS
	M84
	{% endif %}
timeout = 1800

[heater_bed]
heater_pin = PA2
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PC4
min_temp = 0
max_temp = 130
control = pid
pid_kp = 68.601
pid_ki = 1.185
pid_kd = 993.000

[bltouch]
sensor_pin = ^PB1
control_pin = PB0
x_offset = -31.8
y_offset = -40.5
speed = 35
samples = 2
samples_result = median
samples_tolerance = 0.05
samples_tolerance_retries = 2
sample_retract_dist = 5.0
probe_with_touch_mode = true
stow_on_each_sample = false
z_offset = 2.049

[safe_z_home]
home_xy_position = 147, 154
speed = 75
z_hop = 10
z_hop_speed = 5
move_to_previous = false

[bed_screws]
screw1 = 30,51
screw1_name = "FL"
screw2 = 200,51
screw2_name = "FR"
screw3 = 200,195
screw3_name = "RR"
screw4 = 30,195
screw4_name = "RL"

[screws_tilt_adjust]
screw1 = 67, 67
screw1_name = front left screw
screw2 = 230, 67
screw2_name = front right screw
screw3 = 230, 230
screw3_name = rear right screw
screw4 = 67.60, 230
screw4_name = rear left screw
horizontal_move_z = 10
speed = 200
screw_thread = CW-M4

[bed_mesh]
speed = 120
mesh_min = 10,11
mesh_max = 195,182
probe_count = 3,3
algorithm = bicubic
fade_start = 1
fade_end = 10
fade_target = 0

[filament_motion_sensor SFS_T0]
detection_length = 150.00
extruder = extruder
switch_pin = PA4
pause_on_runout = True
event_delay = 3.0
pause_delay = 0.5
runout_gcode = 
	M117 Runout Detected!

[delayed_gcode DISABLEFILAMENTSENSOR]
initial_duration = 1
gcode = 
	SET_FILAMENT_SENSOR SENSOR=SFS_T0 ENABLE=0

[gcode_macro SFS_ENABLE]
description = Enable smart filament sensor
gcode = 
	M117 ENABLING the Smart Filament Sensor
	G92 E0
	SET_FILAMENT_SENSOR SENSOR=SFS_T0 ENABLE=1

[gcode_macro SFS_DISABLE]
description = Disable smart filament sensor
gcode = 
	M117 DISABLING the Smart Filament Sensor
	G92 E0
	SET_FILAMENT_SENSOR SENSOR=SFS_T0 ENABLE=0

[gcode_macro FILAMENT_RUNOUT]
gcode = 
	M117 Runout Detected!
	M300 S1 P10
	M600
	M300 S1 P10

[gcode_macro M300]
gcode = 
	{% set S = params.S|default(1000)|int %}
	{% set P = params.P|default(100)|int %}
	SET_PIN PIN=BEEPER VALUE=0.5 CYCLE_TIME={ 1.0/S if S > 0 else 1 }
	G4 P{P}
	SET_PIN PIN=BEEPER VALUE=0
	[gcode_macro M600]
	gcode:
	{% set X = params.X|default(25)|float %}
	{% set Y = params.Y|default(25)|float %}
	{% set Z = params.Z|default(10)|float %}
	SAVE_GCODE_STATE NAME=M600_state
	PAUSE
	G91
	G1 E-.8 F2700
	G1 Z{Z}
	G90
	G1 X{X} Y{Y} F3000
	G91
	G1 E-15 F1000
	RESTORE_GCODE_STATE NAME=M600_state

[gcode_arcs]
resolution = 1.0

[input_shaper]
shaper_freq_x = 73.5
shaper_type_x = ei
shaper_freq_y = 76.9
shaper_type_y = mzv
=======================
bed_mesh: bicubic interpolation with a probe_count of less than 4 points detected.  Forcing lagrange interpolation. Configured Probe Count: 3, 3
Extruder max_extrude_ratio=0.266081
mcu 'mcu': Starting serial connect
mcu 'mcu': got {'oid': 12, 'next_clock': 3475272704, 'value': 31548, '#name': 'analog_in_state', '#sent_time': 23.304659097000002, '#receive_time': 23.322832115}
Resetting prediction variance 23.366: freq=72000000 diff=-550736 stddev=72000.000
mcu 'mcu': got {'oid': 17, 'next_clock': 3478872704, 'value': 31496, '#name': 'analog_in_state', '#sent_time': 23.366307578, '#receive_time': 23.372804134000003}
Resetting prediction variance 23.421: freq=63066501 diff=490511 stddev=72000.000
Resetting prediction variance 23.476: freq=66412126 diff=407804 stddev=72000.000
Resetting prediction variance 23.530: freq=67959723 diff=368877 stddev=72000.000
mcu 'mcu': got {'oid': 10, 'next_clock': 3495432704, 'value': 14000, '#name': 'analog_in_state', '#sent_time': 23.586085708000002, '#receive_time': 23.602852615}
mcu 'mcu': got {'oid': 12, 'next_clock': 3496872704, 'value': 31548, '#name': 'analog_in_state', '#sent_time': 23.586085708000002, '#receive_time': 23.622865652}
mcu 'mcu': got {'oid': 17, 'next_clock': 3500472704, 'value': 31499, '#name': 'analog_in_state', '#sent_time': 23.640393004, '#receive_time': 23.672832763000002}
Loaded MCU 'mcu' 119 commands (v0.12.0-286-g81de9a861 / gcc: (15:8-2019-q3-1+b1) 8.3.1 20190703 (release) [gcc-8-branch revision 273027] binutils: (2.35.2-2+14+b2) 2.35.2)
MCU 'mcu' config: ADC_MAX=4095 BUS_PINS_i2c1=PB6,PB7 BUS_PINS_i2c1a=PB8,PB9 BUS_PINS_i2c2=PB10,PB11 BUS_PINS_spi1=PA6,PA7,PA5 BUS_PINS_spi1a=PB4,PB5,PB3 BUS_PINS_spi2=PB14,PB15,PB13 BUS_PINS_spi3=PB4,PB5,PB3 CLOCK_FREQ=72000000 MCU=stm32f103xe PWM_MAX=255 RECEIVE_WINDOW=192 RESERVE_PINS_serial=PA10,PA9 SERIAL_BAUD=250000 STATS_SUMSQ_BASE=256 STEPPER_BOTH_EDGE=1
mcu_temperature 'mcu' nominal base=357.558140 slope=-767.441860
Configured MCU 'mcu' (1024 moves)
Starting heater checks for heater_bed
webhooks client 548287232320: New connection
bed_mesh: generated points
Index |  Tool Adjusted  |   Probe
  0   | (41.8, 51.5)    | (10.0, 11.0)
  1   | (134.3, 51.5)   | (102.5, 11.0)
  2   | (226.8, 51.5)   | (195.0, 11.0)
  3   | (226.8, 137.0)  | (195.0, 96.5)
  4   | (134.3, 137.0)  | (102.5, 96.5)
  5   | (41.8, 137.0)   | (10.0, 96.5)
  6   | (41.8, 222.5)   | (10.0, 182.0)
  7   | (134.3, 222.5)  | (102.5, 182.0)
  8   | (226.8, 222.5)  | (195.0, 182.0)
Starting heater checks for extruder
MCU 'mcu' configured for 72Mhz but running at 71Mhz!
Stats 24.8: gcodein=0  mcu: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=1146 bytes_read=4624 bytes_retransmit=9 bytes_invalid=0 send_seq=125 receive_seq=125 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=70510172  raspberry_pi: temp=52.6 mcu_temp: temp=0.0 heater_bed: target=0 temp=0.0 pwm=0.000 sysload=1.83 cputime=1.866 memavail=1509956 print_time=109.310 buffer_time=0.249 print_stall=0 extruder: target=0 temp=0.0 pwm=0.000
webhooks client 548287232320: Client info {'program': 'Moonraker', 'version': 'v0.9.3-3-gccfe32f'}
webhooks: registering remote method 'shutdown_machine' for connection id: 548287232320
webhooks: registering remote method 'reboot_machine' for connection id: 548287232320
webhooks: registering remote method 'pause_job_queue' for connection id: 548287232320
webhooks: registering remote method 'start_job_queue' for connection id: 548287232320
webhooks: registering remote method 'spoolman_set_active_spool' for connection id: 548287232320
Stats 25.8: gcodein=0  mcu: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=1152 bytes_read=4820 bytes_retransmit=9 bytes_invalid=0 send_seq=126 receive_seq=126 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=70510172  raspberry_pi: temp=52.1 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=1.77 cputime=1.898 memavail=1505352 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.6 pwm=0.000
Stats 26.8: gcodein=0  mcu: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=1158 bytes_read=4971 bytes_retransmit=9 bytes_invalid=0 send_seq=127 receive_seq=127 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=70510172  raspberry_pi: temp=52.1 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.77 cputime=1.940 memavail=1504824 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.6 pwm=0.000
Stats 27.8: gcodein=0  mcu: mcu_awake=0.006 mcu_task_avg=0.000028 mcu_task_stddev=0.000013 bytes_write=1164 bytes_read=5137 bytes_retransmit=9 bytes_invalid=0 send_seq=128 receive_seq=128 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=70510172  raspberry_pi: temp=51.1 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.77 cputime=1.954 memavail=1503116 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
webhooks: registering remote method 'obico_remote_event' for connection id: 548287232320
Stats 28.8: gcodein=0  mcu: mcu_awake=0.006 mcu_task_avg=0.000028 mcu_task_stddev=0.000013 bytes_write=1170 bytes_read=5333 bytes_retransmit=9 bytes_invalid=0 send_seq=129 receive_seq=129 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=70510172  raspberry_pi: temp=53.6 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.77 cputime=1.974 memavail=1494612 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.6 pwm=0.000
Stats 29.8: gcodein=0  mcu: mcu_awake=0.006 mcu_task_avg=0.000028 mcu_task_stddev=0.000013 bytes_write=1176 bytes_read=5484 bytes_retransmit=9 bytes_invalid=0 send_seq=130 receive_seq=130 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=70510172  raspberry_pi: temp=51.6 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.77 cputime=1.989 memavail=1496260 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 30.8: gcodein=0  mcu: mcu_awake=0.006 mcu_task_avg=0.000028 mcu_task_stddev=0.000013 bytes_write=1182 bytes_read=5635 bytes_retransmit=9 bytes_invalid=0 send_seq=131 receive_seq=131 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=70510172  raspberry_pi: temp=50.6 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.95 cputime=2.000 memavail=1497376 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.6 pwm=0.000
Stats 31.8: gcodein=0  mcu: mcu_awake=0.006 mcu_task_avg=0.000028 mcu_task_stddev=0.000013 bytes_write=1188 bytes_read=5831 bytes_retransmit=9 bytes_invalid=0 send_seq=132 receive_seq=132 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=70510172  raspberry_pi: temp=51.6 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.95 cputime=2.012 memavail=1483184 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.6 pwm=0.000
Stats 32.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1194 bytes_read=5996 bytes_retransmit=9 bytes_invalid=0 send_seq=133 receive_seq=133 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=70510172  raspberry_pi: temp=51.1 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.95 cputime=2.023 memavail=1483252 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 33.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1200 bytes_read=6147 bytes_retransmit=9 bytes_invalid=0 send_seq=134 receive_seq=134 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=70510172  raspberry_pi: temp=50.6 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=1.95 cputime=2.033 memavail=1483008 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Resetting prediction variance 34.586: freq=70510172 diff=16289326 stddev=132823.323
Stats 34.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1206 bytes_read=6328 bytes_retransmit=9 bytes_invalid=0 send_seq=135 receive_seq=135 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71956666  raspberry_pi: temp=51.1 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.95 cputime=2.046 memavail=1482316 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 35.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1212 bytes_read=6469 bytes_retransmit=9 bytes_invalid=0 send_seq=136 receive_seq=136 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71962165  raspberry_pi: temp=51.1 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.35 cputime=2.063 memavail=1482316 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 36.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1218 bytes_read=6610 bytes_retransmit=9 bytes_invalid=0 send_seq=137 receive_seq=137 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71964976  raspberry_pi: temp=50.6 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.35 cputime=2.080 memavail=1482316 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 37.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1224 bytes_read=6810 bytes_retransmit=9 bytes_invalid=0 send_seq=138 receive_seq=138 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71967083  raspberry_pi: temp=50.1 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.35 cputime=2.099 memavail=1482324 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 38.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1230 bytes_read=6961 bytes_retransmit=9 bytes_invalid=0 send_seq=139 receive_seq=139 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71968826  raspberry_pi: temp=50.1 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=2.35 cputime=2.115 memavail=1482328 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.6 pwm=0.000
Stats 39.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1236 bytes_read=7112 bytes_retransmit=9 bytes_invalid=0 send_seq=140 receive_seq=140 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71970350  raspberry_pi: temp=50.1 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.35 cputime=2.130 memavail=1482328 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 40.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1242 bytes_read=7308 bytes_retransmit=9 bytes_invalid=0 send_seq=141 receive_seq=141 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71971810  raspberry_pi: temp=50.6 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.48 cputime=2.150 memavail=1481880 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 41.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1248 bytes_read=7459 bytes_retransmit=9 bytes_invalid=0 send_seq=142 receive_seq=142 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71973084  raspberry_pi: temp=49.2 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.48 cputime=2.167 memavail=1481664 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.6 pwm=0.000
Stats 42.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1254 bytes_read=7610 bytes_retransmit=9 bytes_invalid=0 send_seq=143 receive_seq=143 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71974261  raspberry_pi: temp=50.6 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.48 cputime=2.183 memavail=1480792 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 43.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1260 bytes_read=7820 bytes_retransmit=9 bytes_invalid=0 send_seq=144 receive_seq=144 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71975362  raspberry_pi: temp=50.6 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.48 cputime=2.202 memavail=1480840 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.6 pwm=0.000
Stats 44.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1266 bytes_read=7971 bytes_retransmit=9 bytes_invalid=0 send_seq=145 receive_seq=145 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71976394  raspberry_pi: temp=49.2 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.48 cputime=2.218 memavail=1480088 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 45.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1272 bytes_read=8122 bytes_retransmit=9 bytes_invalid=0 send_seq=146 receive_seq=146 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71977374  raspberry_pi: temp=50.1 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.61 cputime=2.235 memavail=1478096 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 46.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1278 bytes_read=8318 bytes_retransmit=9 bytes_invalid=0 send_seq=147 receive_seq=147 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71978281  raspberry_pi: temp=50.6 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.61 cputime=2.246 memavail=1475292 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.6 pwm=0.000
Stats 47.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1284 bytes_read=8469 bytes_retransmit=9 bytes_invalid=0 send_seq=148 receive_seq=148 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71979180  raspberry_pi: temp=49.7 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.61 cputime=2.257 memavail=1475292 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 48.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1290 bytes_read=8634 bytes_retransmit=9 bytes_invalid=0 send_seq=149 receive_seq=149 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71979993  raspberry_pi: temp=49.7 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.61 cputime=2.267 memavail=1475292 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 49.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1296 bytes_read=8830 bytes_retransmit=9 bytes_invalid=0 send_seq=150 receive_seq=150 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71980761  raspberry_pi: temp=50.6 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.61 cputime=2.278 memavail=1475292 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.6 pwm=0.000
Stats 50.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1302 bytes_read=8981 bytes_retransmit=9 bytes_invalid=0 send_seq=151 receive_seq=151 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71981507  raspberry_pi: temp=50.1 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.56 cputime=2.289 memavail=1475292 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 51.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1308 bytes_read=9132 bytes_retransmit=9 bytes_invalid=0 send_seq=152 receive_seq=152 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71982213  raspberry_pi: temp=51.1 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.56 cputime=2.306 memavail=1475300 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.6 pwm=0.000
Stats 52.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1314 bytes_read=9328 bytes_retransmit=9 bytes_invalid=0 send_seq=153 receive_seq=153 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71982876  raspberry_pi: temp=49.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.56 cputime=2.322 memavail=1475300 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 53.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1320 bytes_read=9493 bytes_retransmit=9 bytes_invalid=0 send_seq=154 receive_seq=154 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71983514  raspberry_pi: temp=48.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.56 cputime=2.340 memavail=1475300 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 54.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1326 bytes_read=9644 bytes_retransmit=9 bytes_invalid=0 send_seq=155 receive_seq=155 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71984119  raspberry_pi: temp=49.2 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=2.56 cputime=2.357 memavail=1475052 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 55.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1332 bytes_read=9840 bytes_retransmit=9 bytes_invalid=0 send_seq=156 receive_seq=156 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71984694  raspberry_pi: temp=48.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.59 cputime=2.374 memavail=1474808 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 56.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1338 bytes_read=9991 bytes_retransmit=9 bytes_invalid=0 send_seq=157 receive_seq=157 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71985243  raspberry_pi: temp=49.2 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.59 cputime=2.392 memavail=1474816 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 57.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1344 bytes_read=10142 bytes_retransmit=9 bytes_invalid=0 send_seq=158 receive_seq=158 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71985766  raspberry_pi: temp=49.2 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=2.59 cputime=2.408 memavail=1474568 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.6 pwm=0.000
Stats 58.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1350 bytes_read=10352 bytes_retransmit=9 bytes_invalid=0 send_seq=159 receive_seq=159 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71986266  raspberry_pi: temp=49.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.59 cputime=2.427 memavail=1474568 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 59.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1356 bytes_read=10503 bytes_retransmit=9 bytes_invalid=0 send_seq=160 receive_seq=160 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71986742  raspberry_pi: temp=49.2 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.59 cputime=2.445 memavail=1474548 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.6 pwm=0.000
Stats 60.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1362 bytes_read=10654 bytes_retransmit=9 bytes_invalid=0 send_seq=161 receive_seq=161 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71987210  raspberry_pi: temp=50.1 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.63 cputime=2.463 memavail=1474604 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.6 pwm=0.000
Stats 61.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1368 bytes_read=10850 bytes_retransmit=9 bytes_invalid=0 send_seq=162 receive_seq=162 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71987644  raspberry_pi: temp=49.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.63 cputime=2.480 memavail=1474604 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.6 pwm=0.000
Stats 62.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1374 bytes_read=11001 bytes_retransmit=9 bytes_invalid=0 send_seq=163 receive_seq=163 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71988060  raspberry_pi: temp=49.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=2.63 cputime=2.495 memavail=1474368 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 63.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1380 bytes_read=11166 bytes_retransmit=9 bytes_invalid=0 send_seq=164 receive_seq=164 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71988460  raspberry_pi: temp=49.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.63 cputime=2.513 memavail=1474400 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 64.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1386 bytes_read=11362 bytes_retransmit=9 bytes_invalid=0 send_seq=165 receive_seq=165 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71988848  raspberry_pi: temp=49.2 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.63 cputime=2.530 memavail=1474148 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 65.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1392 bytes_read=11513 bytes_retransmit=9 bytes_invalid=0 send_seq=166 receive_seq=166 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71989215  raspberry_pi: temp=49.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.74 cputime=2.547 memavail=1474148 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 66.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1398 bytes_read=11679 bytes_retransmit=9 bytes_invalid=0 send_seq=167 receive_seq=167 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71989567  raspberry_pi: temp=49.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.74 cputime=2.564 memavail=1474356 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.6 pwm=0.000
Stats 67.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1404 bytes_read=11860 bytes_retransmit=9 bytes_invalid=0 send_seq=168 receive_seq=168 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71989906  raspberry_pi: temp=49.2 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=2.74 cputime=2.582 memavail=1474180 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 68.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1410 bytes_read=12025 bytes_retransmit=9 bytes_invalid=0 send_seq=169 receive_seq=169 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71990248  raspberry_pi: temp=48.2 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.74 cputime=2.599 memavail=1474180 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 69.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1416 bytes_read=12191 bytes_retransmit=9 bytes_invalid=0 send_seq=170 receive_seq=170 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71990558  raspberry_pi: temp=51.1 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.74 cputime=2.613 memavail=1456988 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 70.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1422 bytes_read=12372 bytes_retransmit=9 bytes_invalid=0 send_seq=171 receive_seq=171 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71990856  raspberry_pi: temp=49.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.92 cputime=2.627 memavail=1445668 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 71.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1428 bytes_read=12523 bytes_retransmit=9 bytes_invalid=0 send_seq=172 receive_seq=172 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71991144  raspberry_pi: temp=51.1 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.92 cputime=2.638 memavail=1419980 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.6 pwm=0.000
Stats 72.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1434 bytes_read=12689 bytes_retransmit=9 bytes_invalid=0 send_seq=173 receive_seq=173 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71991434  raspberry_pi: temp=51.1 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=2.92 cputime=2.651 memavail=1407644 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 73.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1440 bytes_read=12884 bytes_retransmit=9 bytes_invalid=0 send_seq=174 receive_seq=174 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71991705  raspberry_pi: temp=50.1 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.92 cputime=2.664 memavail=1377156 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.6 pwm=0.000
Stats 74.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1446 bytes_read=13035 bytes_retransmit=9 bytes_invalid=0 send_seq=175 receive_seq=175 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71991961  raspberry_pi: temp=51.1 mcu_temp: temp=29.4 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.92 cputime=2.678 memavail=1406120 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 75.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1452 bytes_read=13201 bytes_retransmit=9 bytes_invalid=0 send_seq=176 receive_seq=176 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71992209  raspberry_pi: temp=50.1 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=2.84 cputime=2.691 memavail=1477124 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 76.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1458 bytes_read=13382 bytes_retransmit=9 bytes_invalid=0 send_seq=177 receive_seq=177 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71992444  raspberry_pi: temp=51.6 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.84 cputime=2.702 memavail=1477124 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.6 pwm=0.000
Stats 77.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1464 bytes_read=13533 bytes_retransmit=9 bytes_invalid=0 send_seq=178 receive_seq=178 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71992672  raspberry_pi: temp=50.1 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.84 cputime=2.712 memavail=1476624 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.6 pwm=0.000
Stats 78.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1470 bytes_read=13713 bytes_retransmit=9 bytes_invalid=0 send_seq=179 receive_seq=179 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71992892  raspberry_pi: temp=50.1 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.84 cputime=2.723 memavail=1476624 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 79.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1476 bytes_read=13894 bytes_retransmit=9 bytes_invalid=0 send_seq=180 receive_seq=180 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71993104  raspberry_pi: temp=49.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.84 cputime=2.738 memavail=1476624 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 80.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1482 bytes_read=14045 bytes_retransmit=9 bytes_invalid=0 send_seq=181 receive_seq=181 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71993312  raspberry_pi: temp=49.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.70 cputime=2.754 memavail=1477836 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 81.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1488 bytes_read=14211 bytes_retransmit=9 bytes_invalid=0 send_seq=182 receive_seq=182 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71993514  raspberry_pi: temp=49.2 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=2.70 cputime=2.771 memavail=1477836 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 82.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1494 bytes_read=14392 bytes_retransmit=9 bytes_invalid=0 send_seq=183 receive_seq=183 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71993708  raspberry_pi: temp=50.1 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.70 cputime=2.788 memavail=1477596 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 83.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1506 bytes_read=14573 bytes_retransmit=9 bytes_invalid=0 send_seq=185 receive_seq=185 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71994079  raspberry_pi: temp=50.6 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=2.70 cputime=2.805 memavail=1477596 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 84.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1512 bytes_read=14739 bytes_retransmit=9 bytes_invalid=0 send_seq=186 receive_seq=186 retransmit_seq=2 srtt=0.003 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=71994256  raspberry_pi: temp=50.1 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.70 cputime=2.822 memavail=1476364 print_time=109.310 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Starting Klippy...
Args: ['/home/coon/klipper/klippy/klippy.py', '/home/coon/printer_data/config/printer.cfg', '-l', '/home/coon/printer_data/logs/klippy.log', '-I', '/home/coon/printer_data/comms/klippy.serial', '-a', '/home/coon/printer_data/comms/klippy.sock']
Git version: 'v0.12.0-404-g80d185c94'
Branch: master
Remote: origin
Tracked URL: https://github.com/Klipper3d/klipper.git
CPU: 4 core ?
Python: '3.9.2 (default, Dec  1 2024, 12:12:57) \n[GCC 10.2.1 20210110]'
Start printer at Sun Dec 22 19:34:23 2024 (1734914063.7 270.1)
===== Config file =====
[virtual_sdcard]
path = ~/printer_data/gcodes
on_error_gcode = CANCEL_PRINT

[pause_resume]
recover_velocity = 25

[display_status]

[respond]
default_prefix = 

[gcode_macro CANCEL_PRINT]
description = Cancel the actual running print
rename_existing = BASE_CANCEL_PRINT
gcode = 
	G91
	G0 Z10 F600
	G90
	TURN_OFF_HEATERS
	G0 X5 Y220
	CLEAR_PAUSE
	
	BASE_CANCEL_PRINT

[gcode_macro PAUSE]
description = Pause the actual running print
rename_existing = PAUSE_BASE
gcode = 
	
	{% set x = params.X|default(5) %}
	{% set y = params.Y|default(225) %}
	{% set z = params.Z|default(10)|float %}
	{% set e = params.E|default(1) %}
	
	{% set max_z = printer.toolhead.axis_maximum.z|float %}
	{% set act_z = printer.toolhead.position.z|float %}
	{% set lift_z = z|abs %}
	{% if act_z < (max_z - lift_z) %}
	{% set z_safe = lift_z %}
	{% else %}
	{% set z_safe = max_z - act_z %}
	{% endif %}
	
	PAUSE_BASE
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E-{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	{% if "xyz" in printer.toolhead.homed_axes %}
	G1 Z{z_safe}
	G90
	G1 X{x} Y{y} F6000
	{% else %}
	{action_respond_info("Printer not homed")}
	{% endif %}

[gcode_macro RESUME]
description = Resume the actual running print
rename_existing = RESUME_BASE
variable_last_extruder_temp = {'restore': False, 'temp': 0}
variable_restore_idle_timeout = 0
variable_idle_state = False
gcode = 
	
	{% set e = params.E|default(1) %}
	
	{% if 'VELOCITY' in params|upper %}
	{% set get_params = ('VELOCITY=' + params.VELOCITY)  %}
	{%else %}
	{% set get_params = "" %}
	{% endif %}
	
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	RESUME_BASE {get_params}

[gcode_macro SET_PAUSE_NEXT_LAYER]
description = Enable a pause if the next layer is reached
gcode = 
	{% set pause_next_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_next_layer %}
	{% set ENABLE = params.ENABLE|default(1)|int != 0 %}
	{% set MACRO = params.MACRO|default(pause_next_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_next_layer VALUE="{{ 'enable': ENABLE, 'call': MACRO }}"

[gcode_macro SET_PAUSE_AT_LAYER]
description = Enable/disable a pause if a given layer number is reached
gcode = 
	{% set pause_at_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_at_layer %}
	{% set ENABLE = params.ENABLE|int != 0 if params.ENABLE is defined
	else params.LAYER is defined %}
	{% set LAYER = params.LAYER|default(pause_at_layer.layer)|int %}
	{% set MACRO = params.MACRO|default(pause_at_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_at_layer VALUE="{{ 'enable': ENABLE, 'layer': LAYER, 'call': MACRO }}"

[gcode_macro SET_PRINT_STATS_INFO]
rename_existing = SET_PRINT_STATS_INFO_BASE
description = Overwrite, to get pause_next_layer and pause_at_layer feature
variable_pause_next_layer = { 'enable': False, 'call': "PAUSE" }
variable_pause_at_layer = { 'enable': False, 'layer': 0, 'call': "PAUSE" }
gcode = 
	{% if pause_next_layer.enable %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_next_layer" % pause_next_layer.call}'
	{pause_next_layer.call}
	SET_PAUSE_NEXT_LAYER ENABLE=0
	{% elif pause_at_layer.enable and params.CURRENT_LAYER is defined and params.CURRENT_LAYER|int == pause_at_layer.layer %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_at_layer [%d]" % (pause_at_layer.call, pause_at_layer.layer)}'
	{pause_at_layer.call}
	SET_PAUSE_AT_LAYER ENABLE=0
	{% endif %}
	SET_PRINT_STATS_INFO_BASE {rawparams}

[gcode_macro _TOOLHEAD_PARK_PAUSE_CANCEL]
description = Helper: park toolhead used in PAUSE and CANCEL_PRINT
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set velocity = printer.configfile.settings.pause_resume.recover_velocity %}
	{% set use_custom     = client.use_custom_pos|default(false)|lower == 'true' %}
	{% set custom_park_x  = client.custom_park_x|default(0.0) %}
	{% set custom_park_y  = client.custom_park_y|default(0.0) %}
	{% set park_dz        = client.custom_park_dz|default(2.0)|abs %}
	{% set sp_hop         = client.speed_hop|default(15) * 60 %}
	{% set sp_move        = client.speed_move|default(velocity) * 60 %}
	
	{% set origin    = printer.gcode_move.homing_origin %}
	{% set act       = printer.gcode_move.gcode_position %}
	{% set max       = printer.toolhead.axis_maximum %}
	{% set cone      = printer.toolhead.cone_start_z|default(max.z) %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	
	{% set z_min = params.Z_MIN|default(0)|float %}
	{% set z_park = [[(act.z + park_dz), z_min]|max, (max.z - origin.z)]|min %}
	{% set x_park = params.X       if params.X is defined
	else custom_park_x  if use_custom
	else 0.0            if round_bed
	else (max.x - 5.0) %}
	{% set y_park = params.Y       if params.Y is defined
	else custom_park_y  if use_custom
	else (max.y - 5.0)  if round_bed and z_park < cone
	else 0.0            if round_bed
	else (max.y - 5.0) %}
	
	_CLIENT_RETRACT
	{% if "xyz" in printer.toolhead.homed_axes %}
	G90
	G1 Z{z_park} F{sp_hop}
	G1 X{x_park} Y{y_park} F{sp_move}
	{% if not printer.gcode_move.absolute_coordinates %} G91 {% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='Printer not homed'
	{% endif %}

[gcode_macro _CLIENT_EXTRUDE]
description = Extrudes, if the extruder is hot enough
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set use_fw_retract = (client.use_fw_retract|default(false)|lower == 'true') and (printer.firmware_retraction is defined) %}
	{% set length = params.LENGTH|default(client.unretract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_unretract)|default(35) %}
	{% set absolute_extrude = printer.gcode_move.absolute_extrude %}
	
	{% if printer.toolhead.extruder != '' %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if use_fw_retract %}
	{% if length < 0 %}
	G10
	{% else %}
	G11
	{% endif %}
	{% else %}
	M83
	G1 E{length} F{(speed|float|abs) * 60}
	{% if absolute_extrude %}
	M82
	{% endif %}
	{% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='{"\"%s\" not hot enough" % printer.toolhead.extruder}'
	{% endif %}
	{% endif %}

[gcode_macro _CLIENT_RETRACT]
description = Retracts, if the extruder is hot enough
gcode = 
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set length = params.LENGTH|default(client.retract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_retract)|default(35) %}
	
	_CLIENT_EXTRUDE LENGTH=-{length|float|abs} SPEED={speed|float|abs}

[gcode_macro _CLIENT_LINEAR_MOVE]
description = Linear move with save and restore of the gcode state
gcode = 
	{% set x_move = "X" ~ params.X if params.X is defined else "" %}
	{% set y_move = "Y" ~ params.Y if params.Y is defined else "" %}
	{% set z_move = "Z" ~ params.Z if params.Z is defined else "" %}
	{% set e_move = "E" ~ params.E if params.E is defined else "" %}
	{% set rate = "F" ~ params.F if params.F is defined else "" %}
	{% set ABSOLUTE = params.ABSOLUTE | default(0) | int != 0 %}
	{% set ABSOLUTE_E = params.ABSOLUTE_E | default(0) | int != 0 %}
	SAVE_GCODE_STATE NAME=_client_movement
	{% if x_move or y_move or z_move %}
	G9{ 0 if ABSOLUTE else 1 }
	{% endif %}
	{% if e_move %}
	M8{ 2 if ABSOLUTE_E else 3 }
	{% endif %}
	G1 { x_move } { y_move } { z_move } { e_move } { rate }
	RESTORE_GCODE_STATE NAME=_client_movement

[gcode_macro play_test]
gcode = 
	RESPOND TYPE=command MSG="action:prompt_begin Question"
	RESPOND TYPE=command MSG="action:prompt_text Do you wont to cancel the print?"
	RESPOND TYPE=command MSG="action:prompt_footer_button continue|RESPOND TYPE=command MSG=action:prompt_end"
	RESPOND TYPE=command MSG="action:prompt_footer_button CANCEL|CANCEL_PRINT|error"
	RESPOND TYPE=command MSG="action:prompt_show"

[gcode_macro PRINT_START]
gcode = 
	START_PRINT {rawparams}

[gcode_macro START_PRINT]
gcode = 
	{% set BED_TEMP = params.BED_TEMP|default(60)|float %}
	{% set EXTRUDER_TEMP = params.EXTRUDER_TEMP|default(190)|float %}
	
	M190 S{BED_TEMP}
	
	G90
	
	G28
	
	RESPOND MSG="Bed Meshing"
	
	
	
	
	
	
	
	
	BED_MESH_CLEAR
	BED_MESH_CALIBRATE ADAPTIVE=1
	
	
	
	
	
	
	
	RESPOND MSG="Heating to print temp"
	M104 S{EXTRUDER_TEMP}
	G0 Z40 F240
	M109 S{EXTRUDER_TEMP}
	RESPOND MSG="Enable Runout Sensor"
	SFS_ENABLE
	RESPOND MSG="Line Purge"
	LINE_PURGE
	RESPOND MSG="Print Started"

[gcode_macro LINE_PURGE]
gcode = 
	G92 E0
	G1 Z2.0 F3000
	G1 X0.1 Y20 Z0.3 F5000.0
	G1 X0.1 Y200.0 Z0.3 F1500.0 E15
	G1 X0.4 Y200.0 Z0.3 F5000.0
	G1 X0.4 Y20 Z0.3 F1500.0 E30
	G92 E0
	G1 Z2.0 F3000
	G1 X5 Y20 Z0.3 F5000.0

[gcode_macro PRINT_END]
gcode = 
	END_PRINT

[gcode_macro END_PRINT]
gcode = 
	
	
	RESPOND MSG="Print Finished"
	G91
	G1 E-.5 Z0.2 F2400
	G1 X5 Y5 F6000
	G1 Z10
	G90
	SFS_DISABLE
	
	G1 X0 Y220 F6000
	M106 S0
	M104 S0
	M140 S0
	
	M84 X Y E

[gcode_macro SET_ACTIVE_SPOOL]
gcode = 
	{% if params.ID %}
	{% set id = params.ID|int %}
	{action_call_remote_method(
	"spoolman_set_active_spool",
	spool_id=id
	)}
	{% else %}
	{action_respond_info("Parameter 'ID' is required")}
	{% endif %}

[gcode_macro CLEAR_ACTIVE_SPOOL]
gcode = 
	{action_call_remote_method(
	"spoolman_set_active_spool",
	spool_id=None
	)}

[gcode_macro G29]
gcode = 
	G28
	BED_MESH_CALIBRATE
	G0 X0 Y0 Z10 F6000
	BED_MESH_PROFILE save=default

[gcode_macro M125]
gcode = 
	SAVE_GCODE_STATE NAME=parking
	M117 Parking toolhead
	G91
	G1 Z10 F600
	G90
	G1 X5 Y225 F4000
	RESTORE_GCODE_STATE NAME=parking

[gcode_macro Load_Filament]
gcode = 
	SAVE_GCODE_STATE NAME=loading_filament
	M117 Loading Filament
	M83
	G92 E0.0
	G91
	G1 E50 F200
	G92 E50
	RESTORE_GCODE_STATE NAME=loading_filament

[gcode_macro Unload_Filament]
gcode = 
	SAVE_GCODE_STATE NAME=unloading_filament
	M117 Unloading Filament
	G91
	G1 E5 F100
	G92 E0.0
	G1 E-50 F5000
	G92 E-50
	RESTORE_GCODE_STATE NAME=unloading_filament

[gcode_macro Filament_Change]
gcode = 
	
	SAVE_GCODE_STATE NAME=filament_change
	
	Unload_Filament
	
	RESPOND TYPE=command MSG="action:prompt_begin Question"
	RESPOND TYPE=command MSG="action:prompt_text Please insert new filament and confirm"
	RESPOND TYPE=command MSG="action:prompt_footer_button CONFIRM|Load_Filament|RESPOND TYPE=command MSG=action:prompt_end"
	RESPOND TYPE=command MSG="action:prompt_footer_button CANCEL|RESPOND TYPE=command MSG=action:prompt_end"
	RESPOND TYPE=command MSG="action:prompt_show"
	
	RESTORE_GCODE_STATE NAME=filament_change

[gcode_macro Calibrate_Hotend_PID]
gcode = 
	PID_CALIBRATE HEATER=extruder TARGET=200

[gcode_macro Calibrate_Bed_PID]
gcode = 
	PID_CALIBRATE HEATER=heater_bed TARGET=60

[gcode_macro Calibrate_Zoffset]
gcode = 
	PROBE_CALIBRATE

[gcode_macro Tram_bed]
gcode = 
	SCREWS_TILT_CALCULATE

[gcode_macro TEST_SPEED]
description = Test for max speed and acceleration parameters for the printer. Procedure: Home -> ReadPositionFromMCU -> MovesToolhead@Vel&Accel -> Home -> ReadPositionfromMCU
gcode = 
	
	{% set speed  = params.SPEED|default(printer.configfile.settings.printer.max_velocity)|int %}
	
	{% set iterations = params.ITERATIONS|default(5)|int %}
	
	{% set accel  = params.ACCEL|default(printer.configfile.settings.printer.max_accel)|int %}
	
	{% set min_cruise_ratio = params.MIN_CRUISE_RATIO|default(0.5)|float %}
	
	{% set bound = params.BOUND|default(20)|int %}
	
	{% set smallpatternsize = SMALLPATTERNSIZE|default(20)|int %}
	
	
	
	{% set x_min = printer.toolhead.axis_minimum.x + bound %}
	{% set x_max = printer.toolhead.axis_maximum.x - bound %}
	{% set y_min = printer.toolhead.axis_minimum.y + bound %}
	{% set y_max = printer.toolhead.axis_maximum.y - bound %}
	
	
	
	{% set x_center = (printer.toolhead.axis_minimum.x|float + printer.toolhead.axis_maximum.x|float ) / 2 %}
	{% set y_center = (printer.toolhead.axis_minimum.y|float + printer.toolhead.axis_maximum.y|float ) / 2 %}
	
	
	{% set x_center_min = x_center - (smallpatternsize/2) %}
	{% set x_center_max = x_center + (smallpatternsize/2) %}
	{% set y_center_min = y_center - (smallpatternsize/2) %}
	{% set y_center_max = y_center + (smallpatternsize/2) %}
	
	
	SAVE_GCODE_STATE NAME=TEST_SPEED
	
	
	{ action_respond_info("TEST_SPEED: starting %d iterations at speed %d, accel %d" % (iterations, speed, accel)) }
	
	
	M400
	G28
	
	{% if printer.configfile.settings.quad_gantry_level %}
	{% if printer.quad_gantry_level.applied == False %}
	QUAD_GANTRY_LEVEL
	G28 Z
	{% endif %}
	{% endif %}
	
	G90
	G1 X{printer.toolhead.axis_maximum.x-50} Y{printer.toolhead.axis_maximum.y-50} F{30*60}
	M400
	G28 X Y
	G0 X{printer.toolhead.axis_maximum.x-1} Y{printer.toolhead.axis_maximum.y-1} F{30*60}
	G4 P1000
	GET_POSITION
	
	
	G0 X{x_min} Y{y_min} Z{bound + 10} F{speed*60}
	
	
	{% if printer.configfile.settings.printer.minimum_cruise_ratio is defined %}
	SET_VELOCITY_LIMIT VELOCITY={speed} ACCEL={accel} MINIMUM_CRUISE_RATIO={min_cruise_ratio}
	{% else %}
	SET_VELOCITY_LIMIT VELOCITY={speed} ACCEL={accel} ACCEL_TO_DECEL={accel / 2}
	{% endif %}
	
	{% for i in range(iterations) %}
	
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_max} Y{y_max} F{speed*60}
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	G0 X{x_min} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	
	
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_min} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	
	
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_max} Y{y_center_max} F{speed*60}
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	G0 X{x_center_min} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	
	
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_min} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	{% endfor %}
	
	
	{% if printer.configfile.settings.printer.minimum_cruise_ratio is defined %}
	SET_VELOCITY_LIMIT VELOCITY={printer.configfile.settings.printer.max_velocity} ACCEL={printer.configfile.settings.printer.max_accel} MINIMUM_CRUISE_RATIO={printer.configfile.settings.printer.minimum_cruise_ratio}
	{% else %}
	SET_VELOCITY_LIMIT VELOCITY={printer.configfile.settings.printer.max_velocity} ACCEL={printer.configfile.settings.printer.max_accel} ACCEL_TO_DECEL={printer.configfile.settings.printer.max_accel_to_decel}
	{% endif %}
	
	
	M400
	G28
	
	G90
	G0 X{printer.toolhead.axis_maximum.x-1} Y{printer.toolhead.axis_maximum.y-1} F{30*60}
	G4 P1000
	GET_POSITION
	
	
	RESTORE_GCODE_STATE NAME=TEST_SPEED

[gcode_macro GET_TIMELAPSE_SETUP]
description = Print the Timelapse setup
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% set output_txt = ["Timelapse Setup:"] %}
	{% set _dummy = output_txt.append("enable: %s" % tl.enable) %}
	{% set _dummy = output_txt.append("park: %s" % tl.park.enable) %}
	{% if tl.park.enable %}
	{% set _dummy = output_txt.append("park position: %s time: %s s" % (tl.park.pos, tl.park.time)) %}
	{% set _dummy = output_txt.append("park cord x:%s y:%s dz:%s" % (tl.park.coord.x, tl.park.coord.y, tl.park.coord.dz)) %}
	{% set _dummy = output_txt.append("travel speed: %s mm/s" % tl.speed.travel) %}
	{% endif %}
	{% set _dummy = output_txt.append("fw_retract: %s" % tl.extruder.fw_retract) %}
	{% if not tl.extruder.fw_retract %}
	{% set _dummy = output_txt.append("retract: %s mm speed: %s mm/s" % (tl.extruder.retract, tl.speed.retract)) %}
	{% set _dummy = output_txt.append("extrude: %s mm speed: %s mm/s" % (tl.extruder.extrude, tl.speed.extrude)) %}
	{% endif %}
	{% set _dummy = output_txt.append("verbose: %s" % tl.verbose) %}
	{action_respond_info(output_txt|join("\n"))}

[gcode_macro _SET_TIMELAPSE_SETUP]
description = Set user parameters for timelapse
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	
	{% set min = printer.toolhead.axis_minimum %}
	{% set max = printer.toolhead.axis_maximum %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	{% set park = {'min'   : {'x': (min.x / 1.42)|round(3) if round_bed else min.x|round(3),
	'y': (min.y / 1.42)|round(3) if round_bed else min.y|round(3)},
	'max'   : {'x': (max.x / 1.42)|round(3) if round_bed else max.x|round(3),
	'y': (max.y / 1.42)|round(3) if round_bed else max.y|round(3)},
	'center': {'x': (max.x-(max.x-min.x)/2)|round(3),
	'y': (max.y-(max.y-min.y)/2)|round(3)}} %}
	
	{% if params.ENABLE %}
	{% if params.ENABLE|lower is in ['true', 'false'] %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=enable VALUE={True if params.ENABLE|lower == 'true' else False}
	{% else %}
	{action_raise_error("ENABLE=%s not supported. Allowed values are [True, False]" % params.ENABLE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.VERBOSE %}
	{% if params.VERBOSE|lower is in ['true', 'false'] %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=verbose VALUE={True if params.VERBOSE|lower == 'true' else False}
	{% else %}
	{action_raise_error("VERBOSE=%s not supported. Allowed values are [True, False]" % params.VERBOSE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_X %}
	{% if params.CUSTOM_POS_X|float >= min.x and params.CUSTOM_POS_X|float <= max.x %}
	{% set _dummy = tl.park.custom.update({'x':params.CUSTOM_POS_X|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_X=%s must be within [%s - %s]" % (params.CUSTOM_POS_X, min.x, max.x))}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_Y %}
	{% if params.CUSTOM_POS_Y|float >= min.y and params.CUSTOM_POS_Y|float <= max.y %}
	{% set _dummy = tl.park.custom.update({'y':params.CUSTOM_POS_Y|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_Y=%s must be within [%s - %s]" % (params.CUSTOM_POS_Y, min.y, max.y))}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_DZ %}
	{% if params.CUSTOM_POS_DZ|float >= min.z and params.CUSTOM_POS_DZ|float <= max.z %}
	{% set _dummy = tl.park.custom.update({'dz':params.CUSTOM_POS_DZ|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_DZ=%s must be within [%s - %s]" % (params.CUSTOM_POS_DZ, min.z, max.z))}
	{% endif %}
	{% endif %}
	{% if params.PARK_ENABLE %}
	{% if params.PARK_ENABLE|lower is in ['true', 'false'] %}
	{% set _dummy = tl.park.update({'enable':True if params.PARK_ENABLE|lower == 'true' else False}) %}
	{% else %}
	{action_raise_error("PARK_ENABLE=%s not supported. Allowed values are [True, False]" % params.PARK_ENABLE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.PARK_POS %}
	{% if params.PARK_POS|lower is in ['center','front_left','front_right','back_left','back_right','custom','x_only','y_only'] %}
	{% set dic = {'center'      : {'x': park.center.x   , 'y': park.center.y   , 'dz': 1                },
	'front_left'  : {'x': park.min.x      , 'y': park.min.y      , 'dz': 0                },
	'front_right' : {'x': park.max.x      , 'y': park.min.y      , 'dz': 0                },
	'back_left'   : {'x': park.min.x      , 'y': park.max.y      , 'dz': 0                },
	'back_right'  : {'x': park.max.x      , 'y': park.max.y      , 'dz': 0                },
	'custom'      : {'x': tl.park.custom.x, 'y': tl.park.custom.y, 'dz': tl.park.custom.dz},
	'x_only'      : {'x': tl.park.custom.x, 'y': 'none'          , 'dz': tl.park.custom.dz},
	'y_only'      : {'x': 'none'          , 'y': tl.park.custom.y, 'dz': tl.park.custom.dz}} %}
	{% set _dummy = tl.park.update({'pos':params.PARK_POS|lower}) %}
	{% set _dummy = tl.park.update({'coord':dic[tl.park.pos]}) %}
	{% else %}
	{action_raise_error("PARK_POS=%s not supported. Allowed values are [CENTER, FRONT_LEFT, FRONT_RIGHT, BACK_LEFT, BACK_RIGHT, CUSTOM, X_ONLY, Y_ONLY]"
	% params.PARK_POS|upper)}
	{% endif %}
	{% endif %}
	{% if params.PARK_TIME %}
	{% if params.PARK_TIME|float >= 0.0 %}
	{% set _dummy = tl.park.update({'time':params.PARK_TIME|float|round(3)}) %}
	{% else %}
	{action_raise_error("PARK_TIME=%s must be a positive number" % params.PARK_TIME)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=park VALUE="{tl.park}"
	{% if params.TRAVEL_SPEED %}
	{% if params.TRAVEL_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'travel':params.TRAVEL_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("TRAVEL_SPEED=%s must be larger than 0" % params.TRAVEL_SPEED)}
	{% endif %}
	{% endif %}
	{% if params.RETRACT_SPEED %}
	{% if params.RETRACT_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'retract':params.RETRACT_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("RETRACT_SPEED=%s must be larger than 0" % params.RETRACT_SPEED)}
	{% endif %}
	{% endif %}
	{% if params.EXTRUDE_SPEED %}
	{% if params.EXTRUDE_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'extrude':params.EXTRUDE_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("EXTRUDE_SPEED=%s must be larger than 0" % params.EXTRUDE_SPEED)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=speed VALUE="{tl.speed}"
	{% if params.EXTRUDE_DISTANCE %}
	{% if params.EXTRUDE_DISTANCE|float >= 0.0 %}
	{% set _dummy = tl.extruder.update({'extrude':params.EXTRUDE_DISTANCE|float|round(3)}) %}
	{% else %}
	{action_raise_error("EXTRUDE_DISTANCE=%s must be specified as positiv number" % params.EXTRUDE_DISTANCE)}
	{% endif %}
	{% endif %}
	{% if params.RETRACT_DISTANCE %}
	{% if params.RETRACT_DISTANCE|float >= 0.0 %}
	{% set _dummy = tl.extruder.update({'retract':params.RETRACT_DISTANCE|float|round(3)}) %}
	{% else %}
	{action_raise_error("RETRACT_DISTANCE=%s must be specified as positiv number" % params.RETRACT_DISTANCE)}
	{% endif %}
	{% endif %}
	{% if params.FW_RETRACT %}
	{% if params.FW_RETRACT|lower is in ['true', 'false'] %}
	{% if 'firmware_retraction' in printer.configfile.settings %}
	{% set _dummy = tl.extruder.update({'fw_retract': True if params.FW_RETRACT|lower == 'true' else False}) %}
	{% else %}
	{% set _dummy = tl.extruder.update({'fw_retract':False}) %}
	{% if params.FW_RETRACT|capitalize == 'True' %}
	{action_raise_error("[firmware_retraction] not defined in printer.cfg. Can not enable fw_retract")}
	{% endif %}
	{% endif %}
	{% else %}
	{action_raise_error("FW_RETRACT=%s not supported. Allowed values are [True, False]" % params.FW_RETRACT|capitalize)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=extruder VALUE="{tl.extruder}"
	{% if printer.configfile.settings['gcode_macro pause'] is defined %}
	{% set _dummy = tl.macro.update({'pause': printer.configfile.settings['gcode_macro pause'].rename_existing}) %}
	{% endif %}
	{% if printer.configfile.settings['gcode_macro resume'] is defined %}
	{% set _dummy = tl.macro.update({'resume': printer.configfile.settings['gcode_macro resume'].rename_existing}) %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=macro VALUE="{tl.macro}"

[gcode_macro TIMELAPSE_TAKE_FRAME]
description = Take Timelapse shoot
variable_enable = False
variable_takingframe = False
variable_park = {'enable': False,
	'pos'   : 'center',
	'time'  : 0.1,
	'custom': {'x': 0, 'y': 0, 'dz': 0},
	'coord' : {'x': 0, 'y': 0, 'dz': 0}}
variable_extruder = {'fw_retract': False,
	'retract': 1.0,
	'extrude': 1.0}
variable_speed = {'travel': 100,
	'retract': 15,
	'extrude': 15}
variable_verbose = True
variable_check_time = 0.5
variable_restore = {'absolute': {'coordinates': True, 'extrude': True}, 'speed': 1500, 'e':0, 'factor': {'speed': 1.0, 'extrude': 1.0}}
variable_macro = {'pause': 'PAUSE', 'resume': 'RESUME'}
variable_is_paused = False
gcode = 
	{% set hyperlapse = True if params.HYPERLAPSE and params.HYPERLAPSE|lower =='true' else False %}
	{% if enable %}
	{% if (hyperlapse and printer['gcode_macro HYPERLAPSE'].run) or
	(not hyperlapse and not printer['gcode_macro HYPERLAPSE'].run) %}
	{% if park.enable %}
	{% set pos = {'x': 'X' + park.coord.x|string if park.pos != 'y_only' else '',
	'y': 'Y' + park.coord.y|string if park.pos != 'x_only' else '',
	'z': 'Z'+ [printer.gcode_move.gcode_position.z + park.coord.dz, printer.toolhead.axis_maximum.z]|min|string} %}
	{% set restore = {'absolute': {'coordinates': printer.gcode_move.absolute_coordinates,
	'extrude'    : printer.gcode_move.absolute_extrude},
	'speed'   : printer.gcode_move.speed,
	'e'       : printer.gcode_move.gcode_position.e,
	'factor'  : {'speed'  : printer.gcode_move.speed_factor,
	'extrude': printer.gcode_move.extrude_factor}} %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=restore VALUE="{restore}"
	{% if not printer[printer.toolhead.extruder].can_extrude %}
	{% if verbose %}{action_respond_info("Timelapse: Warning, minimum extruder temperature not reached!")}{% endif %}
	{% else %}
	{% if extruder.fw_retract %}
	G10
	{% else %}
	M83
	G0 E-{extruder.retract} F{speed.retract * 60}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=is_paused VALUE=True
	{macro.pause}
	SET_GCODE_OFFSET X=0 Y=0
	G90
	{% if "xyz" not in printer.toolhead.homed_axes %}
	{% if verbose %}{action_respond_info("Timelapse: Warning, axis not homed yet!")}{% endif %}
	{% else %}
	G0 {pos.x} {pos.y} {pos.z} F{speed.travel * 60}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=takingframe VALUE=True
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_TAKE_FRAME DURATION={check_time}
	M400
	{% endif %}
	_TIMELAPSE_NEW_FRAME HYPERLAPSE={hyperlapse}
	{% endif %}
	{% else %}
	{% if verbose %}{action_respond_info("Timelapse: disabled, take frame ignored")}{% endif %}
	{% endif %}

[gcode_macro _TIMELAPSE_NEW_FRAME]
description = action call for timelapse shoot. must be a seperate macro
gcode = 
	{action_call_remote_method("timelapse_newframe",
	macropark=printer['gcode_macro TIMELAPSE_TAKE_FRAME'].park,
	hyperlapse=params.HYPERLAPSE)}

[delayed_gcode _WAIT_TIMELAPSE_TAKE_FRAME]
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% set factor = {'speed': printer.gcode_move.speed_factor, 'extrude': printer.gcode_move.extrude_factor} %}
	{% if tl.takingframe %}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_TAKE_FRAME DURATION={tl.check_time}
	{% else %}
	{tl.macro.resume} VELOCITY={tl.speed.travel}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=is_paused VALUE=False
	{% if not printer[printer.toolhead.extruder].can_extrude %}
	{action_respond_info("Timelapse: Warning minimum extruder temperature not reached!")}
	{% else %}
	{% if tl.extruder.fw_retract %}
	G11
	{% else %}
	G0 E{tl.extruder.extrude} F{tl.speed.extrude * 60}
	G0 F{tl.restore.speed}
	{% if tl.restore.absolute.extrude %}
	M82
	G92 E{tl.restore.e}
	{% endif %}
	{% endif %}
	{% endif %}
	{% if tl.restore.factor.speed   != factor.speed   %} M220 S{(factor.speed*100)|round(0)}   {% endif %}
	{% if tl.restore.factor.extrude != factor.extrude %} M221 S{(factor.extrude*100)|round(0)} {% endif %}
	{% if not tl.restore.absolute.coordinates %} G91 {% endif %}
	{% endif %}

[gcode_macro HYPERLAPSE]
description = Start/Stop a hyperlapse recording
variable_cycle = 0
variable_run = False
gcode = 
	{% set cycle = params.CYCLE|default(30)|int %}
	{% if params.ACTION and params.ACTION|lower == 'start' %}
	{action_respond_info("Hyperlapse: frames started (Cycle %d sec)" % cycle)}
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=run VALUE=True
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=cycle VALUE={cycle}
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION={cycle}
	TIMELAPSE_TAKE_FRAME HYPERLAPSE=True
	{% elif params.ACTION and params.ACTION|lower == 'stop' %}
	{% if run %}{action_respond_info("Hyperlapse: frames stopped")}{% endif %}
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=run VALUE=False
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION=0
	{% else %}
	{action_raise_error("Hyperlapse: No valid input parameter
	Use:
	- HYPERLAPSE ACTION=START [CYCLE=time]
	- HYPERLAPSE ACTION=STOP")}
	{% endif %}

[delayed_gcode _HYPERLAPSE_LOOP]
gcode = 
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION={printer["gcode_macro HYPERLAPSE"].cycle}
	TIMELAPSE_TAKE_FRAME HYPERLAPSE=True

[gcode_macro TIMELAPSE_RENDER]
description = Render Timelapse video and wait for the result
variable_render = False
variable_run_identifier = 0
gcode = 
	{action_respond_info("Timelapse: Rendering started")}
	{action_call_remote_method("timelapse_render", byrendermacro="True")}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_RENDER VARIABLE=render VALUE=True
	{printer.configfile.settings['gcode_macro pause'].rename_existing}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_RENDER DURATION=0.5

[delayed_gcode _WAIT_TIMELAPSE_RENDER]
gcode = 
	{% set ri = printer['gcode_macro TIMELAPSE_RENDER'].run_identifier % 4 %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_RENDER VARIABLE=run_identifier VALUE={ri + 1}
	{% if printer['gcode_macro TIMELAPSE_RENDER'].render %}
	M117 Rendering {['-','\\','|','/'][ri]}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_RENDER DURATION=0.5
	{% else %}
	{action_respond_info("Timelapse: Rendering finished")}
	M117
	{printer.configfile.settings['gcode_macro resume'].rename_existing}
	{% endif %}

[gcode_macro TEST_STREAM_DELAY]
description = Helper macro to find stream and park delay
gcode = 
	{% set min = printer.toolhead.axis_minimum %}
	{% set max = printer.toolhead.axis_maximum %}
	{% set act = printer.toolhead.position %}
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% if act.z > 5.0 %}
	G0 X{min.x + 5.0} F{tl.speed.travel|int * 60}
	G0 X{(max.x-min.x)/2}
	G4 P{tl.park.time|float * 1000}
	_TIMELAPSE_NEW_FRAME HYPERLAPSE=FALSE
	G0 X{max.x - 5.0}
	{% else %}
	{action_raise_error("Toolhead z %.3f to low. Please place head above z = 5.0" % act.z)}
	{% endif %}

[gcode_macro _OBICO_LAYER_CHANGE]
description = Run a scan across the current print area
variable_first_layer_scan_retract_length = 6
variable_first_layer_scan_retract_speed = 15
variable_first_layer_scan_cooldown_temp = 170
variable_first_layer_scan_resume_speed = 50
variable_first_layer_scan_enabled = True
variable_first_layer_scan_stepover = 10
variable_first_layer_scan_speed = 10
variable_first_layer_scan_zhop = 4
variable_first_layer_scan_zhop_speed = 15
variable_verbose = False
variable_current_layer = -1
variable_first_layer_scanning = False
variable_wait = {'resume': "RESUME", 'absolute_coordinates': True, 'absolute_extrude': True, 'e': 0.0, 'previous_temp': 0}
gcode = 
	
	{% set pause_macro  = "PAUSE"  if printer.configfile.settings['gcode_macro pause']  is not defined
	else printer.configfile.settings['gcode_macro pause'].rename_existing %}
	{% set resume_macro = "RESUME" if printer.configfile.settings['gcode_macro resume'] is not defined
	else printer.configfile.settings['gcode_macro resume'].rename_existing %}
	
	{% set current_layer_default = printer.print_stats.info.current_layer if printer.print_stats.info.current_layer is not none else -1 %}
	{% set current_layer = params.CURRENT_LAYER|default(current_layer_default)|int %}
	
	{% set polygon_points = printer.exclude_object.objects|map(attribute='polygon')|sum(start=[]) if printer.exclude_object is defined else [] %}
	{% set min_x = params.MINX|default(polygon_points|map(attribute=0)|min|default(printer.toolhead.axis_minimum.x))|float %}
	{% set min_y = params.MINY|default(polygon_points|map(attribute=1)|min|default(printer.toolhead.axis_minimum.y))|float %}
	{% set max_x = params.MAXX|default(polygon_points|map(attribute=0)|max|default(printer.toolhead.axis_maximum.x))|float %}
	{% set max_y = params.MAXY|default(polygon_points|map(attribute=1)|max|default(printer.toolhead.axis_maximum.y))|float %}
	
	{% set stepoverCount = ((max_y - min_y) / first_layer_scan_stepover|float)|round(method='ceil')|int %}
	
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Layer %d" % (current_layer)}' {% endif %}
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=current_layer VALUE={current_layer}
	
	{% if first_layer_scan_enabled and current_layer == 2 %}
	
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=first_layer_scanning VALUE=True
	
	
	{% set wait_dic = {'resume'              : resume_macro,
	'absolute_coordinates': printer.gcode_move.absolute_coordinates,
	'absolute_extrude'    : printer.gcode_move.absolute_extrude,
	'e'                   : printer.gcode_move.gcode_position.e,
	'previous_temp'       : printer.extruder.target} %}
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=wait VALUE="{wait_dic}"
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Prepare scanning" {% endif %}
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Scan Coordinates: Min:[%.3f:%.3f] Max:[%.3f:%.3f]" % (min_x,min_y,max_x,max_y)}' {% endif %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Retract %.1fmm filament" % first_layer_scan_retract_length|abs}' {% endif %}
	M83
	G0 E-{first_layer_scan_retract_length|abs} F{first_layer_scan_retract_speed|float * 60}
	{% endif %}
	G91
	G0 Z{first_layer_scan_zhop|abs} F{first_layer_scan_zhop_speed|float * 60}
	
	
	M106 S255
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Fan on and lowering temperature to %.1f" % first_layer_scan_cooldown_temp}' {% endif %}
	M104 S{first_layer_scan_cooldown_temp}
	M109 S{first_layer_scan_cooldown_temp}
	
	{pause_macro}
	
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Start scanning" {% endif %}
	
	UPDATE_DELAYED_GCODE ID=_WAIT_OBICO_LAYER_CHANGE DURATION=1.0
	G90
	G0 X{min_x} Y{min_y} F{first_layer_scan_resume_speed|float * 60}
	{% for ystep in range(stepoverCount) %}
	G0 Y{min_y + first_layer_scan_stepover|float * ystep} F{first_layer_scan_speed|float * 60}
	G0 X{max_x if ystep % 2 == 0 else min_x}              F{first_layer_scan_speed|float * 60}
	{% endfor %}
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Finish scanning" {% endif %}
	
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=first_layer_scanning VALUE=False
	
	{% endif %}

[delayed_gcode _WAIT_OBICO_LAYER_CHANGE]
gcode = 
	{% set lc_macro = printer['gcode_macro _OBICO_LAYER_CHANGE'] %}
	{% if lc_macro.first_layer_scanning %}
	
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Waiting for first layer scan..." {% endif %}
	UPDATE_DELAYED_GCODE ID=_WAIT_OBICO_LAYER_CHANGE DURATION=1.0
	{% else %}
	
	M107
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Fan off and resume print" {% endif %}
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Call %s VELOCITY=%.1f" % (lc_macro.wait.resume, lc_macro.first_layer_scan_resume_speed)}' {% endif %}
	{lc_macro.wait.resume} VELOCITY={lc_macro.first_layer_scan_resume_speed}
	G91
	G0 Z-{lc_macro.first_layer_scan_zhop|abs} F{lc_macro.first_layer_scan_zhop_speed|float * 60}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% set first_layer_scan_unretract_length = lc_macro.first_layer_scan_retract_length + 0.5 %}
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Extrude %.1fmm filament" % first_layer_scan_unretract_length|abs}' {% endif %}
	M83
	G0 E{first_layer_scan_unretract_length|abs} F{lc_macro.first_layer_scan_retract_speed|float * 60}
	{% endif %}
	
	
	M104 S{lc_macro.wait.previous_temp}
	M109 S{lc_macro.wait.previous_temp}
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Heating back up to previous temperature"}' {% endif %}
	
	
	{% if lc_macro.wait.absolute_coordinates %} G90 {% endif %}
	{% if lc_macro.wait.absolute_extrude %}
	M82
	G92 E{lc_macro.wait.e}
	{% endif %}
	{% endif %}

[gcode_macro OBICO_LINK_STATUS]
description = Link to Obico server
variable_one_time_passcode = ''
variable_one_time_passlink = ''
variable_is_linked = False
gcode = 
	{action_respond_info('Obico one_time_passcode: {}'.format(one_time_passcode))}
	{action_respond_info('Obico one_time_passlink: {}'.format(one_time_passlink))}
	{action_respond_info('Obico is_linked: {}'.format(is_linked))}
	{% if not is_linked and one_time_passcode != '' %}
	M117 Code: {one_time_passcode}
	{% else %}
	M117 Obico linked
	{% endif %}

[gcode_macro _OBICO_RELINK]
description = Re-link to Obico server
gcode = 
	{action_respond_info('WARNING: Re-link to Obico server')}
	{action_call_remote_method("obico_remote_event", event_name='relink_obico', message='')}
	{action_respond_info('WARNING: relink_obico requested')}

[exclude_object]

[mcu]
serial = /dev/serial/by-id/usb-1a86_USB_Serial-if00-port0
restart_method = command

[temperature_sensor raspberry_pi]
sensor_type = temperature_host
min_temp = 10
max_temp = 100

[temperature_sensor mcu_temp]
sensor_type = temperature_mcu
min_temp = 0
max_temp = 100

[printer]
kinematics = cartesian
max_velocity = 200
max_accel = 4000
max_z_velocity = 10
max_z_accel = 100
minimum_cruise_ratio = 0.5
square_corner_velocity = 5

[stepper_x]
step_pin = PB9
dir_pin = PC2
enable_pin = !PC3
microsteps = 16
rotation_distance = 40
endstop_pin = ^PA5
position_endstop = 0
position_max = 230
homing_speed = 50

[stepper_y]
step_pin = PB7
dir_pin = PB8
enable_pin = !PC3
microsteps = 16
rotation_distance = 40
endstop_pin = ^PA6
position_endstop = 0
position_max = 231
homing_speed = 50

[stepper_z]
step_pin = PB5
dir_pin = !PB6
enable_pin = !PC3
microsteps = 16
rotation_distance = 8
endstop_pin = probe:z_virtual_endstop
position_max = 250
position_min = -4
homing_speed = 4
second_homing_speed = 1
homing_retract_dist = 2.0

[fan]
pin = PA0

[extruder]
max_extrude_only_distance = 100.0
step_pin = PB3
dir_pin = PB4
enable_pin = !PC3
microsteps = 16
gear_ratio = 42:12
rotation_distance = 26.359
nozzle_diameter = 0.400
filament_diameter = 1.750
heater_pin = PA1
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PC5
min_temp = 0
max_temp = 300
min_extrude_temp = 170
pressure_advance = .0369
pressure_advance_smooth_time = 0.04
control = pid
pid_kp = 19.195
pid_ki = 1.000
pid_kd = 92.135

[firmware_retraction]
retract_length = 0.3
retract_speed = 20

[idle_timeout]
gcode = 
	{% if printer.pause_resume.is_paused %}
	M118 Idle timeout while paused, turning off hotend
	SET_HEATER_TEMPERATURE HEATER=extruder TARGET=0
	{% else %}
	M118 Idle timeout
	TURN_OFF_HEATERS
	M84
	{% endif %}
timeout = 1800

[heater_bed]
heater_pin = PA2
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PC4
min_temp = 0
max_temp = 130
control = pid
pid_kp = 68.601
pid_ki = 1.185
pid_kd = 993.000

[bltouch]
sensor_pin = ^PB1
control_pin = PB0
x_offset = -31.8
y_offset = -40.5
speed = 35
samples = 2
samples_result = median
samples_tolerance = 0.05
samples_tolerance_retries = 2
sample_retract_dist = 5.0
probe_with_touch_mode = true
stow_on_each_sample = false
z_offset = 2.049

[safe_z_home]
home_xy_position = 147, 154
speed = 75
z_hop = 10
z_hop_speed = 5
move_to_previous = false

[bed_screws]
screw1 = 30,51
screw1_name = "FL"
screw2 = 200,51
screw2_name = "FR"
screw3 = 200,195
screw3_name = "RR"
screw4 = 30,195
screw4_name = "RL"

[screws_tilt_adjust]
screw1 = 67, 67
screw1_name = front left screw
screw2 = 230, 67
screw2_name = front right screw
screw3 = 230, 230
screw3_name = rear right screw
screw4 = 67.60, 230
screw4_name = rear left screw
horizontal_move_z = 10
speed = 200
screw_thread = CW-M4

[bed_mesh]
speed = 120
mesh_min = 10,11
mesh_max = 195,182
probe_count = 3,3
algorithm = bicubic
fade_start = 1
fade_end = 10
fade_target = 0

[filament_motion_sensor SFS_T0]
detection_length = 150.00
extruder = extruder
switch_pin = PA4
pause_on_runout = True
event_delay = 3.0
pause_delay = 0.5
runout_gcode = 
	M117 Runout Detected!

[delayed_gcode DISABLEFILAMENTSENSOR]
initial_duration = 1
gcode = 
	SET_FILAMENT_SENSOR SENSOR=SFS_T0 ENABLE=0

[gcode_macro SFS_ENABLE]
description = Enable smart filament sensor
gcode = 
	M117 ENABLING the Smart Filament Sensor
	G92 E0
	SET_FILAMENT_SENSOR SENSOR=SFS_T0 ENABLE=1

[gcode_macro SFS_DISABLE]
description = Disable smart filament sensor
gcode = 
	M117 DISABLING the Smart Filament Sensor
	G92 E0
	SET_FILAMENT_SENSOR SENSOR=SFS_T0 ENABLE=0

[gcode_macro FILAMENT_RUNOUT]
gcode = 
	M117 Runout Detected!
	M300 S1 P10
	M600
	M300 S1 P10

[gcode_macro M300]
gcode = 
	{% set S = params.S|default(1000)|int %}
	{% set P = params.P|default(100)|int %}
	SET_PIN PIN=BEEPER VALUE=0.5 CYCLE_TIME={ 1.0/S if S > 0 else 1 }
	G4 P{P}
	SET_PIN PIN=BEEPER VALUE=0
	[gcode_macro M600]
	gcode:
	{% set X = params.X|default(25)|float %}
	{% set Y = params.Y|default(25)|float %}
	{% set Z = params.Z|default(10)|float %}
	SAVE_GCODE_STATE NAME=M600_state
	PAUSE
	G91
	G1 E-.8 F2700
	G1 Z{Z}
	G90
	G1 X{X} Y{Y} F3000
	G91
	G1 E-15 F1000
	RESTORE_GCODE_STATE NAME=M600_state

[gcode_arcs]
resolution = 1.0

[input_shaper]
shaper_freq_x = 73.5
shaper_type_x = ei
shaper_freq_y = 76.9
shaper_type_y = mzv
=======================
bed_mesh: bicubic interpolation with a probe_count of less than 4 points detected.  Forcing lagrange interpolation. Configured Probe Count: 3, 3
Extruder max_extrude_ratio=0.266081
mcu 'mcu': Starting serial connect
webhooks client 547994590896: New connection
webhooks client 547994590896: Client info {'program': 'Moonraker', 'version': 'v0.9.3-3-gccfe32f'}
mcu 'mcu': got {'oid': 10, 'next_clock': 4178763520, 'value': 14002, '#name': 'analog_in_state', '#sent_time': 271.650879319, '#receive_time': 271.70224096699997}
mcu 'mcu': got {'oid': 12, 'next_clock': 4180203520, 'value': 31545, '#name': 'analog_in_state', '#sent_time': 271.704534227, '#receive_time': 271.722221967}
mcu 'mcu': got {'oid': 17, 'next_clock': 4183803520, 'value': 31494, '#name': 'analog_in_state', '#sent_time': 271.75840506000003, '#receive_time': 271.772196023}
mcu 'mcu': got {'oid': 10, 'next_clock': 4200363520, 'value': 14004, '#name': 'analog_in_state', '#sent_time': 271.974040837, '#receive_time': 272.00213092999996}
mcu 'mcu': got {'oid': 12, 'next_clock': 4201803520, 'value': 31545, '#name': 'analog_in_state', '#sent_time': 271.974040837, '#receive_time': 272.022271263}
mcu 'mcu': got {'oid': 17, 'next_clock': 4205403520, 'value': 31495, '#name': 'analog_in_state', '#sent_time': 272.02775050400004, '#receive_time': 272.072261282}
Loaded MCU 'mcu' 119 commands (v0.12.0-286-g81de9a861 / gcc: (15:8-2019-q3-1+b1) 8.3.1 20190703 (release) [gcc-8-branch revision 273027] binutils: (2.35.2-2+14+b2) 2.35.2)
MCU 'mcu' config: ADC_MAX=4095 BUS_PINS_i2c1=PB6,PB7 BUS_PINS_i2c1a=PB8,PB9 BUS_PINS_i2c2=PB10,PB11 BUS_PINS_spi1=PA6,PA7,PA5 BUS_PINS_spi1a=PB4,PB5,PB3 BUS_PINS_spi2=PB14,PB15,PB13 BUS_PINS_spi3=PB4,PB5,PB3 CLOCK_FREQ=72000000 MCU=stm32f103xe PWM_MAX=255 RECEIVE_WINDOW=192 RESERVE_PINS_serial=PA10,PA9 SERIAL_BAUD=250000 STATS_SUMSQ_BASE=256 STEPPER_BOTH_EDGE=1
mcu_temperature 'mcu' nominal base=357.558140 slope=-767.441860
Configured MCU 'mcu' (1024 moves)
Starting heater checks for heater_bed
bed_mesh: generated points
Index |  Tool Adjusted  |   Probe
  0   | (41.8, 51.5)    | (10.0, 11.0)
  1   | (134.3, 51.5)   | (102.5, 11.0)
  2   | (226.8, 51.5)   | (195.0, 11.0)
  3   | (226.8, 137.0)  | (195.0, 96.5)
  4   | (134.3, 137.0)  | (102.5, 96.5)
  5   | (41.8, 137.0)   | (10.0, 96.5)
  6   | (41.8, 222.5)   | (10.0, 182.0)
  7   | (134.3, 222.5)  | (102.5, 182.0)
  8   | (226.8, 222.5)  | (195.0, 182.0)
Starting heater checks for extruder
Stats 273.1: gcodein=0  mcu: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=1146 bytes_read=4691 bytes_retransmit=18 bytes_invalid=7 send_seq=119 receive_seq=119 retransmit_seq=2 srtt=0.003 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72001416  raspberry_pi: temp=49.7 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.29 cputime=1.446 memavail=1474056 print_time=357.669 buffer_time=0.249 print_stall=0 extruder: target=0 temp=21.6 pwm=0.000
webhooks: registering remote method 'shutdown_machine' for connection id: 547994590896
webhooks: registering remote method 'reboot_machine' for connection id: 547994590896
webhooks: registering remote method 'pause_job_queue' for connection id: 547994590896
webhooks: registering remote method 'start_job_queue' for connection id: 547994590896
webhooks: registering remote method 'spoolman_set_active_spool' for connection id: 547994590896
webhooks: registering remote method 'obico_remote_event' for connection id: 547994590896
Stats 274.1: gcodein=0  mcu: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=1152 bytes_read=4860 bytes_retransmit=18 bytes_invalid=7 send_seq=120 receive_seq=120 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000524  raspberry_pi: temp=49.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.29 cputime=1.508 memavail=1472840 print_time=357.669 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 275.1: gcodein=0  mcu: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=1158 bytes_read=5001 bytes_retransmit=18 bytes_invalid=7 send_seq=121 receive_seq=121 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000260  raspberry_pi: temp=51.1 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.29 cputime=1.549 memavail=1470160 print_time=357.669 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 276.1: gcodein=0  mcu: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=1164 bytes_read=5156 bytes_retransmit=18 bytes_invalid=7 send_seq=122 receive_seq=122 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000129  raspberry_pi: temp=49.7 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.43 cputime=1.566 memavail=1470180 print_time=357.669 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 277.1: gcodein=0  mcu: mcu_awake=0.004 mcu_task_avg=0.000025 mcu_task_stddev=0.000013 bytes_write=1170 bytes_read=5352 bytes_retransmit=18 bytes_invalid=7 send_seq=123 receive_seq=123 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000115  raspberry_pi: temp=49.7 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.43 cputime=1.577 memavail=1470180 print_time=357.669 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 278.1: gcodein=0  mcu: mcu_awake=0.004 mcu_task_avg=0.000025 mcu_task_stddev=0.000013 bytes_write=1176 bytes_read=5503 bytes_retransmit=18 bytes_invalid=7 send_seq=124 receive_seq=124 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000096  raspberry_pi: temp=49.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.43 cputime=1.587 memavail=1469956 print_time=357.669 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 279.1: gcodein=0  mcu: mcu_awake=0.004 mcu_task_avg=0.000025 mcu_task_stddev=0.000013 bytes_write=1182 bytes_read=5669 bytes_retransmit=18 bytes_invalid=7 send_seq=125 receive_seq=125 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000138  raspberry_pi: temp=50.6 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.43 cputime=1.598 memavail=1469956 print_time=357.669 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 280.1: gcodein=0  mcu: mcu_awake=0.004 mcu_task_avg=0.000025 mcu_task_stddev=0.000013 bytes_write=1188 bytes_read=5850 bytes_retransmit=18 bytes_invalid=7 send_seq=126 receive_seq=126 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000206  raspberry_pi: temp=50.1 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.43 cputime=1.612 memavail=1469956 print_time=357.669 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 281.1: gcodein=0  mcu: mcu_awake=0.004 mcu_task_avg=0.000025 mcu_task_stddev=0.000013 bytes_write=1194 bytes_read=6001 bytes_retransmit=18 bytes_invalid=7 send_seq=127 receive_seq=127 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000209  raspberry_pi: temp=49.7 mcu_temp: temp=29.4 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.39 cputime=1.629 memavail=1469732 print_time=357.669 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 282.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1200 bytes_read=6181 bytes_retransmit=18 bytes_invalid=7 send_seq=128 receive_seq=128 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000209  raspberry_pi: temp=49.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.39 cputime=1.647 memavail=1469732 print_time=357.669 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 283.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1206 bytes_read=6362 bytes_retransmit=18 bytes_invalid=7 send_seq=129 receive_seq=129 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000227  raspberry_pi: temp=48.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.39 cputime=1.663 memavail=1469484 print_time=357.669 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 284.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1212 bytes_read=6513 bytes_retransmit=18 bytes_invalid=7 send_seq=130 receive_seq=130 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000687  raspberry_pi: temp=48.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.39 cputime=1.680 memavail=1469484 print_time=357.669 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 285.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1218 bytes_read=6679 bytes_retransmit=18 bytes_invalid=7 send_seq=131 receive_seq=131 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000586  raspberry_pi: temp=50.6 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=2.39 cputime=1.696 memavail=1469492 print_time=357.669 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 286.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1224 bytes_read=6860 bytes_retransmit=18 bytes_invalid=7 send_seq=132 receive_seq=132 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000517  raspberry_pi: temp=49.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=2.36 cputime=1.713 memavail=1469268 print_time=357.669 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 287.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1230 bytes_read=7025 bytes_retransmit=18 bytes_invalid=7 send_seq=133 receive_seq=133 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000463  raspberry_pi: temp=49.2 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.36 cputime=1.729 memavail=1469268 print_time=357.669 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 288.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1236 bytes_read=7191 bytes_retransmit=18 bytes_invalid=7 send_seq=134 receive_seq=134 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000413  raspberry_pi: temp=48.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.36 cputime=1.747 memavail=1469268 print_time=357.669 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.6 pwm=0.000
Stats 289.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1242 bytes_read=7372 bytes_retransmit=18 bytes_invalid=7 send_seq=135 receive_seq=135 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000384  raspberry_pi: temp=48.7 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.36 cputime=1.766 memavail=1471768 print_time=357.669 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 290.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1248 bytes_read=7523 bytes_retransmit=18 bytes_invalid=7 send_seq=136 receive_seq=136 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000356  raspberry_pi: temp=49.2 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=2.36 cputime=1.782 memavail=1471544 print_time=357.669 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.6 pwm=0.000
Stats 291.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1254 bytes_read=7689 bytes_retransmit=18 bytes_invalid=7 send_seq=137 receive_seq=137 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000335  raspberry_pi: temp=48.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.33 cputime=1.799 memavail=1473992 print_time=357.669 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.6 pwm=0.000
Stats 292.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1260 bytes_read=7884 bytes_retransmit=18 bytes_invalid=7 send_seq=138 receive_seq=138 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000316  raspberry_pi: temp=48.7 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=2.33 cputime=1.818 memavail=1473324 print_time=357.669 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 293.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1266 bytes_read=8035 bytes_retransmit=18 bytes_invalid=7 send_seq=139 receive_seq=139 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000304  raspberry_pi: temp=49.7 mcu_temp: temp=29.4 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.33 cputime=1.834 memavail=1473324 print_time=357.669 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 294.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1272 bytes_read=8216 bytes_retransmit=18 bytes_invalid=7 send_seq=140 receive_seq=140 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000283  raspberry_pi: temp=49.2 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.33 cputime=1.852 memavail=1473324 print_time=357.669 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 295.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1278 bytes_read=8382 bytes_retransmit=18 bytes_invalid=7 send_seq=141 receive_seq=141 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000269  raspberry_pi: temp=48.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.4 pwm=0.000 sysload=2.33 cputime=1.869 memavail=1472572 print_time=357.669 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 296.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1284 bytes_read=8533 bytes_retransmit=18 bytes_invalid=7 send_seq=142 receive_seq=142 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000260  raspberry_pi: temp=49.2 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.30 cputime=1.885 memavail=1472572 print_time=357.669 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 297.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1290 bytes_read=8728 bytes_retransmit=18 bytes_invalid=7 send_seq=143 receive_seq=143 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000253  raspberry_pi: temp=49.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.30 cputime=1.900 memavail=1471740 print_time=357.669 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 298.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1296 bytes_read=8894 bytes_retransmit=18 bytes_invalid=7 send_seq=144 receive_seq=144 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000241  raspberry_pi: temp=49.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.30 cputime=1.911 memavail=1470928 print_time=357.669 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 299.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1302 bytes_read=9045 bytes_retransmit=18 bytes_invalid=7 send_seq=145 receive_seq=145 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000223  raspberry_pi: temp=50.6 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.30 cputime=1.921 memavail=1470428 print_time=357.669 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.6 pwm=0.000
Stats 300.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1308 bytes_read=9226 bytes_retransmit=18 bytes_invalid=7 send_seq=146 receive_seq=146 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000212  raspberry_pi: temp=49.2 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.30 cputime=1.932 memavail=1470564 print_time=357.669 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 301.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1314 bytes_read=9392 bytes_retransmit=18 bytes_invalid=7 send_seq=147 receive_seq=147 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000204  raspberry_pi: temp=49.7 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.20 cputime=1.943 memavail=1470340 print_time=357.669 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 302.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1320 bytes_read=9557 bytes_retransmit=18 bytes_invalid=7 send_seq=148 receive_seq=148 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000193  raspberry_pi: temp=49.2 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.20 cputime=1.956 memavail=1470340 print_time=357.669 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 303.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1326 bytes_read=9738 bytes_retransmit=18 bytes_invalid=7 send_seq=149 receive_seq=149 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000194  raspberry_pi: temp=49.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.20 cputime=1.974 memavail=1470340 print_time=357.669 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 304.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1332 bytes_read=9904 bytes_retransmit=18 bytes_invalid=7 send_seq=150 receive_seq=150 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000194  raspberry_pi: temp=48.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.20 cputime=1.991 memavail=1470116 print_time=357.669 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 305.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1338 bytes_read=10055 bytes_retransmit=18 bytes_invalid=7 send_seq=151 receive_seq=151 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000195  raspberry_pi: temp=49.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.20 cputime=2.007 memavail=1469400 print_time=357.669 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 306.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1344 bytes_read=10236 bytes_retransmit=18 bytes_invalid=7 send_seq=152 receive_seq=152 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000208  raspberry_pi: temp=48.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.10 cputime=2.024 memavail=1469400 print_time=357.669 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 307.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1350 bytes_read=10402 bytes_retransmit=18 bytes_invalid=7 send_seq=153 receive_seq=153 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000205  raspberry_pi: temp=49.2 mcu_temp: temp=29.4 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=2.10 cputime=2.041 memavail=1469400 print_time=357.669 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 308.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1356 bytes_read=10567 bytes_retransmit=18 bytes_invalid=7 send_seq=154 receive_seq=154 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000204  raspberry_pi: temp=49.2 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.10 cputime=2.058 memavail=1469400 print_time=357.669 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 309.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1362 bytes_read=10748 bytes_retransmit=18 bytes_invalid=7 send_seq=155 receive_seq=155 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000204  raspberry_pi: temp=48.2 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.10 cputime=2.075 memavail=1469400 print_time=357.669 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.6 pwm=0.000
Stats 310.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1368 bytes_read=10914 bytes_retransmit=18 bytes_invalid=7 send_seq=156 receive_seq=156 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000200  raspberry_pi: temp=48.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.10 cputime=2.092 memavail=1469168 print_time=357.669 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.6 pwm=0.000
Stats 311.1: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1374 bytes_read=11065 bytes_retransmit=18 bytes_invalid=7 send_seq=157 receive_seq=157 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000198  raspberry_pi: temp=48.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.09 cputime=2.110 memavail=1469168 print_time=396.097 buffer_time=0.654 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
webhooks client 547994590896: Disconnected
Restarting printer
Start printer at Sun Dec 22 19:35:06 2024 (1734914106.5 312.9)
===== Config file =====
[virtual_sdcard]
path = ~/printer_data/gcodes
on_error_gcode = CANCEL_PRINT

[pause_resume]
recover_velocity = 25

[display_status]

[respond]
default_prefix = 

[gcode_macro CANCEL_PRINT]
description = Cancel the actual running print
rename_existing = BASE_CANCEL_PRINT
gcode = 
	G91
	G0 Z10 F600
	G90
	TURN_OFF_HEATERS
	G0 X5 Y220
	CLEAR_PAUSE
	
	BASE_CANCEL_PRINT

[gcode_macro PAUSE]
description = Pause the actual running print
rename_existing = PAUSE_BASE
gcode = 
	
	{% set x = params.X|default(5) %}
	{% set y = params.Y|default(225) %}
	{% set z = params.Z|default(10)|float %}
	{% set e = params.E|default(1) %}
	
	{% set max_z = printer.toolhead.axis_maximum.z|float %}
	{% set act_z = printer.toolhead.position.z|float %}
	{% set lift_z = z|abs %}
	{% if act_z < (max_z - lift_z) %}
	{% set z_safe = lift_z %}
	{% else %}
	{% set z_safe = max_z - act_z %}
	{% endif %}
	
	PAUSE_BASE
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E-{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	{% if "xyz" in printer.toolhead.homed_axes %}
	G1 Z{z_safe}
	G90
	G1 X{x} Y{y} F6000
	{% else %}
	{action_respond_info("Printer not homed")}
	{% endif %}

[gcode_macro RESUME]
description = Resume the actual running print
rename_existing = RESUME_BASE
variable_last_extruder_temp = {'restore': False, 'temp': 0}
variable_restore_idle_timeout = 0
variable_idle_state = False
gcode = 
	
	{% set e = params.E|default(1) %}
	
	{% if 'VELOCITY' in params|upper %}
	{% set get_params = ('VELOCITY=' + params.VELOCITY)  %}
	{%else %}
	{% set get_params = "" %}
	{% endif %}
	
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	RESUME_BASE {get_params}

[gcode_macro SET_PAUSE_NEXT_LAYER]
description = Enable a pause if the next layer is reached
gcode = 
	{% set pause_next_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_next_layer %}
	{% set ENABLE = params.ENABLE|default(1)|int != 0 %}
	{% set MACRO = params.MACRO|default(pause_next_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_next_layer VALUE="{{ 'enable': ENABLE, 'call': MACRO }}"

[gcode_macro SET_PAUSE_AT_LAYER]
description = Enable/disable a pause if a given layer number is reached
gcode = 
	{% set pause_at_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_at_layer %}
	{% set ENABLE = params.ENABLE|int != 0 if params.ENABLE is defined
	else params.LAYER is defined %}
	{% set LAYER = params.LAYER|default(pause_at_layer.layer)|int %}
	{% set MACRO = params.MACRO|default(pause_at_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_at_layer VALUE="{{ 'enable': ENABLE, 'layer': LAYER, 'call': MACRO }}"

[gcode_macro SET_PRINT_STATS_INFO]
rename_existing = SET_PRINT_STATS_INFO_BASE
description = Overwrite, to get pause_next_layer and pause_at_layer feature
variable_pause_next_layer = { 'enable': False, 'call': "PAUSE" }
variable_pause_at_layer = { 'enable': False, 'layer': 0, 'call': "PAUSE" }
gcode = 
	{% if pause_next_layer.enable %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_next_layer" % pause_next_layer.call}'
	{pause_next_layer.call}
	SET_PAUSE_NEXT_LAYER ENABLE=0
	{% elif pause_at_layer.enable and params.CURRENT_LAYER is defined and params.CURRENT_LAYER|int == pause_at_layer.layer %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_at_layer [%d]" % (pause_at_layer.call, pause_at_layer.layer)}'
	{pause_at_layer.call}
	SET_PAUSE_AT_LAYER ENABLE=0
	{% endif %}
	SET_PRINT_STATS_INFO_BASE {rawparams}

[gcode_macro _TOOLHEAD_PARK_PAUSE_CANCEL]
description = Helper: park toolhead used in PAUSE and CANCEL_PRINT
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set velocity = printer.configfile.settings.pause_resume.recover_velocity %}
	{% set use_custom     = client.use_custom_pos|default(false)|lower == 'true' %}
	{% set custom_park_x  = client.custom_park_x|default(0.0) %}
	{% set custom_park_y  = client.custom_park_y|default(0.0) %}
	{% set park_dz        = client.custom_park_dz|default(2.0)|abs %}
	{% set sp_hop         = client.speed_hop|default(15) * 60 %}
	{% set sp_move        = client.speed_move|default(velocity) * 60 %}
	
	{% set origin    = printer.gcode_move.homing_origin %}
	{% set act       = printer.gcode_move.gcode_position %}
	{% set max       = printer.toolhead.axis_maximum %}
	{% set cone      = printer.toolhead.cone_start_z|default(max.z) %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	
	{% set z_min = params.Z_MIN|default(0)|float %}
	{% set z_park = [[(act.z + park_dz), z_min]|max, (max.z - origin.z)]|min %}
	{% set x_park = params.X       if params.X is defined
	else custom_park_x  if use_custom
	else 0.0            if round_bed
	else (max.x - 5.0) %}
	{% set y_park = params.Y       if params.Y is defined
	else custom_park_y  if use_custom
	else (max.y - 5.0)  if round_bed and z_park < cone
	else 0.0            if round_bed
	else (max.y - 5.0) %}
	
	_CLIENT_RETRACT
	{% if "xyz" in printer.toolhead.homed_axes %}
	G90
	G1 Z{z_park} F{sp_hop}
	G1 X{x_park} Y{y_park} F{sp_move}
	{% if not printer.gcode_move.absolute_coordinates %} G91 {% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='Printer not homed'
	{% endif %}

[gcode_macro _CLIENT_EXTRUDE]
description = Extrudes, if the extruder is hot enough
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set use_fw_retract = (client.use_fw_retract|default(false)|lower == 'true') and (printer.firmware_retraction is defined) %}
	{% set length = params.LENGTH|default(client.unretract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_unretract)|default(35) %}
	{% set absolute_extrude = printer.gcode_move.absolute_extrude %}
	
	{% if printer.toolhead.extruder != '' %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if use_fw_retract %}
	{% if length < 0 %}
	G10
	{% else %}
	G11
	{% endif %}
	{% else %}
	M83
	G1 E{length} F{(speed|float|abs) * 60}
	{% if absolute_extrude %}
	M82
	{% endif %}
	{% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='{"\"%s\" not hot enough" % printer.toolhead.extruder}'
	{% endif %}
	{% endif %}

[gcode_macro _CLIENT_RETRACT]
description = Retracts, if the extruder is hot enough
gcode = 
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set length = params.LENGTH|default(client.retract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_retract)|default(35) %}
	
	_CLIENT_EXTRUDE LENGTH=-{length|float|abs} SPEED={speed|float|abs}

[gcode_macro _CLIENT_LINEAR_MOVE]
description = Linear move with save and restore of the gcode state
gcode = 
	{% set x_move = "X" ~ params.X if params.X is defined else "" %}
	{% set y_move = "Y" ~ params.Y if params.Y is defined else "" %}
	{% set z_move = "Z" ~ params.Z if params.Z is defined else "" %}
	{% set e_move = "E" ~ params.E if params.E is defined else "" %}
	{% set rate = "F" ~ params.F if params.F is defined else "" %}
	{% set ABSOLUTE = params.ABSOLUTE | default(0) | int != 0 %}
	{% set ABSOLUTE_E = params.ABSOLUTE_E | default(0) | int != 0 %}
	SAVE_GCODE_STATE NAME=_client_movement
	{% if x_move or y_move or z_move %}
	G9{ 0 if ABSOLUTE else 1 }
	{% endif %}
	{% if e_move %}
	M8{ 2 if ABSOLUTE_E else 3 }
	{% endif %}
	G1 { x_move } { y_move } { z_move } { e_move } { rate }
	RESTORE_GCODE_STATE NAME=_client_movement

[gcode_macro play_test]
gcode = 
	RESPOND TYPE=command MSG="action:prompt_begin Question"
	RESPOND TYPE=command MSG="action:prompt_text Do you wont to cancel the print?"
	RESPOND TYPE=command MSG="action:prompt_footer_button continue|RESPOND TYPE=command MSG=action:prompt_end"
	RESPOND TYPE=command MSG="action:prompt_footer_button CANCEL|CANCEL_PRINT|error"
	RESPOND TYPE=command MSG="action:prompt_show"

[gcode_macro PRINT_START]
gcode = 
	START_PRINT {rawparams}

[gcode_macro START_PRINT]
gcode = 
	{% set BED_TEMP = params.BED_TEMP|default(60)|float %}
	{% set EXTRUDER_TEMP = params.EXTRUDER_TEMP|default(190)|float %}
	
	M190 S{BED_TEMP}
	
	G90
	
	G28
	
	RESPOND MSG="Bed Meshing"
	
	
	
	
	
	
	
	
	BED_MESH_CLEAR
	BED_MESH_CALIBRATE ADAPTIVE=1
	
	
	
	
	
	
	
	RESPOND MSG="Heating to print temp"
	M104 S{EXTRUDER_TEMP}
	G0 Z40 F240
	M109 S{EXTRUDER_TEMP}
	RESPOND MSG="Enable Runout Sensor"
	SFS_ENABLE
	RESPOND MSG="Line Purge"
	LINE_PURGE
	RESPOND MSG="Print Started"

[gcode_macro LINE_PURGE]
gcode = 
	G92 E0
	G1 Z2.0 F3000
	G1 X0.1 Y20 Z0.3 F5000.0
	G1 X0.1 Y200.0 Z0.3 F1500.0 E15
	G1 X0.4 Y200.0 Z0.3 F5000.0
	G1 X0.4 Y20 Z0.3 F1500.0 E30
	G92 E0
	G1 Z2.0 F3000
	G1 X5 Y20 Z0.3 F5000.0

[gcode_macro PRINT_END]
gcode = 
	END_PRINT

[gcode_macro END_PRINT]
gcode = 
	
	
	RESPOND MSG="Print Finished"
	G91
	G1 E-.5 Z0.2 F2400
	G1 X5 Y5 F6000
	G1 Z10
	G90
	SFS_DISABLE
	
	G1 X0 Y220 F6000
	M106 S0
	M104 S0
	M140 S0
	
	M84 X Y E

[gcode_macro SET_ACTIVE_SPOOL]
gcode = 
	{% if params.ID %}
	{% set id = params.ID|int %}
	{action_call_remote_method(
	"spoolman_set_active_spool",
	spool_id=id
	)}
	{% else %}
	{action_respond_info("Parameter 'ID' is required")}
	{% endif %}

[gcode_macro CLEAR_ACTIVE_SPOOL]
gcode = 
	{action_call_remote_method(
	"spoolman_set_active_spool",
	spool_id=None
	)}

[gcode_macro G29]
gcode = 
	G28
	BED_MESH_CALIBRATE
	G0 X0 Y0 Z10 F6000
	BED_MESH_PROFILE save=default

[gcode_macro M125]
gcode = 
	SAVE_GCODE_STATE NAME=parking
	M117 Parking toolhead
	G91
	G1 Z10 F600
	G90
	G1 X5 Y225 F4000
	RESTORE_GCODE_STATE NAME=parking

[gcode_macro Load_Filament]
gcode = 
	SAVE_GCODE_STATE NAME=loading_filament
	M117 Loading Filament
	M83
	G92 E0.0
	G91
	G1 E50 F200
	G92 E50
	RESTORE_GCODE_STATE NAME=loading_filament

[gcode_macro Unload_Filament]
gcode = 
	SAVE_GCODE_STATE NAME=unloading_filament
	M117 Unloading Filament
	G91
	G1 E5 F100
	G92 E0.0
	G1 E-50 F5000
	G92 E-50
	RESTORE_GCODE_STATE NAME=unloading_filament

[gcode_macro Filament_Change]
gcode = 
	
	SAVE_GCODE_STATE NAME=filament_change
	
	Unload_Filament
	
	RESPOND TYPE=command MSG="action:prompt_begin Question"
	RESPOND TYPE=command MSG="action:prompt_text Please insert new filament and confirm"
	RESPOND TYPE=command MSG="action:prompt_footer_button CONFIRM|Load_Filament|RESPOND TYPE=command MSG=action:prompt_end"
	RESPOND TYPE=command MSG="action:prompt_footer_button CANCEL|RESPOND TYPE=command MSG=action:prompt_end"
	RESPOND TYPE=command MSG="action:prompt_show"
	
	RESTORE_GCODE_STATE NAME=filament_change

[gcode_macro Calibrate_Hotend_PID]
gcode = 
	PID_CALIBRATE HEATER=extruder TARGET=200

[gcode_macro Calibrate_Bed_PID]
gcode = 
	PID_CALIBRATE HEATER=heater_bed TARGET=60

[gcode_macro Calibrate_Zoffset]
gcode = 
	PROBE_CALIBRATE

[gcode_macro Tram_bed]
gcode = 
	SCREWS_TILT_CALCULATE

[gcode_macro TEST_SPEED]
description = Test for max speed and acceleration parameters for the printer. Procedure: Home -> ReadPositionFromMCU -> MovesToolhead@Vel&Accel -> Home -> ReadPositionfromMCU
gcode = 
	
	{% set speed  = params.SPEED|default(printer.configfile.settings.printer.max_velocity)|int %}
	
	{% set iterations = params.ITERATIONS|default(5)|int %}
	
	{% set accel  = params.ACCEL|default(printer.configfile.settings.printer.max_accel)|int %}
	
	{% set min_cruise_ratio = params.MIN_CRUISE_RATIO|default(0.5)|float %}
	
	{% set bound = params.BOUND|default(20)|int %}
	
	{% set smallpatternsize = SMALLPATTERNSIZE|default(20)|int %}
	
	
	
	{% set x_min = printer.toolhead.axis_minimum.x + bound %}
	{% set x_max = printer.toolhead.axis_maximum.x - bound %}
	{% set y_min = printer.toolhead.axis_minimum.y + bound %}
	{% set y_max = printer.toolhead.axis_maximum.y - bound %}
	
	
	
	{% set x_center = (printer.toolhead.axis_minimum.x|float + printer.toolhead.axis_maximum.x|float ) / 2 %}
	{% set y_center = (printer.toolhead.axis_minimum.y|float + printer.toolhead.axis_maximum.y|float ) / 2 %}
	
	
	{% set x_center_min = x_center - (smallpatternsize/2) %}
	{% set x_center_max = x_center + (smallpatternsize/2) %}
	{% set y_center_min = y_center - (smallpatternsize/2) %}
	{% set y_center_max = y_center + (smallpatternsize/2) %}
	
	
	SAVE_GCODE_STATE NAME=TEST_SPEED
	
	
	{ action_respond_info("TEST_SPEED: starting %d iterations at speed %d, accel %d" % (iterations, speed, accel)) }
	
	
	M400
	G28
	
	{% if printer.configfile.settings.quad_gantry_level %}
	{% if printer.quad_gantry_level.applied == False %}
	QUAD_GANTRY_LEVEL
	G28 Z
	{% endif %}
	{% endif %}
	
	G90
	G1 X{printer.toolhead.axis_maximum.x-50} Y{printer.toolhead.axis_maximum.y-50} F{30*60}
	M400
	G28 X Y
	G0 X{printer.toolhead.axis_maximum.x-1} Y{printer.toolhead.axis_maximum.y-1} F{30*60}
	G4 P1000
	GET_POSITION
	
	
	G0 X{x_min} Y{y_min} Z{bound + 10} F{speed*60}
	
	
	{% if printer.configfile.settings.printer.minimum_cruise_ratio is defined %}
	SET_VELOCITY_LIMIT VELOCITY={speed} ACCEL={accel} MINIMUM_CRUISE_RATIO={min_cruise_ratio}
	{% else %}
	SET_VELOCITY_LIMIT VELOCITY={speed} ACCEL={accel} ACCEL_TO_DECEL={accel / 2}
	{% endif %}
	
	{% for i in range(iterations) %}
	
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_max} Y{y_max} F{speed*60}
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	G0 X{x_min} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	
	
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_min} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	
	
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_max} Y{y_center_max} F{speed*60}
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	G0 X{x_center_min} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	
	
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_min} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	{% endfor %}
	
	
	{% if printer.configfile.settings.printer.minimum_cruise_ratio is defined %}
	SET_VELOCITY_LIMIT VELOCITY={printer.configfile.settings.printer.max_velocity} ACCEL={printer.configfile.settings.printer.max_accel} MINIMUM_CRUISE_RATIO={printer.configfile.settings.printer.minimum_cruise_ratio}
	{% else %}
	SET_VELOCITY_LIMIT VELOCITY={printer.configfile.settings.printer.max_velocity} ACCEL={printer.configfile.settings.printer.max_accel} ACCEL_TO_DECEL={printer.configfile.settings.printer.max_accel_to_decel}
	{% endif %}
	
	
	M400
	G28
	
	G90
	G0 X{printer.toolhead.axis_maximum.x-1} Y{printer.toolhead.axis_maximum.y-1} F{30*60}
	G4 P1000
	GET_POSITION
	
	
	RESTORE_GCODE_STATE NAME=TEST_SPEED

[gcode_macro GET_TIMELAPSE_SETUP]
description = Print the Timelapse setup
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% set output_txt = ["Timelapse Setup:"] %}
	{% set _dummy = output_txt.append("enable: %s" % tl.enable) %}
	{% set _dummy = output_txt.append("park: %s" % tl.park.enable) %}
	{% if tl.park.enable %}
	{% set _dummy = output_txt.append("park position: %s time: %s s" % (tl.park.pos, tl.park.time)) %}
	{% set _dummy = output_txt.append("park cord x:%s y:%s dz:%s" % (tl.park.coord.x, tl.park.coord.y, tl.park.coord.dz)) %}
	{% set _dummy = output_txt.append("travel speed: %s mm/s" % tl.speed.travel) %}
	{% endif %}
	{% set _dummy = output_txt.append("fw_retract: %s" % tl.extruder.fw_retract) %}
	{% if not tl.extruder.fw_retract %}
	{% set _dummy = output_txt.append("retract: %s mm speed: %s mm/s" % (tl.extruder.retract, tl.speed.retract)) %}
	{% set _dummy = output_txt.append("extrude: %s mm speed: %s mm/s" % (tl.extruder.extrude, tl.speed.extrude)) %}
	{% endif %}
	{% set _dummy = output_txt.append("verbose: %s" % tl.verbose) %}
	{action_respond_info(output_txt|join("\n"))}

[gcode_macro _SET_TIMELAPSE_SETUP]
description = Set user parameters for timelapse
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	
	{% set min = printer.toolhead.axis_minimum %}
	{% set max = printer.toolhead.axis_maximum %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	{% set park = {'min'   : {'x': (min.x / 1.42)|round(3) if round_bed else min.x|round(3),
	'y': (min.y / 1.42)|round(3) if round_bed else min.y|round(3)},
	'max'   : {'x': (max.x / 1.42)|round(3) if round_bed else max.x|round(3),
	'y': (max.y / 1.42)|round(3) if round_bed else max.y|round(3)},
	'center': {'x': (max.x-(max.x-min.x)/2)|round(3),
	'y': (max.y-(max.y-min.y)/2)|round(3)}} %}
	
	{% if params.ENABLE %}
	{% if params.ENABLE|lower is in ['true', 'false'] %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=enable VALUE={True if params.ENABLE|lower == 'true' else False}
	{% else %}
	{action_raise_error("ENABLE=%s not supported. Allowed values are [True, False]" % params.ENABLE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.VERBOSE %}
	{% if params.VERBOSE|lower is in ['true', 'false'] %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=verbose VALUE={True if params.VERBOSE|lower == 'true' else False}
	{% else %}
	{action_raise_error("VERBOSE=%s not supported. Allowed values are [True, False]" % params.VERBOSE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_X %}
	{% if params.CUSTOM_POS_X|float >= min.x and params.CUSTOM_POS_X|float <= max.x %}
	{% set _dummy = tl.park.custom.update({'x':params.CUSTOM_POS_X|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_X=%s must be within [%s - %s]" % (params.CUSTOM_POS_X, min.x, max.x))}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_Y %}
	{% if params.CUSTOM_POS_Y|float >= min.y and params.CUSTOM_POS_Y|float <= max.y %}
	{% set _dummy = tl.park.custom.update({'y':params.CUSTOM_POS_Y|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_Y=%s must be within [%s - %s]" % (params.CUSTOM_POS_Y, min.y, max.y))}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_DZ %}
	{% if params.CUSTOM_POS_DZ|float >= min.z and params.CUSTOM_POS_DZ|float <= max.z %}
	{% set _dummy = tl.park.custom.update({'dz':params.CUSTOM_POS_DZ|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_DZ=%s must be within [%s - %s]" % (params.CUSTOM_POS_DZ, min.z, max.z))}
	{% endif %}
	{% endif %}
	{% if params.PARK_ENABLE %}
	{% if params.PARK_ENABLE|lower is in ['true', 'false'] %}
	{% set _dummy = tl.park.update({'enable':True if params.PARK_ENABLE|lower == 'true' else False}) %}
	{% else %}
	{action_raise_error("PARK_ENABLE=%s not supported. Allowed values are [True, False]" % params.PARK_ENABLE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.PARK_POS %}
	{% if params.PARK_POS|lower is in ['center','front_left','front_right','back_left','back_right','custom','x_only','y_only'] %}
	{% set dic = {'center'      : {'x': park.center.x   , 'y': park.center.y   , 'dz': 1                },
	'front_left'  : {'x': park.min.x      , 'y': park.min.y      , 'dz': 0                },
	'front_right' : {'x': park.max.x      , 'y': park.min.y      , 'dz': 0                },
	'back_left'   : {'x': park.min.x      , 'y': park.max.y      , 'dz': 0                },
	'back_right'  : {'x': park.max.x      , 'y': park.max.y      , 'dz': 0                },
	'custom'      : {'x': tl.park.custom.x, 'y': tl.park.custom.y, 'dz': tl.park.custom.dz},
	'x_only'      : {'x': tl.park.custom.x, 'y': 'none'          , 'dz': tl.park.custom.dz},
	'y_only'      : {'x': 'none'          , 'y': tl.park.custom.y, 'dz': tl.park.custom.dz}} %}
	{% set _dummy = tl.park.update({'pos':params.PARK_POS|lower}) %}
	{% set _dummy = tl.park.update({'coord':dic[tl.park.pos]}) %}
	{% else %}
	{action_raise_error("PARK_POS=%s not supported. Allowed values are [CENTER, FRONT_LEFT, FRONT_RIGHT, BACK_LEFT, BACK_RIGHT, CUSTOM, X_ONLY, Y_ONLY]"
	% params.PARK_POS|upper)}
	{% endif %}
	{% endif %}
	{% if params.PARK_TIME %}
	{% if params.PARK_TIME|float >= 0.0 %}
	{% set _dummy = tl.park.update({'time':params.PARK_TIME|float|round(3)}) %}
	{% else %}
	{action_raise_error("PARK_TIME=%s must be a positive number" % params.PARK_TIME)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=park VALUE="{tl.park}"
	{% if params.TRAVEL_SPEED %}
	{% if params.TRAVEL_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'travel':params.TRAVEL_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("TRAVEL_SPEED=%s must be larger than 0" % params.TRAVEL_SPEED)}
	{% endif %}
	{% endif %}
	{% if params.RETRACT_SPEED %}
	{% if params.RETRACT_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'retract':params.RETRACT_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("RETRACT_SPEED=%s must be larger than 0" % params.RETRACT_SPEED)}
	{% endif %}
	{% endif %}
	{% if params.EXTRUDE_SPEED %}
	{% if params.EXTRUDE_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'extrude':params.EXTRUDE_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("EXTRUDE_SPEED=%s must be larger than 0" % params.EXTRUDE_SPEED)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=speed VALUE="{tl.speed}"
	{% if params.EXTRUDE_DISTANCE %}
	{% if params.EXTRUDE_DISTANCE|float >= 0.0 %}
	{% set _dummy = tl.extruder.update({'extrude':params.EXTRUDE_DISTANCE|float|round(3)}) %}
	{% else %}
	{action_raise_error("EXTRUDE_DISTANCE=%s must be specified as positiv number" % params.EXTRUDE_DISTANCE)}
	{% endif %}
	{% endif %}
	{% if params.RETRACT_DISTANCE %}
	{% if params.RETRACT_DISTANCE|float >= 0.0 %}
	{% set _dummy = tl.extruder.update({'retract':params.RETRACT_DISTANCE|float|round(3)}) %}
	{% else %}
	{action_raise_error("RETRACT_DISTANCE=%s must be specified as positiv number" % params.RETRACT_DISTANCE)}
	{% endif %}
	{% endif %}
	{% if params.FW_RETRACT %}
	{% if params.FW_RETRACT|lower is in ['true', 'false'] %}
	{% if 'firmware_retraction' in printer.configfile.settings %}
	{% set _dummy = tl.extruder.update({'fw_retract': True if params.FW_RETRACT|lower == 'true' else False}) %}
	{% else %}
	{% set _dummy = tl.extruder.update({'fw_retract':False}) %}
	{% if params.FW_RETRACT|capitalize == 'True' %}
	{action_raise_error("[firmware_retraction] not defined in printer.cfg. Can not enable fw_retract")}
	{% endif %}
	{% endif %}
	{% else %}
	{action_raise_error("FW_RETRACT=%s not supported. Allowed values are [True, False]" % params.FW_RETRACT|capitalize)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=extruder VALUE="{tl.extruder}"
	{% if printer.configfile.settings['gcode_macro pause'] is defined %}
	{% set _dummy = tl.macro.update({'pause': printer.configfile.settings['gcode_macro pause'].rename_existing}) %}
	{% endif %}
	{% if printer.configfile.settings['gcode_macro resume'] is defined %}
	{% set _dummy = tl.macro.update({'resume': printer.configfile.settings['gcode_macro resume'].rename_existing}) %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=macro VALUE="{tl.macro}"

[gcode_macro TIMELAPSE_TAKE_FRAME]
description = Take Timelapse shoot
variable_enable = False
variable_takingframe = False
variable_park = {'enable': False,
	'pos'   : 'center',
	'time'  : 0.1,
	'custom': {'x': 0, 'y': 0, 'dz': 0},
	'coord' : {'x': 0, 'y': 0, 'dz': 0}}
variable_extruder = {'fw_retract': False,
	'retract': 1.0,
	'extrude': 1.0}
variable_speed = {'travel': 100,
	'retract': 15,
	'extrude': 15}
variable_verbose = True
variable_check_time = 0.5
variable_restore = {'absolute': {'coordinates': True, 'extrude': True}, 'speed': 1500, 'e':0, 'factor': {'speed': 1.0, 'extrude': 1.0}}
variable_macro = {'pause': 'PAUSE', 'resume': 'RESUME'}
variable_is_paused = False
gcode = 
	{% set hyperlapse = True if params.HYPERLAPSE and params.HYPERLAPSE|lower =='true' else False %}
	{% if enable %}
	{% if (hyperlapse and printer['gcode_macro HYPERLAPSE'].run) or
	(not hyperlapse and not printer['gcode_macro HYPERLAPSE'].run) %}
	{% if park.enable %}
	{% set pos = {'x': 'X' + park.coord.x|string if park.pos != 'y_only' else '',
	'y': 'Y' + park.coord.y|string if park.pos != 'x_only' else '',
	'z': 'Z'+ [printer.gcode_move.gcode_position.z + park.coord.dz, printer.toolhead.axis_maximum.z]|min|string} %}
	{% set restore = {'absolute': {'coordinates': printer.gcode_move.absolute_coordinates,
	'extrude'    : printer.gcode_move.absolute_extrude},
	'speed'   : printer.gcode_move.speed,
	'e'       : printer.gcode_move.gcode_position.e,
	'factor'  : {'speed'  : printer.gcode_move.speed_factor,
	'extrude': printer.gcode_move.extrude_factor}} %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=restore VALUE="{restore}"
	{% if not printer[printer.toolhead.extruder].can_extrude %}
	{% if verbose %}{action_respond_info("Timelapse: Warning, minimum extruder temperature not reached!")}{% endif %}
	{% else %}
	{% if extruder.fw_retract %}
	G10
	{% else %}
	M83
	G0 E-{extruder.retract} F{speed.retract * 60}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=is_paused VALUE=True
	{macro.pause}
	SET_GCODE_OFFSET X=0 Y=0
	G90
	{% if "xyz" not in printer.toolhead.homed_axes %}
	{% if verbose %}{action_respond_info("Timelapse: Warning, axis not homed yet!")}{% endif %}
	{% else %}
	G0 {pos.x} {pos.y} {pos.z} F{speed.travel * 60}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=takingframe VALUE=True
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_TAKE_FRAME DURATION={check_time}
	M400
	{% endif %}
	_TIMELAPSE_NEW_FRAME HYPERLAPSE={hyperlapse}
	{% endif %}
	{% else %}
	{% if verbose %}{action_respond_info("Timelapse: disabled, take frame ignored")}{% endif %}
	{% endif %}

[gcode_macro _TIMELAPSE_NEW_FRAME]
description = action call for timelapse shoot. must be a seperate macro
gcode = 
	{action_call_remote_method("timelapse_newframe",
	macropark=printer['gcode_macro TIMELAPSE_TAKE_FRAME'].park,
	hyperlapse=params.HYPERLAPSE)}

[delayed_gcode _WAIT_TIMELAPSE_TAKE_FRAME]
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% set factor = {'speed': printer.gcode_move.speed_factor, 'extrude': printer.gcode_move.extrude_factor} %}
	{% if tl.takingframe %}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_TAKE_FRAME DURATION={tl.check_time}
	{% else %}
	{tl.macro.resume} VELOCITY={tl.speed.travel}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=is_paused VALUE=False
	{% if not printer[printer.toolhead.extruder].can_extrude %}
	{action_respond_info("Timelapse: Warning minimum extruder temperature not reached!")}
	{% else %}
	{% if tl.extruder.fw_retract %}
	G11
	{% else %}
	G0 E{tl.extruder.extrude} F{tl.speed.extrude * 60}
	G0 F{tl.restore.speed}
	{% if tl.restore.absolute.extrude %}
	M82
	G92 E{tl.restore.e}
	{% endif %}
	{% endif %}
	{% endif %}
	{% if tl.restore.factor.speed   != factor.speed   %} M220 S{(factor.speed*100)|round(0)}   {% endif %}
	{% if tl.restore.factor.extrude != factor.extrude %} M221 S{(factor.extrude*100)|round(0)} {% endif %}
	{% if not tl.restore.absolute.coordinates %} G91 {% endif %}
	{% endif %}

[gcode_macro HYPERLAPSE]
description = Start/Stop a hyperlapse recording
variable_cycle = 0
variable_run = False
gcode = 
	{% set cycle = params.CYCLE|default(30)|int %}
	{% if params.ACTION and params.ACTION|lower == 'start' %}
	{action_respond_info("Hyperlapse: frames started (Cycle %d sec)" % cycle)}
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=run VALUE=True
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=cycle VALUE={cycle}
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION={cycle}
	TIMELAPSE_TAKE_FRAME HYPERLAPSE=True
	{% elif params.ACTION and params.ACTION|lower == 'stop' %}
	{% if run %}{action_respond_info("Hyperlapse: frames stopped")}{% endif %}
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=run VALUE=False
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION=0
	{% else %}
	{action_raise_error("Hyperlapse: No valid input parameter
	Use:
	- HYPERLAPSE ACTION=START [CYCLE=time]
	- HYPERLAPSE ACTION=STOP")}
	{% endif %}

[delayed_gcode _HYPERLAPSE_LOOP]
gcode = 
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION={printer["gcode_macro HYPERLAPSE"].cycle}
	TIMELAPSE_TAKE_FRAME HYPERLAPSE=True

[gcode_macro TIMELAPSE_RENDER]
description = Render Timelapse video and wait for the result
variable_render = False
variable_run_identifier = 0
gcode = 
	{action_respond_info("Timelapse: Rendering started")}
	{action_call_remote_method("timelapse_render", byrendermacro="True")}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_RENDER VARIABLE=render VALUE=True
	{printer.configfile.settings['gcode_macro pause'].rename_existing}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_RENDER DURATION=0.5

[delayed_gcode _WAIT_TIMELAPSE_RENDER]
gcode = 
	{% set ri = printer['gcode_macro TIMELAPSE_RENDER'].run_identifier % 4 %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_RENDER VARIABLE=run_identifier VALUE={ri + 1}
	{% if printer['gcode_macro TIMELAPSE_RENDER'].render %}
	M117 Rendering {['-','\\','|','/'][ri]}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_RENDER DURATION=0.5
	{% else %}
	{action_respond_info("Timelapse: Rendering finished")}
	M117
	{printer.configfile.settings['gcode_macro resume'].rename_existing}
	{% endif %}

[gcode_macro TEST_STREAM_DELAY]
description = Helper macro to find stream and park delay
gcode = 
	{% set min = printer.toolhead.axis_minimum %}
	{% set max = printer.toolhead.axis_maximum %}
	{% set act = printer.toolhead.position %}
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% if act.z > 5.0 %}
	G0 X{min.x + 5.0} F{tl.speed.travel|int * 60}
	G0 X{(max.x-min.x)/2}
	G4 P{tl.park.time|float * 1000}
	_TIMELAPSE_NEW_FRAME HYPERLAPSE=FALSE
	G0 X{max.x - 5.0}
	{% else %}
	{action_raise_error("Toolhead z %.3f to low. Please place head above z = 5.0" % act.z)}
	{% endif %}

[gcode_macro _OBICO_LAYER_CHANGE]
description = Run a scan across the current print area
variable_first_layer_scan_retract_length = 6
variable_first_layer_scan_retract_speed = 15
variable_first_layer_scan_cooldown_temp = 170
variable_first_layer_scan_resume_speed = 50
variable_first_layer_scan_enabled = True
variable_first_layer_scan_stepover = 10
variable_first_layer_scan_speed = 10
variable_first_layer_scan_zhop = 4
variable_first_layer_scan_zhop_speed = 15
variable_verbose = False
variable_current_layer = -1
variable_first_layer_scanning = False
variable_wait = {'resume': "RESUME", 'absolute_coordinates': True, 'absolute_extrude': True, 'e': 0.0, 'previous_temp': 0}
gcode = 
	
	{% set pause_macro  = "PAUSE"  if printer.configfile.settings['gcode_macro pause']  is not defined
	else printer.configfile.settings['gcode_macro pause'].rename_existing %}
	{% set resume_macro = "RESUME" if printer.configfile.settings['gcode_macro resume'] is not defined
	else printer.configfile.settings['gcode_macro resume'].rename_existing %}
	
	{% set current_layer_default = printer.print_stats.info.current_layer if printer.print_stats.info.current_layer is not none else -1 %}
	{% set current_layer = params.CURRENT_LAYER|default(current_layer_default)|int %}
	
	{% set polygon_points = printer.exclude_object.objects|map(attribute='polygon')|sum(start=[]) if printer.exclude_object is defined else [] %}
	{% set min_x = params.MINX|default(polygon_points|map(attribute=0)|min|default(printer.toolhead.axis_minimum.x))|float %}
	{% set min_y = params.MINY|default(polygon_points|map(attribute=1)|min|default(printer.toolhead.axis_minimum.y))|float %}
	{% set max_x = params.MAXX|default(polygon_points|map(attribute=0)|max|default(printer.toolhead.axis_maximum.x))|float %}
	{% set max_y = params.MAXY|default(polygon_points|map(attribute=1)|max|default(printer.toolhead.axis_maximum.y))|float %}
	
	{% set stepoverCount = ((max_y - min_y) / first_layer_scan_stepover|float)|round(method='ceil')|int %}
	
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Layer %d" % (current_layer)}' {% endif %}
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=current_layer VALUE={current_layer}
	
	{% if first_layer_scan_enabled and current_layer == 2 %}
	
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=first_layer_scanning VALUE=True
	
	
	{% set wait_dic = {'resume'              : resume_macro,
	'absolute_coordinates': printer.gcode_move.absolute_coordinates,
	'absolute_extrude'    : printer.gcode_move.absolute_extrude,
	'e'                   : printer.gcode_move.gcode_position.e,
	'previous_temp'       : printer.extruder.target} %}
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=wait VALUE="{wait_dic}"
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Prepare scanning" {% endif %}
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Scan Coordinates: Min:[%.3f:%.3f] Max:[%.3f:%.3f]" % (min_x,min_y,max_x,max_y)}' {% endif %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Retract %.1fmm filament" % first_layer_scan_retract_length|abs}' {% endif %}
	M83
	G0 E-{first_layer_scan_retract_length|abs} F{first_layer_scan_retract_speed|float * 60}
	{% endif %}
	G91
	G0 Z{first_layer_scan_zhop|abs} F{first_layer_scan_zhop_speed|float * 60}
	
	
	M106 S255
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Fan on and lowering temperature to %.1f" % first_layer_scan_cooldown_temp}' {% endif %}
	M104 S{first_layer_scan_cooldown_temp}
	M109 S{first_layer_scan_cooldown_temp}
	
	{pause_macro}
	
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Start scanning" {% endif %}
	
	UPDATE_DELAYED_GCODE ID=_WAIT_OBICO_LAYER_CHANGE DURATION=1.0
	G90
	G0 X{min_x} Y{min_y} F{first_layer_scan_resume_speed|float * 60}
	{% for ystep in range(stepoverCount) %}
	G0 Y{min_y + first_layer_scan_stepover|float * ystep} F{first_layer_scan_speed|float * 60}
	G0 X{max_x if ystep % 2 == 0 else min_x}              F{first_layer_scan_speed|float * 60}
	{% endfor %}
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Finish scanning" {% endif %}
	
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=first_layer_scanning VALUE=False
	
	{% endif %}

[delayed_gcode _WAIT_OBICO_LAYER_CHANGE]
gcode = 
	{% set lc_macro = printer['gcode_macro _OBICO_LAYER_CHANGE'] %}
	{% if lc_macro.first_layer_scanning %}
	
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Waiting for first layer scan..." {% endif %}
	UPDATE_DELAYED_GCODE ID=_WAIT_OBICO_LAYER_CHANGE DURATION=1.0
	{% else %}
	
	M107
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Fan off and resume print" {% endif %}
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Call %s VELOCITY=%.1f" % (lc_macro.wait.resume, lc_macro.first_layer_scan_resume_speed)}' {% endif %}
	{lc_macro.wait.resume} VELOCITY={lc_macro.first_layer_scan_resume_speed}
	G91
	G0 Z-{lc_macro.first_layer_scan_zhop|abs} F{lc_macro.first_layer_scan_zhop_speed|float * 60}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% set first_layer_scan_unretract_length = lc_macro.first_layer_scan_retract_length + 0.5 %}
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Extrude %.1fmm filament" % first_layer_scan_unretract_length|abs}' {% endif %}
	M83
	G0 E{first_layer_scan_unretract_length|abs} F{lc_macro.first_layer_scan_retract_speed|float * 60}
	{% endif %}
	
	
	M104 S{lc_macro.wait.previous_temp}
	M109 S{lc_macro.wait.previous_temp}
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Heating back up to previous temperature"}' {% endif %}
	
	
	{% if lc_macro.wait.absolute_coordinates %} G90 {% endif %}
	{% if lc_macro.wait.absolute_extrude %}
	M82
	G92 E{lc_macro.wait.e}
	{% endif %}
	{% endif %}

[gcode_macro OBICO_LINK_STATUS]
description = Link to Obico server
variable_one_time_passcode = ''
variable_one_time_passlink = ''
variable_is_linked = False
gcode = 
	{action_respond_info('Obico one_time_passcode: {}'.format(one_time_passcode))}
	{action_respond_info('Obico one_time_passlink: {}'.format(one_time_passlink))}
	{action_respond_info('Obico is_linked: {}'.format(is_linked))}
	{% if not is_linked and one_time_passcode != '' %}
	M117 Code: {one_time_passcode}
	{% else %}
	M117 Obico linked
	{% endif %}

[gcode_macro _OBICO_RELINK]
description = Re-link to Obico server
gcode = 
	{action_respond_info('WARNING: Re-link to Obico server')}
	{action_call_remote_method("obico_remote_event", event_name='relink_obico', message='')}
	{action_respond_info('WARNING: relink_obico requested')}

[exclude_object]

[mcu]
serial = /dev/serial/by-id/usb-1a86_USB_Serial-if00-port0
restart_method = command

[temperature_sensor raspberry_pi]
sensor_type = temperature_host
min_temp = 10
max_temp = 100

[temperature_sensor mcu_temp]
sensor_type = temperature_mcu
min_temp = 0
max_temp = 100

[printer]
kinematics = cartesian
max_velocity = 200
max_accel = 4000
max_z_velocity = 10
max_z_accel = 100
minimum_cruise_ratio = 0.5
square_corner_velocity = 5

[stepper_x]
step_pin = PB9
dir_pin = PC2
enable_pin = !PC3
microsteps = 16
rotation_distance = 40
endstop_pin = ^PA5
position_endstop = 0
position_max = 230
homing_speed = 50

[stepper_y]
step_pin = PB7
dir_pin = PB8
enable_pin = !PC3
microsteps = 16
rotation_distance = 40
endstop_pin = ^PA6
position_endstop = 0
position_max = 231
homing_speed = 50

[stepper_z]
step_pin = PB5
dir_pin = !PB6
enable_pin = !PC3
microsteps = 16
rotation_distance = 8
endstop_pin = probe:z_virtual_endstop
position_max = 250
position_min = -4
homing_speed = 4
second_homing_speed = 1
homing_retract_dist = 2.0

[fan]
pin = PA0

[extruder]
max_extrude_only_distance = 100.0
step_pin = PB3
dir_pin = PB4
enable_pin = !PC3
microsteps = 16
gear_ratio = 42:12
rotation_distance = 26.359
nozzle_diameter = 0.400
filament_diameter = 1.750
heater_pin = PA1
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PC5
min_temp = 0
max_temp = 300
min_extrude_temp = 170
pressure_advance = .0369
pressure_advance_smooth_time = 0.04
control = pid
pid_kp = 19.195
pid_ki = 1.000
pid_kd = 92.135

[firmware_retraction]
retract_length = 0.3
retract_speed = 20

[idle_timeout]
gcode = 
	{% if printer.pause_resume.is_paused %}
	M118 Idle timeout while paused, turning off hotend
	SET_HEATER_TEMPERATURE HEATER=extruder TARGET=0
	{% else %}
	M118 Idle timeout
	TURN_OFF_HEATERS
	M84
	{% endif %}
timeout = 1800

[heater_bed]
heater_pin = PA2
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PC4
min_temp = 0
max_temp = 130
control = pid
pid_kp = 68.601
pid_ki = 1.185
pid_kd = 993.000

[bltouch]
sensor_pin = ^PB1
control_pin = PB0
x_offset = -31.8
y_offset = -40.5
speed = 35
samples = 2
samples_result = median
samples_tolerance = 0.05
samples_tolerance_retries = 2
sample_retract_dist = 5.0
probe_with_touch_mode = true
stow_on_each_sample = false
z_offset = 2.049

[safe_z_home]
home_xy_position = 147, 154
speed = 75
z_hop = 10
z_hop_speed = 5
move_to_previous = false

[bed_screws]
screw1 = 30,51
screw1_name = "FL"
screw2 = 200,51
screw2_name = "FR"
screw3 = 200,195
screw3_name = "RR"
screw4 = 30,195
screw4_name = "RL"

[screws_tilt_adjust]
screw1 = 67, 67
screw1_name = front left screw
screw2 = 230, 67
screw2_name = front right screw
screw3 = 230, 230
screw3_name = rear right screw
screw4 = 67.60, 230
screw4_name = rear left screw
horizontal_move_z = 10
speed = 200
screw_thread = CW-M4

[bed_mesh]
speed = 120
mesh_min = 10,11
mesh_max = 195,182
probe_count = 3,3
algorithm = bicubic
fade_start = 1
fade_end = 10
fade_target = 0

[filament_motion_sensor SFS_T0]
detection_length = 150.00
extruder = extruder
switch_pin = PA4
pause_on_runout = True
event_delay = 3.0
pause_delay = 0.5
runout_gcode = 
	M117 Runout Detected!

[delayed_gcode DISABLEFILAMENTSENSOR]
initial_duration = 1
gcode = 
	SET_FILAMENT_SENSOR SENSOR=SFS_T0 ENABLE=0

[gcode_macro SFS_ENABLE]
description = Enable smart filament sensor
gcode = 
	M117 ENABLING the Smart Filament Sensor
	G92 E0
	SET_FILAMENT_SENSOR SENSOR=SFS_T0 ENABLE=1

[gcode_macro SFS_DISABLE]
description = Disable smart filament sensor
gcode = 
	M117 DISABLING the Smart Filament Sensor
	G92 E0
	SET_FILAMENT_SENSOR SENSOR=SFS_T0 ENABLE=0

[gcode_macro FILAMENT_RUNOUT]
gcode = 
	M117 Runout Detected!
	M300 S1 P10
	M600
	M300 S1 P10

[gcode_macro M300]
gcode = 
	{% set S = params.S|default(1000)|int %}
	{% set P = params.P|default(100)|int %}
	SET_PIN PIN=BEEPER VALUE=0.5 CYCLE_TIME={ 1.0/S if S > 0 else 1 }
	G4 P{P}
	SET_PIN PIN=BEEPER VALUE=0
	[gcode_macro M600]
	gcode:
	{% set X = params.X|default(25)|float %}
	{% set Y = params.Y|default(25)|float %}
	{% set Z = params.Z|default(10)|float %}
	SAVE_GCODE_STATE NAME=M600_state
	PAUSE
	G91
	G1 E-.8 F2700
	G1 Z{Z}
	G90
	G1 X{X} Y{Y} F3000
	G91
	G1 E-15 F1000
	RESTORE_GCODE_STATE NAME=M600_state

[gcode_arcs]
resolution = 1.0

[input_shaper]
shaper_freq_x = 73.5
shaper_type_x = ei
shaper_freq_y = 76.9
shaper_type_y = mzv
=======================
bed_mesh: bicubic interpolation with a probe_count of less than 4 points detected.  Forcing lagrange interpolation. Configured Probe Count: 3, 3
Extruder max_extrude_ratio=0.266081
mcu 'mcu': Starting serial connect
webhooks client 547996431264: New connection
webhooks client 547996431264: Client info {'program': 'Moonraker', 'version': 'v0.9.3-3-gccfe32f'}
mcu 'mcu': got {'oid': 17, 'next_clock': 2948836224, 'value': 31494, '#name': 'analog_in_state', '#sent_time': 314.266141257, '#receive_time': 314.272714812}
mcu 'mcu': got {'oid': 10, 'next_clock': 2965396224, 'value': 14004, '#name': 'analog_in_state', '#sent_time': 314.49134472000003, '#receive_time': 314.502129497}
mcu 'mcu': got {'oid': 12, 'next_clock': 2966836224, 'value': 31547, '#name': 'analog_in_state', '#sent_time': 314.49134472000003, '#receive_time': 314.522093682}
mcu 'mcu': got {'oid': 17, 'next_clock': 2970436224, 'value': 31496, '#name': 'analog_in_state', '#sent_time': 314.545167794, '#receive_time': 314.572128053}
Loaded MCU 'mcu' 119 commands (v0.12.0-286-g81de9a861 / gcc: (15:8-2019-q3-1+b1) 8.3.1 20190703 (release) [gcc-8-branch revision 273027] binutils: (2.35.2-2+14+b2) 2.35.2)
MCU 'mcu' config: ADC_MAX=4095 BUS_PINS_i2c1=PB6,PB7 BUS_PINS_i2c1a=PB8,PB9 BUS_PINS_i2c2=PB10,PB11 BUS_PINS_spi1=PA6,PA7,PA5 BUS_PINS_spi1a=PB4,PB5,PB3 BUS_PINS_spi2=PB14,PB15,PB13 BUS_PINS_spi3=PB4,PB5,PB3 CLOCK_FREQ=72000000 MCU=stm32f103xe PWM_MAX=255 RECEIVE_WINDOW=192 RESERVE_PINS_serial=PA10,PA9 SERIAL_BAUD=250000 STATS_SUMSQ_BASE=256 STEPPER_BOTH_EDGE=1
mcu_temperature 'mcu' nominal base=357.558140 slope=-767.441860
Configured MCU 'mcu' (1024 moves)
Starting heater checks for heater_bed
bed_mesh: generated points
Index |  Tool Adjusted  |   Probe
  0   | (41.8, 51.5)    | (10.0, 11.0)
  1   | (134.3, 51.5)   | (102.5, 11.0)
  2   | (226.8, 51.5)   | (195.0, 11.0)
  3   | (226.8, 137.0)  | (195.0, 96.5)
  4   | (134.3, 137.0)  | (102.5, 96.5)
  5   | (41.8, 137.0)   | (10.0, 96.5)
  6   | (41.8, 222.5)   | (10.0, 182.0)
  7   | (134.3, 222.5)  | (102.5, 182.0)
  8   | (226.8, 222.5)  | (195.0, 182.0)
Starting heater checks for extruder
Stats 315.7: gcodein=0  mcu: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=1146 bytes_read=4624 bytes_retransmit=18 bytes_invalid=6 send_seq=128 receive_seq=128 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000276  raspberry_pi: temp=49.7 mcu_temp: temp=0.0 heater_bed: target=0 temp=0.0 pwm=0.000 sysload=2.01 cputime=2.980 memavail=1468332 print_time=400.284 buffer_time=0.249 print_stall=0 extruder: target=0 temp=0.0 pwm=0.000
webhooks: registering remote method 'shutdown_machine' for connection id: 547996431264
webhooks: registering remote method 'reboot_machine' for connection id: 547996431264
webhooks: registering remote method 'pause_job_queue' for connection id: 547996431264
webhooks: registering remote method 'start_job_queue' for connection id: 547996431264
webhooks: registering remote method 'spoolman_set_active_spool' for connection id: 547996431264
webhooks: registering remote method 'obico_remote_event' for connection id: 547996431264
Stats 316.7: gcodein=0  mcu: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=1152 bytes_read=4805 bytes_retransmit=18 bytes_invalid=6 send_seq=129 receive_seq=129 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000355  raspberry_pi: temp=50.6 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.01 cputime=3.023 memavail=1468028 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 317.7: gcodein=0  mcu: mcu_awake=0.006 mcu_task_avg=0.000028 mcu_task_stddev=0.000013 bytes_write=1158 bytes_read=4986 bytes_retransmit=18 bytes_invalid=6 send_seq=130 receive_seq=130 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000338  raspberry_pi: temp=49.7 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=2.01 cputime=3.063 memavail=1468852 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 318.7: gcodein=0  mcu: mcu_awake=0.006 mcu_task_avg=0.000028 mcu_task_stddev=0.000013 bytes_write=1164 bytes_read=5137 bytes_retransmit=18 bytes_invalid=6 send_seq=131 receive_seq=131 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000425  raspberry_pi: temp=50.1 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.01 cputime=3.083 memavail=1468852 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 319.7: gcodein=0  mcu: mcu_awake=0.006 mcu_task_avg=0.000028 mcu_task_stddev=0.000013 bytes_write=1170 bytes_read=5318 bytes_retransmit=18 bytes_invalid=6 send_seq=132 receive_seq=132 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000404  raspberry_pi: temp=50.1 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.01 cputime=3.101 memavail=1468896 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 320.7: gcodein=0  mcu: mcu_awake=0.006 mcu_task_avg=0.000028 mcu_task_stddev=0.000013 bytes_write=1176 bytes_read=5484 bytes_retransmit=18 bytes_invalid=6 send_seq=133 receive_seq=133 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000333  raspberry_pi: temp=48.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=1.93 cputime=3.118 memavail=1468896 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 321.7: gcodein=0  mcu: mcu_awake=0.006 mcu_task_avg=0.000028 mcu_task_stddev=0.000013 bytes_write=1182 bytes_read=5635 bytes_retransmit=18 bytes_invalid=6 send_seq=134 receive_seq=134 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000362  raspberry_pi: temp=49.7 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.93 cputime=3.135 memavail=1468896 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 322.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1188 bytes_read=5830 bytes_retransmit=18 bytes_invalid=6 send_seq=135 receive_seq=135 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000339  raspberry_pi: temp=49.2 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=1.93 cputime=3.151 memavail=1468936 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 323.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1194 bytes_read=5996 bytes_retransmit=18 bytes_invalid=6 send_seq=136 receive_seq=136 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000334  raspberry_pi: temp=49.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=1.93 cputime=3.169 memavail=1468712 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 324.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1200 bytes_read=6147 bytes_retransmit=18 bytes_invalid=6 send_seq=137 receive_seq=137 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000312  raspberry_pi: temp=48.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.93 cputime=3.185 memavail=1468212 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 325.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1206 bytes_read=6328 bytes_retransmit=18 bytes_invalid=6 send_seq=138 receive_seq=138 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000300  raspberry_pi: temp=48.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.77 cputime=3.204 memavail=1468216 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 326.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1212 bytes_read=6494 bytes_retransmit=18 bytes_invalid=6 send_seq=139 receive_seq=139 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000303  raspberry_pi: temp=49.2 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=1.77 cputime=3.221 memavail=1468216 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 327.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1218 bytes_read=6659 bytes_retransmit=18 bytes_invalid=6 send_seq=140 receive_seq=140 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000258  raspberry_pi: temp=49.2 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.77 cputime=3.233 memavail=1468216 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 328.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1224 bytes_read=6840 bytes_retransmit=18 bytes_invalid=6 send_seq=141 receive_seq=141 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000230  raspberry_pi: temp=50.1 mcu_temp: temp=29.4 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.77 cputime=3.244 memavail=1468216 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 329.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1230 bytes_read=7006 bytes_retransmit=18 bytes_invalid=6 send_seq=142 receive_seq=142 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000208  raspberry_pi: temp=49.2 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.77 cputime=3.255 memavail=1468216 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.6 pwm=0.000
Stats 330.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1236 bytes_read=7157 bytes_retransmit=18 bytes_invalid=6 send_seq=143 receive_seq=143 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000191  raspberry_pi: temp=48.2 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.63 cputime=3.265 memavail=1468224 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 331.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1242 bytes_read=7338 bytes_retransmit=18 bytes_invalid=6 send_seq=144 receive_seq=144 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000236  raspberry_pi: temp=50.1 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.63 cputime=3.277 memavail=1468224 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.6 pwm=0.000
Stats 332.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1248 bytes_read=7510 bytes_retransmit=18 bytes_invalid=6 send_seq=145 receive_seq=145 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000238  raspberry_pi: temp=48.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.63 cputime=3.293 memavail=1467984 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 333.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1254 bytes_read=7650 bytes_retransmit=18 bytes_invalid=6 send_seq=146 receive_seq=146 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000240  raspberry_pi: temp=48.7 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.63 cputime=3.312 memavail=1467984 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 334.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1260 bytes_read=7819 bytes_retransmit=18 bytes_invalid=6 send_seq=147 receive_seq=147 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000239  raspberry_pi: temp=49.2 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.63 cputime=3.329 memavail=1467488 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 335.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1266 bytes_read=7974 bytes_retransmit=18 bytes_invalid=6 send_seq=148 receive_seq=148 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000236  raspberry_pi: temp=49.2 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.50 cputime=3.348 memavail=1467496 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 336.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1272 bytes_read=8125 bytes_retransmit=18 bytes_invalid=6 send_seq=149 receive_seq=149 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000237  raspberry_pi: temp=49.2 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.50 cputime=3.367 memavail=1467496 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 337.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1278 bytes_read=8320 bytes_retransmit=18 bytes_invalid=6 send_seq=150 receive_seq=150 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000243  raspberry_pi: temp=48.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=1.50 cputime=3.386 memavail=1467496 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 338.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1284 bytes_read=8486 bytes_retransmit=18 bytes_invalid=6 send_seq=151 receive_seq=151 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000237  raspberry_pi: temp=49.2 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.50 cputime=3.405 memavail=1467248 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 339.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1290 bytes_read=8637 bytes_retransmit=18 bytes_invalid=6 send_seq=152 receive_seq=152 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000234  raspberry_pi: temp=49.7 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.50 cputime=3.422 memavail=1467248 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 340.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1296 bytes_read=8818 bytes_retransmit=18 bytes_invalid=6 send_seq=153 receive_seq=153 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000228  raspberry_pi: temp=48.7 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.38 cputime=3.438 memavail=1467248 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.6 pwm=0.000
Stats 341.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1302 bytes_read=8984 bytes_retransmit=18 bytes_invalid=6 send_seq=154 receive_seq=154 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000224  raspberry_pi: temp=49.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=1.38 cputime=3.455 memavail=1467248 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 342.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1308 bytes_read=9135 bytes_retransmit=18 bytes_invalid=6 send_seq=155 receive_seq=155 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000227  raspberry_pi: temp=48.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.38 cputime=3.471 memavail=1467248 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 343.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1314 bytes_read=9330 bytes_retransmit=18 bytes_invalid=6 send_seq=156 receive_seq=156 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000231  raspberry_pi: temp=49.2 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.38 cputime=3.490 memavail=1467248 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 344.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1320 bytes_read=9496 bytes_retransmit=18 bytes_invalid=6 send_seq=157 receive_seq=157 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000233  raspberry_pi: temp=49.7 mcu_temp: temp=29.7 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.38 cputime=3.507 memavail=1467248 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 345.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1326 bytes_read=9647 bytes_retransmit=18 bytes_invalid=6 send_seq=158 receive_seq=158 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000232  raspberry_pi: temp=48.7 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.43 cputime=3.523 memavail=1467260 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 346.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1332 bytes_read=9828 bytes_retransmit=18 bytes_invalid=6 send_seq=159 receive_seq=159 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000239  raspberry_pi: temp=48.7 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.43 cputime=3.541 memavail=1467260 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.6 pwm=0.000
Stats 347.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1338 bytes_read=9994 bytes_retransmit=18 bytes_invalid=6 send_seq=160 receive_seq=160 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000229  raspberry_pi: temp=49.7 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.43 cputime=3.555 memavail=1467260 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 348.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1344 bytes_read=10159 bytes_retransmit=18 bytes_invalid=6 send_seq=161 receive_seq=161 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000223  raspberry_pi: temp=48.7 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.43 cputime=3.565 memavail=1467260 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 349.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1350 bytes_read=10340 bytes_retransmit=18 bytes_invalid=6 send_seq=162 receive_seq=162 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000218  raspberry_pi: temp=49.7 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.43 cputime=3.576 memavail=1467260 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 350.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1356 bytes_read=10506 bytes_retransmit=18 bytes_invalid=6 send_seq=163 receive_seq=163 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000223  raspberry_pi: temp=49.2 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.55 cputime=3.586 memavail=1467260 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 351.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1362 bytes_read=10657 bytes_retransmit=18 bytes_invalid=6 send_seq=164 receive_seq=164 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000216  raspberry_pi: temp=48.7 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.55 cputime=3.596 memavail=1467260 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 352.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1368 bytes_read=10838 bytes_retransmit=18 bytes_invalid=6 send_seq=165 receive_seq=165 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000216  raspberry_pi: temp=49.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.55 cputime=3.612 memavail=1467036 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 353.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1374 bytes_read=11018 bytes_retransmit=18 bytes_invalid=6 send_seq=166 receive_seq=166 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000214  raspberry_pi: temp=50.6 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.55 cputime=3.630 memavail=1466812 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 354.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1380 bytes_read=11169 bytes_retransmit=18 bytes_invalid=6 send_seq=167 receive_seq=167 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000217  raspberry_pi: temp=49.7 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=1.55 cputime=3.647 memavail=1466056 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 355.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1386 bytes_read=11350 bytes_retransmit=18 bytes_invalid=6 send_seq=168 receive_seq=168 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000217  raspberry_pi: temp=48.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.51 cputime=3.665 memavail=1466060 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 356.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1392 bytes_read=11516 bytes_retransmit=18 bytes_invalid=6 send_seq=169 receive_seq=169 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000214  raspberry_pi: temp=48.7 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.51 cputime=3.682 memavail=1466060 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 357.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1398 bytes_read=11667 bytes_retransmit=18 bytes_invalid=6 send_seq=170 receive_seq=170 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000214  raspberry_pi: temp=48.7 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.51 cputime=3.699 memavail=1466060 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 358.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1404 bytes_read=11862 bytes_retransmit=18 bytes_invalid=6 send_seq=171 receive_seq=171 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000221  raspberry_pi: temp=49.2 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.51 cputime=3.718 memavail=1466060 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 359.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1410 bytes_read=12028 bytes_retransmit=18 bytes_invalid=6 send_seq=172 receive_seq=172 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000218  raspberry_pi: temp=49.7 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.51 cputime=3.735 memavail=1466060 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 360.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1416 bytes_read=12179 bytes_retransmit=18 bytes_invalid=6 send_seq=173 receive_seq=173 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000217  raspberry_pi: temp=48.2 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.39 cputime=3.753 memavail=1466060 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 361.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1422 bytes_read=12360 bytes_retransmit=18 bytes_invalid=6 send_seq=174 receive_seq=174 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000217  raspberry_pi: temp=49.7 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.39 cputime=3.771 memavail=1466060 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 362.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1428 bytes_read=12526 bytes_retransmit=18 bytes_invalid=6 send_seq=175 receive_seq=175 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000215  raspberry_pi: temp=49.2 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.39 cputime=3.785 memavail=1468824 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 363.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1434 bytes_read=12691 bytes_retransmit=18 bytes_invalid=6 send_seq=176 receive_seq=176 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000209  raspberry_pi: temp=49.2 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.39 cputime=3.795 memavail=1468368 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 364.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1440 bytes_read=12872 bytes_retransmit=18 bytes_invalid=6 send_seq=177 receive_seq=177 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000203  raspberry_pi: temp=50.1 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.39 cputime=3.807 memavail=1467560 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 365.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1446 bytes_read=13038 bytes_retransmit=18 bytes_invalid=6 send_seq=178 receive_seq=178 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000200  raspberry_pi: temp=48.7 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=1.36 cputime=3.817 memavail=1467644 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 366.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1452 bytes_read=13189 bytes_retransmit=18 bytes_invalid=6 send_seq=179 receive_seq=179 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000194  raspberry_pi: temp=49.7 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.36 cputime=3.827 memavail=1467644 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 367.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1458 bytes_read=13370 bytes_retransmit=18 bytes_invalid=6 send_seq=180 receive_seq=180 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000191  raspberry_pi: temp=48.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=1.36 cputime=3.844 memavail=1467644 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 368.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1464 bytes_read=13550 bytes_retransmit=18 bytes_invalid=6 send_seq=181 receive_seq=181 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000191  raspberry_pi: temp=49.7 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.36 cputime=3.862 memavail=1467644 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 369.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1470 bytes_read=13701 bytes_retransmit=18 bytes_invalid=6 send_seq=182 receive_seq=182 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000194  raspberry_pi: temp=50.1 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.36 cputime=3.879 memavail=1467392 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 370.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1476 bytes_read=13882 bytes_retransmit=18 bytes_invalid=6 send_seq=183 receive_seq=183 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000198  raspberry_pi: temp=50.1 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.49 cputime=3.896 memavail=1469192 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 371.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1482 bytes_read=14048 bytes_retransmit=18 bytes_invalid=6 send_seq=184 receive_seq=184 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000200  raspberry_pi: temp=48.2 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.49 cputime=3.914 memavail=1469204 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 372.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1488 bytes_read=14199 bytes_retransmit=18 bytes_invalid=6 send_seq=185 receive_seq=185 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000200  raspberry_pi: temp=50.1 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.49 cputime=3.931 memavail=1468964 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 373.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1494 bytes_read=14394 bytes_retransmit=18 bytes_invalid=6 send_seq=186 receive_seq=186 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000203  raspberry_pi: temp=49.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.49 cputime=3.949 memavail=1468964 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.6 pwm=0.000
Stats 374.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1500 bytes_read=14560 bytes_retransmit=18 bytes_invalid=6 send_seq=187 receive_seq=187 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000206  raspberry_pi: temp=49.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.49 cputime=3.968 memavail=1468712 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 375.8: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1512 bytes_read=14727 bytes_retransmit=18 bytes_invalid=6 send_seq=189 receive_seq=189 retransmit_seq=2 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000206  raspberry_pi: temp=47.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.45 cputime=3.985 memavail=1468724 print_time=400.284 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
webhooks client 547996431264: Disconnected
Starting Klippy...
Args: ['/home/coon/klipper/klippy/klippy.py', '/home/coon/printer_data/config/printer.cfg', '-l', '/home/coon/printer_data/logs/klippy.log', '-I', '/home/coon/printer_data/comms/klippy.serial', '-a', '/home/coon/printer_data/comms/klippy.sock']
Git version: 'v0.12.0-404-g80d185c94'
Branch: master
Remote: origin
Tracked URL: https://github.com/Klipper3d/klipper.git
CPU: 4 core ?
Python: '3.9.2 (default, Dec  1 2024, 12:12:57) \n[GCC 10.2.1 20210110]'
Start printer at Sun Dec 22 19:37:47 2024 (1734914267.7 21.2)
===== Config file =====
[virtual_sdcard]
path = ~/printer_data/gcodes
on_error_gcode = CANCEL_PRINT

[pause_resume]
recover_velocity = 25

[display_status]

[respond]
default_prefix = 

[gcode_macro CANCEL_PRINT]
description = Cancel the actual running print
rename_existing = BASE_CANCEL_PRINT
gcode = 
	G91
	G0 Z10 F600
	G90
	TURN_OFF_HEATERS
	G0 X5 Y220
	CLEAR_PAUSE
	
	BASE_CANCEL_PRINT

[gcode_macro PAUSE]
description = Pause the actual running print
rename_existing = PAUSE_BASE
gcode = 
	
	{% set x = params.X|default(5) %}
	{% set y = params.Y|default(225) %}
	{% set z = params.Z|default(10)|float %}
	{% set e = params.E|default(1) %}
	
	{% set max_z = printer.toolhead.axis_maximum.z|float %}
	{% set act_z = printer.toolhead.position.z|float %}
	{% set lift_z = z|abs %}
	{% if act_z < (max_z - lift_z) %}
	{% set z_safe = lift_z %}
	{% else %}
	{% set z_safe = max_z - act_z %}
	{% endif %}
	
	PAUSE_BASE
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E-{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	{% if "xyz" in printer.toolhead.homed_axes %}
	G1 Z{z_safe}
	G90
	G1 X{x} Y{y} F6000
	{% else %}
	{action_respond_info("Printer not homed")}
	{% endif %}

[gcode_macro RESUME]
description = Resume the actual running print
rename_existing = RESUME_BASE
variable_last_extruder_temp = {'restore': False, 'temp': 0}
variable_restore_idle_timeout = 0
variable_idle_state = False
gcode = 
	
	{% set e = params.E|default(1) %}
	
	{% if 'VELOCITY' in params|upper %}
	{% set get_params = ('VELOCITY=' + params.VELOCITY)  %}
	{%else %}
	{% set get_params = "" %}
	{% endif %}
	
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	RESUME_BASE {get_params}

[gcode_macro SET_PAUSE_NEXT_LAYER]
description = Enable a pause if the next layer is reached
gcode = 
	{% set pause_next_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_next_layer %}
	{% set ENABLE = params.ENABLE|default(1)|int != 0 %}
	{% set MACRO = params.MACRO|default(pause_next_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_next_layer VALUE="{{ 'enable': ENABLE, 'call': MACRO }}"

[gcode_macro SET_PAUSE_AT_LAYER]
description = Enable/disable a pause if a given layer number is reached
gcode = 
	{% set pause_at_layer = printer['gcode_macro SET_PRINT_STATS_INFO'].pause_at_layer %}
	{% set ENABLE = params.ENABLE|int != 0 if params.ENABLE is defined
	else params.LAYER is defined %}
	{% set LAYER = params.LAYER|default(pause_at_layer.layer)|int %}
	{% set MACRO = params.MACRO|default(pause_at_layer.call, True) %}
	SET_GCODE_VARIABLE MACRO=SET_PRINT_STATS_INFO VARIABLE=pause_at_layer VALUE="{{ 'enable': ENABLE, 'layer': LAYER, 'call': MACRO }}"

[gcode_macro SET_PRINT_STATS_INFO]
rename_existing = SET_PRINT_STATS_INFO_BASE
description = Overwrite, to get pause_next_layer and pause_at_layer feature
variable_pause_next_layer = { 'enable': False, 'call': "PAUSE" }
variable_pause_at_layer = { 'enable': False, 'layer': 0, 'call': "PAUSE" }
gcode = 
	{% if pause_next_layer.enable %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_next_layer" % pause_next_layer.call}'
	{pause_next_layer.call}
	SET_PAUSE_NEXT_LAYER ENABLE=0
	{% elif pause_at_layer.enable and params.CURRENT_LAYER is defined and params.CURRENT_LAYER|int == pause_at_layer.layer %}
	RESPOND TYPE=echo MSG='{"%s, forced by pause_at_layer [%d]" % (pause_at_layer.call, pause_at_layer.layer)}'
	{pause_at_layer.call}
	SET_PAUSE_AT_LAYER ENABLE=0
	{% endif %}
	SET_PRINT_STATS_INFO_BASE {rawparams}

[gcode_macro _TOOLHEAD_PARK_PAUSE_CANCEL]
description = Helper: park toolhead used in PAUSE and CANCEL_PRINT
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set velocity = printer.configfile.settings.pause_resume.recover_velocity %}
	{% set use_custom     = client.use_custom_pos|default(false)|lower == 'true' %}
	{% set custom_park_x  = client.custom_park_x|default(0.0) %}
	{% set custom_park_y  = client.custom_park_y|default(0.0) %}
	{% set park_dz        = client.custom_park_dz|default(2.0)|abs %}
	{% set sp_hop         = client.speed_hop|default(15) * 60 %}
	{% set sp_move        = client.speed_move|default(velocity) * 60 %}
	
	{% set origin    = printer.gcode_move.homing_origin %}
	{% set act       = printer.gcode_move.gcode_position %}
	{% set max       = printer.toolhead.axis_maximum %}
	{% set cone      = printer.toolhead.cone_start_z|default(max.z) %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	
	{% set z_min = params.Z_MIN|default(0)|float %}
	{% set z_park = [[(act.z + park_dz), z_min]|max, (max.z - origin.z)]|min %}
	{% set x_park = params.X       if params.X is defined
	else custom_park_x  if use_custom
	else 0.0            if round_bed
	else (max.x - 5.0) %}
	{% set y_park = params.Y       if params.Y is defined
	else custom_park_y  if use_custom
	else (max.y - 5.0)  if round_bed and z_park < cone
	else 0.0            if round_bed
	else (max.y - 5.0) %}
	
	_CLIENT_RETRACT
	{% if "xyz" in printer.toolhead.homed_axes %}
	G90
	G1 Z{z_park} F{sp_hop}
	G1 X{x_park} Y{y_park} F{sp_move}
	{% if not printer.gcode_move.absolute_coordinates %} G91 {% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='Printer not homed'
	{% endif %}

[gcode_macro _CLIENT_EXTRUDE]
description = Extrudes, if the extruder is hot enough
gcode = 
	
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set use_fw_retract = (client.use_fw_retract|default(false)|lower == 'true') and (printer.firmware_retraction is defined) %}
	{% set length = params.LENGTH|default(client.unretract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_unretract)|default(35) %}
	{% set absolute_extrude = printer.gcode_move.absolute_extrude %}
	
	{% if printer.toolhead.extruder != '' %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if use_fw_retract %}
	{% if length < 0 %}
	G10
	{% else %}
	G11
	{% endif %}
	{% else %}
	M83
	G1 E{length} F{(speed|float|abs) * 60}
	{% if absolute_extrude %}
	M82
	{% endif %}
	{% endif %}
	{% else %}
	RESPOND TYPE=echo MSG='{"\"%s\" not hot enough" % printer.toolhead.extruder}'
	{% endif %}
	{% endif %}

[gcode_macro _CLIENT_RETRACT]
description = Retracts, if the extruder is hot enough
gcode = 
	{% set client = printer['gcode_macro _CLIENT_VARIABLE']|default({}) %}
	{% set length = params.LENGTH|default(client.retract)|default(1.0)|float %}
	{% set speed = params.SPEED|default(client.speed_retract)|default(35) %}
	
	_CLIENT_EXTRUDE LENGTH=-{length|float|abs} SPEED={speed|float|abs}

[gcode_macro _CLIENT_LINEAR_MOVE]
description = Linear move with save and restore of the gcode state
gcode = 
	{% set x_move = "X" ~ params.X if params.X is defined else "" %}
	{% set y_move = "Y" ~ params.Y if params.Y is defined else "" %}
	{% set z_move = "Z" ~ params.Z if params.Z is defined else "" %}
	{% set e_move = "E" ~ params.E if params.E is defined else "" %}
	{% set rate = "F" ~ params.F if params.F is defined else "" %}
	{% set ABSOLUTE = params.ABSOLUTE | default(0) | int != 0 %}
	{% set ABSOLUTE_E = params.ABSOLUTE_E | default(0) | int != 0 %}
	SAVE_GCODE_STATE NAME=_client_movement
	{% if x_move or y_move or z_move %}
	G9{ 0 if ABSOLUTE else 1 }
	{% endif %}
	{% if e_move %}
	M8{ 2 if ABSOLUTE_E else 3 }
	{% endif %}
	G1 { x_move } { y_move } { z_move } { e_move } { rate }
	RESTORE_GCODE_STATE NAME=_client_movement

[gcode_macro play_test]
gcode = 
	RESPOND TYPE=command MSG="action:prompt_begin Question"
	RESPOND TYPE=command MSG="action:prompt_text Do you wont to cancel the print?"
	RESPOND TYPE=command MSG="action:prompt_footer_button continue|RESPOND TYPE=command MSG=action:prompt_end"
	RESPOND TYPE=command MSG="action:prompt_footer_button CANCEL|CANCEL_PRINT|error"
	RESPOND TYPE=command MSG="action:prompt_show"

[gcode_macro PRINT_START]
gcode = 
	START_PRINT {rawparams}

[gcode_macro START_PRINT]
gcode = 
	{% set BED_TEMP = params.BED_TEMP|default(60)|float %}
	{% set EXTRUDER_TEMP = params.EXTRUDER_TEMP|default(190)|float %}
	
	M190 S{BED_TEMP}
	
	G90
	
	G28
	
	RESPOND MSG="Bed Meshing"
	
	
	
	
	
	
	
	
	BED_MESH_CLEAR
	BED_MESH_CALIBRATE ADAPTIVE=1
	
	
	
	
	
	
	
	RESPOND MSG="Heating to print temp"
	M104 S{EXTRUDER_TEMP}
	G0 Z40 F240
	M109 S{EXTRUDER_TEMP}
	RESPOND MSG="Enable Runout Sensor"
	SFS_ENABLE
	RESPOND MSG="Line Purge"
	LINE_PURGE
	RESPOND MSG="Print Started"

[gcode_macro LINE_PURGE]
gcode = 
	G92 E0
	G1 Z2.0 F3000
	G1 X0.1 Y20 Z0.3 F5000.0
	G1 X0.1 Y200.0 Z0.3 F1500.0 E15
	G1 X0.4 Y200.0 Z0.3 F5000.0
	G1 X0.4 Y20 Z0.3 F1500.0 E30
	G92 E0
	G1 Z2.0 F3000
	G1 X5 Y20 Z0.3 F5000.0

[gcode_macro PRINT_END]
gcode = 
	END_PRINT

[gcode_macro END_PRINT]
gcode = 
	
	
	RESPOND MSG="Print Finished"
	G91
	G1 E-.5 Z0.2 F2400
	G1 X5 Y5 F6000
	G1 Z10
	G90
	SFS_DISABLE
	
	G1 X0 Y220 F6000
	M106 S0
	M104 S0
	M140 S0
	
	M84 X Y E

[gcode_macro SET_ACTIVE_SPOOL]
gcode = 
	{% if params.ID %}
	{% set id = params.ID|int %}
	{action_call_remote_method(
	"spoolman_set_active_spool",
	spool_id=id
	)}
	{% else %}
	{action_respond_info("Parameter 'ID' is required")}
	{% endif %}

[gcode_macro CLEAR_ACTIVE_SPOOL]
gcode = 
	{action_call_remote_method(
	"spoolman_set_active_spool",
	spool_id=None
	)}

[gcode_macro G29]
gcode = 
	G28
	BED_MESH_CALIBRATE
	G0 X0 Y0 Z10 F6000
	BED_MESH_PROFILE save=default

[gcode_macro M125]
gcode = 
	SAVE_GCODE_STATE NAME=parking
	M117 Parking toolhead
	G91
	G1 Z10 F600
	G90
	G1 X5 Y225 F4000
	RESTORE_GCODE_STATE NAME=parking

[gcode_macro Load_Filament]
gcode = 
	SAVE_GCODE_STATE NAME=loading_filament
	M117 Loading Filament
	M83
	G92 E0.0
	G91
	G1 E50 F200
	G92 E50
	RESTORE_GCODE_STATE NAME=loading_filament

[gcode_macro Unload_Filament]
gcode = 
	SAVE_GCODE_STATE NAME=unloading_filament
	M117 Unloading Filament
	G91
	G1 E5 F100
	G92 E0.0
	G1 E-50 F5000
	G92 E-50
	RESTORE_GCODE_STATE NAME=unloading_filament

[gcode_macro Filament_Change]
gcode = 
	
	SAVE_GCODE_STATE NAME=filament_change
	
	Unload_Filament
	
	RESPOND TYPE=command MSG="action:prompt_begin Question"
	RESPOND TYPE=command MSG="action:prompt_text Please insert new filament and confirm"
	RESPOND TYPE=command MSG="action:prompt_footer_button CONFIRM|Load_Filament|RESPOND TYPE=command MSG=action:prompt_end"
	RESPOND TYPE=command MSG="action:prompt_footer_button CANCEL|RESPOND TYPE=command MSG=action:prompt_end"
	RESPOND TYPE=command MSG="action:prompt_show"
	
	RESTORE_GCODE_STATE NAME=filament_change

[gcode_macro Calibrate_Hotend_PID]
gcode = 
	PID_CALIBRATE HEATER=extruder TARGET=200

[gcode_macro Calibrate_Bed_PID]
gcode = 
	PID_CALIBRATE HEATER=heater_bed TARGET=60

[gcode_macro Calibrate_Zoffset]
gcode = 
	PROBE_CALIBRATE

[gcode_macro Tram_bed]
gcode = 
	SCREWS_TILT_CALCULATE

[gcode_macro TEST_SPEED]
description = Test for max speed and acceleration parameters for the printer. Procedure: Home -> ReadPositionFromMCU -> MovesToolhead@Vel&Accel -> Home -> ReadPositionfromMCU
gcode = 
	
	{% set speed  = params.SPEED|default(printer.configfile.settings.printer.max_velocity)|int %}
	
	{% set iterations = params.ITERATIONS|default(5)|int %}
	
	{% set accel  = params.ACCEL|default(printer.configfile.settings.printer.max_accel)|int %}
	
	{% set min_cruise_ratio = params.MIN_CRUISE_RATIO|default(0.5)|float %}
	
	{% set bound = params.BOUND|default(20)|int %}
	
	{% set smallpatternsize = SMALLPATTERNSIZE|default(20)|int %}
	
	
	
	{% set x_min = printer.toolhead.axis_minimum.x + bound %}
	{% set x_max = printer.toolhead.axis_maximum.x - bound %}
	{% set y_min = printer.toolhead.axis_minimum.y + bound %}
	{% set y_max = printer.toolhead.axis_maximum.y - bound %}
	
	
	
	{% set x_center = (printer.toolhead.axis_minimum.x|float + printer.toolhead.axis_maximum.x|float ) / 2 %}
	{% set y_center = (printer.toolhead.axis_minimum.y|float + printer.toolhead.axis_maximum.y|float ) / 2 %}
	
	
	{% set x_center_min = x_center - (smallpatternsize/2) %}
	{% set x_center_max = x_center + (smallpatternsize/2) %}
	{% set y_center_min = y_center - (smallpatternsize/2) %}
	{% set y_center_max = y_center + (smallpatternsize/2) %}
	
	
	SAVE_GCODE_STATE NAME=TEST_SPEED
	
	
	{ action_respond_info("TEST_SPEED: starting %d iterations at speed %d, accel %d" % (iterations, speed, accel)) }
	
	
	M400
	G28
	
	{% if printer.configfile.settings.quad_gantry_level %}
	{% if printer.quad_gantry_level.applied == False %}
	QUAD_GANTRY_LEVEL
	G28 Z
	{% endif %}
	{% endif %}
	
	G90
	G1 X{printer.toolhead.axis_maximum.x-50} Y{printer.toolhead.axis_maximum.y-50} F{30*60}
	M400
	G28 X Y
	G0 X{printer.toolhead.axis_maximum.x-1} Y{printer.toolhead.axis_maximum.y-1} F{30*60}
	G4 P1000
	GET_POSITION
	
	
	G0 X{x_min} Y{y_min} Z{bound + 10} F{speed*60}
	
	
	{% if printer.configfile.settings.printer.minimum_cruise_ratio is defined %}
	SET_VELOCITY_LIMIT VELOCITY={speed} ACCEL={accel} MINIMUM_CRUISE_RATIO={min_cruise_ratio}
	{% else %}
	SET_VELOCITY_LIMIT VELOCITY={speed} ACCEL={accel} ACCEL_TO_DECEL={accel / 2}
	{% endif %}
	
	{% for i in range(iterations) %}
	
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_max} Y{y_max} F{speed*60}
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	G0 X{x_min} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	
	
	G0 X{x_min} Y{y_min} F{speed*60}
	G0 X{x_min} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_max} F{speed*60}
	G0 X{x_max} Y{y_min} F{speed*60}
	
	
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_max} Y{y_center_max} F{speed*60}
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	G0 X{x_center_min} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	
	
	G0 X{x_center_min} Y{y_center_min} F{speed*60}
	G0 X{x_center_min} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_max} F{speed*60}
	G0 X{x_center_max} Y{y_center_min} F{speed*60}
	{% endfor %}
	
	
	{% if printer.configfile.settings.printer.minimum_cruise_ratio is defined %}
	SET_VELOCITY_LIMIT VELOCITY={printer.configfile.settings.printer.max_velocity} ACCEL={printer.configfile.settings.printer.max_accel} MINIMUM_CRUISE_RATIO={printer.configfile.settings.printer.minimum_cruise_ratio}
	{% else %}
	SET_VELOCITY_LIMIT VELOCITY={printer.configfile.settings.printer.max_velocity} ACCEL={printer.configfile.settings.printer.max_accel} ACCEL_TO_DECEL={printer.configfile.settings.printer.max_accel_to_decel}
	{% endif %}
	
	
	M400
	G28
	
	G90
	G0 X{printer.toolhead.axis_maximum.x-1} Y{printer.toolhead.axis_maximum.y-1} F{30*60}
	G4 P1000
	GET_POSITION
	
	
	RESTORE_GCODE_STATE NAME=TEST_SPEED

[gcode_macro GET_TIMELAPSE_SETUP]
description = Print the Timelapse setup
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% set output_txt = ["Timelapse Setup:"] %}
	{% set _dummy = output_txt.append("enable: %s" % tl.enable) %}
	{% set _dummy = output_txt.append("park: %s" % tl.park.enable) %}
	{% if tl.park.enable %}
	{% set _dummy = output_txt.append("park position: %s time: %s s" % (tl.park.pos, tl.park.time)) %}
	{% set _dummy = output_txt.append("park cord x:%s y:%s dz:%s" % (tl.park.coord.x, tl.park.coord.y, tl.park.coord.dz)) %}
	{% set _dummy = output_txt.append("travel speed: %s mm/s" % tl.speed.travel) %}
	{% endif %}
	{% set _dummy = output_txt.append("fw_retract: %s" % tl.extruder.fw_retract) %}
	{% if not tl.extruder.fw_retract %}
	{% set _dummy = output_txt.append("retract: %s mm speed: %s mm/s" % (tl.extruder.retract, tl.speed.retract)) %}
	{% set _dummy = output_txt.append("extrude: %s mm speed: %s mm/s" % (tl.extruder.extrude, tl.speed.extrude)) %}
	{% endif %}
	{% set _dummy = output_txt.append("verbose: %s" % tl.verbose) %}
	{action_respond_info(output_txt|join("\n"))}

[gcode_macro _SET_TIMELAPSE_SETUP]
description = Set user parameters for timelapse
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	
	{% set min = printer.toolhead.axis_minimum %}
	{% set max = printer.toolhead.axis_maximum %}
	{% set round_bed = True if printer.configfile.settings.printer.kinematics is in ['delta','polar','rotary_delta','winch']
	else False %}
	{% set park = {'min'   : {'x': (min.x / 1.42)|round(3) if round_bed else min.x|round(3),
	'y': (min.y / 1.42)|round(3) if round_bed else min.y|round(3)},
	'max'   : {'x': (max.x / 1.42)|round(3) if round_bed else max.x|round(3),
	'y': (max.y / 1.42)|round(3) if round_bed else max.y|round(3)},
	'center': {'x': (max.x-(max.x-min.x)/2)|round(3),
	'y': (max.y-(max.y-min.y)/2)|round(3)}} %}
	
	{% if params.ENABLE %}
	{% if params.ENABLE|lower is in ['true', 'false'] %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=enable VALUE={True if params.ENABLE|lower == 'true' else False}
	{% else %}
	{action_raise_error("ENABLE=%s not supported. Allowed values are [True, False]" % params.ENABLE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.VERBOSE %}
	{% if params.VERBOSE|lower is in ['true', 'false'] %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=verbose VALUE={True if params.VERBOSE|lower == 'true' else False}
	{% else %}
	{action_raise_error("VERBOSE=%s not supported. Allowed values are [True, False]" % params.VERBOSE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_X %}
	{% if params.CUSTOM_POS_X|float >= min.x and params.CUSTOM_POS_X|float <= max.x %}
	{% set _dummy = tl.park.custom.update({'x':params.CUSTOM_POS_X|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_X=%s must be within [%s - %s]" % (params.CUSTOM_POS_X, min.x, max.x))}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_Y %}
	{% if params.CUSTOM_POS_Y|float >= min.y and params.CUSTOM_POS_Y|float <= max.y %}
	{% set _dummy = tl.park.custom.update({'y':params.CUSTOM_POS_Y|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_Y=%s must be within [%s - %s]" % (params.CUSTOM_POS_Y, min.y, max.y))}
	{% endif %}
	{% endif %}
	{% if params.CUSTOM_POS_DZ %}
	{% if params.CUSTOM_POS_DZ|float >= min.z and params.CUSTOM_POS_DZ|float <= max.z %}
	{% set _dummy = tl.park.custom.update({'dz':params.CUSTOM_POS_DZ|float|round(3)}) %}
	{% else %}
	{action_raise_error("CUSTOM_POS_DZ=%s must be within [%s - %s]" % (params.CUSTOM_POS_DZ, min.z, max.z))}
	{% endif %}
	{% endif %}
	{% if params.PARK_ENABLE %}
	{% if params.PARK_ENABLE|lower is in ['true', 'false'] %}
	{% set _dummy = tl.park.update({'enable':True if params.PARK_ENABLE|lower == 'true' else False}) %}
	{% else %}
	{action_raise_error("PARK_ENABLE=%s not supported. Allowed values are [True, False]" % params.PARK_ENABLE|capitalize)}
	{% endif %}
	{% endif %}
	{% if params.PARK_POS %}
	{% if params.PARK_POS|lower is in ['center','front_left','front_right','back_left','back_right','custom','x_only','y_only'] %}
	{% set dic = {'center'      : {'x': park.center.x   , 'y': park.center.y   , 'dz': 1                },
	'front_left'  : {'x': park.min.x      , 'y': park.min.y      , 'dz': 0                },
	'front_right' : {'x': park.max.x      , 'y': park.min.y      , 'dz': 0                },
	'back_left'   : {'x': park.min.x      , 'y': park.max.y      , 'dz': 0                },
	'back_right'  : {'x': park.max.x      , 'y': park.max.y      , 'dz': 0                },
	'custom'      : {'x': tl.park.custom.x, 'y': tl.park.custom.y, 'dz': tl.park.custom.dz},
	'x_only'      : {'x': tl.park.custom.x, 'y': 'none'          , 'dz': tl.park.custom.dz},
	'y_only'      : {'x': 'none'          , 'y': tl.park.custom.y, 'dz': tl.park.custom.dz}} %}
	{% set _dummy = tl.park.update({'pos':params.PARK_POS|lower}) %}
	{% set _dummy = tl.park.update({'coord':dic[tl.park.pos]}) %}
	{% else %}
	{action_raise_error("PARK_POS=%s not supported. Allowed values are [CENTER, FRONT_LEFT, FRONT_RIGHT, BACK_LEFT, BACK_RIGHT, CUSTOM, X_ONLY, Y_ONLY]"
	% params.PARK_POS|upper)}
	{% endif %}
	{% endif %}
	{% if params.PARK_TIME %}
	{% if params.PARK_TIME|float >= 0.0 %}
	{% set _dummy = tl.park.update({'time':params.PARK_TIME|float|round(3)}) %}
	{% else %}
	{action_raise_error("PARK_TIME=%s must be a positive number" % params.PARK_TIME)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=park VALUE="{tl.park}"
	{% if params.TRAVEL_SPEED %}
	{% if params.TRAVEL_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'travel':params.TRAVEL_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("TRAVEL_SPEED=%s must be larger than 0" % params.TRAVEL_SPEED)}
	{% endif %}
	{% endif %}
	{% if params.RETRACT_SPEED %}
	{% if params.RETRACT_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'retract':params.RETRACT_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("RETRACT_SPEED=%s must be larger than 0" % params.RETRACT_SPEED)}
	{% endif %}
	{% endif %}
	{% if params.EXTRUDE_SPEED %}
	{% if params.EXTRUDE_SPEED|float > 0.0 %}
	{% set _dummy = tl.speed.update({'extrude':params.EXTRUDE_SPEED|float|round(3)}) %}
	{% else %}
	{action_raise_error("EXTRUDE_SPEED=%s must be larger than 0" % params.EXTRUDE_SPEED)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=speed VALUE="{tl.speed}"
	{% if params.EXTRUDE_DISTANCE %}
	{% if params.EXTRUDE_DISTANCE|float >= 0.0 %}
	{% set _dummy = tl.extruder.update({'extrude':params.EXTRUDE_DISTANCE|float|round(3)}) %}
	{% else %}
	{action_raise_error("EXTRUDE_DISTANCE=%s must be specified as positiv number" % params.EXTRUDE_DISTANCE)}
	{% endif %}
	{% endif %}
	{% if params.RETRACT_DISTANCE %}
	{% if params.RETRACT_DISTANCE|float >= 0.0 %}
	{% set _dummy = tl.extruder.update({'retract':params.RETRACT_DISTANCE|float|round(3)}) %}
	{% else %}
	{action_raise_error("RETRACT_DISTANCE=%s must be specified as positiv number" % params.RETRACT_DISTANCE)}
	{% endif %}
	{% endif %}
	{% if params.FW_RETRACT %}
	{% if params.FW_RETRACT|lower is in ['true', 'false'] %}
	{% if 'firmware_retraction' in printer.configfile.settings %}
	{% set _dummy = tl.extruder.update({'fw_retract': True if params.FW_RETRACT|lower == 'true' else False}) %}
	{% else %}
	{% set _dummy = tl.extruder.update({'fw_retract':False}) %}
	{% if params.FW_RETRACT|capitalize == 'True' %}
	{action_raise_error("[firmware_retraction] not defined in printer.cfg. Can not enable fw_retract")}
	{% endif %}
	{% endif %}
	{% else %}
	{action_raise_error("FW_RETRACT=%s not supported. Allowed values are [True, False]" % params.FW_RETRACT|capitalize)}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=extruder VALUE="{tl.extruder}"
	{% if printer.configfile.settings['gcode_macro pause'] is defined %}
	{% set _dummy = tl.macro.update({'pause': printer.configfile.settings['gcode_macro pause'].rename_existing}) %}
	{% endif %}
	{% if printer.configfile.settings['gcode_macro resume'] is defined %}
	{% set _dummy = tl.macro.update({'resume': printer.configfile.settings['gcode_macro resume'].rename_existing}) %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=macro VALUE="{tl.macro}"

[gcode_macro TIMELAPSE_TAKE_FRAME]
description = Take Timelapse shoot
variable_enable = False
variable_takingframe = False
variable_park = {'enable': False,
	'pos'   : 'center',
	'time'  : 0.1,
	'custom': {'x': 0, 'y': 0, 'dz': 0},
	'coord' : {'x': 0, 'y': 0, 'dz': 0}}
variable_extruder = {'fw_retract': False,
	'retract': 1.0,
	'extrude': 1.0}
variable_speed = {'travel': 100,
	'retract': 15,
	'extrude': 15}
variable_verbose = True
variable_check_time = 0.5
variable_restore = {'absolute': {'coordinates': True, 'extrude': True}, 'speed': 1500, 'e':0, 'factor': {'speed': 1.0, 'extrude': 1.0}}
variable_macro = {'pause': 'PAUSE', 'resume': 'RESUME'}
variable_is_paused = False
gcode = 
	{% set hyperlapse = True if params.HYPERLAPSE and params.HYPERLAPSE|lower =='true' else False %}
	{% if enable %}
	{% if (hyperlapse and printer['gcode_macro HYPERLAPSE'].run) or
	(not hyperlapse and not printer['gcode_macro HYPERLAPSE'].run) %}
	{% if park.enable %}
	{% set pos = {'x': 'X' + park.coord.x|string if park.pos != 'y_only' else '',
	'y': 'Y' + park.coord.y|string if park.pos != 'x_only' else '',
	'z': 'Z'+ [printer.gcode_move.gcode_position.z + park.coord.dz, printer.toolhead.axis_maximum.z]|min|string} %}
	{% set restore = {'absolute': {'coordinates': printer.gcode_move.absolute_coordinates,
	'extrude'    : printer.gcode_move.absolute_extrude},
	'speed'   : printer.gcode_move.speed,
	'e'       : printer.gcode_move.gcode_position.e,
	'factor'  : {'speed'  : printer.gcode_move.speed_factor,
	'extrude': printer.gcode_move.extrude_factor}} %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=restore VALUE="{restore}"
	{% if not printer[printer.toolhead.extruder].can_extrude %}
	{% if verbose %}{action_respond_info("Timelapse: Warning, minimum extruder temperature not reached!")}{% endif %}
	{% else %}
	{% if extruder.fw_retract %}
	G10
	{% else %}
	M83
	G0 E-{extruder.retract} F{speed.retract * 60}
	{% endif %}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=is_paused VALUE=True
	{macro.pause}
	SET_GCODE_OFFSET X=0 Y=0
	G90
	{% if "xyz" not in printer.toolhead.homed_axes %}
	{% if verbose %}{action_respond_info("Timelapse: Warning, axis not homed yet!")}{% endif %}
	{% else %}
	G0 {pos.x} {pos.y} {pos.z} F{speed.travel * 60}
	{% endif %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=takingframe VALUE=True
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_TAKE_FRAME DURATION={check_time}
	M400
	{% endif %}
	_TIMELAPSE_NEW_FRAME HYPERLAPSE={hyperlapse}
	{% endif %}
	{% else %}
	{% if verbose %}{action_respond_info("Timelapse: disabled, take frame ignored")}{% endif %}
	{% endif %}

[gcode_macro _TIMELAPSE_NEW_FRAME]
description = action call for timelapse shoot. must be a seperate macro
gcode = 
	{action_call_remote_method("timelapse_newframe",
	macropark=printer['gcode_macro TIMELAPSE_TAKE_FRAME'].park,
	hyperlapse=params.HYPERLAPSE)}

[delayed_gcode _WAIT_TIMELAPSE_TAKE_FRAME]
gcode = 
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% set factor = {'speed': printer.gcode_move.speed_factor, 'extrude': printer.gcode_move.extrude_factor} %}
	{% if tl.takingframe %}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_TAKE_FRAME DURATION={tl.check_time}
	{% else %}
	{tl.macro.resume} VELOCITY={tl.speed.travel}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_TAKE_FRAME VARIABLE=is_paused VALUE=False
	{% if not printer[printer.toolhead.extruder].can_extrude %}
	{action_respond_info("Timelapse: Warning minimum extruder temperature not reached!")}
	{% else %}
	{% if tl.extruder.fw_retract %}
	G11
	{% else %}
	G0 E{tl.extruder.extrude} F{tl.speed.extrude * 60}
	G0 F{tl.restore.speed}
	{% if tl.restore.absolute.extrude %}
	M82
	G92 E{tl.restore.e}
	{% endif %}
	{% endif %}
	{% endif %}
	{% if tl.restore.factor.speed   != factor.speed   %} M220 S{(factor.speed*100)|round(0)}   {% endif %}
	{% if tl.restore.factor.extrude != factor.extrude %} M221 S{(factor.extrude*100)|round(0)} {% endif %}
	{% if not tl.restore.absolute.coordinates %} G91 {% endif %}
	{% endif %}

[gcode_macro HYPERLAPSE]
description = Start/Stop a hyperlapse recording
variable_cycle = 0
variable_run = False
gcode = 
	{% set cycle = params.CYCLE|default(30)|int %}
	{% if params.ACTION and params.ACTION|lower == 'start' %}
	{action_respond_info("Hyperlapse: frames started (Cycle %d sec)" % cycle)}
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=run VALUE=True
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=cycle VALUE={cycle}
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION={cycle}
	TIMELAPSE_TAKE_FRAME HYPERLAPSE=True
	{% elif params.ACTION and params.ACTION|lower == 'stop' %}
	{% if run %}{action_respond_info("Hyperlapse: frames stopped")}{% endif %}
	SET_GCODE_VARIABLE MACRO=HYPERLAPSE VARIABLE=run VALUE=False
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION=0
	{% else %}
	{action_raise_error("Hyperlapse: No valid input parameter
	Use:
	- HYPERLAPSE ACTION=START [CYCLE=time]
	- HYPERLAPSE ACTION=STOP")}
	{% endif %}

[delayed_gcode _HYPERLAPSE_LOOP]
gcode = 
	UPDATE_DELAYED_GCODE ID=_HYPERLAPSE_LOOP DURATION={printer["gcode_macro HYPERLAPSE"].cycle}
	TIMELAPSE_TAKE_FRAME HYPERLAPSE=True

[gcode_macro TIMELAPSE_RENDER]
description = Render Timelapse video and wait for the result
variable_render = False
variable_run_identifier = 0
gcode = 
	{action_respond_info("Timelapse: Rendering started")}
	{action_call_remote_method("timelapse_render", byrendermacro="True")}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_RENDER VARIABLE=render VALUE=True
	{printer.configfile.settings['gcode_macro pause'].rename_existing}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_RENDER DURATION=0.5

[delayed_gcode _WAIT_TIMELAPSE_RENDER]
gcode = 
	{% set ri = printer['gcode_macro TIMELAPSE_RENDER'].run_identifier % 4 %}
	SET_GCODE_VARIABLE MACRO=TIMELAPSE_RENDER VARIABLE=run_identifier VALUE={ri + 1}
	{% if printer['gcode_macro TIMELAPSE_RENDER'].render %}
	M117 Rendering {['-','\\','|','/'][ri]}
	UPDATE_DELAYED_GCODE ID=_WAIT_TIMELAPSE_RENDER DURATION=0.5
	{% else %}
	{action_respond_info("Timelapse: Rendering finished")}
	M117
	{printer.configfile.settings['gcode_macro resume'].rename_existing}
	{% endif %}

[gcode_macro TEST_STREAM_DELAY]
description = Helper macro to find stream and park delay
gcode = 
	{% set min = printer.toolhead.axis_minimum %}
	{% set max = printer.toolhead.axis_maximum %}
	{% set act = printer.toolhead.position %}
	{% set tl = printer['gcode_macro TIMELAPSE_TAKE_FRAME'] %}
	{% if act.z > 5.0 %}
	G0 X{min.x + 5.0} F{tl.speed.travel|int * 60}
	G0 X{(max.x-min.x)/2}
	G4 P{tl.park.time|float * 1000}
	_TIMELAPSE_NEW_FRAME HYPERLAPSE=FALSE
	G0 X{max.x - 5.0}
	{% else %}
	{action_raise_error("Toolhead z %.3f to low. Please place head above z = 5.0" % act.z)}
	{% endif %}

[gcode_macro _OBICO_LAYER_CHANGE]
description = Run a scan across the current print area
variable_first_layer_scan_retract_length = 6
variable_first_layer_scan_retract_speed = 15
variable_first_layer_scan_cooldown_temp = 170
variable_first_layer_scan_resume_speed = 50
variable_first_layer_scan_enabled = True
variable_first_layer_scan_stepover = 10
variable_first_layer_scan_speed = 10
variable_first_layer_scan_zhop = 4
variable_first_layer_scan_zhop_speed = 15
variable_verbose = False
variable_current_layer = -1
variable_first_layer_scanning = False
variable_wait = {'resume': "RESUME", 'absolute_coordinates': True, 'absolute_extrude': True, 'e': 0.0, 'previous_temp': 0}
gcode = 
	
	{% set pause_macro  = "PAUSE"  if printer.configfile.settings['gcode_macro pause']  is not defined
	else printer.configfile.settings['gcode_macro pause'].rename_existing %}
	{% set resume_macro = "RESUME" if printer.configfile.settings['gcode_macro resume'] is not defined
	else printer.configfile.settings['gcode_macro resume'].rename_existing %}
	
	{% set current_layer_default = printer.print_stats.info.current_layer if printer.print_stats.info.current_layer is not none else -1 %}
	{% set current_layer = params.CURRENT_LAYER|default(current_layer_default)|int %}
	
	{% set polygon_points = printer.exclude_object.objects|map(attribute='polygon')|sum(start=[]) if printer.exclude_object is defined else [] %}
	{% set min_x = params.MINX|default(polygon_points|map(attribute=0)|min|default(printer.toolhead.axis_minimum.x))|float %}
	{% set min_y = params.MINY|default(polygon_points|map(attribute=1)|min|default(printer.toolhead.axis_minimum.y))|float %}
	{% set max_x = params.MAXX|default(polygon_points|map(attribute=0)|max|default(printer.toolhead.axis_maximum.x))|float %}
	{% set max_y = params.MAXY|default(polygon_points|map(attribute=1)|max|default(printer.toolhead.axis_maximum.y))|float %}
	
	{% set stepoverCount = ((max_y - min_y) / first_layer_scan_stepover|float)|round(method='ceil')|int %}
	
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Layer %d" % (current_layer)}' {% endif %}
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=current_layer VALUE={current_layer}
	
	{% if first_layer_scan_enabled and current_layer == 2 %}
	
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=first_layer_scanning VALUE=True
	
	
	{% set wait_dic = {'resume'              : resume_macro,
	'absolute_coordinates': printer.gcode_move.absolute_coordinates,
	'absolute_extrude'    : printer.gcode_move.absolute_extrude,
	'e'                   : printer.gcode_move.gcode_position.e,
	'previous_temp'       : printer.extruder.target} %}
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=wait VALUE="{wait_dic}"
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Prepare scanning" {% endif %}
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Scan Coordinates: Min:[%.3f:%.3f] Max:[%.3f:%.3f]" % (min_x,min_y,max_x,max_y)}' {% endif %}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Retract %.1fmm filament" % first_layer_scan_retract_length|abs}' {% endif %}
	M83
	G0 E-{first_layer_scan_retract_length|abs} F{first_layer_scan_retract_speed|float * 60}
	{% endif %}
	G91
	G0 Z{first_layer_scan_zhop|abs} F{first_layer_scan_zhop_speed|float * 60}
	
	
	M106 S255
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Fan on and lowering temperature to %.1f" % first_layer_scan_cooldown_temp}' {% endif %}
	M104 S{first_layer_scan_cooldown_temp}
	M109 S{first_layer_scan_cooldown_temp}
	
	{pause_macro}
	
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Start scanning" {% endif %}
	
	UPDATE_DELAYED_GCODE ID=_WAIT_OBICO_LAYER_CHANGE DURATION=1.0
	G90
	G0 X{min_x} Y{min_y} F{first_layer_scan_resume_speed|float * 60}
	{% for ystep in range(stepoverCount) %}
	G0 Y{min_y + first_layer_scan_stepover|float * ystep} F{first_layer_scan_speed|float * 60}
	G0 X{max_x if ystep % 2 == 0 else min_x}              F{first_layer_scan_speed|float * 60}
	{% endfor %}
	
	{% if verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Finish scanning" {% endif %}
	
	SET_GCODE_VARIABLE MACRO=_OBICO_LAYER_CHANGE VARIABLE=first_layer_scanning VALUE=False
	
	{% endif %}

[delayed_gcode _WAIT_OBICO_LAYER_CHANGE]
gcode = 
	{% set lc_macro = printer['gcode_macro _OBICO_LAYER_CHANGE'] %}
	{% if lc_macro.first_layer_scanning %}
	
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Waiting for first layer scan..." {% endif %}
	UPDATE_DELAYED_GCODE ID=_WAIT_OBICO_LAYER_CHANGE DURATION=1.0
	{% else %}
	
	M107
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG="Fan off and resume print" {% endif %}
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Call %s VELOCITY=%.1f" % (lc_macro.wait.resume, lc_macro.first_layer_scan_resume_speed)}' {% endif %}
	{lc_macro.wait.resume} VELOCITY={lc_macro.first_layer_scan_resume_speed}
	G91
	G0 Z-{lc_macro.first_layer_scan_zhop|abs} F{lc_macro.first_layer_scan_zhop_speed|float * 60}
	{% if printer[printer.toolhead.extruder].can_extrude %}
	{% set first_layer_scan_unretract_length = lc_macro.first_layer_scan_retract_length + 0.5 %}
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Extrude %.1fmm filament" % first_layer_scan_unretract_length|abs}' {% endif %}
	M83
	G0 E{first_layer_scan_unretract_length|abs} F{lc_macro.first_layer_scan_retract_speed|float * 60}
	{% endif %}
	
	
	M104 S{lc_macro.wait.previous_temp}
	M109 S{lc_macro.wait.previous_temp}
	{% if lc_macro.verbose %} RESPOND PREFIX='OBICO DEBUG:' MSG='{"Heating back up to previous temperature"}' {% endif %}
	
	
	{% if lc_macro.wait.absolute_coordinates %} G90 {% endif %}
	{% if lc_macro.wait.absolute_extrude %}
	M82
	G92 E{lc_macro.wait.e}
	{% endif %}
	{% endif %}

[gcode_macro OBICO_LINK_STATUS]
description = Link to Obico server
variable_one_time_passcode = ''
variable_one_time_passlink = ''
variable_is_linked = False
gcode = 
	{action_respond_info('Obico one_time_passcode: {}'.format(one_time_passcode))}
	{action_respond_info('Obico one_time_passlink: {}'.format(one_time_passlink))}
	{action_respond_info('Obico is_linked: {}'.format(is_linked))}
	{% if not is_linked and one_time_passcode != '' %}
	M117 Code: {one_time_passcode}
	{% else %}
	M117 Obico linked
	{% endif %}

[gcode_macro _OBICO_RELINK]
description = Re-link to Obico server
gcode = 
	{action_respond_info('WARNING: Re-link to Obico server')}
	{action_call_remote_method("obico_remote_event", event_name='relink_obico', message='')}
	{action_respond_info('WARNING: relink_obico requested')}

[exclude_object]

[mcu]
serial = /dev/serial/by-id/usb-1a86_USB_Serial-if00-port0
restart_method = command

[temperature_sensor raspberry_pi]
sensor_type = temperature_host
min_temp = 10
max_temp = 100

[temperature_sensor mcu_temp]
sensor_type = temperature_mcu
min_temp = 0
max_temp = 100

[printer]
kinematics = cartesian
max_velocity = 200
max_accel = 4000
max_z_velocity = 10
max_z_accel = 100
minimum_cruise_ratio = 0.5
square_corner_velocity = 5

[stepper_x]
step_pin = PB9
dir_pin = PC2
enable_pin = !PC3
microsteps = 16
rotation_distance = 40
endstop_pin = ^PA5
position_endstop = 0
position_max = 230
homing_speed = 50

[stepper_y]
step_pin = PB7
dir_pin = PB8
enable_pin = !PC3
microsteps = 16
rotation_distance = 40
endstop_pin = ^PA6
position_endstop = 0
position_max = 231
homing_speed = 50

[stepper_z]
step_pin = PB5
dir_pin = !PB6
enable_pin = !PC3
microsteps = 16
rotation_distance = 8
endstop_pin = probe:z_virtual_endstop
position_max = 250
position_min = -4
homing_speed = 4
second_homing_speed = 1
homing_retract_dist = 2.0

[fan]
pin = PA0

[extruder]
max_extrude_only_distance = 100.0
step_pin = PB3
dir_pin = PB4
enable_pin = !PC3
microsteps = 16
gear_ratio = 42:12
rotation_distance = 26.359
nozzle_diameter = 0.400
filament_diameter = 1.750
heater_pin = PA1
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PC5
min_temp = 0
max_temp = 300
min_extrude_temp = 170
pressure_advance = .0369
pressure_advance_smooth_time = 0.04
control = pid
pid_kp = 19.195
pid_ki = 1.000
pid_kd = 92.135

[firmware_retraction]
retract_length = 0.3
retract_speed = 20

[idle_timeout]
gcode = 
	{% if printer.pause_resume.is_paused %}
	M118 Idle timeout while paused, turning off hotend
	SET_HEATER_TEMPERATURE HEATER=extruder TARGET=0
	{% else %}
	M118 Idle timeout
	TURN_OFF_HEATERS
	M84
	{% endif %}
timeout = 1800

[heater_bed]
heater_pin = PA2
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PC4
min_temp = 0
max_temp = 130
control = pid
pid_kp = 68.601
pid_ki = 1.185
pid_kd = 993.000

[bltouch]
sensor_pin = ^PB1
control_pin = PB0
x_offset = -31.8
y_offset = -40.5
speed = 35
samples = 2
samples_result = median
samples_tolerance = 0.05
samples_tolerance_retries = 2
sample_retract_dist = 5.0
probe_with_touch_mode = true
stow_on_each_sample = false
z_offset = 2.049

[safe_z_home]
home_xy_position = 147, 154
speed = 75
z_hop = 10
z_hop_speed = 5
move_to_previous = false

[bed_screws]
screw1 = 30,51
screw1_name = "FL"
screw2 = 200,51
screw2_name = "FR"
screw3 = 200,195
screw3_name = "RR"
screw4 = 30,195
screw4_name = "RL"

[screws_tilt_adjust]
screw1 = 67, 67
screw1_name = front left screw
screw2 = 230, 67
screw2_name = front right screw
screw3 = 230, 230
screw3_name = rear right screw
screw4 = 67.60, 230
screw4_name = rear left screw
horizontal_move_z = 10
speed = 200
screw_thread = CW-M4

[bed_mesh]
speed = 120
mesh_min = 10,11
mesh_max = 195,182
probe_count = 3,3
algorithm = bicubic
fade_start = 1
fade_end = 10
fade_target = 0

[filament_motion_sensor SFS_T0]
detection_length = 150.00
extruder = extruder
switch_pin = PA4
pause_on_runout = True
event_delay = 3.0
pause_delay = 0.5
runout_gcode = 
	M117 Runout Detected!

[delayed_gcode DISABLEFILAMENTSENSOR]
initial_duration = 1
gcode = 
	SET_FILAMENT_SENSOR SENSOR=SFS_T0 ENABLE=0

[gcode_macro SFS_ENABLE]
description = Enable smart filament sensor
gcode = 
	M117 ENABLING the Smart Filament Sensor
	G92 E0
	SET_FILAMENT_SENSOR SENSOR=SFS_T0 ENABLE=1

[gcode_macro SFS_DISABLE]
description = Disable smart filament sensor
gcode = 
	M117 DISABLING the Smart Filament Sensor
	G92 E0
	SET_FILAMENT_SENSOR SENSOR=SFS_T0 ENABLE=0

[gcode_macro FILAMENT_RUNOUT]
gcode = 
	M117 Runout Detected!
	M300 S1 P10
	M600
	M300 S1 P10

[gcode_macro M300]
gcode = 
	{% set S = params.S|default(1000)|int %}
	{% set P = params.P|default(100)|int %}
	SET_PIN PIN=BEEPER VALUE=0.5 CYCLE_TIME={ 1.0/S if S > 0 else 1 }
	G4 P{P}
	SET_PIN PIN=BEEPER VALUE=0
	[gcode_macro M600]
	gcode:
	{% set X = params.X|default(25)|float %}
	{% set Y = params.Y|default(25)|float %}
	{% set Z = params.Z|default(10)|float %}
	SAVE_GCODE_STATE NAME=M600_state
	PAUSE
	G91
	G1 E-.8 F2700
	G1 Z{Z}
	G90
	G1 X{X} Y{Y} F3000
	G91
	G1 E-15 F1000
	RESTORE_GCODE_STATE NAME=M600_state

[gcode_arcs]
resolution = 1.0

[input_shaper]
shaper_freq_x = 73.5
shaper_type_x = ei
shaper_freq_y = 76.9
shaper_type_y = mzv
=======================
bed_mesh: bicubic interpolation with a probe_count of less than 4 points detected.  Forcing lagrange interpolation. Configured Probe Count: 3, 3
Extruder max_extrude_ratio=0.266081
mcu 'mcu': Starting serial connect
mcu 'mcu': got {'oid': 10, 'next_clock': 2594094336, 'value': 14004, '#name': 'analog_in_state', '#sent_time': 23.312744189, '#receive_time': 23.326715041}
mcu 'mcu': got {'oid': 12, 'next_clock': 2595534336, 'value': 31548, '#name': 'analog_in_state', '#sent_time': 23.312744189, '#receive_time': 23.346641819000002}
mcu 'mcu': got {'oid': 17, 'next_clock': 2599134336, 'value': 31498, '#name': 'analog_in_state', '#sent_time': 23.367029986000002, '#receive_time': 23.396613041000002}
Loaded MCU 'mcu' 119 commands (v0.12.0-286-g81de9a861 / gcc: (15:8-2019-q3-1+b1) 8.3.1 20190703 (release) [gcc-8-branch revision 273027] binutils: (2.35.2-2+14+b2) 2.35.2)
MCU 'mcu' config: ADC_MAX=4095 BUS_PINS_i2c1=PB6,PB7 BUS_PINS_i2c1a=PB8,PB9 BUS_PINS_i2c2=PB10,PB11 BUS_PINS_spi1=PA6,PA7,PA5 BUS_PINS_spi1a=PB4,PB5,PB3 BUS_PINS_spi2=PB14,PB15,PB13 BUS_PINS_spi3=PB4,PB5,PB3 CLOCK_FREQ=72000000 MCU=stm32f103xe PWM_MAX=255 RECEIVE_WINDOW=192 RESERVE_PINS_serial=PA10,PA9 SERIAL_BAUD=250000 STATS_SUMSQ_BASE=256 STEPPER_BOTH_EDGE=1
mcu_temperature 'mcu' nominal base=357.558140 slope=-767.441860
Configured MCU 'mcu' (1024 moves)
Starting heater checks for heater_bed
webhooks client 547695212816: New connection
bed_mesh: generated points
Index |  Tool Adjusted  |   Probe
  0   | (41.8, 51.5)    | (10.0, 11.0)
  1   | (134.3, 51.5)   | (102.5, 11.0)
  2   | (226.8, 51.5)   | (195.0, 11.0)
  3   | (226.8, 137.0)  | (195.0, 96.5)
  4   | (134.3, 137.0)  | (102.5, 96.5)
  5   | (41.8, 137.0)   | (10.0, 96.5)
  6   | (41.8, 222.5)   | (10.0, 182.0)
  7   | (134.3, 222.5)  | (102.5, 182.0)
  8   | (226.8, 222.5)  | (195.0, 182.0)
Starting heater checks for extruder
Stats 24.6: gcodein=0  mcu: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=1146 bytes_read=4619 bytes_retransmit=0 bytes_invalid=0 send_seq=128 receive_seq=128 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72001017  raspberry_pi: temp=53.1 mcu_temp: temp=0.0 heater_bed: target=0 temp=0.0 pwm=0.000 sysload=1.46 cputime=1.879 memavail=1512136 print_time=574.150 buffer_time=0.249 print_stall=0 extruder: target=0 temp=0.0 pwm=0.000
webhooks client 547695212816: Client info {'program': 'Moonraker', 'version': 'v0.9.3-3-gccfe32f'}
webhooks: registering remote method 'shutdown_machine' for connection id: 547695212816
webhooks: registering remote method 'reboot_machine' for connection id: 547695212816
webhooks: registering remote method 'pause_job_queue' for connection id: 547695212816
webhooks: registering remote method 'start_job_queue' for connection id: 547695212816
webhooks: registering remote method 'spoolman_set_active_spool' for connection id: 547695212816
Stats 25.6: gcodein=0  mcu: mcu_awake=0.006 mcu_task_avg=0.000028 mcu_task_stddev=0.000013 bytes_write=1152 bytes_read=4785 bytes_retransmit=0 bytes_invalid=0 send_seq=129 receive_seq=129 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72001705  raspberry_pi: temp=53.6 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.50 cputime=1.908 memavail=1511036 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 26.6: gcodein=0  mcu: mcu_awake=0.006 mcu_task_avg=0.000028 mcu_task_stddev=0.000013 bytes_write=1158 bytes_read=4936 bytes_retransmit=0 bytes_invalid=0 send_seq=130 receive_seq=130 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72001059  raspberry_pi: temp=52.6 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.50 cputime=1.948 memavail=1502896 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 27.6: gcodein=0  mcu: mcu_awake=0.006 mcu_task_avg=0.000028 mcu_task_stddev=0.000013 bytes_write=1164 bytes_read=5132 bytes_retransmit=0 bytes_invalid=0 send_seq=131 receive_seq=131 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000404  raspberry_pi: temp=52.1 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.50 cputime=1.962 memavail=1502248 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
webhooks: registering remote method 'obico_remote_event' for connection id: 547695212816
Stats 28.6: gcodein=0  mcu: mcu_awake=0.006 mcu_task_avg=0.000028 mcu_task_stddev=0.000013 bytes_write=1170 bytes_read=5283 bytes_retransmit=0 bytes_invalid=0 send_seq=132 receive_seq=132 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000542  raspberry_pi: temp=52.1 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.50 cputime=1.981 memavail=1499148 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 29.6: gcodein=0  mcu: mcu_awake=0.006 mcu_task_avg=0.000028 mcu_task_stddev=0.000013 bytes_write=1176 bytes_read=5434 bytes_retransmit=0 bytes_invalid=0 send_seq=133 receive_seq=133 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000416  raspberry_pi: temp=51.6 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=1.50 cputime=1.996 memavail=1498672 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 30.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1182 bytes_read=5644 bytes_retransmit=0 bytes_invalid=0 send_seq=134 receive_seq=134 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000259  raspberry_pi: temp=51.1 mcu_temp: temp=29.4 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=1.62 cputime=2.009 memavail=1495264 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 31.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1188 bytes_read=5795 bytes_retransmit=0 bytes_invalid=0 send_seq=135 receive_seq=135 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000191  raspberry_pi: temp=52.1 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.62 cputime=2.020 memavail=1493356 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 32.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1194 bytes_read=5946 bytes_retransmit=0 bytes_invalid=0 send_seq=136 receive_seq=136 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000153  raspberry_pi: temp=50.6 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=1.62 cputime=2.031 memavail=1482792 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 33.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1200 bytes_read=6142 bytes_retransmit=0 bytes_invalid=0 send_seq=137 receive_seq=137 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000186  raspberry_pi: temp=51.1 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.62 cputime=2.043 memavail=1482792 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 34.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1206 bytes_read=6293 bytes_retransmit=0 bytes_invalid=0 send_seq=138 receive_seq=138 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000157  raspberry_pi: temp=52.1 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.62 cputime=2.054 memavail=1482052 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 35.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1212 bytes_read=6458 bytes_retransmit=0 bytes_invalid=0 send_seq=139 receive_seq=139 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000181  raspberry_pi: temp=51.6 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.82 cputime=2.071 memavail=1484808 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 36.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1218 bytes_read=6654 bytes_retransmit=0 bytes_invalid=0 send_seq=140 receive_seq=140 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000186  raspberry_pi: temp=51.1 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.82 cputime=2.089 memavail=1484560 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 37.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1224 bytes_read=6805 bytes_retransmit=0 bytes_invalid=0 send_seq=141 receive_seq=141 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000265  raspberry_pi: temp=49.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.82 cputime=2.105 memavail=1483836 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 38.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1230 bytes_read=6971 bytes_retransmit=0 bytes_invalid=0 send_seq=142 receive_seq=142 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000277  raspberry_pi: temp=51.6 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.82 cputime=2.124 memavail=1483836 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 39.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1236 bytes_read=7152 bytes_retransmit=0 bytes_invalid=0 send_seq=143 receive_seq=143 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000269  raspberry_pi: temp=51.1 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.82 cputime=2.143 memavail=1483596 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 40.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1242 bytes_read=7317 bytes_retransmit=0 bytes_invalid=0 send_seq=144 receive_seq=144 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000331  raspberry_pi: temp=51.1 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=1.99 cputime=2.161 memavail=1483120 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 41.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1248 bytes_read=7483 bytes_retransmit=0 bytes_invalid=0 send_seq=145 receive_seq=145 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000315  raspberry_pi: temp=50.1 mcu_temp: temp=29.4 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.99 cputime=2.179 memavail=1483132 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 42.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1254 bytes_read=7664 bytes_retransmit=0 bytes_invalid=0 send_seq=146 receive_seq=146 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000295  raspberry_pi: temp=49.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.99 cputime=2.197 memavail=1483132 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 43.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1260 bytes_read=7815 bytes_retransmit=0 bytes_invalid=0 send_seq=147 receive_seq=147 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000320  raspberry_pi: temp=49.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.99 cputime=2.213 memavail=1483132 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 44.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1266 bytes_read=7981 bytes_retransmit=0 bytes_invalid=0 send_seq=148 receive_seq=148 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000303  raspberry_pi: temp=50.1 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.99 cputime=2.231 memavail=1485944 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 45.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1272 bytes_read=8176 bytes_retransmit=0 bytes_invalid=0 send_seq=149 receive_seq=149 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000281  raspberry_pi: temp=49.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.99 cputime=2.249 memavail=1485948 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 46.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1278 bytes_read=8321 bytes_retransmit=0 bytes_invalid=0 send_seq=150 receive_seq=150 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000266  raspberry_pi: temp=51.1 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.99 cputime=2.266 memavail=1485464 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 47.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1284 bytes_read=8476 bytes_retransmit=0 bytes_invalid=0 send_seq=151 receive_seq=151 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000260  raspberry_pi: temp=50.1 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.99 cputime=2.283 memavail=1484988 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 48.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1290 bytes_read=8645 bytes_retransmit=0 bytes_invalid=0 send_seq=152 receive_seq=152 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000253  raspberry_pi: temp=50.6 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.99 cputime=2.301 memavail=1484988 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 49.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1296 bytes_read=8786 bytes_retransmit=0 bytes_invalid=0 send_seq=153 receive_seq=153 retransmit_seq=0 srtt=0.003 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000275  raspberry_pi: temp=49.2 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.99 cputime=2.318 memavail=1484764 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 50.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1302 bytes_read=8965 bytes_retransmit=0 bytes_invalid=0 send_seq=154 receive_seq=154 retransmit_seq=0 srtt=0.003 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000261  raspberry_pi: temp=50.1 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=1.99 cputime=2.335 memavail=1484764 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 51.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1308 bytes_read=9146 bytes_retransmit=0 bytes_invalid=0 send_seq=155 receive_seq=155 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000254  raspberry_pi: temp=51.1 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.99 cputime=2.351 memavail=1484544 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 52.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1314 bytes_read=9297 bytes_retransmit=0 bytes_invalid=0 send_seq=156 receive_seq=156 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000242  raspberry_pi: temp=51.1 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.99 cputime=2.367 memavail=1484312 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 53.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1320 bytes_read=9463 bytes_retransmit=0 bytes_invalid=0 send_seq=157 receive_seq=157 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000230  raspberry_pi: temp=49.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.99 cputime=2.378 memavail=1484312 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 54.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1326 bytes_read=9644 bytes_retransmit=0 bytes_invalid=0 send_seq=158 receive_seq=158 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000218  raspberry_pi: temp=50.1 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=1.99 cputime=2.389 memavail=1483556 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 55.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1332 bytes_read=9809 bytes_retransmit=0 bytes_invalid=0 send_seq=159 receive_seq=159 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000208  raspberry_pi: temp=50.1 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.99 cputime=2.400 memavail=1483300 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 56.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1338 bytes_read=9975 bytes_retransmit=0 bytes_invalid=0 send_seq=160 receive_seq=160 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000199  raspberry_pi: temp=50.1 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.99 cputime=2.414 memavail=1483308 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 57.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1344 bytes_read=10156 bytes_retransmit=0 bytes_invalid=0 send_seq=161 receive_seq=161 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000197  raspberry_pi: temp=49.7 mcu_temp: temp=29.4 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.99 cputime=2.432 memavail=1483308 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 58.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1350 bytes_read=10307 bytes_retransmit=0 bytes_invalid=0 send_seq=162 receive_seq=162 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000199  raspberry_pi: temp=49.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.99 cputime=2.449 memavail=1483084 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 59.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1356 bytes_read=10473 bytes_retransmit=0 bytes_invalid=0 send_seq=163 receive_seq=163 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000206  raspberry_pi: temp=49.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.99 cputime=2.464 memavail=1483084 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 60.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1362 bytes_read=10654 bytes_retransmit=0 bytes_invalid=0 send_seq=164 receive_seq=164 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000205  raspberry_pi: temp=49.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.99 cputime=2.482 memavail=1482932 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 61.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1368 bytes_read=10819 bytes_retransmit=0 bytes_invalid=0 send_seq=165 receive_seq=165 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000203  raspberry_pi: temp=50.1 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.99 cputime=2.496 memavail=1482708 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 62.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1374 bytes_read=10985 bytes_retransmit=0 bytes_invalid=0 send_seq=166 receive_seq=166 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000198  raspberry_pi: temp=51.1 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=1.99 cputime=2.506 memavail=1482756 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 63.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1380 bytes_read=11166 bytes_retransmit=0 bytes_invalid=0 send_seq=167 receive_seq=167 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000192  raspberry_pi: temp=50.6 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=1.99 cputime=2.517 memavail=1482756 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 64.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1386 bytes_read=11317 bytes_retransmit=0 bytes_invalid=0 send_seq=168 receive_seq=168 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000191  raspberry_pi: temp=50.1 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=1.99 cputime=2.528 memavail=1481748 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 65.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1392 bytes_read=11483 bytes_retransmit=0 bytes_invalid=0 send_seq=169 receive_seq=169 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000186  raspberry_pi: temp=50.6 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.00 cputime=2.539 memavail=1481748 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 66.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1398 bytes_read=11678 bytes_retransmit=0 bytes_invalid=0 send_seq=170 receive_seq=170 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000180  raspberry_pi: temp=49.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.00 cputime=2.554 memavail=1481748 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 67.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1404 bytes_read=11829 bytes_retransmit=0 bytes_invalid=0 send_seq=171 receive_seq=171 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000186  raspberry_pi: temp=50.6 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.00 cputime=2.570 memavail=1481748 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 68.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1410 bytes_read=12010 bytes_retransmit=0 bytes_invalid=0 send_seq=172 receive_seq=172 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000190  raspberry_pi: temp=50.6 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.00 cputime=2.589 memavail=1481748 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 69.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1416 bytes_read=12176 bytes_retransmit=0 bytes_invalid=0 send_seq=173 receive_seq=173 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000205  raspberry_pi: temp=50.1 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=2.00 cputime=2.606 memavail=1481748 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.6 pwm=0.000
Stats 70.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1422 bytes_read=12327 bytes_retransmit=0 bytes_invalid=0 send_seq=174 receive_seq=174 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000203  raspberry_pi: temp=49.2 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.00 cputime=2.623 memavail=1481748 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 71.6: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1428 bytes_read=12522 bytes_retransmit=0 bytes_invalid=0 send_seq=175 receive_seq=175 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000207  raspberry_pi: temp=49.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.00 cputime=2.641 memavail=1481748 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 72.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1434 bytes_read=12688 bytes_retransmit=0 bytes_invalid=0 send_seq=176 receive_seq=176 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000205  raspberry_pi: temp=49.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.00 cputime=2.659 memavail=1481748 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 73.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1440 bytes_read=12839 bytes_retransmit=0 bytes_invalid=0 send_seq=177 receive_seq=177 retransmit_seq=0 srtt=0.003 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000225  raspberry_pi: temp=49.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.00 cputime=2.676 memavail=1481524 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 74.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1446 bytes_read=13020 bytes_retransmit=0 bytes_invalid=0 send_seq=178 receive_seq=178 retransmit_seq=0 srtt=0.003 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000225  raspberry_pi: temp=49.2 mcu_temp: temp=29.6 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.00 cputime=2.694 memavail=1481524 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 75.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1452 bytes_read=13186 bytes_retransmit=0 bytes_invalid=0 send_seq=179 receive_seq=179 retransmit_seq=0 srtt=0.003 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000222  raspberry_pi: temp=49.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.08 cputime=2.712 memavail=1481320 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 76.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1458 bytes_read=13351 bytes_retransmit=0 bytes_invalid=0 send_seq=180 receive_seq=180 retransmit_seq=0 srtt=0.003 rttvar=0.001 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000220  raspberry_pi: temp=49.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.08 cputime=2.729 memavail=1481320 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 77.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1464 bytes_read=13532 bytes_retransmit=0 bytes_invalid=0 send_seq=181 receive_seq=181 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000219  raspberry_pi: temp=49.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=2.08 cputime=2.746 memavail=1481324 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 78.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1470 bytes_read=13698 bytes_retransmit=0 bytes_invalid=0 send_seq=182 receive_seq=182 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000217  raspberry_pi: temp=50.6 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.08 cputime=2.763 memavail=1481324 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 79.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1476 bytes_read=13849 bytes_retransmit=0 bytes_invalid=0 send_seq=183 receive_seq=183 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000214  raspberry_pi: temp=49.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.08 cputime=2.780 memavail=1481324 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 80.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1482 bytes_read=14030 bytes_retransmit=0 bytes_invalid=0 send_seq=184 receive_seq=184 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000211  raspberry_pi: temp=49.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.07 cputime=2.797 memavail=1481324 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.4 pwm=0.000
Stats 81.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1488 bytes_read=14210 bytes_retransmit=0 bytes_invalid=0 send_seq=185 receive_seq=185 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000208  raspberry_pi: temp=50.1 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.07 cputime=2.814 memavail=1481324 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 82.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1494 bytes_read=14361 bytes_retransmit=0 bytes_invalid=0 send_seq=186 receive_seq=186 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000206  raspberry_pi: temp=49.2 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.5 pwm=0.000 sysload=2.07 cputime=2.830 memavail=1481324 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 83.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1506 bytes_read=14558 bytes_retransmit=0 bytes_invalid=0 send_seq=188 receive_seq=188 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000211  raspberry_pi: temp=49.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.07 cputime=2.849 memavail=1481324 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
Stats 84.7: gcodein=0  mcu: mcu_awake=0.002 mcu_task_avg=0.000019 mcu_task_stddev=0.000009 bytes_write=1512 bytes_read=14724 bytes_retransmit=0 bytes_invalid=0 send_seq=189 receive_seq=189 retransmit_seq=0 srtt=0.003 rttvar=0.000 rto=0.025 ready_bytes=0 upcoming_bytes=0 freq=72000210  raspberry_pi: temp=49.7 mcu_temp: temp=29.5 heater_bed: target=0 temp=20.6 pwm=0.000 sysload=2.07 cputime=2.867 memavail=1480584 print_time=574.150 buffer_time=0.000 print_stall=0 extruder: target=0 temp=21.5 pwm=0.000
webhooks client 547695212816: Disconnected
webhooks client 547697274016: New connection
webhooks client 547697274016: Client info {'program': 'Moonraker', 'version': 'v0.9.3-3-gccfe32f'}
webhooks: registering remote method 'shutdown_machine' for connection id: 547697274016
webhooks: registering remote method 'reboot_machine' for connection id: 547697274016
webhooks: registering remote method 'pause_job_queue' for connection id: 547697274016
webhooks: registering remote method 'start_job_queue' for connection id: 547697274016
webhooks: registering remote method 'spoolman_set_active_spool' for connection id: 547697274016
